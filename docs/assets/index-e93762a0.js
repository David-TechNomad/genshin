var aO=Object.defineProperty;var sO=(a,l,h)=>l in a?aO(a,l,{enumerable:!0,configurable:!0,writable:!0,value:h}):a[l]=h;var N=(a,l,h)=>(sO(a,typeof l!="symbol"?l+"":l,h),h);(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))m(x);new MutationObserver(x=>{for(const _ of x)if(_.type==="childList")for(const A of _.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&m(A)}).observe(document,{childList:!0,subtree:!0});function h(x){const _={};return x.integrity&&(_.integrity=x.integrity),x.referrerPolicy&&(_.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?_.credentials="include":x.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function m(x){if(x.ep)return;x.ep=!0;const _=h(x);fetch(x.href,_)}})();function oO(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var xM={exports:{}},$p={},bM={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qu=Symbol.for("react.element"),lO=Symbol.for("react.portal"),cO=Symbol.for("react.fragment"),uO=Symbol.for("react.strict_mode"),hO=Symbol.for("react.profiler"),dO=Symbol.for("react.provider"),pO=Symbol.for("react.context"),fO=Symbol.for("react.forward_ref"),mO=Symbol.for("react.suspense"),gO=Symbol.for("react.memo"),vO=Symbol.for("react.lazy"),ew=Symbol.iterator;function yO(a){return a===null||typeof a!="object"?null:(a=ew&&a[ew]||a["@@iterator"],typeof a=="function"?a:null)}var SM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_M=Object.assign,wM={};function ec(a,l,h){this.props=a,this.context=l,this.refs=wM,this.updater=h||SM}ec.prototype.isReactComponent={};ec.prototype.setState=function(a,l){if(typeof a!="object"&&typeof a!="function"&&a!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,a,l,"setState")};ec.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};function MM(){}MM.prototype=ec.prototype;function Bv(a,l,h){this.props=a,this.context=l,this.refs=wM,this.updater=h||SM}var Hv=Bv.prototype=new MM;Hv.constructor=Bv;_M(Hv,ec.prototype);Hv.isPureReactComponent=!0;var tw=Array.isArray,TM=Object.prototype.hasOwnProperty,jv={current:null},EM={key:!0,ref:!0,__self:!0,__source:!0};function AM(a,l,h){var m,x={},_=null,A=null;if(l!=null)for(m in l.ref!==void 0&&(A=l.ref),l.key!==void 0&&(_=""+l.key),l)TM.call(l,m)&&!EM.hasOwnProperty(m)&&(x[m]=l[m]);var k=arguments.length-2;if(k===1)x.children=h;else if(1<k){for(var B=Array(k),K=0;K<k;K++)B[K]=arguments[K+2];x.children=B}if(a&&a.defaultProps)for(m in k=a.defaultProps,k)x[m]===void 0&&(x[m]=k[m]);return{$$typeof:qu,type:a,key:_,ref:A,props:x,_owner:jv.current}}function xO(a,l){return{$$typeof:qu,type:a.type,key:l,ref:a.ref,props:a.props,_owner:a._owner}}function Gv(a){return typeof a=="object"&&a!==null&&a.$$typeof===qu}function bO(a){var l={"=":"=0",":":"=2"};return"$"+a.replace(/[=:]/g,function(h){return l[h]})}var nw=/\/+/g;function gg(a,l){return typeof a=="object"&&a!==null&&a.key!=null?bO(""+a.key):l.toString(36)}function gp(a,l,h,m,x){var _=typeof a;(_==="undefined"||_==="boolean")&&(a=null);var A=!1;if(a===null)A=!0;else switch(_){case"string":case"number":A=!0;break;case"object":switch(a.$$typeof){case qu:case lO:A=!0}}if(A)return A=a,x=x(A),a=m===""?"."+gg(A,0):m,tw(x)?(h="",a!=null&&(h=a.replace(nw,"$&/")+"/"),gp(x,l,h,"",function(K){return K})):x!=null&&(Gv(x)&&(x=xO(x,h+(!x.key||A&&A.key===x.key?"":(""+x.key).replace(nw,"$&/")+"/")+a)),l.push(x)),1;if(A=0,m=m===""?".":m+":",tw(a))for(var k=0;k<a.length;k++){_=a[k];var B=m+gg(_,k);A+=gp(_,l,h,B,x)}else if(B=yO(a),typeof B=="function")for(a=B.call(a),k=0;!(_=a.next()).done;)_=_.value,B=m+gg(_,k++),A+=gp(_,l,h,B,x);else if(_==="object")throw l=String(a),Error("Objects are not valid as a React child (found: "+(l==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":l)+"). If you meant to render a collection of children, use an array instead.");return A}function Qd(a,l,h){if(a==null)return a;var m=[],x=0;return gp(a,m,"","",function(_){return l.call(h,_,x++)}),m}function SO(a){if(a._status===-1){var l=a._result;l=l(),l.then(function(h){(a._status===0||a._status===-1)&&(a._status=1,a._result=h)},function(h){(a._status===0||a._status===-1)&&(a._status=2,a._result=h)}),a._status===-1&&(a._status=0,a._result=l)}if(a._status===1)return a._result.default;throw a._result}var ci={current:null},vp={transition:null},_O={ReactCurrentDispatcher:ci,ReactCurrentBatchConfig:vp,ReactCurrentOwner:jv};yt.Children={map:Qd,forEach:function(a,l,h){Qd(a,function(){l.apply(this,arguments)},h)},count:function(a){var l=0;return Qd(a,function(){l++}),l},toArray:function(a){return Qd(a,function(l){return l})||[]},only:function(a){if(!Gv(a))throw Error("React.Children.only expected to receive a single React element child.");return a}};yt.Component=ec;yt.Fragment=cO;yt.Profiler=hO;yt.PureComponent=Bv;yt.StrictMode=uO;yt.Suspense=mO;yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_O;yt.cloneElement=function(a,l,h){if(a==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+a+".");var m=_M({},a.props),x=a.key,_=a.ref,A=a._owner;if(l!=null){if(l.ref!==void 0&&(_=l.ref,A=jv.current),l.key!==void 0&&(x=""+l.key),a.type&&a.type.defaultProps)var k=a.type.defaultProps;for(B in l)TM.call(l,B)&&!EM.hasOwnProperty(B)&&(m[B]=l[B]===void 0&&k!==void 0?k[B]:l[B])}var B=arguments.length-2;if(B===1)m.children=h;else if(1<B){k=Array(B);for(var K=0;K<B;K++)k[K]=arguments[K+2];m.children=k}return{$$typeof:qu,type:a.type,key:x,ref:_,props:m,_owner:A}};yt.createContext=function(a){return a={$$typeof:pO,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},a.Provider={$$typeof:dO,_context:a},a.Consumer=a};yt.createElement=AM;yt.createFactory=function(a){var l=AM.bind(null,a);return l.type=a,l};yt.createRef=function(){return{current:null}};yt.forwardRef=function(a){return{$$typeof:fO,render:a}};yt.isValidElement=Gv;yt.lazy=function(a){return{$$typeof:vO,_payload:{_status:-1,_result:a},_init:SO}};yt.memo=function(a,l){return{$$typeof:gO,type:a,compare:l===void 0?null:l}};yt.startTransition=function(a){var l=vp.transition;vp.transition={};try{a()}finally{vp.transition=l}};yt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};yt.useCallback=function(a,l){return ci.current.useCallback(a,l)};yt.useContext=function(a){return ci.current.useContext(a)};yt.useDebugValue=function(){};yt.useDeferredValue=function(a){return ci.current.useDeferredValue(a)};yt.useEffect=function(a,l){return ci.current.useEffect(a,l)};yt.useId=function(){return ci.current.useId()};yt.useImperativeHandle=function(a,l,h){return ci.current.useImperativeHandle(a,l,h)};yt.useInsertionEffect=function(a,l){return ci.current.useInsertionEffect(a,l)};yt.useLayoutEffect=function(a,l){return ci.current.useLayoutEffect(a,l)};yt.useMemo=function(a,l){return ci.current.useMemo(a,l)};yt.useReducer=function(a,l,h){return ci.current.useReducer(a,l,h)};yt.useRef=function(a){return ci.current.useRef(a)};yt.useState=function(a){return ci.current.useState(a)};yt.useSyncExternalStore=function(a,l,h){return ci.current.useSyncExternalStore(a,l,h)};yt.useTransition=function(){return ci.current.useTransition()};yt.version="18.2.0";bM.exports=yt;var Mn=bM.exports;const wO=oO(Mn);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MO=Mn,TO=Symbol.for("react.element"),EO=Symbol.for("react.fragment"),AO=Object.prototype.hasOwnProperty,RO=MO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LO={key:!0,ref:!0,__self:!0,__source:!0};function RM(a,l,h){var m,x={},_=null,A=null;h!==void 0&&(_=""+h),l.key!==void 0&&(_=""+l.key),l.ref!==void 0&&(A=l.ref);for(m in l)AO.call(l,m)&&!LO.hasOwnProperty(m)&&(x[m]=l[m]);if(a&&a.defaultProps)for(m in l=a.defaultProps,l)x[m]===void 0&&(x[m]=l[m]);return{$$typeof:TO,type:a,key:_,ref:A,props:x,_owner:RO.current}}$p.Fragment=EO;$p.jsx=RM;$p.jsxs=RM;xM.exports=$p;var Tt=xM.exports;var Wg={},LM={exports:{}},Fi={},PM={exports:{}},CM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function l(Xe,tt){var st=Xe.length;Xe.push(tt);e:for(;0<st;){var Yt=st-1>>>1,sn=Xe[Yt];if(0<x(sn,tt))Xe[Yt]=tt,Xe[st]=sn,st=Yt;else break e}}function h(Xe){return Xe.length===0?null:Xe[0]}function m(Xe){if(Xe.length===0)return null;var tt=Xe[0],st=Xe.pop();if(st!==tt){Xe[0]=st;e:for(var Yt=0,sn=Xe.length,bs=sn>>>1;Yt<bs;){var Tr=2*(Yt+1)-1,Ss=Xe[Tr],nr=Tr+1,_s=Xe[nr];if(0>x(Ss,st))nr<sn&&0>x(_s,Ss)?(Xe[Yt]=_s,Xe[nr]=st,Yt=nr):(Xe[Yt]=Ss,Xe[Tr]=st,Yt=Tr);else if(nr<sn&&0>x(_s,st))Xe[Yt]=_s,Xe[nr]=st,Yt=nr;else break e}}return tt}function x(Xe,tt){var st=Xe.sortIndex-tt.sortIndex;return st!==0?st:Xe.id-tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _=performance;a.unstable_now=function(){return _.now()}}else{var A=Date,k=A.now();a.unstable_now=function(){return A.now()-k}}var B=[],K=[],ge=1,ve=null,fe=3,Ce=!1,Fe=!1,Ue=!1,vt=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(Xe){for(var tt=h(K);tt!==null;){if(tt.callback===null)m(K);else if(tt.startTime<=Xe)m(K),tt.sortIndex=tt.expirationTime,l(B,tt);else break;tt=h(K)}}function D(Xe){if(Ue=!1,se(Xe),!Fe)if(h(B)!==null)Fe=!0,tr(Q);else{var tt=h(K);tt!==null&&Eo(D,tt.startTime-Xe)}}function Q(Xe,tt){Fe=!1,Ue&&(Ue=!1,re(_e),_e=-1),Ce=!0;var st=fe;try{for(se(tt),ve=h(B);ve!==null&&(!(ve.expirationTime>tt)||Xe&&!at());){var Yt=ve.callback;if(typeof Yt=="function"){ve.callback=null,fe=ve.priorityLevel;var sn=Yt(ve.expirationTime<=tt);tt=a.unstable_now(),typeof sn=="function"?ve.callback=sn:ve===h(B)&&m(B),se(tt)}else m(B);ve=h(B)}if(ve!==null)var bs=!0;else{var Tr=h(K);Tr!==null&&Eo(D,Tr.startTime-tt),bs=!1}return bs}finally{ve=null,fe=st,Ce=!1}}var oe=!1,xe=null,_e=-1,We=5,ke=-1;function at(){return!(a.unstable_now()-ke<We)}function gn(){if(xe!==null){var Xe=a.unstable_now();ke=Xe;var tt=!0;try{tt=xe(!0,Xe)}finally{tt?ei():(oe=!1,xe=null)}}else oe=!1}var ei;if(typeof Z=="function")ei=function(){Z(gn)};else if(typeof MessageChannel<"u"){var er=new MessageChannel,xs=er.port2;er.port1.onmessage=gn,ei=function(){xs.postMessage(null)}}else ei=function(){vt(gn,0)};function tr(Xe){xe=Xe,oe||(oe=!0,ei())}function Eo(Xe,tt){_e=vt(function(){Xe(a.unstable_now())},tt)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Xe){Xe.callback=null},a.unstable_continueExecution=function(){Fe||Ce||(Fe=!0,tr(Q))},a.unstable_forceFrameRate=function(Xe){0>Xe||125<Xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):We=0<Xe?Math.floor(1e3/Xe):5},a.unstable_getCurrentPriorityLevel=function(){return fe},a.unstable_getFirstCallbackNode=function(){return h(B)},a.unstable_next=function(Xe){switch(fe){case 1:case 2:case 3:var tt=3;break;default:tt=fe}var st=fe;fe=tt;try{return Xe()}finally{fe=st}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Xe,tt){switch(Xe){case 1:case 2:case 3:case 4:case 5:break;default:Xe=3}var st=fe;fe=Xe;try{return tt()}finally{fe=st}},a.unstable_scheduleCallback=function(Xe,tt,st){var Yt=a.unstable_now();switch(typeof st=="object"&&st!==null?(st=st.delay,st=typeof st=="number"&&0<st?Yt+st:Yt):st=Yt,Xe){case 1:var sn=-1;break;case 2:sn=250;break;case 5:sn=1073741823;break;case 4:sn=1e4;break;default:sn=5e3}return sn=st+sn,Xe={id:ge++,callback:tt,priorityLevel:Xe,startTime:st,expirationTime:sn,sortIndex:-1},st>Yt?(Xe.sortIndex=st,l(K,Xe),h(B)===null&&Xe===h(K)&&(Ue?(re(_e),_e=-1):Ue=!0,Eo(D,st-Yt))):(Xe.sortIndex=sn,l(B,Xe),Fe||Ce||(Fe=!0,tr(Q))),Xe},a.unstable_shouldYield=at,a.unstable_wrapCallback=function(Xe){var tt=fe;return function(){var st=fe;fe=tt;try{return Xe.apply(this,arguments)}finally{fe=st}}}})(CM);PM.exports=CM;var PO=PM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DM=Mn,ki=PO;function Ie(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,h=1;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var OM=new Set,Pu={};function Mo(a,l){ql(a,l),ql(a+"Capture",l)}function ql(a,l){for(Pu[a]=l,a=0;a<l.length;a++)OM.add(l[a])}var va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xg=Object.prototype.hasOwnProperty,CO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iw={},rw={};function DO(a){return Xg.call(rw,a)?!0:Xg.call(iw,a)?!1:CO.test(a)?rw[a]=!0:(iw[a]=!0,!1)}function OO(a,l,h,m){if(h!==null&&h.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:h!==null?!h.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function IO(a,l,h,m){if(l===null||typeof l>"u"||OO(a,l,h,m))return!0;if(m)return!1;if(h!==null)switch(h.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function ui(a,l,h,m,x,_,A){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=x,this.mustUseProperty=h,this.propertyName=a,this.type=l,this.sanitizeURL=_,this.removeEmptyString=A}var Bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){Bn[a]=new ui(a,0,!1,a,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];Bn[l]=new ui(l,1,!1,a[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){Bn[a]=new ui(a,2,!1,a.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){Bn[a]=new ui(a,2,!1,a,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){Bn[a]=new ui(a,3,!1,a.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(a){Bn[a]=new ui(a,3,!0,a,null,!1,!1)});["capture","download"].forEach(function(a){Bn[a]=new ui(a,4,!1,a,null,!1,!1)});["cols","rows","size","span"].forEach(function(a){Bn[a]=new ui(a,6,!1,a,null,!1,!1)});["rowSpan","start"].forEach(function(a){Bn[a]=new ui(a,5,!1,a.toLowerCase(),null,!1,!1)});var Vv=/[\-:]([a-z])/g;function Wv(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(Vv,Wv);Bn[l]=new ui(l,1,!1,a,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(Vv,Wv);Bn[l]=new ui(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(Vv,Wv);Bn[l]=new ui(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(a){Bn[a]=new ui(a,1,!1,a.toLowerCase(),null,!1,!1)});Bn.xlinkHref=new ui("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(a){Bn[a]=new ui(a,1,!1,a.toLowerCase(),null,!0,!0)});function Xv(a,l,h,m){var x=Bn.hasOwnProperty(l)?Bn[l]:null;(x!==null?x.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(IO(l,h,x,m)&&(h=null),m||x===null?DO(l)&&(h===null?a.removeAttribute(l):a.setAttribute(l,""+h)):x.mustUseProperty?a[x.propertyName]=h===null?x.type===3?!1:"":h:(l=x.attributeName,m=x.attributeNamespace,h===null?a.removeAttribute(l):(x=x.type,h=x===3||x===4&&h===!0?"":""+h,m?a.setAttributeNS(m,l,h):a.setAttribute(l,h))))}var Sa=DM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zd=Symbol.for("react.element"),Ll=Symbol.for("react.portal"),Pl=Symbol.for("react.fragment"),qv=Symbol.for("react.strict_mode"),qg=Symbol.for("react.profiler"),IM=Symbol.for("react.provider"),NM=Symbol.for("react.context"),Yv=Symbol.for("react.forward_ref"),Yg=Symbol.for("react.suspense"),Qg=Symbol.for("react.suspense_list"),Qv=Symbol.for("react.memo"),$a=Symbol.for("react.lazy"),kM=Symbol.for("react.offscreen"),aw=Symbol.iterator;function ou(a){return a===null||typeof a!="object"?null:(a=aw&&a[aw]||a["@@iterator"],typeof a=="function"?a:null)}var tn=Object.assign,vg;function gu(a){if(vg===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);vg=l&&l[1]||""}return`
`+vg+a}var yg=!1;function xg(a,l){if(!a||yg)return"";yg=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(K){var m=K}Reflect.construct(a,[],l)}else{try{l.call()}catch(K){m=K}a.call(l.prototype)}else{try{throw Error()}catch(K){m=K}a()}}catch(K){if(K&&m&&typeof K.stack=="string"){for(var x=K.stack.split(`
`),_=m.stack.split(`
`),A=x.length-1,k=_.length-1;1<=A&&0<=k&&x[A]!==_[k];)k--;for(;1<=A&&0<=k;A--,k--)if(x[A]!==_[k]){if(A!==1||k!==1)do if(A--,k--,0>k||x[A]!==_[k]){var B=`
`+x[A].replace(" at new "," at ");return a.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",a.displayName)),B}while(1<=A&&0<=k);break}}}finally{yg=!1,Error.prepareStackTrace=h}return(a=a?a.displayName||a.name:"")?gu(a):""}function NO(a){switch(a.tag){case 5:return gu(a.type);case 16:return gu("Lazy");case 13:return gu("Suspense");case 19:return gu("SuspenseList");case 0:case 2:case 15:return a=xg(a.type,!1),a;case 11:return a=xg(a.type.render,!1),a;case 1:return a=xg(a.type,!0),a;default:return""}}function Zg(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case Pl:return"Fragment";case Ll:return"Portal";case qg:return"Profiler";case qv:return"StrictMode";case Yg:return"Suspense";case Qg:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case NM:return(a.displayName||"Context")+".Consumer";case IM:return(a._context.displayName||"Context")+".Provider";case Yv:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Qv:return l=a.displayName||null,l!==null?l:Zg(a.type)||"Memo";case $a:l=a._payload,a=a._init;try{return Zg(a(l))}catch{}}return null}function kO(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zg(l);case 8:return l===qv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ps(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function FM(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function FO(a){var l=FM(a)?"checked":"value",h=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),m=""+a[l];if(!a.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,_=h.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return x.call(this)},set:function(A){m=""+A,_.call(this,A)}}),Object.defineProperty(a,l,{enumerable:h.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Kd(a){a._valueTracker||(a._valueTracker=FO(a))}function UM(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var h=l.getValue(),m="";return a&&(m=FM(a)?a.checked?"true":"false":a.value),a=m,a!==h?(l.setValue(a),!0):!1}function Rp(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Kg(a,l){var h=l.checked;return tn({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??a._wrapperState.initialChecked})}function sw(a,l){var h=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;h=ps(l.value!=null?l.value:h),a._wrapperState={initialChecked:m,initialValue:h,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function zM(a,l){l=l.checked,l!=null&&Xv(a,"checked",l,!1)}function Jg(a,l){zM(a,l);var h=ps(l.value),m=l.type;if(h!=null)m==="number"?(h===0&&a.value===""||a.value!=h)&&(a.value=""+h):a.value!==""+h&&(a.value=""+h);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?$g(a,l.type,h):l.hasOwnProperty("defaultValue")&&$g(a,l.type,ps(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function ow(a,l,h){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,h||l===a.value||(a.value=l),a.defaultValue=l}h=a.name,h!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,h!==""&&(a.name=h)}function $g(a,l,h){(l!=="number"||Rp(a.ownerDocument)!==a)&&(h==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+h&&(a.defaultValue=""+h))}var vu=Array.isArray;function Hl(a,l,h,m){if(a=a.options,l){l={};for(var x=0;x<h.length;x++)l["$"+h[x]]=!0;for(h=0;h<a.length;h++)x=l.hasOwnProperty("$"+a[h].value),a[h].selected!==x&&(a[h].selected=x),x&&m&&(a[h].defaultSelected=!0)}else{for(h=""+ps(h),l=null,x=0;x<a.length;x++){if(a[x].value===h){a[x].selected=!0,m&&(a[x].defaultSelected=!0);return}l!==null||a[x].disabled||(l=a[x])}l!==null&&(l.selected=!0)}}function ev(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return tn({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function lw(a,l){var h=l.value;if(h==null){if(h=l.children,l=l.defaultValue,h!=null){if(l!=null)throw Error(Ie(92));if(vu(h)){if(1<h.length)throw Error(Ie(93));h=h[0]}l=h}l==null&&(l=""),h=l}a._wrapperState={initialValue:ps(h)}}function BM(a,l){var h=ps(l.value),m=ps(l.defaultValue);h!=null&&(h=""+h,h!==a.value&&(a.value=h),l.defaultValue==null&&a.defaultValue!==h&&(a.defaultValue=h)),m!=null&&(a.defaultValue=""+m)}function cw(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function HM(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tv(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?HM(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Jd,jM=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,h,m,x){MSApp.execUnsafeLocalFunction(function(){return a(l,h,m,x)})}:a}(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(Jd=Jd||document.createElement("div"),Jd.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Jd.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function Cu(a,l){if(l){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=l;return}}a.textContent=l}var bu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UO=["Webkit","ms","Moz","O"];Object.keys(bu).forEach(function(a){UO.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),bu[l]=bu[a]})});function GM(a,l,h){return l==null||typeof l=="boolean"||l===""?"":h||typeof l!="number"||l===0||bu.hasOwnProperty(a)&&bu[a]?(""+l).trim():l+"px"}function VM(a,l){a=a.style;for(var h in l)if(l.hasOwnProperty(h)){var m=h.indexOf("--")===0,x=GM(h,l[h],m);h==="float"&&(h="cssFloat"),m?a.setProperty(h,x):a[h]=x}}var zO=tn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nv(a,l){if(l){if(zO[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(Ie(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(Ie(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(Ie(61))}if(l.style!=null&&typeof l.style!="object")throw Error(Ie(62))}}function iv(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rv=null;function Zv(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var av=null,jl=null,Gl=null;function uw(a){if(a=Zu(a)){if(typeof av!="function")throw Error(Ie(280));var l=a.stateNode;l&&(l=af(l),av(a.stateNode,a.type,l))}}function WM(a){jl?Gl?Gl.push(a):Gl=[a]:jl=a}function XM(){if(jl){var a=jl,l=Gl;if(Gl=jl=null,uw(a),l)for(a=0;a<l.length;a++)uw(l[a])}}function qM(a,l){return a(l)}function YM(){}var bg=!1;function QM(a,l,h){if(bg)return a(l,h);bg=!0;try{return qM(a,l,h)}finally{bg=!1,(jl!==null||Gl!==null)&&(YM(),XM())}}function Du(a,l){var h=a.stateNode;if(h===null)return null;var m=af(h);if(m===null)return null;h=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(Ie(231,l,typeof h));return h}var sv=!1;if(va)try{var lu={};Object.defineProperty(lu,"passive",{get:function(){sv=!0}}),window.addEventListener("test",lu,lu),window.removeEventListener("test",lu,lu)}catch{sv=!1}function BO(a,l,h,m,x,_,A,k,B){var K=Array.prototype.slice.call(arguments,3);try{l.apply(h,K)}catch(ge){this.onError(ge)}}var Su=!1,Lp=null,Pp=!1,ov=null,HO={onError:function(a){Su=!0,Lp=a}};function jO(a,l,h,m,x,_,A,k,B){Su=!1,Lp=null,BO.apply(HO,arguments)}function GO(a,l,h,m,x,_,A,k,B){if(jO.apply(this,arguments),Su){if(Su){var K=Lp;Su=!1,Lp=null}else throw Error(Ie(198));Pp||(Pp=!0,ov=K)}}function To(a){var l=a,h=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,l.flags&4098&&(h=l.return),a=l.return;while(a)}return l.tag===3?h:null}function ZM(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function hw(a){if(To(a)!==a)throw Error(Ie(188))}function VO(a){var l=a.alternate;if(!l){if(l=To(a),l===null)throw Error(Ie(188));return l!==a?null:a}for(var h=a,m=l;;){var x=h.return;if(x===null)break;var _=x.alternate;if(_===null){if(m=x.return,m!==null){h=m;continue}break}if(x.child===_.child){for(_=x.child;_;){if(_===h)return hw(x),a;if(_===m)return hw(x),l;_=_.sibling}throw Error(Ie(188))}if(h.return!==m.return)h=x,m=_;else{for(var A=!1,k=x.child;k;){if(k===h){A=!0,h=x,m=_;break}if(k===m){A=!0,m=x,h=_;break}k=k.sibling}if(!A){for(k=_.child;k;){if(k===h){A=!0,h=_,m=x;break}if(k===m){A=!0,m=_,h=x;break}k=k.sibling}if(!A)throw Error(Ie(189))}}if(h.alternate!==m)throw Error(Ie(190))}if(h.tag!==3)throw Error(Ie(188));return h.stateNode.current===h?a:l}function KM(a){return a=VO(a),a!==null?JM(a):null}function JM(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=JM(a);if(l!==null)return l;a=a.sibling}return null}var $M=ki.unstable_scheduleCallback,dw=ki.unstable_cancelCallback,WO=ki.unstable_shouldYield,XO=ki.unstable_requestPaint,un=ki.unstable_now,qO=ki.unstable_getCurrentPriorityLevel,Kv=ki.unstable_ImmediatePriority,e2=ki.unstable_UserBlockingPriority,Cp=ki.unstable_NormalPriority,YO=ki.unstable_LowPriority,t2=ki.unstable_IdlePriority,ef=null,jr=null;function QO(a){if(jr&&typeof jr.onCommitFiberRoot=="function")try{jr.onCommitFiberRoot(ef,a,void 0,(a.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:JO,ZO=Math.log,KO=Math.LN2;function JO(a){return a>>>=0,a===0?32:31-(ZO(a)/KO|0)|0}var $d=64,ep=4194304;function yu(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Dp(a,l){var h=a.pendingLanes;if(h===0)return 0;var m=0,x=a.suspendedLanes,_=a.pingedLanes,A=h&268435455;if(A!==0){var k=A&~x;k!==0?m=yu(k):(_&=A,_!==0&&(m=yu(_)))}else A=h&~x,A!==0?m=yu(A):_!==0&&(m=yu(_));if(m===0)return 0;if(l!==0&&l!==m&&!(l&x)&&(x=m&-m,_=l&-l,x>=_||x===16&&(_&4194240)!==0))return l;if(m&4&&(m|=h&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=m;0<l;)h=31-_r(l),x=1<<h,m|=a[h],l&=~x;return m}function $O(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eI(a,l){for(var h=a.suspendedLanes,m=a.pingedLanes,x=a.expirationTimes,_=a.pendingLanes;0<_;){var A=31-_r(_),k=1<<A,B=x[A];B===-1?(!(k&h)||k&m)&&(x[A]=$O(k,l)):B<=l&&(a.expiredLanes|=k),_&=~k}}function lv(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function n2(){var a=$d;return $d<<=1,!($d&4194240)&&($d=64),a}function Sg(a){for(var l=[],h=0;31>h;h++)l.push(a);return l}function Yu(a,l,h){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-_r(l),a[l]=h}function tI(a,l){var h=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<h;){var x=31-_r(h),_=1<<x;l[x]=0,m[x]=-1,a[x]=-1,h&=~_}}function Jv(a,l){var h=a.entangledLanes|=l;for(a=a.entanglements;h;){var m=31-_r(h),x=1<<m;x&l|a[m]&l&&(a[m]|=l),h&=~x}}var It=0;function i2(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var r2,$v,a2,s2,o2,cv=!1,tp=[],as=null,ss=null,os=null,Ou=new Map,Iu=new Map,ts=[],nI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pw(a,l){switch(a){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":Ou.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Iu.delete(l.pointerId)}}function cu(a,l,h,m,x,_){return a===null||a.nativeEvent!==_?(a={blockedOn:l,domEventName:h,eventSystemFlags:m,nativeEvent:_,targetContainers:[x]},l!==null&&(l=Zu(l),l!==null&&$v(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),a)}function iI(a,l,h,m,x){switch(l){case"focusin":return as=cu(as,a,l,h,m,x),!0;case"dragenter":return ss=cu(ss,a,l,h,m,x),!0;case"mouseover":return os=cu(os,a,l,h,m,x),!0;case"pointerover":var _=x.pointerId;return Ou.set(_,cu(Ou.get(_)||null,a,l,h,m,x)),!0;case"gotpointercapture":return _=x.pointerId,Iu.set(_,cu(Iu.get(_)||null,a,l,h,m,x)),!0}return!1}function l2(a){var l=po(a.target);if(l!==null){var h=To(l);if(h!==null){if(l=h.tag,l===13){if(l=ZM(h),l!==null){a.blockedOn=l,o2(a.priority,function(){a2(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function yp(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var h=uv(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(h===null){h=a.nativeEvent;var m=new h.constructor(h.type,h);rv=m,h.target.dispatchEvent(m),rv=null}else return l=Zu(h),l!==null&&$v(l),a.blockedOn=h,!1;l.shift()}return!0}function fw(a,l,h){yp(a)&&h.delete(l)}function rI(){cv=!1,as!==null&&yp(as)&&(as=null),ss!==null&&yp(ss)&&(ss=null),os!==null&&yp(os)&&(os=null),Ou.forEach(fw),Iu.forEach(fw)}function uu(a,l){a.blockedOn===l&&(a.blockedOn=null,cv||(cv=!0,ki.unstable_scheduleCallback(ki.unstable_NormalPriority,rI)))}function Nu(a){function l(x){return uu(x,a)}if(0<tp.length){uu(tp[0],a);for(var h=1;h<tp.length;h++){var m=tp[h];m.blockedOn===a&&(m.blockedOn=null)}}for(as!==null&&uu(as,a),ss!==null&&uu(ss,a),os!==null&&uu(os,a),Ou.forEach(l),Iu.forEach(l),h=0;h<ts.length;h++)m=ts[h],m.blockedOn===a&&(m.blockedOn=null);for(;0<ts.length&&(h=ts[0],h.blockedOn===null);)l2(h),h.blockedOn===null&&ts.shift()}var Vl=Sa.ReactCurrentBatchConfig,Op=!0;function aI(a,l,h,m){var x=It,_=Vl.transition;Vl.transition=null;try{It=1,e1(a,l,h,m)}finally{It=x,Vl.transition=_}}function sI(a,l,h,m){var x=It,_=Vl.transition;Vl.transition=null;try{It=4,e1(a,l,h,m)}finally{It=x,Vl.transition=_}}function e1(a,l,h,m){if(Op){var x=uv(a,l,h,m);if(x===null)Cg(a,l,m,Ip,h),pw(a,m);else if(iI(x,a,l,h,m))m.stopPropagation();else if(pw(a,m),l&4&&-1<nI.indexOf(a)){for(;x!==null;){var _=Zu(x);if(_!==null&&r2(_),_=uv(a,l,h,m),_===null&&Cg(a,l,m,Ip,h),_===x)break;x=_}x!==null&&m.stopPropagation()}else Cg(a,l,m,null,h)}}var Ip=null;function uv(a,l,h,m){if(Ip=null,a=Zv(m),a=po(a),a!==null)if(l=To(a),l===null)a=null;else if(h=l.tag,h===13){if(a=ZM(l),a!==null)return a;a=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return Ip=a,null}function c2(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qO()){case Kv:return 1;case e2:return 4;case Cp:case YO:return 16;case t2:return 536870912;default:return 16}default:return 16}}var is=null,t1=null,xp=null;function u2(){if(xp)return xp;var a,l=t1,h=l.length,m,x="value"in is?is.value:is.textContent,_=x.length;for(a=0;a<h&&l[a]===x[a];a++);var A=h-a;for(m=1;m<=A&&l[h-m]===x[_-m];m++);return xp=x.slice(a,1<m?1-m:void 0)}function bp(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function np(){return!0}function mw(){return!1}function Ui(a){function l(h,m,x,_,A){this._reactName=h,this._targetInst=x,this.type=m,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var k in a)a.hasOwnProperty(k)&&(h=a[k],this[k]=h?h(_):_[k]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?np:mw,this.isPropagationStopped=mw,this}return tn(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=np)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=np)},persist:function(){},isPersistent:np}),l}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n1=Ui(tc),Qu=tn({},tc,{view:0,detail:0}),oI=Ui(Qu),_g,wg,hu,tf=tn({},Qu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:i1,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==hu&&(hu&&a.type==="mousemove"?(_g=a.screenX-hu.screenX,wg=a.screenY-hu.screenY):wg=_g=0,hu=a),_g)},movementY:function(a){return"movementY"in a?a.movementY:wg}}),gw=Ui(tf),lI=tn({},tf,{dataTransfer:0}),cI=Ui(lI),uI=tn({},Qu,{relatedTarget:0}),Mg=Ui(uI),hI=tn({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),dI=Ui(hI),pI=tn({},tc,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),fI=Ui(pI),mI=tn({},tc,{data:0}),vw=Ui(mI),gI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xI(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=yI[a])?!!l[a]:!1}function i1(){return xI}var bI=tn({},Qu,{key:function(a){if(a.key){var l=gI[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=bp(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?vI[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:i1,charCode:function(a){return a.type==="keypress"?bp(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?bp(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),SI=Ui(bI),_I=tn({},tf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yw=Ui(_I),wI=tn({},Qu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:i1}),MI=Ui(wI),TI=tn({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),EI=Ui(TI),AI=tn({},tf,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),RI=Ui(AI),LI=[9,13,27,32],r1=va&&"CompositionEvent"in window,_u=null;va&&"documentMode"in document&&(_u=document.documentMode);var PI=va&&"TextEvent"in window&&!_u,h2=va&&(!r1||_u&&8<_u&&11>=_u),xw=String.fromCharCode(32),bw=!1;function d2(a,l){switch(a){case"keyup":return LI.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p2(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Cl=!1;function CI(a,l){switch(a){case"compositionend":return p2(l);case"keypress":return l.which!==32?null:(bw=!0,xw);case"textInput":return a=l.data,a===xw&&bw?null:a;default:return null}}function DI(a,l){if(Cl)return a==="compositionend"||!r1&&d2(a,l)?(a=u2(),xp=t1=is=null,Cl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return h2&&l.locale!=="ko"?null:l.data;default:return null}}var OI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sw(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!OI[a.type]:l==="textarea"}function f2(a,l,h,m){WM(m),l=Np(l,"onChange"),0<l.length&&(h=new n1("onChange","change",null,h,m),a.push({event:h,listeners:l}))}var wu=null,ku=null;function II(a){T2(a,0)}function nf(a){var l=Il(a);if(UM(l))return a}function NI(a,l){if(a==="change")return l}var m2=!1;if(va){var Tg;if(va){var Eg="oninput"in document;if(!Eg){var _w=document.createElement("div");_w.setAttribute("oninput","return;"),Eg=typeof _w.oninput=="function"}Tg=Eg}else Tg=!1;m2=Tg&&(!document.documentMode||9<document.documentMode)}function ww(){wu&&(wu.detachEvent("onpropertychange",g2),ku=wu=null)}function g2(a){if(a.propertyName==="value"&&nf(ku)){var l=[];f2(l,ku,a,Zv(a)),QM(II,l)}}function kI(a,l,h){a==="focusin"?(ww(),wu=l,ku=h,wu.attachEvent("onpropertychange",g2)):a==="focusout"&&ww()}function FI(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return nf(ku)}function UI(a,l){if(a==="click")return nf(l)}function zI(a,l){if(a==="input"||a==="change")return nf(l)}function BI(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Mr=typeof Object.is=="function"?Object.is:BI;function Fu(a,l){if(Mr(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var h=Object.keys(a),m=Object.keys(l);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var x=h[m];if(!Xg.call(l,x)||!Mr(a[x],l[x]))return!1}return!0}function Mw(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Tw(a,l){var h=Mw(a);a=0;for(var m;h;){if(h.nodeType===3){if(m=a+h.textContent.length,a<=l&&m>=l)return{node:h,offset:l-a};a=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Mw(h)}}function v2(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?v2(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function y2(){for(var a=window,l=Rp();l instanceof a.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)a=l.contentWindow;else break;l=Rp(a.document)}return l}function a1(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function HI(a){var l=y2(),h=a.focusedElem,m=a.selectionRange;if(l!==h&&h&&h.ownerDocument&&v2(h.ownerDocument.documentElement,h)){if(m!==null&&a1(h)){if(l=m.start,a=m.end,a===void 0&&(a=l),"selectionStart"in h)h.selectionStart=l,h.selectionEnd=Math.min(a,h.value.length);else if(a=(l=h.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var x=h.textContent.length,_=Math.min(m.start,x);m=m.end===void 0?_:Math.min(m.end,x),!a.extend&&_>m&&(x=m,m=_,_=x),x=Tw(h,_);var A=Tw(h,m);x&&A&&(a.rangeCount!==1||a.anchorNode!==x.node||a.anchorOffset!==x.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(l=l.createRange(),l.setStart(x.node,x.offset),a.removeAllRanges(),_>m?(a.addRange(l),a.extend(A.node,A.offset)):(l.setEnd(A.node,A.offset),a.addRange(l)))}}for(l=[],a=h;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<l.length;h++)a=l[h],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var jI=va&&"documentMode"in document&&11>=document.documentMode,Dl=null,hv=null,Mu=null,dv=!1;function Ew(a,l,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;dv||Dl==null||Dl!==Rp(m)||(m=Dl,"selectionStart"in m&&a1(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Mu&&Fu(Mu,m)||(Mu=m,m=Np(hv,"onSelect"),0<m.length&&(l=new n1("onSelect","select",null,l,h),a.push({event:l,listeners:m}),l.target=Dl)))}function ip(a,l){var h={};return h[a.toLowerCase()]=l.toLowerCase(),h["Webkit"+a]="webkit"+l,h["Moz"+a]="moz"+l,h}var Ol={animationend:ip("Animation","AnimationEnd"),animationiteration:ip("Animation","AnimationIteration"),animationstart:ip("Animation","AnimationStart"),transitionend:ip("Transition","TransitionEnd")},Ag={},x2={};va&&(x2=document.createElement("div").style,"AnimationEvent"in window||(delete Ol.animationend.animation,delete Ol.animationiteration.animation,delete Ol.animationstart.animation),"TransitionEvent"in window||delete Ol.transitionend.transition);function rf(a){if(Ag[a])return Ag[a];if(!Ol[a])return a;var l=Ol[a],h;for(h in l)if(l.hasOwnProperty(h)&&h in x2)return Ag[a]=l[h];return a}var b2=rf("animationend"),S2=rf("animationiteration"),_2=rf("animationstart"),w2=rf("transitionend"),M2=new Map,Aw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ms(a,l){M2.set(a,l),Mo(l,[a])}for(var Rg=0;Rg<Aw.length;Rg++){var Lg=Aw[Rg],GI=Lg.toLowerCase(),VI=Lg[0].toUpperCase()+Lg.slice(1);ms(GI,"on"+VI)}ms(b2,"onAnimationEnd");ms(S2,"onAnimationIteration");ms(_2,"onAnimationStart");ms("dblclick","onDoubleClick");ms("focusin","onFocus");ms("focusout","onBlur");ms(w2,"onTransitionEnd");ql("onMouseEnter",["mouseout","mouseover"]);ql("onMouseLeave",["mouseout","mouseover"]);ql("onPointerEnter",["pointerout","pointerover"]);ql("onPointerLeave",["pointerout","pointerover"]);Mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WI=new Set("cancel close invalid load scroll toggle".split(" ").concat(xu));function Rw(a,l,h){var m=a.type||"unknown-event";a.currentTarget=h,GO(m,l,void 0,a),a.currentTarget=null}function T2(a,l){l=(l&4)!==0;for(var h=0;h<a.length;h++){var m=a[h],x=m.event;m=m.listeners;e:{var _=void 0;if(l)for(var A=m.length-1;0<=A;A--){var k=m[A],B=k.instance,K=k.currentTarget;if(k=k.listener,B!==_&&x.isPropagationStopped())break e;Rw(x,k,K),_=B}else for(A=0;A<m.length;A++){if(k=m[A],B=k.instance,K=k.currentTarget,k=k.listener,B!==_&&x.isPropagationStopped())break e;Rw(x,k,K),_=B}}}if(Pp)throw a=ov,Pp=!1,ov=null,a}function Wt(a,l){var h=l[vv];h===void 0&&(h=l[vv]=new Set);var m=a+"__bubble";h.has(m)||(E2(l,a,2,!1),h.add(m))}function Pg(a,l,h){var m=0;l&&(m|=4),E2(h,a,m,l)}var rp="_reactListening"+Math.random().toString(36).slice(2);function Uu(a){if(!a[rp]){a[rp]=!0,OM.forEach(function(h){h!=="selectionchange"&&(WI.has(h)||Pg(h,!1,a),Pg(h,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[rp]||(l[rp]=!0,Pg("selectionchange",!1,l))}}function E2(a,l,h,m){switch(c2(l)){case 1:var x=aI;break;case 4:x=sI;break;default:x=e1}h=x.bind(null,l,h,a),x=void 0,!sv||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),m?x!==void 0?a.addEventListener(l,h,{capture:!0,passive:x}):a.addEventListener(l,h,!0):x!==void 0?a.addEventListener(l,h,{passive:x}):a.addEventListener(l,h,!1)}function Cg(a,l,h,m,x){var _=m;if(!(l&1)&&!(l&2)&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var k=m.stateNode.containerInfo;if(k===x||k.nodeType===8&&k.parentNode===x)break;if(A===4)for(A=m.return;A!==null;){var B=A.tag;if((B===3||B===4)&&(B=A.stateNode.containerInfo,B===x||B.nodeType===8&&B.parentNode===x))return;A=A.return}for(;k!==null;){if(A=po(k),A===null)return;if(B=A.tag,B===5||B===6){m=_=A;continue e}k=k.parentNode}}m=m.return}QM(function(){var K=_,ge=Zv(h),ve=[];e:{var fe=M2.get(a);if(fe!==void 0){var Ce=n1,Fe=a;switch(a){case"keypress":if(bp(h)===0)break e;case"keydown":case"keyup":Ce=SI;break;case"focusin":Fe="focus",Ce=Mg;break;case"focusout":Fe="blur",Ce=Mg;break;case"beforeblur":case"afterblur":Ce=Mg;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=gw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=cI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=MI;break;case b2:case S2:case _2:Ce=dI;break;case w2:Ce=EI;break;case"scroll":Ce=oI;break;case"wheel":Ce=RI;break;case"copy":case"cut":case"paste":Ce=fI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=yw}var Ue=(l&4)!==0,vt=!Ue&&a==="scroll",re=Ue?fe!==null?fe+"Capture":null:fe;Ue=[];for(var Z=K,se;Z!==null;){se=Z;var D=se.stateNode;if(se.tag===5&&D!==null&&(se=D,re!==null&&(D=Du(Z,re),D!=null&&Ue.push(zu(Z,D,se)))),vt)break;Z=Z.return}0<Ue.length&&(fe=new Ce(fe,Fe,null,h,ge),ve.push({event:fe,listeners:Ue}))}}if(!(l&7)){e:{if(fe=a==="mouseover"||a==="pointerover",Ce=a==="mouseout"||a==="pointerout",fe&&h!==rv&&(Fe=h.relatedTarget||h.fromElement)&&(po(Fe)||Fe[ya]))break e;if((Ce||fe)&&(fe=ge.window===ge?ge:(fe=ge.ownerDocument)?fe.defaultView||fe.parentWindow:window,Ce?(Fe=h.relatedTarget||h.toElement,Ce=K,Fe=Fe?po(Fe):null,Fe!==null&&(vt=To(Fe),Fe!==vt||Fe.tag!==5&&Fe.tag!==6)&&(Fe=null)):(Ce=null,Fe=K),Ce!==Fe)){if(Ue=gw,D="onMouseLeave",re="onMouseEnter",Z="mouse",(a==="pointerout"||a==="pointerover")&&(Ue=yw,D="onPointerLeave",re="onPointerEnter",Z="pointer"),vt=Ce==null?fe:Il(Ce),se=Fe==null?fe:Il(Fe),fe=new Ue(D,Z+"leave",Ce,h,ge),fe.target=vt,fe.relatedTarget=se,D=null,po(ge)===K&&(Ue=new Ue(re,Z+"enter",Fe,h,ge),Ue.target=se,Ue.relatedTarget=vt,D=Ue),vt=D,Ce&&Fe)t:{for(Ue=Ce,re=Fe,Z=0,se=Ue;se;se=Rl(se))Z++;for(se=0,D=re;D;D=Rl(D))se++;for(;0<Z-se;)Ue=Rl(Ue),Z--;for(;0<se-Z;)re=Rl(re),se--;for(;Z--;){if(Ue===re||re!==null&&Ue===re.alternate)break t;Ue=Rl(Ue),re=Rl(re)}Ue=null}else Ue=null;Ce!==null&&Lw(ve,fe,Ce,Ue,!1),Fe!==null&&vt!==null&&Lw(ve,vt,Fe,Ue,!0)}}e:{if(fe=K?Il(K):window,Ce=fe.nodeName&&fe.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&fe.type==="file")var Q=NI;else if(Sw(fe))if(m2)Q=zI;else{Q=FI;var oe=kI}else(Ce=fe.nodeName)&&Ce.toLowerCase()==="input"&&(fe.type==="checkbox"||fe.type==="radio")&&(Q=UI);if(Q&&(Q=Q(a,K))){f2(ve,Q,h,ge);break e}oe&&oe(a,fe,K),a==="focusout"&&(oe=fe._wrapperState)&&oe.controlled&&fe.type==="number"&&$g(fe,"number",fe.value)}switch(oe=K?Il(K):window,a){case"focusin":(Sw(oe)||oe.contentEditable==="true")&&(Dl=oe,hv=K,Mu=null);break;case"focusout":Mu=hv=Dl=null;break;case"mousedown":dv=!0;break;case"contextmenu":case"mouseup":case"dragend":dv=!1,Ew(ve,h,ge);break;case"selectionchange":if(jI)break;case"keydown":case"keyup":Ew(ve,h,ge)}var xe;if(r1)e:{switch(a){case"compositionstart":var _e="onCompositionStart";break e;case"compositionend":_e="onCompositionEnd";break e;case"compositionupdate":_e="onCompositionUpdate";break e}_e=void 0}else Cl?d2(a,h)&&(_e="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(_e="onCompositionStart");_e&&(h2&&h.locale!=="ko"&&(Cl||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&Cl&&(xe=u2()):(is=ge,t1="value"in is?is.value:is.textContent,Cl=!0)),oe=Np(K,_e),0<oe.length&&(_e=new vw(_e,a,null,h,ge),ve.push({event:_e,listeners:oe}),xe?_e.data=xe:(xe=p2(h),xe!==null&&(_e.data=xe)))),(xe=PI?CI(a,h):DI(a,h))&&(K=Np(K,"onBeforeInput"),0<K.length&&(ge=new vw("onBeforeInput","beforeinput",null,h,ge),ve.push({event:ge,listeners:K}),ge.data=xe))}T2(ve,l)})}function zu(a,l,h){return{instance:a,listener:l,currentTarget:h}}function Np(a,l){for(var h=l+"Capture",m=[];a!==null;){var x=a,_=x.stateNode;x.tag===5&&_!==null&&(x=_,_=Du(a,h),_!=null&&m.unshift(zu(a,_,x)),_=Du(a,l),_!=null&&m.push(zu(a,_,x))),a=a.return}return m}function Rl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Lw(a,l,h,m,x){for(var _=l._reactName,A=[];h!==null&&h!==m;){var k=h,B=k.alternate,K=k.stateNode;if(B!==null&&B===m)break;k.tag===5&&K!==null&&(k=K,x?(B=Du(h,_),B!=null&&A.unshift(zu(h,B,k))):x||(B=Du(h,_),B!=null&&A.push(zu(h,B,k)))),h=h.return}A.length!==0&&a.push({event:l,listeners:A})}var XI=/\r\n?/g,qI=/\u0000|\uFFFD/g;function Pw(a){return(typeof a=="string"?a:""+a).replace(XI,`
`).replace(qI,"")}function ap(a,l,h){if(l=Pw(l),Pw(a)!==l&&h)throw Error(Ie(425))}function kp(){}var pv=null,fv=null;function mv(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var gv=typeof setTimeout=="function"?setTimeout:void 0,YI=typeof clearTimeout=="function"?clearTimeout:void 0,Cw=typeof Promise=="function"?Promise:void 0,QI=typeof queueMicrotask=="function"?queueMicrotask:typeof Cw<"u"?function(a){return Cw.resolve(null).then(a).catch(ZI)}:gv;function ZI(a){setTimeout(function(){throw a})}function Dg(a,l){var h=l,m=0;do{var x=h.nextSibling;if(a.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(m===0){a.removeChild(x),Nu(l);return}m--}else h!=="$"&&h!=="$?"&&h!=="$!"||m++;h=x}while(h);Nu(l)}function ls(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function Dw(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"){if(l===0)return a;l--}else h==="/$"&&l++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),Hr="__reactFiber$"+nc,Bu="__reactProps$"+nc,ya="__reactContainer$"+nc,vv="__reactEvents$"+nc,KI="__reactListeners$"+nc,JI="__reactHandles$"+nc;function po(a){var l=a[Hr];if(l)return l;for(var h=a.parentNode;h;){if(l=h[ya]||h[Hr]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(a=Dw(a);a!==null;){if(h=a[Hr])return h;a=Dw(a)}return l}a=h,h=a.parentNode}return null}function Zu(a){return a=a[Hr]||a[ya],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Il(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(Ie(33))}function af(a){return a[Bu]||null}var yv=[],Nl=-1;function gs(a){return{current:a}}function qt(a){0>Nl||(a.current=yv[Nl],yv[Nl]=null,Nl--)}function jt(a,l){Nl++,yv[Nl]=a.current,a.current=l}var fs={},$n=gs(fs),Si=gs(!1),xo=fs;function Yl(a,l){var h=a.type.contextTypes;if(!h)return fs;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var x={},_;for(_ in h)x[_]=l[_];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=x),x}function _i(a){return a=a.childContextTypes,a!=null}function Fp(){qt(Si),qt($n)}function Ow(a,l,h){if($n.current!==fs)throw Error(Ie(168));jt($n,l),jt(Si,h)}function A2(a,l,h){var m=a.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return h;m=m.getChildContext();for(var x in m)if(!(x in l))throw Error(Ie(108,kO(a)||"Unknown",x));return tn({},h,m)}function Up(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||fs,xo=$n.current,jt($n,a),jt(Si,Si.current),!0}function Iw(a,l,h){var m=a.stateNode;if(!m)throw Error(Ie(169));h?(a=A2(a,l,xo),m.__reactInternalMemoizedMergedChildContext=a,qt(Si),qt($n),jt($n,a)):qt(Si),jt(Si,h)}var pa=null,sf=!1,Og=!1;function R2(a){pa===null?pa=[a]:pa.push(a)}function $I(a){sf=!0,R2(a)}function vs(){if(!Og&&pa!==null){Og=!0;var a=0,l=It;try{var h=pa;for(It=1;a<h.length;a++){var m=h[a];do m=m(!0);while(m!==null)}pa=null,sf=!1}catch(x){throw pa!==null&&(pa=pa.slice(a+1)),$M(Kv,vs),x}finally{It=l,Og=!1}}return null}var kl=[],Fl=0,zp=null,Bp=0,qi=[],Yi=0,bo=null,fa=1,ma="";function uo(a,l){kl[Fl++]=Bp,kl[Fl++]=zp,zp=a,Bp=l}function L2(a,l,h){qi[Yi++]=fa,qi[Yi++]=ma,qi[Yi++]=bo,bo=a;var m=fa;a=ma;var x=32-_r(m)-1;m&=~(1<<x),h+=1;var _=32-_r(l)+x;if(30<_){var A=x-x%5;_=(m&(1<<A)-1).toString(32),m>>=A,x-=A,fa=1<<32-_r(l)+x|h<<x|m,ma=_+a}else fa=1<<_|h<<x|m,ma=a}function s1(a){a.return!==null&&(uo(a,1),L2(a,1,0))}function o1(a){for(;a===zp;)zp=kl[--Fl],kl[Fl]=null,Bp=kl[--Fl],kl[Fl]=null;for(;a===bo;)bo=qi[--Yi],qi[Yi]=null,ma=qi[--Yi],qi[Yi]=null,fa=qi[--Yi],qi[Yi]=null}var Ni=null,Ii=null,Kt=!1,br=null;function P2(a,l){var h=Zi(5,null,null,0);h.elementType="DELETED",h.stateNode=l,h.return=a,l=a.deletions,l===null?(a.deletions=[h],a.flags|=16):l.push(h)}function Nw(a,l){switch(a.tag){case 5:var h=a.type;return l=l.nodeType!==1||h.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,Ni=a,Ii=ls(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,Ni=a,Ii=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(h=bo!==null?{id:fa,overflow:ma}:null,a.memoizedState={dehydrated:l,treeContext:h,retryLane:1073741824},h=Zi(18,null,null,0),h.stateNode=l,h.return=a,a.child=h,Ni=a,Ii=null,!0):!1;default:return!1}}function xv(a){return(a.mode&1)!==0&&(a.flags&128)===0}function bv(a){if(Kt){var l=Ii;if(l){var h=l;if(!Nw(a,l)){if(xv(a))throw Error(Ie(418));l=ls(h.nextSibling);var m=Ni;l&&Nw(a,l)?P2(m,h):(a.flags=a.flags&-4097|2,Kt=!1,Ni=a)}}else{if(xv(a))throw Error(Ie(418));a.flags=a.flags&-4097|2,Kt=!1,Ni=a}}}function kw(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Ni=a}function sp(a){if(a!==Ni)return!1;if(!Kt)return kw(a),Kt=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!mv(a.type,a.memoizedProps)),l&&(l=Ii)){if(xv(a))throw C2(),Error(Ie(418));for(;l;)P2(a,l),l=ls(l.nextSibling)}if(kw(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ie(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"){if(l===0){Ii=ls(a.nextSibling);break e}l--}else h!=="$"&&h!=="$!"&&h!=="$?"||l++}a=a.nextSibling}Ii=null}}else Ii=Ni?ls(a.stateNode.nextSibling):null;return!0}function C2(){for(var a=Ii;a;)a=ls(a.nextSibling)}function Ql(){Ii=Ni=null,Kt=!1}function l1(a){br===null?br=[a]:br.push(a)}var e4=Sa.ReactCurrentBatchConfig;function yr(a,l){if(a&&a.defaultProps){l=tn({},l),a=a.defaultProps;for(var h in a)l[h]===void 0&&(l[h]=a[h]);return l}return l}var Hp=gs(null),jp=null,Ul=null,c1=null;function u1(){c1=Ul=jp=null}function h1(a){var l=Hp.current;qt(Hp),a._currentValue=l}function Sv(a,l,h){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===h)break;a=a.return}}function Wl(a,l){jp=a,c1=Ul=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&l&&(bi=!0),a.firstContext=null)}function Ji(a){var l=a._currentValue;if(c1!==a)if(a={context:a,memoizedValue:l,next:null},Ul===null){if(jp===null)throw Error(Ie(308));Ul=a,jp.dependencies={lanes:0,firstContext:a}}else Ul=Ul.next=a;return l}var fo=null;function d1(a){fo===null?fo=[a]:fo.push(a)}function D2(a,l,h,m){var x=l.interleaved;return x===null?(h.next=h,d1(l)):(h.next=x.next,x.next=h),l.interleaved=h,xa(a,m)}function xa(a,l){a.lanes|=l;var h=a.alternate;for(h!==null&&(h.lanes|=l),h=a,a=a.return;a!==null;)a.childLanes|=l,h=a.alternate,h!==null&&(h.childLanes|=l),h=a,a=a.return;return h.tag===3?h.stateNode:null}var es=!1;function p1(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function O2(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ga(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function cs(a,l,h){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,Et&2){var x=m.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),m.pending=l,xa(a,h)}return x=m.interleaved,x===null?(l.next=l,d1(m)):(l.next=x.next,x.next=l),m.interleaved=l,xa(a,h)}function Sp(a,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194240)!==0)){var m=l.lanes;m&=a.pendingLanes,h|=m,l.lanes=h,Jv(a,h)}}function Fw(a,l){var h=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var x=null,_=null;if(h=h.firstBaseUpdate,h!==null){do{var A={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};_===null?x=_=A:_=_.next=A,h=h.next}while(h!==null);_===null?x=_=l:_=_.next=l}else x=_=l;h={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:_,shared:m.shared,effects:m.effects},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=l:a.next=l,h.lastBaseUpdate=l}function Gp(a,l,h,m){var x=a.updateQueue;es=!1;var _=x.firstBaseUpdate,A=x.lastBaseUpdate,k=x.shared.pending;if(k!==null){x.shared.pending=null;var B=k,K=B.next;B.next=null,A===null?_=K:A.next=K,A=B;var ge=a.alternate;ge!==null&&(ge=ge.updateQueue,k=ge.lastBaseUpdate,k!==A&&(k===null?ge.firstBaseUpdate=K:k.next=K,ge.lastBaseUpdate=B))}if(_!==null){var ve=x.baseState;A=0,ge=K=B=null,k=_;do{var fe=k.lane,Ce=k.eventTime;if((m&fe)===fe){ge!==null&&(ge=ge.next={eventTime:Ce,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var Fe=a,Ue=k;switch(fe=l,Ce=h,Ue.tag){case 1:if(Fe=Ue.payload,typeof Fe=="function"){ve=Fe.call(Ce,ve,fe);break e}ve=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=Ue.payload,fe=typeof Fe=="function"?Fe.call(Ce,ve,fe):Fe,fe==null)break e;ve=tn({},ve,fe);break e;case 2:es=!0}}k.callback!==null&&k.lane!==0&&(a.flags|=64,fe=x.effects,fe===null?x.effects=[k]:fe.push(k))}else Ce={eventTime:Ce,lane:fe,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ge===null?(K=ge=Ce,B=ve):ge=ge.next=Ce,A|=fe;if(k=k.next,k===null){if(k=x.shared.pending,k===null)break;fe=k,k=fe.next,fe.next=null,x.lastBaseUpdate=fe,x.shared.pending=null}}while(1);if(ge===null&&(B=ve),x.baseState=B,x.firstBaseUpdate=K,x.lastBaseUpdate=ge,l=x.shared.interleaved,l!==null){x=l;do A|=x.lane,x=x.next;while(x!==l)}else _===null&&(x.shared.lanes=0);_o|=A,a.lanes=A,a.memoizedState=ve}}function Uw(a,l,h){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var m=a[l],x=m.callback;if(x!==null){if(m.callback=null,m=h,typeof x!="function")throw Error(Ie(191,x));x.call(m)}}}var I2=new DM.Component().refs;function _v(a,l,h,m){l=a.memoizedState,h=h(m,l),h=h==null?l:tn({},l,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var of={isMounted:function(a){return(a=a._reactInternals)?To(a)===a:!1},enqueueSetState:function(a,l,h){a=a._reactInternals;var m=li(),x=hs(a),_=ga(m,x);_.payload=l,h!=null&&(_.callback=h),l=cs(a,_,x),l!==null&&(wr(l,a,x,m),Sp(l,a,x))},enqueueReplaceState:function(a,l,h){a=a._reactInternals;var m=li(),x=hs(a),_=ga(m,x);_.tag=1,_.payload=l,h!=null&&(_.callback=h),l=cs(a,_,x),l!==null&&(wr(l,a,x,m),Sp(l,a,x))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var h=li(),m=hs(a),x=ga(h,m);x.tag=2,l!=null&&(x.callback=l),l=cs(a,x,m),l!==null&&(wr(l,a,m,h),Sp(l,a,m))}};function zw(a,l,h,m,x,_,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,_,A):l.prototype&&l.prototype.isPureReactComponent?!Fu(h,m)||!Fu(x,_):!0}function N2(a,l,h){var m=!1,x=fs,_=l.contextType;return typeof _=="object"&&_!==null?_=Ji(_):(x=_i(l)?xo:$n.current,m=l.contextTypes,_=(m=m!=null)?Yl(a,x):fs),l=new l(h,_),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=of,a.stateNode=l,l._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=x,a.__reactInternalMemoizedMaskedChildContext=_),l}function Bw(a,l,h,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,m),l.state!==a&&of.enqueueReplaceState(l,l.state,null)}function wv(a,l,h,m){var x=a.stateNode;x.props=h,x.state=a.memoizedState,x.refs=I2,p1(a);var _=l.contextType;typeof _=="object"&&_!==null?x.context=Ji(_):(_=_i(l)?xo:$n.current,x.context=Yl(a,_)),x.state=a.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(_v(a,l,_,h),x.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(l=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),l!==x.state&&of.enqueueReplaceState(x,x.state,null),Gp(a,h,x,m),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308)}function du(a,l,h){if(a=h.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(Ie(309));var m=h.stateNode}if(!m)throw Error(Ie(147,a));var x=m,_=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===_?l.ref:(l=function(A){var k=x.refs;k===I2&&(k=x.refs={}),A===null?delete k[_]:k[_]=A},l._stringRef=_,l)}if(typeof a!="string")throw Error(Ie(284));if(!h._owner)throw Error(Ie(290,a))}return a}function op(a,l){throw a=Object.prototype.toString.call(l),Error(Ie(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function Hw(a){var l=a._init;return l(a._payload)}function k2(a){function l(re,Z){if(a){var se=re.deletions;se===null?(re.deletions=[Z],re.flags|=16):se.push(Z)}}function h(re,Z){if(!a)return null;for(;Z!==null;)l(re,Z),Z=Z.sibling;return null}function m(re,Z){for(re=new Map;Z!==null;)Z.key!==null?re.set(Z.key,Z):re.set(Z.index,Z),Z=Z.sibling;return re}function x(re,Z){return re=ds(re,Z),re.index=0,re.sibling=null,re}function _(re,Z,se){return re.index=se,a?(se=re.alternate,se!==null?(se=se.index,se<Z?(re.flags|=2,Z):se):(re.flags|=2,Z)):(re.flags|=1048576,Z)}function A(re){return a&&re.alternate===null&&(re.flags|=2),re}function k(re,Z,se,D){return Z===null||Z.tag!==6?(Z=Bg(se,re.mode,D),Z.return=re,Z):(Z=x(Z,se),Z.return=re,Z)}function B(re,Z,se,D){var Q=se.type;return Q===Pl?ge(re,Z,se.props.children,D,se.key):Z!==null&&(Z.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===$a&&Hw(Q)===Z.type)?(D=x(Z,se.props),D.ref=du(re,Z,se),D.return=re,D):(D=Ap(se.type,se.key,se.props,null,re.mode,D),D.ref=du(re,Z,se),D.return=re,D)}function K(re,Z,se,D){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==se.containerInfo||Z.stateNode.implementation!==se.implementation?(Z=Hg(se,re.mode,D),Z.return=re,Z):(Z=x(Z,se.children||[]),Z.return=re,Z)}function ge(re,Z,se,D,Q){return Z===null||Z.tag!==7?(Z=vo(se,re.mode,D,Q),Z.return=re,Z):(Z=x(Z,se),Z.return=re,Z)}function ve(re,Z,se){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=Bg(""+Z,re.mode,se),Z.return=re,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case Zd:return se=Ap(Z.type,Z.key,Z.props,null,re.mode,se),se.ref=du(re,null,Z),se.return=re,se;case Ll:return Z=Hg(Z,re.mode,se),Z.return=re,Z;case $a:var D=Z._init;return ve(re,D(Z._payload),se)}if(vu(Z)||ou(Z))return Z=vo(Z,re.mode,se,null),Z.return=re,Z;op(re,Z)}return null}function fe(re,Z,se,D){var Q=Z!==null?Z.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Q!==null?null:k(re,Z,""+se,D);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case Zd:return se.key===Q?B(re,Z,se,D):null;case Ll:return se.key===Q?K(re,Z,se,D):null;case $a:return Q=se._init,fe(re,Z,Q(se._payload),D)}if(vu(se)||ou(se))return Q!==null?null:ge(re,Z,se,D,null);op(re,se)}return null}function Ce(re,Z,se,D,Q){if(typeof D=="string"&&D!==""||typeof D=="number")return re=re.get(se)||null,k(Z,re,""+D,Q);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Zd:return re=re.get(D.key===null?se:D.key)||null,B(Z,re,D,Q);case Ll:return re=re.get(D.key===null?se:D.key)||null,K(Z,re,D,Q);case $a:var oe=D._init;return Ce(re,Z,se,oe(D._payload),Q)}if(vu(D)||ou(D))return re=re.get(se)||null,ge(Z,re,D,Q,null);op(Z,D)}return null}function Fe(re,Z,se,D){for(var Q=null,oe=null,xe=Z,_e=Z=0,We=null;xe!==null&&_e<se.length;_e++){xe.index>_e?(We=xe,xe=null):We=xe.sibling;var ke=fe(re,xe,se[_e],D);if(ke===null){xe===null&&(xe=We);break}a&&xe&&ke.alternate===null&&l(re,xe),Z=_(ke,Z,_e),oe===null?Q=ke:oe.sibling=ke,oe=ke,xe=We}if(_e===se.length)return h(re,xe),Kt&&uo(re,_e),Q;if(xe===null){for(;_e<se.length;_e++)xe=ve(re,se[_e],D),xe!==null&&(Z=_(xe,Z,_e),oe===null?Q=xe:oe.sibling=xe,oe=xe);return Kt&&uo(re,_e),Q}for(xe=m(re,xe);_e<se.length;_e++)We=Ce(xe,re,_e,se[_e],D),We!==null&&(a&&We.alternate!==null&&xe.delete(We.key===null?_e:We.key),Z=_(We,Z,_e),oe===null?Q=We:oe.sibling=We,oe=We);return a&&xe.forEach(function(at){return l(re,at)}),Kt&&uo(re,_e),Q}function Ue(re,Z,se,D){var Q=ou(se);if(typeof Q!="function")throw Error(Ie(150));if(se=Q.call(se),se==null)throw Error(Ie(151));for(var oe=Q=null,xe=Z,_e=Z=0,We=null,ke=se.next();xe!==null&&!ke.done;_e++,ke=se.next()){xe.index>_e?(We=xe,xe=null):We=xe.sibling;var at=fe(re,xe,ke.value,D);if(at===null){xe===null&&(xe=We);break}a&&xe&&at.alternate===null&&l(re,xe),Z=_(at,Z,_e),oe===null?Q=at:oe.sibling=at,oe=at,xe=We}if(ke.done)return h(re,xe),Kt&&uo(re,_e),Q;if(xe===null){for(;!ke.done;_e++,ke=se.next())ke=ve(re,ke.value,D),ke!==null&&(Z=_(ke,Z,_e),oe===null?Q=ke:oe.sibling=ke,oe=ke);return Kt&&uo(re,_e),Q}for(xe=m(re,xe);!ke.done;_e++,ke=se.next())ke=Ce(xe,re,_e,ke.value,D),ke!==null&&(a&&ke.alternate!==null&&xe.delete(ke.key===null?_e:ke.key),Z=_(ke,Z,_e),oe===null?Q=ke:oe.sibling=ke,oe=ke);return a&&xe.forEach(function(gn){return l(re,gn)}),Kt&&uo(re,_e),Q}function vt(re,Z,se,D){if(typeof se=="object"&&se!==null&&se.type===Pl&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case Zd:e:{for(var Q=se.key,oe=Z;oe!==null;){if(oe.key===Q){if(Q=se.type,Q===Pl){if(oe.tag===7){h(re,oe.sibling),Z=x(oe,se.props.children),Z.return=re,re=Z;break e}}else if(oe.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===$a&&Hw(Q)===oe.type){h(re,oe.sibling),Z=x(oe,se.props),Z.ref=du(re,oe,se),Z.return=re,re=Z;break e}h(re,oe);break}else l(re,oe);oe=oe.sibling}se.type===Pl?(Z=vo(se.props.children,re.mode,D,se.key),Z.return=re,re=Z):(D=Ap(se.type,se.key,se.props,null,re.mode,D),D.ref=du(re,Z,se),D.return=re,re=D)}return A(re);case Ll:e:{for(oe=se.key;Z!==null;){if(Z.key===oe)if(Z.tag===4&&Z.stateNode.containerInfo===se.containerInfo&&Z.stateNode.implementation===se.implementation){h(re,Z.sibling),Z=x(Z,se.children||[]),Z.return=re,re=Z;break e}else{h(re,Z);break}else l(re,Z);Z=Z.sibling}Z=Hg(se,re.mode,D),Z.return=re,re=Z}return A(re);case $a:return oe=se._init,vt(re,Z,oe(se._payload),D)}if(vu(se))return Fe(re,Z,se,D);if(ou(se))return Ue(re,Z,se,D);op(re,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,Z!==null&&Z.tag===6?(h(re,Z.sibling),Z=x(Z,se),Z.return=re,re=Z):(h(re,Z),Z=Bg(se,re.mode,D),Z.return=re,re=Z),A(re)):h(re,Z)}return vt}var Zl=k2(!0),F2=k2(!1),Ku={},Gr=gs(Ku),Hu=gs(Ku),ju=gs(Ku);function mo(a){if(a===Ku)throw Error(Ie(174));return a}function f1(a,l){switch(jt(ju,l),jt(Hu,a),jt(Gr,Ku),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:tv(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=tv(l,a)}qt(Gr),jt(Gr,l)}function Kl(){qt(Gr),qt(Hu),qt(ju)}function U2(a){mo(ju.current);var l=mo(Gr.current),h=tv(l,a.type);l!==h&&(jt(Hu,a),jt(Gr,h))}function m1(a){Hu.current===a&&(qt(Gr),qt(Hu))}var $t=gs(0);function Vp(a){for(var l=a;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Ig=[];function g1(){for(var a=0;a<Ig.length;a++)Ig[a]._workInProgressVersionPrimary=null;Ig.length=0}var _p=Sa.ReactCurrentDispatcher,Ng=Sa.ReactCurrentBatchConfig,So=0,en=null,wn=null,Dn=null,Wp=!1,Tu=!1,Gu=0,t4=0;function Zn(){throw Error(Ie(321))}function v1(a,l){if(l===null)return!1;for(var h=0;h<l.length&&h<a.length;h++)if(!Mr(a[h],l[h]))return!1;return!0}function y1(a,l,h,m,x,_){if(So=_,en=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,_p.current=a===null||a.memoizedState===null?a4:s4,a=h(m,x),Tu){_=0;do{if(Tu=!1,Gu=0,25<=_)throw Error(Ie(301));_+=1,Dn=wn=null,l.updateQueue=null,_p.current=o4,a=h(m,x)}while(Tu)}if(_p.current=Xp,l=wn!==null&&wn.next!==null,So=0,Dn=wn=en=null,Wp=!1,l)throw Error(Ie(300));return a}function x1(){var a=Gu!==0;return Gu=0,a}function Br(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?en.memoizedState=Dn=a:Dn=Dn.next=a,Dn}function $i(){if(wn===null){var a=en.alternate;a=a!==null?a.memoizedState:null}else a=wn.next;var l=Dn===null?en.memoizedState:Dn.next;if(l!==null)Dn=l,wn=a;else{if(a===null)throw Error(Ie(310));wn=a,a={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Dn===null?en.memoizedState=Dn=a:Dn=Dn.next=a}return Dn}function Vu(a,l){return typeof l=="function"?l(a):l}function kg(a){var l=$i(),h=l.queue;if(h===null)throw Error(Ie(311));h.lastRenderedReducer=a;var m=wn,x=m.baseQueue,_=h.pending;if(_!==null){if(x!==null){var A=x.next;x.next=_.next,_.next=A}m.baseQueue=x=_,h.pending=null}if(x!==null){_=x.next,m=m.baseState;var k=A=null,B=null,K=_;do{var ge=K.lane;if((So&ge)===ge)B!==null&&(B=B.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),m=K.hasEagerState?K.eagerState:a(m,K.action);else{var ve={lane:ge,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};B===null?(k=B=ve,A=m):B=B.next=ve,en.lanes|=ge,_o|=ge}K=K.next}while(K!==null&&K!==_);B===null?A=m:B.next=k,Mr(m,l.memoizedState)||(bi=!0),l.memoizedState=m,l.baseState=A,l.baseQueue=B,h.lastRenderedState=m}if(a=h.interleaved,a!==null){x=a;do _=x.lane,en.lanes|=_,_o|=_,x=x.next;while(x!==a)}else x===null&&(h.lanes=0);return[l.memoizedState,h.dispatch]}function Fg(a){var l=$i(),h=l.queue;if(h===null)throw Error(Ie(311));h.lastRenderedReducer=a;var m=h.dispatch,x=h.pending,_=l.memoizedState;if(x!==null){h.pending=null;var A=x=x.next;do _=a(_,A.action),A=A.next;while(A!==x);Mr(_,l.memoizedState)||(bi=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),h.lastRenderedState=_}return[_,m]}function z2(){}function B2(a,l){var h=en,m=$i(),x=l(),_=!Mr(m.memoizedState,x);if(_&&(m.memoizedState=x,bi=!0),m=m.queue,b1(G2.bind(null,h,m,a),[a]),m.getSnapshot!==l||_||Dn!==null&&Dn.memoizedState.tag&1){if(h.flags|=2048,Wu(9,j2.bind(null,h,m,x,l),void 0,null),On===null)throw Error(Ie(349));So&30||H2(h,l,x)}return x}function H2(a,l,h){a.flags|=16384,a={getSnapshot:l,value:h},l=en.updateQueue,l===null?(l={lastEffect:null,stores:null},en.updateQueue=l,l.stores=[a]):(h=l.stores,h===null?l.stores=[a]:h.push(a))}function j2(a,l,h,m){l.value=h,l.getSnapshot=m,V2(l)&&W2(a)}function G2(a,l,h){return h(function(){V2(l)&&W2(a)})}function V2(a){var l=a.getSnapshot;a=a.value;try{var h=l();return!Mr(a,h)}catch{return!0}}function W2(a){var l=xa(a,1);l!==null&&wr(l,a,1,-1)}function jw(a){var l=Br();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vu,lastRenderedState:a},l.queue=a,a=a.dispatch=r4.bind(null,en,a),[l.memoizedState,a]}function Wu(a,l,h,m){return a={tag:a,create:l,destroy:h,deps:m,next:null},l=en.updateQueue,l===null?(l={lastEffect:null,stores:null},en.updateQueue=l,l.lastEffect=a.next=a):(h=l.lastEffect,h===null?l.lastEffect=a.next=a:(m=h.next,h.next=a,a.next=m,l.lastEffect=a)),a}function X2(){return $i().memoizedState}function wp(a,l,h,m){var x=Br();en.flags|=a,x.memoizedState=Wu(1|l,h,void 0,m===void 0?null:m)}function lf(a,l,h,m){var x=$i();m=m===void 0?null:m;var _=void 0;if(wn!==null){var A=wn.memoizedState;if(_=A.destroy,m!==null&&v1(m,A.deps)){x.memoizedState=Wu(l,h,_,m);return}}en.flags|=a,x.memoizedState=Wu(1|l,h,_,m)}function Gw(a,l){return wp(8390656,8,a,l)}function b1(a,l){return lf(2048,8,a,l)}function q2(a,l){return lf(4,2,a,l)}function Y2(a,l){return lf(4,4,a,l)}function Q2(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Z2(a,l,h){return h=h!=null?h.concat([a]):null,lf(4,4,Q2.bind(null,l,a),h)}function S1(){}function K2(a,l){var h=$i();l=l===void 0?null:l;var m=h.memoizedState;return m!==null&&l!==null&&v1(l,m[1])?m[0]:(h.memoizedState=[a,l],a)}function J2(a,l){var h=$i();l=l===void 0?null:l;var m=h.memoizedState;return m!==null&&l!==null&&v1(l,m[1])?m[0]:(a=a(),h.memoizedState=[a,l],a)}function $2(a,l,h){return So&21?(Mr(h,l)||(h=n2(),en.lanes|=h,_o|=h,a.baseState=!0),l):(a.baseState&&(a.baseState=!1,bi=!0),a.memoizedState=h)}function n4(a,l){var h=It;It=h!==0&&4>h?h:4,a(!0);var m=Ng.transition;Ng.transition={};try{a(!1),l()}finally{It=h,Ng.transition=m}}function eT(){return $i().memoizedState}function i4(a,l,h){var m=hs(a);if(h={lane:m,action:h,hasEagerState:!1,eagerState:null,next:null},tT(a))nT(l,h);else if(h=D2(a,l,h,m),h!==null){var x=li();wr(h,a,m,x),iT(h,l,m)}}function r4(a,l,h){var m=hs(a),x={lane:m,action:h,hasEagerState:!1,eagerState:null,next:null};if(tT(a))nT(l,x);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var A=l.lastRenderedState,k=_(A,h);if(x.hasEagerState=!0,x.eagerState=k,Mr(k,A)){var B=l.interleaved;B===null?(x.next=x,d1(l)):(x.next=B.next,B.next=x),l.interleaved=x;return}}catch{}finally{}h=D2(a,l,x,m),h!==null&&(x=li(),wr(h,a,m,x),iT(h,l,m))}}function tT(a){var l=a.alternate;return a===en||l!==null&&l===en}function nT(a,l){Tu=Wp=!0;var h=a.pending;h===null?l.next=l:(l.next=h.next,h.next=l),a.pending=l}function iT(a,l,h){if(h&4194240){var m=l.lanes;m&=a.pendingLanes,h|=m,l.lanes=h,Jv(a,h)}}var Xp={readContext:Ji,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useInsertionEffect:Zn,useLayoutEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useMutableSource:Zn,useSyncExternalStore:Zn,useId:Zn,unstable_isNewReconciler:!1},a4={readContext:Ji,useCallback:function(a,l){return Br().memoizedState=[a,l===void 0?null:l],a},useContext:Ji,useEffect:Gw,useImperativeHandle:function(a,l,h){return h=h!=null?h.concat([a]):null,wp(4194308,4,Q2.bind(null,l,a),h)},useLayoutEffect:function(a,l){return wp(4194308,4,a,l)},useInsertionEffect:function(a,l){return wp(4,2,a,l)},useMemo:function(a,l){var h=Br();return l=l===void 0?null:l,a=a(),h.memoizedState=[a,l],a},useReducer:function(a,l,h){var m=Br();return l=h!==void 0?h(l):l,m.memoizedState=m.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},m.queue=a,a=a.dispatch=i4.bind(null,en,a),[m.memoizedState,a]},useRef:function(a){var l=Br();return a={current:a},l.memoizedState=a},useState:jw,useDebugValue:S1,useDeferredValue:function(a){return Br().memoizedState=a},useTransition:function(){var a=jw(!1),l=a[0];return a=n4.bind(null,a[1]),Br().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,h){var m=en,x=Br();if(Kt){if(h===void 0)throw Error(Ie(407));h=h()}else{if(h=l(),On===null)throw Error(Ie(349));So&30||H2(m,l,h)}x.memoizedState=h;var _={value:h,getSnapshot:l};return x.queue=_,Gw(G2.bind(null,m,_,a),[a]),m.flags|=2048,Wu(9,j2.bind(null,m,_,h,l),void 0,null),h},useId:function(){var a=Br(),l=On.identifierPrefix;if(Kt){var h=ma,m=fa;h=(m&~(1<<32-_r(m)-1)).toString(32)+h,l=":"+l+"R"+h,h=Gu++,0<h&&(l+="H"+h.toString(32)),l+=":"}else h=t4++,l=":"+l+"r"+h.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},s4={readContext:Ji,useCallback:K2,useContext:Ji,useEffect:b1,useImperativeHandle:Z2,useInsertionEffect:q2,useLayoutEffect:Y2,useMemo:J2,useReducer:kg,useRef:X2,useState:function(){return kg(Vu)},useDebugValue:S1,useDeferredValue:function(a){var l=$i();return $2(l,wn.memoizedState,a)},useTransition:function(){var a=kg(Vu)[0],l=$i().memoizedState;return[a,l]},useMutableSource:z2,useSyncExternalStore:B2,useId:eT,unstable_isNewReconciler:!1},o4={readContext:Ji,useCallback:K2,useContext:Ji,useEffect:b1,useImperativeHandle:Z2,useInsertionEffect:q2,useLayoutEffect:Y2,useMemo:J2,useReducer:Fg,useRef:X2,useState:function(){return Fg(Vu)},useDebugValue:S1,useDeferredValue:function(a){var l=$i();return wn===null?l.memoizedState=a:$2(l,wn.memoizedState,a)},useTransition:function(){var a=Fg(Vu)[0],l=$i().memoizedState;return[a,l]},useMutableSource:z2,useSyncExternalStore:B2,useId:eT,unstable_isNewReconciler:!1};function Jl(a,l){try{var h="",m=l;do h+=NO(m),m=m.return;while(m);var x=h}catch(_){x=`
Error generating stack: `+_.message+`
`+_.stack}return{value:a,source:l,stack:x,digest:null}}function Ug(a,l,h){return{value:a,source:null,stack:h??null,digest:l??null}}function Mv(a,l){try{console.error(l.value)}catch(h){setTimeout(function(){throw h})}}var l4=typeof WeakMap=="function"?WeakMap:Map;function rT(a,l,h){h=ga(-1,h),h.tag=3,h.payload={element:null};var m=l.value;return h.callback=function(){Yp||(Yp=!0,Iv=m),Mv(a,l)},h}function aT(a,l,h){h=ga(-1,h),h.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var x=l.value;h.payload=function(){return m(x)},h.callback=function(){Mv(a,l)}}var _=a.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(h.callback=function(){Mv(a,l),typeof m!="function"&&(us===null?us=new Set([this]):us.add(this));var A=l.stack;this.componentDidCatch(l.value,{componentStack:A!==null?A:""})}),h}function Vw(a,l,h){var m=a.pingCache;if(m===null){m=a.pingCache=new l4;var x=new Set;m.set(l,x)}else x=m.get(l),x===void 0&&(x=new Set,m.set(l,x));x.has(h)||(x.add(h),a=_4.bind(null,a,l,h),l.then(a,a))}function Ww(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Xw(a,l,h,m,x){return a.mode&1?(a.flags|=65536,a.lanes=x,a):(a===l?a.flags|=65536:(a.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(l=ga(-1,1),l.tag=2,cs(h,l,1))),h.lanes|=1),a)}var c4=Sa.ReactCurrentOwner,bi=!1;function oi(a,l,h,m){l.child=a===null?F2(l,null,h,m):Zl(l,a.child,h,m)}function qw(a,l,h,m,x){h=h.render;var _=l.ref;return Wl(l,x),m=y1(a,l,h,m,_,x),h=x1(),a!==null&&!bi?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~x,ba(a,l,x)):(Kt&&h&&s1(l),l.flags|=1,oi(a,l,m,x),l.child)}function Yw(a,l,h,m,x){if(a===null){var _=h.type;return typeof _=="function"&&!L1(_)&&_.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(l.tag=15,l.type=_,sT(a,l,_,m,x)):(a=Ap(h.type,null,m,l,l.mode,x),a.ref=l.ref,a.return=l,l.child=a)}if(_=a.child,!(a.lanes&x)){var A=_.memoizedProps;if(h=h.compare,h=h!==null?h:Fu,h(A,m)&&a.ref===l.ref)return ba(a,l,x)}return l.flags|=1,a=ds(_,m),a.ref=l.ref,a.return=l,l.child=a}function sT(a,l,h,m,x){if(a!==null){var _=a.memoizedProps;if(Fu(_,m)&&a.ref===l.ref)if(bi=!1,l.pendingProps=m=_,(a.lanes&x)!==0)a.flags&131072&&(bi=!0);else return l.lanes=a.lanes,ba(a,l,x)}return Tv(a,l,h,m,x)}function oT(a,l,h){var m=l.pendingProps,x=m.children,_=a!==null?a.memoizedState:null;if(m.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},jt(Bl,Oi),Oi|=h;else{if(!(h&1073741824))return a=_!==null?_.baseLanes|h:h,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,jt(Bl,Oi),Oi|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=_!==null?_.baseLanes:h,jt(Bl,Oi),Oi|=m}else _!==null?(m=_.baseLanes|h,l.memoizedState=null):m=h,jt(Bl,Oi),Oi|=m;return oi(a,l,x,h),l.child}function lT(a,l){var h=l.ref;(a===null&&h!==null||a!==null&&a.ref!==h)&&(l.flags|=512,l.flags|=2097152)}function Tv(a,l,h,m,x){var _=_i(h)?xo:$n.current;return _=Yl(l,_),Wl(l,x),h=y1(a,l,h,m,_,x),m=x1(),a!==null&&!bi?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~x,ba(a,l,x)):(Kt&&m&&s1(l),l.flags|=1,oi(a,l,h,x),l.child)}function Qw(a,l,h,m,x){if(_i(h)){var _=!0;Up(l)}else _=!1;if(Wl(l,x),l.stateNode===null)Mp(a,l),N2(l,h,m),wv(l,h,m,x),m=!0;else if(a===null){var A=l.stateNode,k=l.memoizedProps;A.props=k;var B=A.context,K=h.contextType;typeof K=="object"&&K!==null?K=Ji(K):(K=_i(h)?xo:$n.current,K=Yl(l,K));var ge=h.getDerivedStateFromProps,ve=typeof ge=="function"||typeof A.getSnapshotBeforeUpdate=="function";ve||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(k!==m||B!==K)&&Bw(l,A,m,K),es=!1;var fe=l.memoizedState;A.state=fe,Gp(l,m,A,x),B=l.memoizedState,k!==m||fe!==B||Si.current||es?(typeof ge=="function"&&(_v(l,h,ge,m),B=l.memoizedState),(k=es||zw(l,h,k,m,fe,B,K))?(ve||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(l.flags|=4194308)):(typeof A.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=B),A.props=m,A.state=B,A.context=K,m=k):(typeof A.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{A=l.stateNode,O2(a,l),k=l.memoizedProps,K=l.type===l.elementType?k:yr(l.type,k),A.props=K,ve=l.pendingProps,fe=A.context,B=h.contextType,typeof B=="object"&&B!==null?B=Ji(B):(B=_i(h)?xo:$n.current,B=Yl(l,B));var Ce=h.getDerivedStateFromProps;(ge=typeof Ce=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(k!==ve||fe!==B)&&Bw(l,A,m,B),es=!1,fe=l.memoizedState,A.state=fe,Gp(l,m,A,x);var Fe=l.memoizedState;k!==ve||fe!==Fe||Si.current||es?(typeof Ce=="function"&&(_v(l,h,Ce,m),Fe=l.memoizedState),(K=es||zw(l,h,K,m,fe,Fe,B)||!1)?(ge||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,Fe,B),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,Fe,B)),typeof A.componentDidUpdate=="function"&&(l.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof A.componentDidUpdate!="function"||k===a.memoizedProps&&fe===a.memoizedState||(l.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&fe===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=Fe),A.props=m,A.state=Fe,A.context=B,m=K):(typeof A.componentDidUpdate!="function"||k===a.memoizedProps&&fe===a.memoizedState||(l.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&fe===a.memoizedState||(l.flags|=1024),m=!1)}return Ev(a,l,h,m,_,x)}function Ev(a,l,h,m,x,_){lT(a,l);var A=(l.flags&128)!==0;if(!m&&!A)return x&&Iw(l,h,!1),ba(a,l,_);m=l.stateNode,c4.current=l;var k=A&&typeof h.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,a!==null&&A?(l.child=Zl(l,a.child,null,_),l.child=Zl(l,null,k,_)):oi(a,l,k,_),l.memoizedState=m.state,x&&Iw(l,h,!0),l.child}function cT(a){var l=a.stateNode;l.pendingContext?Ow(a,l.pendingContext,l.pendingContext!==l.context):l.context&&Ow(a,l.context,!1),f1(a,l.containerInfo)}function Zw(a,l,h,m,x){return Ql(),l1(x),l.flags|=256,oi(a,l,h,m),l.child}var Av={dehydrated:null,treeContext:null,retryLane:0};function Rv(a){return{baseLanes:a,cachePool:null,transitions:null}}function uT(a,l,h){var m=l.pendingProps,x=$t.current,_=!1,A=(l.flags&128)!==0,k;if((k=A)||(k=a!==null&&a.memoizedState===null?!1:(x&2)!==0),k?(_=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(x|=1),jt($t,x&1),a===null)return bv(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(l.mode&1?a.data==="$!"?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(A=m.children,a=m.fallback,_?(m=l.mode,_=l.child,A={mode:"hidden",children:A},!(m&1)&&_!==null?(_.childLanes=0,_.pendingProps=A):_=hf(A,m,0,null),a=vo(a,m,h,null),_.return=l,a.return=l,_.sibling=a,l.child=_,l.child.memoizedState=Rv(h),l.memoizedState=Av,a):_1(l,A));if(x=a.memoizedState,x!==null&&(k=x.dehydrated,k!==null))return u4(a,l,A,m,k,x,h);if(_){_=m.fallback,A=l.mode,x=a.child,k=x.sibling;var B={mode:"hidden",children:m.children};return!(A&1)&&l.child!==x?(m=l.child,m.childLanes=0,m.pendingProps=B,l.deletions=null):(m=ds(x,B),m.subtreeFlags=x.subtreeFlags&14680064),k!==null?_=ds(k,_):(_=vo(_,A,h,null),_.flags|=2),_.return=l,m.return=l,m.sibling=_,l.child=m,m=_,_=l.child,A=a.child.memoizedState,A=A===null?Rv(h):{baseLanes:A.baseLanes|h,cachePool:null,transitions:A.transitions},_.memoizedState=A,_.childLanes=a.childLanes&~h,l.memoizedState=Av,m}return _=a.child,a=_.sibling,m=ds(_,{mode:"visible",children:m.children}),!(l.mode&1)&&(m.lanes=h),m.return=l,m.sibling=null,a!==null&&(h=l.deletions,h===null?(l.deletions=[a],l.flags|=16):h.push(a)),l.child=m,l.memoizedState=null,m}function _1(a,l){return l=hf({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function lp(a,l,h,m){return m!==null&&l1(m),Zl(l,a.child,null,h),a=_1(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function u4(a,l,h,m,x,_,A){if(h)return l.flags&256?(l.flags&=-257,m=Ug(Error(Ie(422))),lp(a,l,A,m)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(_=m.fallback,x=l.mode,m=hf({mode:"visible",children:m.children},x,0,null),_=vo(_,x,A,null),_.flags|=2,m.return=l,_.return=l,m.sibling=_,l.child=m,l.mode&1&&Zl(l,a.child,null,A),l.child.memoizedState=Rv(A),l.memoizedState=Av,_);if(!(l.mode&1))return lp(a,l,A,null);if(x.data==="$!"){if(m=x.nextSibling&&x.nextSibling.dataset,m)var k=m.dgst;return m=k,_=Error(Ie(419)),m=Ug(_,m,void 0),lp(a,l,A,m)}if(k=(A&a.childLanes)!==0,bi||k){if(m=On,m!==null){switch(A&-A){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=x&(m.suspendedLanes|A)?0:x,x!==0&&x!==_.retryLane&&(_.retryLane=x,xa(a,x),wr(m,a,x,-1))}return R1(),m=Ug(Error(Ie(421))),lp(a,l,A,m)}return x.data==="$?"?(l.flags|=128,l.child=a.child,l=w4.bind(null,a),x._reactRetry=l,null):(a=_.treeContext,Ii=ls(x.nextSibling),Ni=l,Kt=!0,br=null,a!==null&&(qi[Yi++]=fa,qi[Yi++]=ma,qi[Yi++]=bo,fa=a.id,ma=a.overflow,bo=l),l=_1(l,m.children),l.flags|=4096,l)}function Kw(a,l,h){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),Sv(a.return,l,h)}function zg(a,l,h,m,x){var _=a.memoizedState;_===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:x}:(_.isBackwards=l,_.rendering=null,_.renderingStartTime=0,_.last=m,_.tail=h,_.tailMode=x)}function hT(a,l,h){var m=l.pendingProps,x=m.revealOrder,_=m.tail;if(oi(a,l,m.children,h),m=$t.current,m&2)m=m&1|2,l.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Kw(a,h,l);else if(a.tag===19)Kw(a,h,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(jt($t,m),!(l.mode&1))l.memoizedState=null;else switch(x){case"forwards":for(h=l.child,x=null;h!==null;)a=h.alternate,a!==null&&Vp(a)===null&&(x=h),h=h.sibling;h=x,h===null?(x=l.child,l.child=null):(x=h.sibling,h.sibling=null),zg(l,!1,x,h,_);break;case"backwards":for(h=null,x=l.child,l.child=null;x!==null;){if(a=x.alternate,a!==null&&Vp(a)===null){l.child=x;break}a=x.sibling,x.sibling=h,h=x,x=a}zg(l,!0,h,null,_);break;case"together":zg(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Mp(a,l){!(l.mode&1)&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ba(a,l,h){if(a!==null&&(l.dependencies=a.dependencies),_o|=l.lanes,!(h&l.childLanes))return null;if(a!==null&&l.child!==a.child)throw Error(Ie(153));if(l.child!==null){for(a=l.child,h=ds(a,a.pendingProps),l.child=h,h.return=l;a.sibling!==null;)a=a.sibling,h=h.sibling=ds(a,a.pendingProps),h.return=l;h.sibling=null}return l.child}function h4(a,l,h){switch(l.tag){case 3:cT(l),Ql();break;case 5:U2(l);break;case 1:_i(l.type)&&Up(l);break;case 4:f1(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,x=l.memoizedProps.value;jt(Hp,m._currentValue),m._currentValue=x;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(jt($t,$t.current&1),l.flags|=128,null):h&l.child.childLanes?uT(a,l,h):(jt($t,$t.current&1),a=ba(a,l,h),a!==null?a.sibling:null);jt($t,$t.current&1);break;case 19:if(m=(h&l.childLanes)!==0,a.flags&128){if(m)return hT(a,l,h);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),jt($t,$t.current),m)break;return null;case 22:case 23:return l.lanes=0,oT(a,l,h)}return ba(a,l,h)}var dT,Lv,pT,fT;dT=function(a,l){for(var h=l.child;h!==null;){if(h.tag===5||h.tag===6)a.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return;h=h.return}h.sibling.return=h.return,h=h.sibling}};Lv=function(){};pT=function(a,l,h,m){var x=a.memoizedProps;if(x!==m){a=l.stateNode,mo(Gr.current);var _=null;switch(h){case"input":x=Kg(a,x),m=Kg(a,m),_=[];break;case"select":x=tn({},x,{value:void 0}),m=tn({},m,{value:void 0}),_=[];break;case"textarea":x=ev(a,x),m=ev(a,m),_=[];break;default:typeof x.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=kp)}nv(h,m);var A;h=null;for(K in x)if(!m.hasOwnProperty(K)&&x.hasOwnProperty(K)&&x[K]!=null)if(K==="style"){var k=x[K];for(A in k)k.hasOwnProperty(A)&&(h||(h={}),h[A]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(Pu.hasOwnProperty(K)?_||(_=[]):(_=_||[]).push(K,null));for(K in m){var B=m[K];if(k=x!=null?x[K]:void 0,m.hasOwnProperty(K)&&B!==k&&(B!=null||k!=null))if(K==="style")if(k){for(A in k)!k.hasOwnProperty(A)||B&&B.hasOwnProperty(A)||(h||(h={}),h[A]="");for(A in B)B.hasOwnProperty(A)&&k[A]!==B[A]&&(h||(h={}),h[A]=B[A])}else h||(_||(_=[]),_.push(K,h)),h=B;else K==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,k=k?k.__html:void 0,B!=null&&k!==B&&(_=_||[]).push(K,B)):K==="children"?typeof B!="string"&&typeof B!="number"||(_=_||[]).push(K,""+B):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(Pu.hasOwnProperty(K)?(B!=null&&K==="onScroll"&&Wt("scroll",a),_||k===B||(_=[])):(_=_||[]).push(K,B))}h&&(_=_||[]).push("style",h);var K=_;(l.updateQueue=K)&&(l.flags|=4)}};fT=function(a,l,h,m){h!==m&&(l.flags|=4)};function pu(a,l){if(!Kt)switch(a.tailMode){case"hidden":l=a.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Kn(a){var l=a.alternate!==null&&a.alternate.child===a.child,h=0,m=0;if(l)for(var x=a.child;x!==null;)h|=x.lanes|x.childLanes,m|=x.subtreeFlags&14680064,m|=x.flags&14680064,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)h|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=m,a.childLanes=h,l}function d4(a,l,h){var m=l.pendingProps;switch(o1(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(l),null;case 1:return _i(l.type)&&Fp(),Kn(l),null;case 3:return m=l.stateNode,Kl(),qt(Si),qt($n),g1(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(sp(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,br!==null&&(Fv(br),br=null))),Lv(a,l),Kn(l),null;case 5:m1(l);var x=mo(ju.current);if(h=l.type,a!==null&&l.stateNode!=null)pT(a,l,h,m,x),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(Ie(166));return Kn(l),null}if(a=mo(Gr.current),sp(l)){m=l.stateNode,h=l.type;var _=l.memoizedProps;switch(m[Hr]=l,m[Bu]=_,a=(l.mode&1)!==0,h){case"dialog":Wt("cancel",m),Wt("close",m);break;case"iframe":case"object":case"embed":Wt("load",m);break;case"video":case"audio":for(x=0;x<xu.length;x++)Wt(xu[x],m);break;case"source":Wt("error",m);break;case"img":case"image":case"link":Wt("error",m),Wt("load",m);break;case"details":Wt("toggle",m);break;case"input":sw(m,_),Wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!_.multiple},Wt("invalid",m);break;case"textarea":lw(m,_),Wt("invalid",m)}nv(h,_),x=null;for(var A in _)if(_.hasOwnProperty(A)){var k=_[A];A==="children"?typeof k=="string"?m.textContent!==k&&(_.suppressHydrationWarning!==!0&&ap(m.textContent,k,a),x=["children",k]):typeof k=="number"&&m.textContent!==""+k&&(_.suppressHydrationWarning!==!0&&ap(m.textContent,k,a),x=["children",""+k]):Pu.hasOwnProperty(A)&&k!=null&&A==="onScroll"&&Wt("scroll",m)}switch(h){case"input":Kd(m),ow(m,_,!0);break;case"textarea":Kd(m),cw(m);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(m.onclick=kp)}m=x,l.updateQueue=m,m!==null&&(l.flags|=4)}else{A=x.nodeType===9?x:x.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=HM(h)),a==="http://www.w3.org/1999/xhtml"?h==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=A.createElement(h,{is:m.is}):(a=A.createElement(h),h==="select"&&(A=a,m.multiple?A.multiple=!0:m.size&&(A.size=m.size))):a=A.createElementNS(a,h),a[Hr]=l,a[Bu]=m,dT(a,l,!1,!1),l.stateNode=a;e:{switch(A=iv(h,m),h){case"dialog":Wt("cancel",a),Wt("close",a),x=m;break;case"iframe":case"object":case"embed":Wt("load",a),x=m;break;case"video":case"audio":for(x=0;x<xu.length;x++)Wt(xu[x],a);x=m;break;case"source":Wt("error",a),x=m;break;case"img":case"image":case"link":Wt("error",a),Wt("load",a),x=m;break;case"details":Wt("toggle",a),x=m;break;case"input":sw(a,m),x=Kg(a,m),Wt("invalid",a);break;case"option":x=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},x=tn({},m,{value:void 0}),Wt("invalid",a);break;case"textarea":lw(a,m),x=ev(a,m),Wt("invalid",a);break;default:x=m}nv(h,x),k=x;for(_ in k)if(k.hasOwnProperty(_)){var B=k[_];_==="style"?VM(a,B):_==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&jM(a,B)):_==="children"?typeof B=="string"?(h!=="textarea"||B!=="")&&Cu(a,B):typeof B=="number"&&Cu(a,""+B):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Pu.hasOwnProperty(_)?B!=null&&_==="onScroll"&&Wt("scroll",a):B!=null&&Xv(a,_,B,A))}switch(h){case"input":Kd(a),ow(a,m,!1);break;case"textarea":Kd(a),cw(a);break;case"option":m.value!=null&&a.setAttribute("value",""+ps(m.value));break;case"select":a.multiple=!!m.multiple,_=m.value,_!=null?Hl(a,!!m.multiple,_,!1):m.defaultValue!=null&&Hl(a,!!m.multiple,m.defaultValue,!0);break;default:typeof x.onClick=="function"&&(a.onclick=kp)}switch(h){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Kn(l),null;case 6:if(a&&l.stateNode!=null)fT(a,l,a.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(Ie(166));if(h=mo(ju.current),mo(Gr.current),sp(l)){if(m=l.stateNode,h=l.memoizedProps,m[Hr]=l,(_=m.nodeValue!==h)&&(a=Ni,a!==null))switch(a.tag){case 3:ap(m.nodeValue,h,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&ap(m.nodeValue,h,(a.mode&1)!==0)}_&&(l.flags|=4)}else m=(h.nodeType===9?h:h.ownerDocument).createTextNode(m),m[Hr]=l,l.stateNode=m}return Kn(l),null;case 13:if(qt($t),m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Kt&&Ii!==null&&l.mode&1&&!(l.flags&128))C2(),Ql(),l.flags|=98560,_=!1;else if(_=sp(l),m!==null&&m.dehydrated!==null){if(a===null){if(!_)throw Error(Ie(318));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(Ie(317));_[Hr]=l}else Ql(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;Kn(l),_=!1}else br!==null&&(Fv(br),br=null),_=!0;if(!_)return l.flags&65536?l:null}return l.flags&128?(l.lanes=h,l):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(l.child.flags|=8192,l.mode&1&&(a===null||$t.current&1?Tn===0&&(Tn=3):R1())),l.updateQueue!==null&&(l.flags|=4),Kn(l),null);case 4:return Kl(),Lv(a,l),a===null&&Uu(l.stateNode.containerInfo),Kn(l),null;case 10:return h1(l.type._context),Kn(l),null;case 17:return _i(l.type)&&Fp(),Kn(l),null;case 19:if(qt($t),_=l.memoizedState,_===null)return Kn(l),null;if(m=(l.flags&128)!==0,A=_.rendering,A===null)if(m)pu(_,!1);else{if(Tn!==0||a!==null&&a.flags&128)for(a=l.child;a!==null;){if(A=Vp(a),A!==null){for(l.flags|=128,pu(_,!1),m=A.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=h,h=l.child;h!==null;)_=h,a=m,_.flags&=14680066,A=_.alternate,A===null?(_.childLanes=0,_.lanes=a,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=A.childLanes,_.lanes=A.lanes,_.child=A.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=A.memoizedProps,_.memoizedState=A.memoizedState,_.updateQueue=A.updateQueue,_.type=A.type,a=A.dependencies,_.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),h=h.sibling;return jt($t,$t.current&1|2),l.child}a=a.sibling}_.tail!==null&&un()>$l&&(l.flags|=128,m=!0,pu(_,!1),l.lanes=4194304)}else{if(!m)if(a=Vp(A),a!==null){if(l.flags|=128,m=!0,h=a.updateQueue,h!==null&&(l.updateQueue=h,l.flags|=4),pu(_,!0),_.tail===null&&_.tailMode==="hidden"&&!A.alternate&&!Kt)return Kn(l),null}else 2*un()-_.renderingStartTime>$l&&h!==1073741824&&(l.flags|=128,m=!0,pu(_,!1),l.lanes=4194304);_.isBackwards?(A.sibling=l.child,l.child=A):(h=_.last,h!==null?h.sibling=A:l.child=A,_.last=A)}return _.tail!==null?(l=_.tail,_.rendering=l,_.tail=l.sibling,_.renderingStartTime=un(),l.sibling=null,h=$t.current,jt($t,m?h&1|2:h&1),l):(Kn(l),null);case 22:case 23:return A1(),m=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(l.flags|=8192),m&&l.mode&1?Oi&1073741824&&(Kn(l),l.subtreeFlags&6&&(l.flags|=8192)):Kn(l),null;case 24:return null;case 25:return null}throw Error(Ie(156,l.tag))}function p4(a,l){switch(o1(l),l.tag){case 1:return _i(l.type)&&Fp(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Kl(),qt(Si),qt($n),g1(),a=l.flags,a&65536&&!(a&128)?(l.flags=a&-65537|128,l):null;case 5:return m1(l),null;case 13:if(qt($t),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(Ie(340));Ql()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return qt($t),null;case 4:return Kl(),null;case 10:return h1(l.type._context),null;case 22:case 23:return A1(),null;case 24:return null;default:return null}}var cp=!1,Jn=!1,f4=typeof WeakSet=="function"?WeakSet:Set,qe=null;function zl(a,l){var h=a.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(m){an(a,l,m)}else h.current=null}function Pv(a,l,h){try{h()}catch(m){an(a,l,m)}}var Jw=!1;function m4(a,l){if(pv=Op,a=y2(),a1(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var x=m.anchorOffset,_=m.focusNode;m=m.focusOffset;try{h.nodeType,_.nodeType}catch{h=null;break e}var A=0,k=-1,B=-1,K=0,ge=0,ve=a,fe=null;t:for(;;){for(var Ce;ve!==h||x!==0&&ve.nodeType!==3||(k=A+x),ve!==_||m!==0&&ve.nodeType!==3||(B=A+m),ve.nodeType===3&&(A+=ve.nodeValue.length),(Ce=ve.firstChild)!==null;)fe=ve,ve=Ce;for(;;){if(ve===a)break t;if(fe===h&&++K===x&&(k=A),fe===_&&++ge===m&&(B=A),(Ce=ve.nextSibling)!==null)break;ve=fe,fe=ve.parentNode}ve=Ce}h=k===-1||B===-1?null:{start:k,end:B}}else h=null}h=h||{start:0,end:0}}else h=null;for(fv={focusedElem:a,selectionRange:h},Op=!1,qe=l;qe!==null;)if(l=qe,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,qe=a;else for(;qe!==null;){l=qe;try{var Fe=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Fe!==null){var Ue=Fe.memoizedProps,vt=Fe.memoizedState,re=l.stateNode,Z=re.getSnapshotBeforeUpdate(l.elementType===l.type?Ue:yr(l.type,Ue),vt);re.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var se=l.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(D){an(l,l.return,D)}if(a=l.sibling,a!==null){a.return=l.return,qe=a;break}qe=l.return}return Fe=Jw,Jw=!1,Fe}function Eu(a,l,h){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var x=m=m.next;do{if((x.tag&a)===a){var _=x.destroy;x.destroy=void 0,_!==void 0&&Pv(l,h,_)}x=x.next}while(x!==m)}}function cf(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var h=l=l.next;do{if((h.tag&a)===a){var m=h.create;h.destroy=m()}h=h.next}while(h!==l)}}function Cv(a){var l=a.ref;if(l!==null){var h=a.stateNode;switch(a.tag){case 5:a=h;break;default:a=h}typeof l=="function"?l(a):l.current=a}}function mT(a){var l=a.alternate;l!==null&&(a.alternate=null,mT(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Hr],delete l[Bu],delete l[vv],delete l[KI],delete l[JI])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function gT(a){return a.tag===5||a.tag===3||a.tag===4}function $w(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||gT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Dv(a,l,h){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?h.nodeType===8?h.parentNode.insertBefore(a,l):h.insertBefore(a,l):(h.nodeType===8?(l=h.parentNode,l.insertBefore(a,h)):(l=h,l.appendChild(a)),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=kp));else if(m!==4&&(a=a.child,a!==null))for(Dv(a,l,h),a=a.sibling;a!==null;)Dv(a,l,h),a=a.sibling}function Ov(a,l,h){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?h.insertBefore(a,l):h.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(Ov(a,l,h),a=a.sibling;a!==null;)Ov(a,l,h),a=a.sibling}var Un=null,xr=!1;function Ja(a,l,h){for(h=h.child;h!==null;)vT(a,l,h),h=h.sibling}function vT(a,l,h){if(jr&&typeof jr.onCommitFiberUnmount=="function")try{jr.onCommitFiberUnmount(ef,h)}catch{}switch(h.tag){case 5:Jn||zl(h,l);case 6:var m=Un,x=xr;Un=null,Ja(a,l,h),Un=m,xr=x,Un!==null&&(xr?(a=Un,h=h.stateNode,a.nodeType===8?a.parentNode.removeChild(h):a.removeChild(h)):Un.removeChild(h.stateNode));break;case 18:Un!==null&&(xr?(a=Un,h=h.stateNode,a.nodeType===8?Dg(a.parentNode,h):a.nodeType===1&&Dg(a,h),Nu(a)):Dg(Un,h.stateNode));break;case 4:m=Un,x=xr,Un=h.stateNode.containerInfo,xr=!0,Ja(a,l,h),Un=m,xr=x;break;case 0:case 11:case 14:case 15:if(!Jn&&(m=h.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){x=m=m.next;do{var _=x,A=_.destroy;_=_.tag,A!==void 0&&(_&2||_&4)&&Pv(h,l,A),x=x.next}while(x!==m)}Ja(a,l,h);break;case 1:if(!Jn&&(zl(h,l),m=h.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=h.memoizedProps,m.state=h.memoizedState,m.componentWillUnmount()}catch(k){an(h,l,k)}Ja(a,l,h);break;case 21:Ja(a,l,h);break;case 22:h.mode&1?(Jn=(m=Jn)||h.memoizedState!==null,Ja(a,l,h),Jn=m):Ja(a,l,h);break;default:Ja(a,l,h)}}function eM(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var h=a.stateNode;h===null&&(h=a.stateNode=new f4),l.forEach(function(m){var x=M4.bind(null,a,m);h.has(m)||(h.add(m),m.then(x,x))})}}function vr(a,l){var h=l.deletions;if(h!==null)for(var m=0;m<h.length;m++){var x=h[m];try{var _=a,A=l,k=A;e:for(;k!==null;){switch(k.tag){case 5:Un=k.stateNode,xr=!1;break e;case 3:Un=k.stateNode.containerInfo,xr=!0;break e;case 4:Un=k.stateNode.containerInfo,xr=!0;break e}k=k.return}if(Un===null)throw Error(Ie(160));vT(_,A,x),Un=null,xr=!1;var B=x.alternate;B!==null&&(B.return=null),x.return=null}catch(K){an(x,l,K)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)yT(l,a),l=l.sibling}function yT(a,l){var h=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(vr(l,a),zr(a),m&4){try{Eu(3,a,a.return),cf(3,a)}catch(Ue){an(a,a.return,Ue)}try{Eu(5,a,a.return)}catch(Ue){an(a,a.return,Ue)}}break;case 1:vr(l,a),zr(a),m&512&&h!==null&&zl(h,h.return);break;case 5:if(vr(l,a),zr(a),m&512&&h!==null&&zl(h,h.return),a.flags&32){var x=a.stateNode;try{Cu(x,"")}catch(Ue){an(a,a.return,Ue)}}if(m&4&&(x=a.stateNode,x!=null)){var _=a.memoizedProps,A=h!==null?h.memoizedProps:_,k=a.type,B=a.updateQueue;if(a.updateQueue=null,B!==null)try{k==="input"&&_.type==="radio"&&_.name!=null&&zM(x,_),iv(k,A);var K=iv(k,_);for(A=0;A<B.length;A+=2){var ge=B[A],ve=B[A+1];ge==="style"?VM(x,ve):ge==="dangerouslySetInnerHTML"?jM(x,ve):ge==="children"?Cu(x,ve):Xv(x,ge,ve,K)}switch(k){case"input":Jg(x,_);break;case"textarea":BM(x,_);break;case"select":var fe=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!_.multiple;var Ce=_.value;Ce!=null?Hl(x,!!_.multiple,Ce,!1):fe!==!!_.multiple&&(_.defaultValue!=null?Hl(x,!!_.multiple,_.defaultValue,!0):Hl(x,!!_.multiple,_.multiple?[]:"",!1))}x[Bu]=_}catch(Ue){an(a,a.return,Ue)}}break;case 6:if(vr(l,a),zr(a),m&4){if(a.stateNode===null)throw Error(Ie(162));x=a.stateNode,_=a.memoizedProps;try{x.nodeValue=_}catch(Ue){an(a,a.return,Ue)}}break;case 3:if(vr(l,a),zr(a),m&4&&h!==null&&h.memoizedState.isDehydrated)try{Nu(l.containerInfo)}catch(Ue){an(a,a.return,Ue)}break;case 4:vr(l,a),zr(a);break;case 13:vr(l,a),zr(a),x=a.child,x.flags&8192&&(_=x.memoizedState!==null,x.stateNode.isHidden=_,!_||x.alternate!==null&&x.alternate.memoizedState!==null||(T1=un())),m&4&&eM(a);break;case 22:if(ge=h!==null&&h.memoizedState!==null,a.mode&1?(Jn=(K=Jn)||ge,vr(l,a),Jn=K):vr(l,a),zr(a),m&8192){if(K=a.memoizedState!==null,(a.stateNode.isHidden=K)&&!ge&&a.mode&1)for(qe=a,ge=a.child;ge!==null;){for(ve=qe=ge;qe!==null;){switch(fe=qe,Ce=fe.child,fe.tag){case 0:case 11:case 14:case 15:Eu(4,fe,fe.return);break;case 1:zl(fe,fe.return);var Fe=fe.stateNode;if(typeof Fe.componentWillUnmount=="function"){m=fe,h=fe.return;try{l=m,Fe.props=l.memoizedProps,Fe.state=l.memoizedState,Fe.componentWillUnmount()}catch(Ue){an(m,h,Ue)}}break;case 5:zl(fe,fe.return);break;case 22:if(fe.memoizedState!==null){nM(ve);continue}}Ce!==null?(Ce.return=fe,qe=Ce):nM(ve)}ge=ge.sibling}e:for(ge=null,ve=a;;){if(ve.tag===5){if(ge===null){ge=ve;try{x=ve.stateNode,K?(_=x.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(k=ve.stateNode,B=ve.memoizedProps.style,A=B!=null&&B.hasOwnProperty("display")?B.display:null,k.style.display=GM("display",A))}catch(Ue){an(a,a.return,Ue)}}}else if(ve.tag===6){if(ge===null)try{ve.stateNode.nodeValue=K?"":ve.memoizedProps}catch(Ue){an(a,a.return,Ue)}}else if((ve.tag!==22&&ve.tag!==23||ve.memoizedState===null||ve===a)&&ve.child!==null){ve.child.return=ve,ve=ve.child;continue}if(ve===a)break e;for(;ve.sibling===null;){if(ve.return===null||ve.return===a)break e;ge===ve&&(ge=null),ve=ve.return}ge===ve&&(ge=null),ve.sibling.return=ve.return,ve=ve.sibling}}break;case 19:vr(l,a),zr(a),m&4&&eM(a);break;case 21:break;default:vr(l,a),zr(a)}}function zr(a){var l=a.flags;if(l&2){try{e:{for(var h=a.return;h!==null;){if(gT(h)){var m=h;break e}h=h.return}throw Error(Ie(160))}switch(m.tag){case 5:var x=m.stateNode;m.flags&32&&(Cu(x,""),m.flags&=-33);var _=$w(a);Ov(a,_,x);break;case 3:case 4:var A=m.stateNode.containerInfo,k=$w(a);Dv(a,k,A);break;default:throw Error(Ie(161))}}catch(B){an(a,a.return,B)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function g4(a,l,h){qe=a,xT(a)}function xT(a,l,h){for(var m=(a.mode&1)!==0;qe!==null;){var x=qe,_=x.child;if(x.tag===22&&m){var A=x.memoizedState!==null||cp;if(!A){var k=x.alternate,B=k!==null&&k.memoizedState!==null||Jn;k=cp;var K=Jn;if(cp=A,(Jn=B)&&!K)for(qe=x;qe!==null;)A=qe,B=A.child,A.tag===22&&A.memoizedState!==null?iM(x):B!==null?(B.return=A,qe=B):iM(x);for(;_!==null;)qe=_,xT(_),_=_.sibling;qe=x,cp=k,Jn=K}tM(a)}else x.subtreeFlags&8772&&_!==null?(_.return=x,qe=_):tM(a)}}function tM(a){for(;qe!==null;){var l=qe;if(l.flags&8772){var h=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:Jn||cf(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!Jn)if(h===null)m.componentDidMount();else{var x=l.elementType===l.type?h.memoizedProps:yr(l.type,h.memoizedProps);m.componentDidUpdate(x,h.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var _=l.updateQueue;_!==null&&Uw(l,_,m);break;case 3:var A=l.updateQueue;if(A!==null){if(h=null,l.child!==null)switch(l.child.tag){case 5:h=l.child.stateNode;break;case 1:h=l.child.stateNode}Uw(l,A,h)}break;case 5:var k=l.stateNode;if(h===null&&l.flags&4){h=k;var B=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&h.focus();break;case"img":B.src&&(h.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var K=l.alternate;if(K!==null){var ge=K.memoizedState;if(ge!==null){var ve=ge.dehydrated;ve!==null&&Nu(ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}Jn||l.flags&512&&Cv(l)}catch(fe){an(l,l.return,fe)}}if(l===a){qe=null;break}if(h=l.sibling,h!==null){h.return=l.return,qe=h;break}qe=l.return}}function nM(a){for(;qe!==null;){var l=qe;if(l===a){qe=null;break}var h=l.sibling;if(h!==null){h.return=l.return,qe=h;break}qe=l.return}}function iM(a){for(;qe!==null;){var l=qe;try{switch(l.tag){case 0:case 11:case 15:var h=l.return;try{cf(4,l)}catch(B){an(l,h,B)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var x=l.return;try{m.componentDidMount()}catch(B){an(l,x,B)}}var _=l.return;try{Cv(l)}catch(B){an(l,_,B)}break;case 5:var A=l.return;try{Cv(l)}catch(B){an(l,A,B)}}}catch(B){an(l,l.return,B)}if(l===a){qe=null;break}var k=l.sibling;if(k!==null){k.return=l.return,qe=k;break}qe=l.return}}var v4=Math.ceil,qp=Sa.ReactCurrentDispatcher,w1=Sa.ReactCurrentOwner,Ki=Sa.ReactCurrentBatchConfig,Et=0,On=null,fn=null,zn=0,Oi=0,Bl=gs(0),Tn=0,Xu=null,_o=0,uf=0,M1=0,Au=null,xi=null,T1=0,$l=1/0,da=null,Yp=!1,Iv=null,us=null,up=!1,rs=null,Qp=0,Ru=0,Nv=null,Tp=-1,Ep=0;function li(){return Et&6?un():Tp!==-1?Tp:Tp=un()}function hs(a){return a.mode&1?Et&2&&zn!==0?zn&-zn:e4.transition!==null?(Ep===0&&(Ep=n2()),Ep):(a=It,a!==0||(a=window.event,a=a===void 0?16:c2(a.type)),a):1}function wr(a,l,h,m){if(50<Ru)throw Ru=0,Nv=null,Error(Ie(185));Yu(a,h,m),(!(Et&2)||a!==On)&&(a===On&&(!(Et&2)&&(uf|=h),Tn===4&&ns(a,zn)),wi(a,m),h===1&&Et===0&&!(l.mode&1)&&($l=un()+500,sf&&vs()))}function wi(a,l){var h=a.callbackNode;eI(a,l);var m=Dp(a,a===On?zn:0);if(m===0)h!==null&&dw(h),a.callbackNode=null,a.callbackPriority=0;else if(l=m&-m,a.callbackPriority!==l){if(h!=null&&dw(h),l===1)a.tag===0?$I(rM.bind(null,a)):R2(rM.bind(null,a)),QI(function(){!(Et&6)&&vs()}),h=null;else{switch(i2(m)){case 1:h=Kv;break;case 4:h=e2;break;case 16:h=Cp;break;case 536870912:h=t2;break;default:h=Cp}h=AT(h,bT.bind(null,a))}a.callbackPriority=l,a.callbackNode=h}}function bT(a,l){if(Tp=-1,Ep=0,Et&6)throw Error(Ie(327));var h=a.callbackNode;if(Xl()&&a.callbackNode!==h)return null;var m=Dp(a,a===On?zn:0);if(m===0)return null;if(m&30||m&a.expiredLanes||l)l=Zp(a,m);else{l=m;var x=Et;Et|=2;var _=_T();(On!==a||zn!==l)&&(da=null,$l=un()+500,go(a,l));do try{b4();break}catch(k){ST(a,k)}while(1);u1(),qp.current=_,Et=x,fn!==null?l=0:(On=null,zn=0,l=Tn)}if(l!==0){if(l===2&&(x=lv(a),x!==0&&(m=x,l=kv(a,x))),l===1)throw h=Xu,go(a,0),ns(a,m),wi(a,un()),h;if(l===6)ns(a,m);else{if(x=a.current.alternate,!(m&30)&&!y4(x)&&(l=Zp(a,m),l===2&&(_=lv(a),_!==0&&(m=_,l=kv(a,_))),l===1))throw h=Xu,go(a,0),ns(a,m),wi(a,un()),h;switch(a.finishedWork=x,a.finishedLanes=m,l){case 0:case 1:throw Error(Ie(345));case 2:ho(a,xi,da);break;case 3:if(ns(a,m),(m&130023424)===m&&(l=T1+500-un(),10<l)){if(Dp(a,0)!==0)break;if(x=a.suspendedLanes,(x&m)!==m){li(),a.pingedLanes|=a.suspendedLanes&x;break}a.timeoutHandle=gv(ho.bind(null,a,xi,da),l);break}ho(a,xi,da);break;case 4:if(ns(a,m),(m&4194240)===m)break;for(l=a.eventTimes,x=-1;0<m;){var A=31-_r(m);_=1<<A,A=l[A],A>x&&(x=A),m&=~_}if(m=x,m=un()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*v4(m/1960))-m,10<m){a.timeoutHandle=gv(ho.bind(null,a,xi,da),m);break}ho(a,xi,da);break;case 5:ho(a,xi,da);break;default:throw Error(Ie(329))}}}return wi(a,un()),a.callbackNode===h?bT.bind(null,a):null}function kv(a,l){var h=Au;return a.current.memoizedState.isDehydrated&&(go(a,l).flags|=256),a=Zp(a,l),a!==2&&(l=xi,xi=h,l!==null&&Fv(l)),a}function Fv(a){xi===null?xi=a:xi.push.apply(xi,a)}function y4(a){for(var l=a;;){if(l.flags&16384){var h=l.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var m=0;m<h.length;m++){var x=h[m],_=x.getSnapshot;x=x.value;try{if(!Mr(_(),x))return!1}catch{return!1}}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ns(a,l){for(l&=~M1,l&=~uf,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var h=31-_r(l),m=1<<h;a[h]=-1,l&=~m}}function rM(a){if(Et&6)throw Error(Ie(327));Xl();var l=Dp(a,0);if(!(l&1))return wi(a,un()),null;var h=Zp(a,l);if(a.tag!==0&&h===2){var m=lv(a);m!==0&&(l=m,h=kv(a,m))}if(h===1)throw h=Xu,go(a,0),ns(a,l),wi(a,un()),h;if(h===6)throw Error(Ie(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,ho(a,xi,da),wi(a,un()),null}function E1(a,l){var h=Et;Et|=1;try{return a(l)}finally{Et=h,Et===0&&($l=un()+500,sf&&vs())}}function wo(a){rs!==null&&rs.tag===0&&!(Et&6)&&Xl();var l=Et;Et|=1;var h=Ki.transition,m=It;try{if(Ki.transition=null,It=1,a)return a()}finally{It=m,Ki.transition=h,Et=l,!(Et&6)&&vs()}}function A1(){Oi=Bl.current,qt(Bl)}function go(a,l){a.finishedWork=null,a.finishedLanes=0;var h=a.timeoutHandle;if(h!==-1&&(a.timeoutHandle=-1,YI(h)),fn!==null)for(h=fn.return;h!==null;){var m=h;switch(o1(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Fp();break;case 3:Kl(),qt(Si),qt($n),g1();break;case 5:m1(m);break;case 4:Kl();break;case 13:qt($t);break;case 19:qt($t);break;case 10:h1(m.type._context);break;case 22:case 23:A1()}h=h.return}if(On=a,fn=a=ds(a.current,null),zn=Oi=l,Tn=0,Xu=null,M1=uf=_o=0,xi=Au=null,fo!==null){for(l=0;l<fo.length;l++)if(h=fo[l],m=h.interleaved,m!==null){h.interleaved=null;var x=m.next,_=h.pending;if(_!==null){var A=_.next;_.next=x,m.next=A}h.pending=m}fo=null}return a}function ST(a,l){do{var h=fn;try{if(u1(),_p.current=Xp,Wp){for(var m=en.memoizedState;m!==null;){var x=m.queue;x!==null&&(x.pending=null),m=m.next}Wp=!1}if(So=0,Dn=wn=en=null,Tu=!1,Gu=0,w1.current=null,h===null||h.return===null){Tn=1,Xu=l,fn=null;break}e:{var _=a,A=h.return,k=h,B=l;if(l=zn,k.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var K=B,ge=k,ve=ge.tag;if(!(ge.mode&1)&&(ve===0||ve===11||ve===15)){var fe=ge.alternate;fe?(ge.updateQueue=fe.updateQueue,ge.memoizedState=fe.memoizedState,ge.lanes=fe.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var Ce=Ww(A);if(Ce!==null){Ce.flags&=-257,Xw(Ce,A,k,_,l),Ce.mode&1&&Vw(_,K,l),l=Ce,B=K;var Fe=l.updateQueue;if(Fe===null){var Ue=new Set;Ue.add(B),l.updateQueue=Ue}else Fe.add(B);break e}else{if(!(l&1)){Vw(_,K,l),R1();break e}B=Error(Ie(426))}}else if(Kt&&k.mode&1){var vt=Ww(A);if(vt!==null){!(vt.flags&65536)&&(vt.flags|=256),Xw(vt,A,k,_,l),l1(Jl(B,k));break e}}_=B=Jl(B,k),Tn!==4&&(Tn=2),Au===null?Au=[_]:Au.push(_),_=A;do{switch(_.tag){case 3:_.flags|=65536,l&=-l,_.lanes|=l;var re=rT(_,B,l);Fw(_,re);break e;case 1:k=B;var Z=_.type,se=_.stateNode;if(!(_.flags&128)&&(typeof Z.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(us===null||!us.has(se)))){_.flags|=65536,l&=-l,_.lanes|=l;var D=aT(_,k,l);Fw(_,D);break e}}_=_.return}while(_!==null)}MT(h)}catch(Q){l=Q,fn===h&&h!==null&&(fn=h=h.return);continue}break}while(1)}function _T(){var a=qp.current;return qp.current=Xp,a===null?Xp:a}function R1(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),On===null||!(_o&268435455)&&!(uf&268435455)||ns(On,zn)}function Zp(a,l){var h=Et;Et|=2;var m=_T();(On!==a||zn!==l)&&(da=null,go(a,l));do try{x4();break}catch(x){ST(a,x)}while(1);if(u1(),Et=h,qp.current=m,fn!==null)throw Error(Ie(261));return On=null,zn=0,Tn}function x4(){for(;fn!==null;)wT(fn)}function b4(){for(;fn!==null&&!WO();)wT(fn)}function wT(a){var l=ET(a.alternate,a,Oi);a.memoizedProps=a.pendingProps,l===null?MT(a):fn=l,w1.current=null}function MT(a){var l=a;do{var h=l.alternate;if(a=l.return,l.flags&32768){if(h=p4(h,l),h!==null){h.flags&=32767,fn=h;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Tn=6,fn=null;return}}else if(h=d4(h,l,Oi),h!==null){fn=h;return}if(l=l.sibling,l!==null){fn=l;return}fn=l=a}while(l!==null);Tn===0&&(Tn=5)}function ho(a,l,h){var m=It,x=Ki.transition;try{Ki.transition=null,It=1,S4(a,l,h,m)}finally{Ki.transition=x,It=m}return null}function S4(a,l,h,m){do Xl();while(rs!==null);if(Et&6)throw Error(Ie(327));h=a.finishedWork;var x=a.finishedLanes;if(h===null)return null;if(a.finishedWork=null,a.finishedLanes=0,h===a.current)throw Error(Ie(177));a.callbackNode=null,a.callbackPriority=0;var _=h.lanes|h.childLanes;if(tI(a,_),a===On&&(fn=On=null,zn=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||up||(up=!0,AT(Cp,function(){return Xl(),null})),_=(h.flags&15990)!==0,h.subtreeFlags&15990||_){_=Ki.transition,Ki.transition=null;var A=It;It=1;var k=Et;Et|=4,w1.current=null,m4(a,h),yT(h,a),HI(fv),Op=!!pv,fv=pv=null,a.current=h,g4(h),XO(),Et=k,It=A,Ki.transition=_}else a.current=h;if(up&&(up=!1,rs=a,Qp=x),_=a.pendingLanes,_===0&&(us=null),QO(h.stateNode),wi(a,un()),l!==null)for(m=a.onRecoverableError,h=0;h<l.length;h++)x=l[h],m(x.value,{componentStack:x.stack,digest:x.digest});if(Yp)throw Yp=!1,a=Iv,Iv=null,a;return Qp&1&&a.tag!==0&&Xl(),_=a.pendingLanes,_&1?a===Nv?Ru++:(Ru=0,Nv=a):Ru=0,vs(),null}function Xl(){if(rs!==null){var a=i2(Qp),l=Ki.transition,h=It;try{if(Ki.transition=null,It=16>a?16:a,rs===null)var m=!1;else{if(a=rs,rs=null,Qp=0,Et&6)throw Error(Ie(331));var x=Et;for(Et|=4,qe=a.current;qe!==null;){var _=qe,A=_.child;if(qe.flags&16){var k=_.deletions;if(k!==null){for(var B=0;B<k.length;B++){var K=k[B];for(qe=K;qe!==null;){var ge=qe;switch(ge.tag){case 0:case 11:case 15:Eu(8,ge,_)}var ve=ge.child;if(ve!==null)ve.return=ge,qe=ve;else for(;qe!==null;){ge=qe;var fe=ge.sibling,Ce=ge.return;if(mT(ge),ge===K){qe=null;break}if(fe!==null){fe.return=Ce,qe=fe;break}qe=Ce}}}var Fe=_.alternate;if(Fe!==null){var Ue=Fe.child;if(Ue!==null){Fe.child=null;do{var vt=Ue.sibling;Ue.sibling=null,Ue=vt}while(Ue!==null)}}qe=_}}if(_.subtreeFlags&2064&&A!==null)A.return=_,qe=A;else e:for(;qe!==null;){if(_=qe,_.flags&2048)switch(_.tag){case 0:case 11:case 15:Eu(9,_,_.return)}var re=_.sibling;if(re!==null){re.return=_.return,qe=re;break e}qe=_.return}}var Z=a.current;for(qe=Z;qe!==null;){A=qe;var se=A.child;if(A.subtreeFlags&2064&&se!==null)se.return=A,qe=se;else e:for(A=Z;qe!==null;){if(k=qe,k.flags&2048)try{switch(k.tag){case 0:case 11:case 15:cf(9,k)}}catch(Q){an(k,k.return,Q)}if(k===A){qe=null;break e}var D=k.sibling;if(D!==null){D.return=k.return,qe=D;break e}qe=k.return}}if(Et=x,vs(),jr&&typeof jr.onPostCommitFiberRoot=="function")try{jr.onPostCommitFiberRoot(ef,a)}catch{}m=!0}return m}finally{It=h,Ki.transition=l}}return!1}function aM(a,l,h){l=Jl(h,l),l=rT(a,l,1),a=cs(a,l,1),l=li(),a!==null&&(Yu(a,1,l),wi(a,l))}function an(a,l,h){if(a.tag===3)aM(a,a,h);else for(;l!==null;){if(l.tag===3){aM(l,a,h);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(us===null||!us.has(m))){a=Jl(h,a),a=aT(l,a,1),l=cs(l,a,1),a=li(),l!==null&&(Yu(l,1,a),wi(l,a));break}}l=l.return}}function _4(a,l,h){var m=a.pingCache;m!==null&&m.delete(l),l=li(),a.pingedLanes|=a.suspendedLanes&h,On===a&&(zn&h)===h&&(Tn===4||Tn===3&&(zn&130023424)===zn&&500>un()-T1?go(a,0):M1|=h),wi(a,l)}function TT(a,l){l===0&&(a.mode&1?(l=ep,ep<<=1,!(ep&130023424)&&(ep=4194304)):l=1);var h=li();a=xa(a,l),a!==null&&(Yu(a,l,h),wi(a,h))}function w4(a){var l=a.memoizedState,h=0;l!==null&&(h=l.retryLane),TT(a,h)}function M4(a,l){var h=0;switch(a.tag){case 13:var m=a.stateNode,x=a.memoizedState;x!==null&&(h=x.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(Ie(314))}m!==null&&m.delete(l),TT(a,h)}var ET;ET=function(a,l,h){if(a!==null)if(a.memoizedProps!==l.pendingProps||Si.current)bi=!0;else{if(!(a.lanes&h)&&!(l.flags&128))return bi=!1,h4(a,l,h);bi=!!(a.flags&131072)}else bi=!1,Kt&&l.flags&1048576&&L2(l,Bp,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Mp(a,l),a=l.pendingProps;var x=Yl(l,$n.current);Wl(l,h),x=y1(null,l,m,a,x,h);var _=x1();return l.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,_i(m)?(_=!0,Up(l)):_=!1,l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,p1(l),x.updater=of,l.stateNode=x,x._reactInternals=l,wv(l,m,a,h),l=Ev(null,l,m,!0,_,h)):(l.tag=0,Kt&&_&&s1(l),oi(null,l,x,h),l=l.child),l;case 16:m=l.elementType;e:{switch(Mp(a,l),a=l.pendingProps,x=m._init,m=x(m._payload),l.type=m,x=l.tag=E4(m),a=yr(m,a),x){case 0:l=Tv(null,l,m,a,h);break e;case 1:l=Qw(null,l,m,a,h);break e;case 11:l=qw(null,l,m,a,h);break e;case 14:l=Yw(null,l,m,yr(m.type,a),h);break e}throw Error(Ie(306,m,""))}return l;case 0:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:yr(m,x),Tv(a,l,m,x,h);case 1:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:yr(m,x),Qw(a,l,m,x,h);case 3:e:{if(cT(l),a===null)throw Error(Ie(387));m=l.pendingProps,_=l.memoizedState,x=_.element,O2(a,l),Gp(l,m,null,h);var A=l.memoizedState;if(m=A.element,_.isDehydrated)if(_={element:m,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){x=Jl(Error(Ie(423)),l),l=Zw(a,l,m,h,x);break e}else if(m!==x){x=Jl(Error(Ie(424)),l),l=Zw(a,l,m,h,x);break e}else for(Ii=ls(l.stateNode.containerInfo.firstChild),Ni=l,Kt=!0,br=null,h=F2(l,null,m,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Ql(),m===x){l=ba(a,l,h);break e}oi(a,l,m,h)}l=l.child}return l;case 5:return U2(l),a===null&&bv(l),m=l.type,x=l.pendingProps,_=a!==null?a.memoizedProps:null,A=x.children,mv(m,x)?A=null:_!==null&&mv(m,_)&&(l.flags|=32),lT(a,l),oi(a,l,A,h),l.child;case 6:return a===null&&bv(l),null;case 13:return uT(a,l,h);case 4:return f1(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=Zl(l,null,m,h):oi(a,l,m,h),l.child;case 11:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:yr(m,x),qw(a,l,m,x,h);case 7:return oi(a,l,l.pendingProps,h),l.child;case 8:return oi(a,l,l.pendingProps.children,h),l.child;case 12:return oi(a,l,l.pendingProps.children,h),l.child;case 10:e:{if(m=l.type._context,x=l.pendingProps,_=l.memoizedProps,A=x.value,jt(Hp,m._currentValue),m._currentValue=A,_!==null)if(Mr(_.value,A)){if(_.children===x.children&&!Si.current){l=ba(a,l,h);break e}}else for(_=l.child,_!==null&&(_.return=l);_!==null;){var k=_.dependencies;if(k!==null){A=_.child;for(var B=k.firstContext;B!==null;){if(B.context===m){if(_.tag===1){B=ga(-1,h&-h),B.tag=2;var K=_.updateQueue;if(K!==null){K=K.shared;var ge=K.pending;ge===null?B.next=B:(B.next=ge.next,ge.next=B),K.pending=B}}_.lanes|=h,B=_.alternate,B!==null&&(B.lanes|=h),Sv(_.return,h,l),k.lanes|=h;break}B=B.next}}else if(_.tag===10)A=_.type===l.type?null:_.child;else if(_.tag===18){if(A=_.return,A===null)throw Error(Ie(341));A.lanes|=h,k=A.alternate,k!==null&&(k.lanes|=h),Sv(A,h,l),A=_.sibling}else A=_.child;if(A!==null)A.return=_;else for(A=_;A!==null;){if(A===l){A=null;break}if(_=A.sibling,_!==null){_.return=A.return,A=_;break}A=A.return}_=A}oi(a,l,x.children,h),l=l.child}return l;case 9:return x=l.type,m=l.pendingProps.children,Wl(l,h),x=Ji(x),m=m(x),l.flags|=1,oi(a,l,m,h),l.child;case 14:return m=l.type,x=yr(m,l.pendingProps),x=yr(m.type,x),Yw(a,l,m,x,h);case 15:return sT(a,l,l.type,l.pendingProps,h);case 17:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:yr(m,x),Mp(a,l),l.tag=1,_i(m)?(a=!0,Up(l)):a=!1,Wl(l,h),N2(l,m,x),wv(l,m,x,h),Ev(null,l,m,!0,a,h);case 19:return hT(a,l,h);case 22:return oT(a,l,h)}throw Error(Ie(156,l.tag))};function AT(a,l){return $M(a,l)}function T4(a,l,h,m){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zi(a,l,h,m){return new T4(a,l,h,m)}function L1(a){return a=a.prototype,!(!a||!a.isReactComponent)}function E4(a){if(typeof a=="function")return L1(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Yv)return 11;if(a===Qv)return 14}return 2}function ds(a,l){var h=a.alternate;return h===null?(h=Zi(a.tag,l,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=l,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&14680064,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,l=a.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h}function Ap(a,l,h,m,x,_){var A=2;if(m=a,typeof a=="function")L1(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case Pl:return vo(h.children,x,_,l);case qv:A=8,x|=8;break;case qg:return a=Zi(12,h,l,x|2),a.elementType=qg,a.lanes=_,a;case Yg:return a=Zi(13,h,l,x),a.elementType=Yg,a.lanes=_,a;case Qg:return a=Zi(19,h,l,x),a.elementType=Qg,a.lanes=_,a;case kM:return hf(h,x,_,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case IM:A=10;break e;case NM:A=9;break e;case Yv:A=11;break e;case Qv:A=14;break e;case $a:A=16,m=null;break e}throw Error(Ie(130,a==null?a:typeof a,""))}return l=Zi(A,h,l,x),l.elementType=a,l.type=m,l.lanes=_,l}function vo(a,l,h,m){return a=Zi(7,a,m,l),a.lanes=h,a}function hf(a,l,h,m){return a=Zi(22,a,m,l),a.elementType=kM,a.lanes=h,a.stateNode={isHidden:!1},a}function Bg(a,l,h){return a=Zi(6,a,null,l),a.lanes=h,a}function Hg(a,l,h){return l=Zi(4,a.children!==null?a.children:[],a.key,l),l.lanes=h,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function A4(a,l,h,m,x){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sg(0),this.expirationTimes=Sg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sg(0),this.identifierPrefix=m,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function P1(a,l,h,m,x,_,A,k,B){return a=new A4(a,l,h,k,B),l===1?(l=1,_===!0&&(l|=8)):l=0,_=Zi(3,null,null,l),a.current=_,_.stateNode=a,_.memoizedState={element:m,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},p1(_),a}function R4(a,l,h){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ll,key:m==null?null:""+m,children:a,containerInfo:l,implementation:h}}function RT(a){if(!a)return fs;a=a._reactInternals;e:{if(To(a)!==a||a.tag!==1)throw Error(Ie(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(_i(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(Ie(171))}if(a.tag===1){var h=a.type;if(_i(h))return A2(a,h,l)}return l}function LT(a,l,h,m,x,_,A,k,B){return a=P1(h,m,!0,a,x,_,A,k,B),a.context=RT(null),h=a.current,m=li(),x=hs(h),_=ga(m,x),_.callback=l??null,cs(h,_,x),a.current.lanes=x,Yu(a,x,m),wi(a,m),a}function df(a,l,h,m){var x=l.current,_=li(),A=hs(x);return h=RT(h),l.context===null?l.context=h:l.pendingContext=h,l=ga(_,A),l.payload={element:a},m=m===void 0?null:m,m!==null&&(l.callback=m),a=cs(x,l,A),a!==null&&(wr(a,x,A,_),Sp(a,x,A)),A}function Kp(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function sM(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<l?h:l}}function C1(a,l){sM(a,l),(a=a.alternate)&&sM(a,l)}function L4(){return null}var PT=typeof reportError=="function"?reportError:function(a){console.error(a)};function D1(a){this._internalRoot=a}pf.prototype.render=D1.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(Ie(409));df(a,l,null,null)};pf.prototype.unmount=D1.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;wo(function(){df(null,a,null,null)}),l[ya]=null}};function pf(a){this._internalRoot=a}pf.prototype.unstable_scheduleHydration=function(a){if(a){var l=s2();a={blockedOn:null,target:a,priority:l};for(var h=0;h<ts.length&&l!==0&&l<ts[h].priority;h++);ts.splice(h,0,a),h===0&&l2(a)}};function O1(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function ff(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function oM(){}function P4(a,l,h,m,x){if(x){if(typeof m=="function"){var _=m;m=function(){var K=Kp(A);_.call(K)}}var A=LT(l,m,a,0,null,!1,!1,"",oM);return a._reactRootContainer=A,a[ya]=A.current,Uu(a.nodeType===8?a.parentNode:a),wo(),A}for(;x=a.lastChild;)a.removeChild(x);if(typeof m=="function"){var k=m;m=function(){var K=Kp(B);k.call(K)}}var B=P1(a,0,!1,null,null,!1,!1,"",oM);return a._reactRootContainer=B,a[ya]=B.current,Uu(a.nodeType===8?a.parentNode:a),wo(function(){df(l,B,h,m)}),B}function mf(a,l,h,m,x){var _=h._reactRootContainer;if(_){var A=_;if(typeof x=="function"){var k=x;x=function(){var B=Kp(A);k.call(B)}}df(l,A,a,x)}else A=P4(h,l,a,x,m);return Kp(A)}r2=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var h=yu(l.pendingLanes);h!==0&&(Jv(l,h|1),wi(l,un()),!(Et&6)&&($l=un()+500,vs()))}break;case 13:wo(function(){var m=xa(a,1);if(m!==null){var x=li();wr(m,a,1,x)}}),C1(a,1)}};$v=function(a){if(a.tag===13){var l=xa(a,134217728);if(l!==null){var h=li();wr(l,a,134217728,h)}C1(a,134217728)}};a2=function(a){if(a.tag===13){var l=hs(a),h=xa(a,l);if(h!==null){var m=li();wr(h,a,l,m)}C1(a,l)}};s2=function(){return It};o2=function(a,l){var h=It;try{return It=a,l()}finally{It=h}};av=function(a,l,h){switch(l){case"input":if(Jg(a,h),l=h.name,h.type==="radio"&&l!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<h.length;l++){var m=h[l];if(m!==a&&m.form===a.form){var x=af(m);if(!x)throw Error(Ie(90));UM(m),Jg(m,x)}}}break;case"textarea":BM(a,h);break;case"select":l=h.value,l!=null&&Hl(a,!!h.multiple,l,!1)}};qM=E1;YM=wo;var C4={usingClientEntryPoint:!1,Events:[Zu,Il,af,WM,XM,E1]},fu={findFiberByHostInstance:po,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},D4={bundleType:fu.bundleType,version:fu.version,rendererPackageName:fu.rendererPackageName,rendererConfig:fu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sa.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=KM(a),a===null?null:a.stateNode},findFiberByHostInstance:fu.findFiberByHostInstance||L4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hp.isDisabled&&hp.supportsFiber)try{ef=hp.inject(D4),jr=hp}catch{}}Fi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C4;Fi.createPortal=function(a,l){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O1(l))throw Error(Ie(200));return R4(a,l,null,h)};Fi.createRoot=function(a,l){if(!O1(a))throw Error(Ie(299));var h=!1,m="",x=PT;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(x=l.onRecoverableError)),l=P1(a,1,!1,null,null,h,!1,m,x),a[ya]=l.current,Uu(a.nodeType===8?a.parentNode:a),new D1(l)};Fi.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(Ie(188)):(a=Object.keys(a).join(","),Error(Ie(268,a)));return a=KM(l),a=a===null?null:a.stateNode,a};Fi.flushSync=function(a){return wo(a)};Fi.hydrate=function(a,l,h){if(!ff(l))throw Error(Ie(200));return mf(null,a,l,!0,h)};Fi.hydrateRoot=function(a,l,h){if(!O1(a))throw Error(Ie(405));var m=h!=null&&h.hydratedSources||null,x=!1,_="",A=PT;if(h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(_=h.identifierPrefix),h.onRecoverableError!==void 0&&(A=h.onRecoverableError)),l=LT(l,null,a,1,h??null,x,!1,_,A),a[ya]=l.current,Uu(a),m)for(a=0;a<m.length;a++)h=m[a],x=h._getVersion,x=x(h._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[h,x]:l.mutableSourceEagerHydrationData.push(h,x);return new pf(l)};Fi.render=function(a,l,h){if(!ff(l))throw Error(Ie(200));return mf(null,a,l,!1,h)};Fi.unmountComponentAtNode=function(a){if(!ff(a))throw Error(Ie(40));return a._reactRootContainer?(wo(function(){mf(null,null,a,!1,function(){a._reactRootContainer=null,a[ya]=null})}),!0):!1};Fi.unstable_batchedUpdates=E1;Fi.unstable_renderSubtreeIntoContainer=function(a,l,h,m){if(!ff(h))throw Error(Ie(200));if(a==null||a._reactInternals===void 0)throw Error(Ie(38));return mf(a,l,h,!1,m)};Fi.version="18.2.0-next-9e3b772b8-20220608";function CT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CT)}catch(a){console.error(a)}}CT(),LM.exports=Fi;var O4=LM.exports,lM=O4;Wg.createRoot=lM.createRoot,Wg.hydrateRoot=lM.hydrateRoot;/*! For license information please see xviewer.module.min.js.LICENSE.txt */var I4={631:(a,l,h)=>{h.r(l),h.d(l,{TweenChain:()=>x});const m=h(622);class x{constructor(A){this._object=A,this._tween=new m.Tween(A)}start(){return this._tween.start(),this}stop(){return this._tween.stop(),this}repeat(A){return this._chainedTween.repeat(A),this}union(){return this._chainedTween=this._tween=new m.Tween(this._object).union(this._tween,this._chainedTween),this}call(A){return this._chainTween().call(A),this}delay(A){return this._chainTween().delay(A),this}to(A,k,B){let K=this._chainTween().to(A,k);return B&&(B.from&&K.from(B.from),B.easing&&K.easing(B.easing),B.onStart&&K.onStart(B.onStart),B.onStop&&K.onStop(B.onStop),B.onComplete&&K.onComplete(B.onComplete),B.onUpdate&&K.onUpdate(B.onUpdate),B.onRepeat&&K.onRepeat(B.onRepeat)),this}_chainTween(){let A=this._tween;return this._chainedTween&&(A=new m.Tween(this._object),this._chainedTween.chain(A)),this._chainedTween=A,A}}},622:(a,l)=>{Object.defineProperty(l,"__esModule",{value:!0});var h,m={Linear:{None:function(D){return D}},Quadratic:{In:function(D){return D*D},Out:function(D){return D*(2-D)},InOut:function(D){return(D*=2)<1?.5*D*D:-.5*(--D*(D-2)-1)}},Cubic:{In:function(D){return D*D*D},Out:function(D){return--D*D*D+1},InOut:function(D){return(D*=2)<1?.5*D*D*D:.5*((D-=2)*D*D+2)}},Quartic:{In:function(D){return D*D*D*D},Out:function(D){return 1- --D*D*D*D},InOut:function(D){return(D*=2)<1?.5*D*D*D*D:-.5*((D-=2)*D*D*D-2)}},Quintic:{In:function(D){return D*D*D*D*D},Out:function(D){return--D*D*D*D*D+1},InOut:function(D){return(D*=2)<1?.5*D*D*D*D*D:.5*((D-=2)*D*D*D*D+2)}},Sinusoidal:{In:function(D){return 1-Math.cos(D*Math.PI/2)},Out:function(D){return Math.sin(D*Math.PI/2)},InOut:function(D){return .5*(1-Math.cos(Math.PI*D))}},Exponential:{In:function(D){return D===0?0:Math.pow(1024,D-1)},Out:function(D){return D===1?1:1-Math.pow(2,-10*D)},InOut:function(D){return D===0?0:D===1?1:(D*=2)<1?.5*Math.pow(1024,D-1):.5*(2-Math.pow(2,-10*(D-1)))}},Circular:{In:function(D){return 1-Math.sqrt(1-D*D)},Out:function(D){return Math.sqrt(1- --D*D)},InOut:function(D){return(D*=2)<1?-.5*(Math.sqrt(1-D*D)-1):.5*(Math.sqrt(1-(D-=2)*D)+1)}},Elastic:{In:function(D){return D===0?0:D===1?1:-Math.pow(2,10*(D-1))*Math.sin(5*(D-1.1)*Math.PI)},Out:function(D){return D===0?0:D===1?1:Math.pow(2,-10*D)*Math.sin(5*(D-.1)*Math.PI)+1},InOut:function(D){return D===0?0:D===1?1:(D*=2)<1?-.5*Math.pow(2,10*(D-1))*Math.sin(5*(D-1.1)*Math.PI):.5*Math.pow(2,-10*(D-1))*Math.sin(5*(D-1.1)*Math.PI)+1}},Back:{In:function(D){var Q=1.70158;return D*D*((Q+1)*D-Q)},Out:function(D){var Q=1.70158;return--D*D*((Q+1)*D+Q)+1},InOut:function(D){var Q=2.5949095;return(D*=2)<1?D*D*((Q+1)*D-Q)*.5:.5*((D-=2)*D*((Q+1)*D+Q)+2)}},Bounce:{In:function(D){return 1-m.Bounce.Out(1-D)},Out:function(D){return D<1/2.75?7.5625*D*D:D<2/2.75?7.5625*(D-=1.5/2.75)*D+.75:D<2.5/2.75?7.5625*(D-=2.25/2.75)*D+.9375:7.5625*(D-=2.625/2.75)*D+.984375},InOut:function(D){return D<.5?.5*m.Bounce.In(2*D):.5*m.Bounce.Out(2*D-1)+.5}}};function x(){return .001*h()}h=typeof self>"u"&&typeof process<"u"&&process.hrtime?function(){var D=process.hrtime();return 1e3*D[0]+D[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?self.performance.now.bind(self.performance):Date.now!==void 0?Date.now:function(){return new Date().getTime()};var _,A=function(){function D(){this._tweens={},this._tweensAddedDuringUpdate={}}return D.prototype.getAll=function(){var Q=this;return Object.keys(this._tweens).map(function(oe){return Q._tweens[oe]})},D.prototype.removeAll=function(){this._tweens={}},D.prototype.add=function(Q){this._tweens[Q.getId()]=Q,this._tweensAddedDuringUpdate[Q.getId()]=Q},D.prototype.remove=function(Q){delete this._tweens[Q.getId()],delete this._tweensAddedDuringUpdate[Q.getId()]},D.prototype.update=function(Q,oe){Q===void 0&&(Q=x()),oe===void 0&&(oe=!1);var xe=Object.keys(this._tweens);if(xe.length===0)return!1;for(;xe.length>0;){this._tweensAddedDuringUpdate={};for(var _e=0;_e<xe.length;_e++){var We=this._tweens[xe[_e]],ke=!oe;We&&We.update(Q,ke)===!1&&!oe&&delete this._tweens[xe[_e]]}xe=Object.keys(this._tweensAddedDuringUpdate)}return!0},D}(),k={Linear:function(D,Q){var oe=D.length-1,xe=oe*Q,_e=Math.floor(xe),We=k.Utils.Linear;return Q<0?We(D[0],D[1],xe):Q>1?We(D[oe],D[oe-1],oe-xe):We(D[_e],D[_e+1>oe?oe:_e+1],xe-_e)},Bezier:function(D,Q){for(var oe=0,xe=D.length-1,_e=Math.pow,We=k.Utils.Bernstein,ke=0;ke<=xe;ke++)oe+=_e(1-Q,xe-ke)*_e(Q,ke)*D[ke]*We(xe,ke);return oe},CatmullRom:function(D,Q){var oe=D.length-1,xe=oe*Q,_e=Math.floor(xe),We=k.Utils.CatmullRom;return D[0]===D[oe]?(Q<0&&(_e=Math.floor(xe=oe*(1+Q))),We(D[(_e-1+oe)%oe],D[_e],D[(_e+1)%oe],D[(_e+2)%oe],xe-_e)):Q<0?D[0]-(We(D[0],D[0],D[1],D[1],-xe)-D[0]):Q>1?D[oe]-(We(D[oe],D[oe],D[oe-1],D[oe-1],xe-oe)-D[oe]):We(D[_e?_e-1:0],D[_e],D[oe<_e+1?oe:_e+1],D[oe<_e+2?oe:_e+2],xe-_e)},Utils:{Linear:function(D,Q,oe){return(Q-D)*oe+D},Bernstein:function(D,Q){var oe=k.Utils.Factorial;return oe(D)/oe(Q)/oe(D-Q)},Factorial:(_=[1],function(D){var Q=1;if(_[D])return _[D];for(var oe=D;oe>1;oe--)Q*=oe;return _[D]=Q,Q}),CatmullRom:function(D,Q,oe,xe,_e){var We=.5*(oe-D),ke=.5*(xe-Q),at=_e*_e;return(2*Q-2*oe+We+ke)*(_e*at)+(-3*Q+3*oe-2*We-ke)*at+We*_e+Q}}},B=function(){function D(){}return D.nextId=function(){return D._nextId++},D._nextId=0,D}(),K=new A,ge=function(){function D(Q,oe){oe===void 0&&(oe=K),this._object=Q,this._group=oe,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=0,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=m.Linear.None,this._interpolationFunction=k.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=B.nextId(),this._isChainStopped=!1,this._goToEnd=!1,this._headTween=null,this._tailTween=null,this._headStart=!1}return D.prototype.getId=function(){return this._id},D.prototype.isPlaying=function(){return this._isPlaying},D.prototype.isPaused=function(){return this._isPaused},D.prototype.duration=function(Q){return this._duration=Q,this},D.prototype.start=function(Q){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var oe in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(oe),this._valuesStart[oe]=this._valuesStartRepeat[oe];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=Q!==void 0?typeof Q=="string"?x()+parseFloat(Q):Q:x(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},D.prototype._setupProperties=function(Q,oe,xe,_e){for(var We in xe){var ke=Q[We],at=Array.isArray(ke),gn=at?"array":typeof ke,ei=!at&&Array.isArray(xe[We]);if(gn!=="undefined"&&gn!=="function"){if(ei){var er=xe[We];if(er.length===0)continue;er=er.map(this._handleRelativeValue.bind(this,ke)),xe[We]=[ke].concat(er)}if(gn!=="object"&&!at||!ke||ei)oe[We]===void 0&&(oe[We]=ke),at||(oe[We]*=1),_e[We]=ei?xe[We].slice().reverse():oe[We]||0;else{for(var xs in oe[We]=at?[]:{},ke)oe[We][xs]=ke[xs];_e[We]=at?[]:{},this._setupProperties(ke,oe[We],xe[We],_e[We])}}}},D.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},D.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},D.prototype.pause=function(Q){return Q===void 0&&(Q=x()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=Q,this._group&&this._group.remove(this)),this},D.prototype.resume=function(Q){return Q===void 0&&(Q=x()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=Q-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},D.prototype.stopChainedTweens=function(){for(var Q=0,oe=this._chainedTweens.length;Q<oe;Q++)this._chainedTweens[Q].stop();return this._chainedTweens=[],this},D.prototype.group=function(Q){return this._group=Q,this},D.prototype.call=function(Q){return this._onFinishCallback=Q,this},D.prototype.from=function(Q){return this._valuesStart=Object.create(Q),this},D.prototype.to=function(Q,oe){return this._valuesEnd=Object.create(Q),oe!==void 0&&(this._duration=oe),this._chainedTween=this,this},D.prototype.delay=function(Q){return this._delayTime=Q,this},D.prototype.union=function(Q,oe){return this._headTween=Q,this._tailTween=oe.chain(this),this._headStart=!0,this},D.prototype.repeat=function(Q){return this._initialRepeat=Q,this._repeat=Q,this},D.prototype.repeatDelay=function(Q){return this._repeatDelayTime=Q,this},D.prototype.yoyo=function(Q){return this._yoyo=Q,this},D.prototype.easing=function(Q){return this._easingFunction=Q,this},D.prototype.interpolation=function(Q){return this._interpolationFunction=Q,this},D.prototype.chain=function(){for(var Q=[],oe=0;oe<arguments.length;oe++)Q[oe]=arguments[oe];return this._chainedTweens=Q,this},D.prototype.unchain=function(){for(var Q=0;Q<arguments.length;Q++){let oe=this._chainedTweens.findIndex(xe=>xe==arguments[Q]);oe>-1&&this._chainedTweens.splice(oe,1)}return this},D.prototype.onStart=function(Q){return this._onStartCallback=Q,this},D.prototype.onUpdate=function(Q){return this._onUpdateCallback=Q,this},D.prototype.onRepeat=function(Q){return this._onRepeatCallback=Q,this},D.prototype.onComplete=function(Q){return this._onCompleteCallback=Q,this},D.prototype.onStop=function(Q){return this._onStopCallback=Q,this},D.prototype.update=function(Q,oe){if(Q===void 0&&(Q=x()),oe===void 0&&(oe=!0),this._isPaused)return!0;var xe,_e,We=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(Q>We)return!1;oe&&this.start(Q)}if(this._goToEnd=!1,Q<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),_e=(Q-this._startTime)/this._duration,_e=this._duration===0||_e>1?1:_e;var ke=this._easingFunction(_e);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,ke),this._onUpdateCallback&&this._onUpdateCallback(this._object,_e),_e===1){if(this._onFinishCallback&&this._onFinishCallback(this._object),this._headTween&&this._headStart)return this._headTween.start(this._startTime+this._duration),this._headStart=!1,this._isPlaying=!1,!1;if(this._repeat>0){for(xe in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||typeof this._valuesEnd[xe]!="string"||(this._valuesStartRepeat[xe]=this._valuesStartRepeat[xe]+parseFloat(this._valuesEnd[xe])),this._yoyo&&this._swapEndStartRepeatValues(xe),this._valuesStart[xe]=this._valuesStartRepeat[xe];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=Q+this._repeatDelayTime:this._startTime=Q+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._headTween&&(this._headStart=!0,this._initialRepeat=this._repeat),!0}this._tailTween&&this._tailTween.unchain(this),this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var at=0,gn=this._chainedTweens.length;at<gn;at++)this._chainedTweens[at].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},D.prototype._updateProperties=function(Q,oe,xe,_e){for(var We in xe)if(oe[We]!==void 0){var ke=oe[We]||0,at=xe[We],gn=Array.isArray(Q[We]),ei=Array.isArray(at);!gn&&ei?Q[We]=this._interpolationFunction(at,_e):typeof at=="object"&&at?this._updateProperties(Q[We],ke,at,_e):typeof(at=this._handleRelativeValue(ke,at))=="number"&&(Q[We]=ke+(at-ke)*_e)}},D.prototype._handleRelativeValue=function(Q,oe){return typeof oe!="string"?oe:oe.charAt(0)==="+"||oe.charAt(0)==="-"?Q+parseFloat(oe):parseFloat(oe)},D.prototype._swapEndStartRepeatValues=function(Q){var oe=this._valuesStartRepeat[Q],xe=this._valuesEnd[Q];this._valuesStartRepeat[Q]=typeof xe=="string"?this._valuesStartRepeat[Q]+parseFloat(xe):this._valuesEnd[Q],this._valuesEnd[Q]=oe},D}(),ve="18.6.4",fe=B.nextId,Ce=K,Fe=Ce.getAll.bind(Ce),Ue=Ce.removeAll.bind(Ce),vt=Ce.add.bind(Ce),re=Ce.remove.bind(Ce),Z=Ce.update.bind(Ce),se={Easing:m,Group:A,Interpolation:k,now:x,Sequence:B,nextId:fe,Tween:ge,VERSION:ve,getAll:Fe,removeAll:Ue,add:vt,remove:re,update:Z};l.Easing=m,l.Group=A,l.Interpolation=k,l.Sequence=B,l.Tween=ge,l.VERSION=ve,l.add=vt,l.default=se,l.getAll=Fe,l.nextId=fe,l.now=x,l.remove=re,l.removeAll=Ue,l.update=Z}},cM={};function Xt(a){var l=cM[a];if(l!==void 0)return l.exports;var h=cM[a]={exports:{}};return I4[a](h,h.exports,Xt),h.exports}Xt.d=(a,l)=>{for(var h in l)Xt.o(l,h)&&!Xt.o(a,h)&&Object.defineProperty(a,h,{enumerable:!0,get:l[h]})},Xt.o=(a,l)=>Object.prototype.hasOwnProperty.call(a,l),Xt.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var E={};(()=>{Xt.d(E,{J12:()=>v0,$c:()=>mL,I_b:()=>iS,oGK:()=>Ed,$p:()=>_t,$q:()=>yL,$r:()=>nS,i5S:()=>gL,nXV:()=>tS,bd1:()=>vL,LY2:()=>_f,bGH:()=>tr,NDo:()=>Y1,gSk:()=>Yf,WMw:()=>gn,OTo:()=>ry,Se2:()=>bf,cum:()=>xy,Mig:()=>o0,i_9:()=>QA,m7l:()=>Hs,sYA:()=>BA,Xcj:()=>oR,mzJ:()=>rR,ZZA:()=>FA,T__:()=>kx,HkE:()=>fx,tGC:()=>MR,gOo:()=>Ha,meI:()=>Xn,BbS:()=>c0,kqm:()=>$A,Wat:()=>r_,Hmr:()=>l0,SJI:()=>vd,rMl:()=>QC,mTL:()=>vb,y8_:()=>TR,_Li:()=>xe,z81:()=>ar,_MY:()=>Z,dFZ:()=>ng,IIx:()=>n_,N$j:()=>el,XO3:()=>a_,_YM:()=>Fs,TUj:()=>pR,ZzF:()=>Ar,GQ:()=>_R,nvb:()=>RR,DvJ:()=>ea,fQA:()=>SR,TlE:()=>$e,u9r:()=>Ke,s4_:()=>pb,T95:()=>$1,CtF:()=>Ua,V1s:()=>Vo,Rki:()=>bR,ROQ:()=>TA,YN5:()=>LR,BVQ:()=>nl,YT8:()=>Fx,_DE:()=>N_,YGz:()=>K1,WXy:()=>D0,max:()=>x,trn:()=>PR,zf8:()=>il,uWy:()=>vn,SUY:()=>bb,Ilk:()=>Pe,xRS:()=>s_,R2R:()=>n0,epp:()=>En,wA2:()=>wt,Z_g:()=>MA,EB7:()=>Fm,DqL:()=>HA,_3:()=>CR,b_z:()=>rl,Qrh:()=>Pi,unp:()=>t_,_am:()=>zy,fY$:()=>wa,vxC:()=>Ma,BtG:()=>_c,cBK:()=>jA,g8_:()=>Ao,AXT:()=>jm,yj7:()=>zx,dYG:()=>tb,tm_:()=>Ue,S2y:()=>vt,B02:()=>re,PeU:()=>Fe,Hyl:()=>ji,Wqd:()=>Hx,Xaj:()=>xs,dZ3:()=>J1,m_w:()=>DR,fHI:()=>ka,LBq:()=>dR,JUT:()=>am,p3g:()=>gh,IEO:()=>Ia,yxD:()=>sb,A5E:()=>Hc,jfJ:()=>QT,T_J:()=>KT,tEQ:()=>rb,qkB:()=>Xr,HWo:()=>jd,brP:()=>Ea,$YQ:()=>Ec,iRp:()=>Rn,Ox3:()=>dd,cBI:()=>zb,cU9:()=>nb,ntt:()=>Zf,DT1:()=>OR,Kgo:()=>al,ehD:()=>_e,fSK:()=>_s,Vdb:()=>G1,l8J:()=>h3,dj0:()=>by,QM0:()=>l3,TOt:()=>Xm,Qmf:()=>El,JIf:()=>Fr,Ny0:()=>ed,eD:()=>ac,jwo:()=>t3,dSO:()=>Ta,Bf4:()=>oc,USm:()=>jn,pBf:()=>zi,vpe:()=>k,$Vf:()=>IR,O7d:()=>ol,JE9:()=>iu,hH6:()=>ai,e62:()=>N3,a$l:()=>Ge,OM3:()=>k3,VzW:()=>Ti,ybr:()=>jh,yo9:()=>Hh,Wzm:()=>wA,zUS:()=>VS,Wl3:()=>oe,iWj:()=>wc,CoK:()=>kd,ylh:()=>uR,v9Y:()=>p3,LSk:()=>Kf,XSA:()=>Ud,w$m:()=>X1,ksN:()=>Sf,j4z:()=>a3,OAl:()=>i3,VLJ:()=>yR,ZAu:()=>Vn,cLu:()=>di,vmT:()=>ob,Qpg:()=>vR,So8:()=>YA,Wjw:()=>NR,cJO:()=>ll,QRU:()=>gb,uSM:()=>h_,S3k:()=>Uc,fnl:()=>qC,PpQ:()=>im,ZRs:()=>YT,oqc:()=>ZT,UT1:()=>cg,KQe:()=>hg,s28:()=>ug,uEm:()=>og,b08:()=>sg,yPR:()=>so,ph9:()=>Ur,llF:()=>ag,EIF:()=>lg,lb7:()=>Na,L5s:()=>md,$TI:()=>Eb,SPe:()=>Qh,aVm:()=>O3,j87:()=>I3,RNb:()=>P3,Kz5:()=>ty,vpT:()=>Qo,kB5:()=>ri,_C8:()=>ml,Syv:()=>Po,NMF:()=>ws,pIN:()=>hh,eMJ:()=>JT,x5V:()=>fh,tUh:()=>hr,z8B:()=>Sx,GZb:()=>kR,p7y:()=>Os,S9g:()=>_h,Zr5:()=>th,vCF:()=>rc,yt0:()=>n3,uXU:()=>e3,_kC:()=>za,lk7:()=>pd,x12:()=>Lr,Zzh:()=>fR,nls:()=>In,g_z:()=>nd,U7:()=>Bx,FT0:()=>$x,blk:()=>Im,ejS:()=>ur,rnI:()=>rr,wem:()=>rt,lfu:()=>t0,FDw:()=>WT,lRj:()=>VT,D1R:()=>ir,qyh:()=>rh,GUF:()=>Co,EoG:()=>Q1,aNw:()=>Wn,Zp0:()=>js,lLk:()=>i0,jAl:()=>py,uEv:()=>my,YKA:()=>fy,cRx:()=>sy,Y8D:()=>ay,RsA:()=>fe,F5T:()=>on,u7G:()=>fd,M8C:()=>hn,Vkp:()=>dn,yGw:()=>De,Sm8:()=>st,Kj0:()=>Je,vBJ:()=>pi,lRF:()=>zh,Lun:()=>Lm,YBo:()=>Km,kaV:()=>Jx,RSm:()=>Zm,xoR:()=>Fc,EJi:()=>ra,Qme:()=>i_,Wid:()=>zt,IKL:()=>Kx,r_:()=>tt,OoA:()=>Ro,qhX:()=>q1,M5h:()=>er,Ns1:()=>sc,Ue:()=>ao,RR3:()=>O5,TyD:()=>At,vZf:()=>GT,HTd:()=>jT,aH4:()=>Lo,YLQ:()=>lc,BVF:()=>xf,MyG:()=>$T,jFi:()=>ke,aCh:()=>yy,uL9:()=>Er,IFH:()=>qf,bdR:()=>at,M6v:()=>nh,RvT:()=>r3,ymC:()=>o_,dUE:()=>Us,Tme:()=>ot,Gql:()=>XA,PA7:()=>vy,REq:()=>FR,pQR:()=>Ns,ghN:()=>sn,Hy8:()=>j1,Wpd:()=>V1,LgZ:()=>nr,iWC:()=>Tr,lkL:()=>l_,iKG:()=>Oa,_iA:()=>se,ntZ:()=>D,anP:()=>Tm,HRQ:()=>B0,hpZ:()=>_,w2v:()=>Ln,WI2:()=>ro,y$t:()=>Oc,cPb:()=>Qt,JOQ:()=>ta,BKK:()=>UR,_12:()=>na,tJx:()=>wR,OdJ:()=>WC,SyM:()=>qn,cek:()=>Bc,xG9:()=>Ib,woe:()=>km,UY4:()=>Kh,aq0:()=>xR,ujx:()=>zR,Uol:()=>Pr,VYz:()=>Mb,tSf:()=>ZC,M20:()=>io,iUV:()=>dt,tf:()=>Tb,ZQ6:()=>Gm,mXe:()=>id,_fP:()=>Ft,iLg:()=>aa,zbs:()=>ib,ZTh:()=>Wf,HdW:()=>dy,UZH:()=>ve,mSO:()=>ph,wk1:()=>ti,E2K:()=>uy,FUD:()=>Hf,pKu:()=>Uf,GG6:()=>zf,Gih:()=>Bf,iiP:()=>jf,SvJ:()=>Gf,ptH:()=>Pf,jZA:()=>Cf,y2t:()=>Df,gi4:()=>Of,Djp:()=>If,BG$:()=>Nf,NYV:()=>kf,xJs:()=>Ff,bsb:()=>uh,ekQ:()=>Lf,CaW:()=>Af,eaV:()=>Ef,BFQ:()=>oh,v3W:()=>lh,ILR:()=>ch,fto:()=>hy,l0P:()=>Rf,vCx:()=>Tf,_AM:()=>Mf,wuA:()=>sh,av9:()=>ly,CtA:()=>cy,FIo:()=>Zx,zHn:()=>gc,iMs:()=>hR,T_f:()=>hb,hEm:()=>wf,D9w:()=>oy,CdI:()=>Z1,wo6:()=>Rd,TIb:()=>XC,rpg:()=>hi,ce8:()=>qT,rOj:()=>Xe,V4E:()=>BR,o8S:()=>cl,lGU:()=>Xf,vuL:()=>Vf,KI_:()=>Ei,iLN:()=>tg,xsS:()=>Ds,b26:()=>ge,w5d:()=>Gd,WdD:()=>ct,Vj0:()=>cr,jyz:()=>xt,Tn7:()=>Qx,bnF:()=>ia,HW6:()=>HR,oa8:()=>ul,T_1:()=>ER,iDF:()=>Cr,iAb:()=>ey,OdW:()=>tl,_YX:()=>mR,TUv:()=>qh,Hw6:()=>As,aLr:()=>Qr,Aip:()=>jR,xo$:()=>Fa,$V:()=>Rb,lDi:()=>db,gti:()=>Vm,PMe:()=>hd,FvO:()=>Db,jyi:()=>xx,xeV:()=>Cm,k74:()=>Ss,RlZ:()=>W1,KhW:()=>bs,HgB:()=>u3,W2J:()=>uc,JWc:()=>o3,kP0:()=>JC,u37:()=>ZA,Z6B:()=>d3,QZ1:()=>s3,Ir4:()=>c3,nE5:()=>c_,NwF:()=>zs,Wbm:()=>Eo,N4l:()=>ei,QmN:()=>Ce,wes:()=>m,IOt:()=>Aa,L5g:()=>GR,H$k:()=>hl,xEZ:()=>Ut,Yin:()=>aS,dpR:()=>ud,hmx:()=>fr,Lb$:()=>k_,Cne:()=>VR,XvJ:()=>dl,XZw:()=>WR,FE5:()=>pl,CJI:()=>Bi,z$h:()=>dh,UlW:()=>Qf,WwZ:()=>gy,Lcc:()=>XR,WXh:()=>fl,VNk:()=>CS,ub3:()=>We,xfE:()=>ih,qlB:()=>Eh,lCJ:()=>vm,WTc:()=>C3,rAo:()=>D3,xWb:()=>He,gH0:()=>cR,rBU:()=>je,rDY:()=>Sm,ywz:()=>yn,wJv:()=>Wr,JQ4:()=>Vr,k0A:()=>ny,irR:()=>iy,LsT:()=>ah,Oih:()=>US,p9U:()=>FS,MiG:()=>Nr,JSe:()=>zS,dwk:()=>Q,FM8:()=>ce,Pa4:()=>C,Ltg:()=>Qe,yC1:()=>Bs,Lpp:()=>YC,fO1:()=>_A,AEx:()=>jP,_9o:()=>BS,k5T:()=>$C,b5g:()=>mx,Ywn:()=>S3,GVz:()=>b3,oAp:()=>By,kFz:()=>Ey,dd2:()=>Rt,CP7:()=>Bh,fQK:()=>px,Uk6:()=>Qm,_sL:()=>cc,Pnf:()=>Ms,c8b:()=>Yt,_lf:()=>Ts,ad5:()=>XT,L_r:()=>mh,HOT:()=>Ir,$R8:()=>h,lDs:()=>bL,Oe_:()=>xL,S6$:()=>A,CbL:()=>Ot,knz:()=>ht});var a={};Xt.r(a),Xt.d(a,{ArcCurve:()=>kx,CatmullRomCurve3:()=>Fx,CubicBezierCurve:()=>jm,CubicBezierCurve3:()=>zx,EllipseCurve:()=>ed,LineCurve:()=>nd,LineCurve3:()=>Bx,QuadraticBezierCurve:()=>Gm,QuadraticBezierCurve3:()=>id,SplineCurve:()=>Vm});var l={};Xt.r(l),Xt.d(l,{BoxGeometry:()=>ea,CapsuleGeometry:()=>nl,CircleGeometry:()=>il,ConeGeometry:()=>rl,CylinderGeometry:()=>ka,DodecahedronGeometry:()=>al,EdgesGeometry:()=>Xm,ExtrudeGeometry:()=>ol,IcosahedronGeometry:()=>ll,LatheGeometry:()=>Os,OctahedronGeometry:()=>Ns,PlaneGeometry:()=>na,PolyhedronGeometry:()=>Pr,RingGeometry:()=>cl,ShapeGeometry:()=>ul,SphereGeometry:()=>Fa,TetrahedronGeometry:()=>hl,TorusGeometry:()=>dl,TorusKnotGeometry:()=>pl,TubeGeometry:()=>fl,WireframeGeometry:()=>Qm});var h={};Xt.r(h),Xt.d(h,{CSS2DObject:()=>YR,CSS2DRenderer:()=>QR,CSS3DObject:()=>qb,CSS3DRenderer:()=>$R,CSS3DSprite:()=>KR,Projector:()=>eL,RenderableFace:()=>Qb,RenderableLine:()=>Zb,RenderableObject:()=>Yb,RenderableSprite:()=>Kb,RenderableVertex:()=>Ys,SimplexNoise:()=>qR,computeMikkTSpaceTangents:()=>nL,computeMorphedAttributes:()=>lL,computeTangents:()=>tL,createMeshesFromInstancedMesh:()=>uL,createMeshesFromMultiMaterialMesh:()=>hL,createMultiMaterialObject:()=>dL,deepCloneAttribute:()=>Md,deinterleaveAttribute:()=>Td,deinterleaveGeometry:()=>aL,estimateBytesUsed:()=>sL,interleaveAttributes:()=>rL,mergeBufferAttributes:()=>m0,mergeBufferGeometries:()=>iL,mergeGroups:()=>Jb,mergeVertices:()=>oL,reduceVertices:()=>pL,sortInstancedMesh:()=>fL,toCreasedNormals:()=>cL,toTrianglesDrawMode:()=>g0});var m={};Xt.r(m),Xt.d(m,{Easing:()=>mi.Easing,Group:()=>mi.Group,Interpolation:()=>mi.Interpolation,Sequence:()=>mi.Sequence,Tween:()=>mi.Tween,TweenChain:()=>OP.TweenChain,TweenManager:()=>PS,VERSION:()=>mi.VERSION,__esModule:()=>mi.__esModule,add:()=>mi.add,getAll:()=>mi.getAll,nextId:()=>mi.nextId,now:()=>mi.now,remove:()=>mi.remove,removeAll:()=>mi.removeAll,update:()=>mi.update});var x={};Xt.r(x),Xt.d(x,{FInterpConstantTo:()=>rC,FInterpTo:()=>iC,QInterpConstantTo:()=>nC,QInterpTo:()=>tC,Quat_exponentialDamp:()=>QP,Quat_quarticDamp:()=>ZP,Quat_smoothDamp:()=>KP,VInterpConstantTo:()=>eC,VInterpTo:()=>$P,Vec3_smoothDamp:()=>JP,exponentialDamp:()=>IS,quarticDamp:()=>Sl,smoothDamp:()=>O0});var _={};Xt.r(_),Xt.d(_,{Alpha:()=>xC,BaseRenderer:()=>$S,Behaviour:()=>Qc,Color:()=>bC,Controller:()=>QS,Emitter:()=>vC,Force:()=>JS,GPURenderer:()=>wC,Gravity:()=>SC,Particle:()=>k0,Scale:()=>_C,System:()=>F0,copyProperties:()=>pC,ease:()=>_l,setPrototypeByObj:()=>Od});var A={};Xt.r(A),Xt.d(A,{Box:()=>MC,Capsule:()=>TC,Circle:()=>EC,Cone:()=>AC,Cylinder:()=>RC,Dodecahedron:()=>LC,Edges:()=>PC,Extrude:()=>CC,Icosahedron:()=>DC,Lathe:()=>OC,Octahedron:()=>IC,Plane:()=>NC,Polyhedron:()=>kC,Ring:()=>FC,Shape:()=>UC,Sphere:()=>zC,Tetrahedron:()=>BC,Torus:()=>HC,TorusKnot:()=>jC,Tube:()=>GC,Wireframe:()=>VC});for(let o=0;o<256;o++)(o<16?"0":"")+o.toString(16);Array.prototype.remove=function(o){let e=this.indexOf(o);e>-1&&this.splice(e,1)};class k{constructor(){N(this,"_events",{})}clear(){return this._events={},this}on(e,t,n,i=!1){let r=this._events[e];if(r==null&&(r=this._events[e]=[]),!(r.findIndex(c=>c.callback===t&&(!n||c.target===n))>-1))return r.push({name:e,callback:t,target:n,once:i}),this;console.warn(`event: ${e} duplicate registered`)}off(e,t,n){let i=this._events[e];if(i){let r=i.findIndex(s=>s.callback===t&&(!n||s.target===n));this._removeEvent(i,r,e)}return this}onof(e,t,n){return n._listeners===void 0&&(n._listeners=[]),n._listeners.push({name:e,callback:t}),this.on(e,t),this}offof(e){for(let t of e._listeners)this.off(t.name,t.callback);return this}_removeEvent(e,t,n){return t>-1&&(e.splice(t,1),e.length===0&&delete this._events[n]),this}targetOff(e){for(let t in this._events){let n=this._events[t];for(let i=n.length;i--;)n[i].target===e&&this._removeEvent(n,i,t)}}emit(e,...t){let n=this._events[e];if(n)for(let i=n.length;i--;){let r=n[i];r.once&&this._removeEvent(n,i,e),r.target?r.callback.apply(r.target,t):r.callback(...t)}return this}}class B{constructor(e,t,n,i){N(this,"_target",null);N(this,"_callback",null);N(this,"_interval",0);N(this,"_repeat",0);N(this,"_elapsed",0);N(this,"_lastTime",0);N(this,"_repeatForever",!1);N(this,"_pause",!1);this._target=e,this._callback=t,this._interval=n,this._repeat=i,this._repeatForever=i===-1}get pause(){return this._pause}set pause(e){this._pause=e}get target(){return this._target}get callback(){return this._callback}get lived(){return this._repeat>0||this._repeatForever}update(e){this._pause||(this._repeat>0||this._repeatForever)&&(this._elapsed+=e,this._elapsed-this._lastTime>=this._interval&&(this._lastTime+=this._interval,this._repeat--,this.trigger(e)))}trigger(e){this._target&&this._callback&&this._callback.call(this._target,e,this._elapsed)}}class K{constructor(e,t){N(this,"_target");N(this,"_callers");this._target=e,this._callers=t}get target(){return this._target}get callers(){return this._callers}}class ge{constructor(){N(this,"_callers",{});N(this,"_callersArray",[])}pause(e){let t=this._callers[e.uuid];t&&t.forEach(n=>n.pause=!0)}resume(e){let t=this._callers[e.uuid];t&&t.forEach(n=>n.pause=!1)}schedule(e,t,n,i){let r=this._callers[e.uuid];r===void 0&&(r=this._callers[e.uuid]=[],this._callersArray.push(new K(e,r))),r.push(new B(e,t,n,i))}unshedule(e,t){let n=this._callers[e.uuid];if(n){let i=n.findIndex(r=>r.callback===t);i!==-1&&n.splice(i,1)}}unscheduleAll(e){delete this._callers[e.uuid];let t=this._callersArray.findIndex(n=>n.target===e);t!==-1&&this._callersArray.splice(t,1)}update(e){let t,n=this._callersArray;for(let i=n.length;i--;){t=n[i].callers;for(let r=t.length;r--;)t[r].lived?t[r].update(e):t.splice(r,1)}}}const ve="150",fe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ce={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Fe=0,Ue=1,vt=2,re=3,Z=0,se=1,D=2,Q=3,oe=0,xe=1,_e=2,We=2,ke=0,at=1,gn=2,ei=3,er=4,xs=5,tr=100,Eo=101,Xe=102,tt=103,st=104,Yt=200,sn=201,bs=202,Tr=203,Ss=204,nr=205,_s=206,j1=207,G1=208,V1=209,W1=210,xf=0,bf=1,th=2,rc=3,ac=4,Sf=5,X1=6,nh=7,sc=0,q1=1,Y1=2,Er=0,Q1=1,Z1=2,K1=3,_f=4,J1=5,ih=300,wa=301,Ma=302,Ta=303,oc=304,Ao=306,hi=1e3,vn=1001,Ro=1002,At=1003,lc=1004,jT=1004,Lo=1005,GT=1005,rt=1006,rh=1007,VT=1007,ir=1008,WT=1008,yn=1009,$1=1010,ey=1011,ah=1012,ty=1013,Vr=1014,Ti=1015,di=1016,ny=1017,iy=1018,Wr=1020,ry=1021,ti=1023,ay=1024,sy=1025,Xr=1026,Ea=1027,wf=1028,oy=1029,ly=1030,cy=1031,uy=1033,sh=33776,oh=33777,lh=33778,ch=33779,Mf=35840,Tf=35841,Ef=35842,Af=35843,hy=36196,Rf=37492,Lf=37496,Pf=37808,Cf=37809,Df=37810,Of=37811,If=37812,Nf=37813,kf=37814,Ff=37815,Uf=37816,zf=37817,Bf=37818,Hf=37819,jf=37820,Gf=37821,uh=36492,dy=36283,Vf=36284,Wf=36285,Xf=36286,py=2200,fy=2201,my=2202,Po=2300,ws=2301,hh=2302,Ms=2400,Ts=2401,cc=2402,qf=2500,Yf=2501,gy=0,Qf=1,dh=2,rr=3e3,ht=3001,ar=3200,ph=3201,Aa=0,vy=1,yy="",Ei="srgb",Co="srgb-linear",Zf="display-p3",XT=0,fh=7680,qT=7681,YT=7682,QT=7683,ZT=34055,KT=34056,JT=5386,$T=512,e3=513,t3=514,n3=515,i3=516,r3=517,a3=518,xy=519,uc=35044,by=35048,s3=35040,o3=35045,l3=35049,c3=35041,u3=35046,h3=35050,d3=35042,p3="100",Kf="300 es",mh=1035;class zi{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const n=t.slice(0);for(let i=0,r=n.length;i<r;i++)n[i].call(this,e);e.target=null}}}const Hn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Sy=1234567;const Es=Math.PI/180,hc=180/Math.PI;function Ai(){const o=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Hn[255&o]+Hn[o>>8&255]+Hn[o>>16&255]+Hn[o>>24&255]+"-"+Hn[255&e]+Hn[e>>8&255]+"-"+Hn[e>>16&15|64]+Hn[e>>24&255]+"-"+Hn[63&t|128]+Hn[t>>8&255]+"-"+Hn[t>>16&255]+Hn[t>>24&255]+Hn[255&n]+Hn[n>>8&255]+Hn[n>>16&255]+Hn[n>>24&255]).toLowerCase()}function nn(o,e,t){return Math.max(e,Math.min(t,o))}function Jf(o,e){return(o%e+e)%e}function dc(o,e,t){return(1-t)*o+t*e}function $f(o){return(o&o-1)==0&&o!==0}function _y(o){return Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function wy(o){return Math.pow(2,Math.floor(Math.log(o)/Math.LN2))}function qr(o,e){switch(e.constructor){case Float32Array:return o;case Uint16Array:return o/65535;case Uint8Array:return o/255;case Int16Array:return Math.max(o/32767,-1);case Int8Array:return Math.max(o/127,-1);default:throw new Error("Invalid component type.")}}function kt(o,e){switch(e.constructor){case Float32Array:return o;case Uint16Array:return Math.round(65535*o);case Uint8Array:return Math.round(255*o);case Int16Array:return Math.round(32767*o);case Int8Array:return Math.round(127*o);default:throw new Error("Invalid component type.")}}const hn={DEG2RAD:Es,RAD2DEG:hc,generateUUID:Ai,clamp:nn,clamp01:function(o){return nn(o,0,1)},euclideanModulo:Jf,mapLinear:function(o,e,t,n,i){return n+(o-e)*(i-n)/(t-e)},inverseLerp:function(o,e,t){return o!==e?(t-o)/(e-o):0},lerp:dc,damp:function(o,e,t,n){return dc(o,e,1-Math.exp(-t*n))},pingpong:function(o,e=1){return e-Math.abs(Jf(o,2*e)-e)},smoothstep:function(o,e,t){return o<=e?0:o>=t?1:(o=(o-e)/(t-e))*o*(3-2*o)},smootherstep:function(o,e,t){return o<=e?0:o>=t?1:(o=(o-e)/(t-e))*o*o*(o*(6*o-15)+10)},randInt:function(o,e){return o+Math.random()*(e-o+1)>>0},randFloat:function(o,e){return o+Math.random()*(e-o)},randFloatSpread:function(o){return o*(.5-Math.random())},seededRandom:function(o){o!==void 0&&(Sy=o);let e=Sy+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(o){return o*Es},radToDeg:function(o){return o*hc},isPowerOfTwo:$f,ceilPowerOfTwo:_y,floorPowerOfTwo:wy,setQuaternionFromProperEuler:function(o,e,t,n,i){const r=Math.cos,s=Math.sin,c=r(t/2),u=s(t/2),d=r((e+n)/2),p=s((e+n)/2),f=r((e-n)/2),g=s((e-n)/2),v=r((n-e)/2),b=s((n-e)/2);switch(i){case"XYX":o.set(c*p,u*f,u*g,c*d);break;case"YZY":o.set(u*g,c*p,u*f,c*d);break;case"ZXZ":o.set(u*f,u*g,c*p,c*d);break;case"XZX":o.set(c*p,u*b,u*v,c*d);break;case"YXY":o.set(u*v,c*p,u*b,c*d);break;case"ZYZ":o.set(u*b,u*v,c*p,c*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:kt,denormalize:qr};class ce{constructor(e=0,t=0){ce.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class dn{constructor(){dn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,i,r,s,c,u,d){const p=this.elements;return p[0]=e,p[1]=i,p[2]=c,p[3]=t,p[4]=r,p[5]=u,p[6]=n,p[7]=s,p[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],c=n[3],u=n[6],d=n[1],p=n[4],f=n[7],g=n[2],v=n[5],b=n[8],y=i[0],S=i[3],M=i[6],w=i[1],T=i[4],R=i[7],L=i[2],P=i[5],I=i[8];return r[0]=s*y+c*w+u*L,r[3]=s*S+c*T+u*P,r[6]=s*M+c*R+u*I,r[1]=d*y+p*w+f*L,r[4]=d*S+p*T+f*P,r[7]=d*M+p*R+f*I,r[2]=g*y+v*w+b*L,r[5]=g*S+v*T+b*P,r[8]=g*M+v*R+b*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],c=e[5],u=e[6],d=e[7],p=e[8];return t*s*p-t*c*d-n*r*p+n*c*u+i*r*d-i*s*u}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],c=e[5],u=e[6],d=e[7],p=e[8],f=p*s-c*d,g=c*u-p*r,v=d*r-s*u,b=t*f+n*g+i*v;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/b;return e[0]=f*y,e[1]=(i*d-p*n)*y,e[2]=(c*n-i*s)*y,e[3]=g*y,e[4]=(p*t-i*u)*y,e[5]=(i*r-c*t)*y,e[6]=v*y,e[7]=(n*u-d*t)*y,e[8]=(s*t-n*r)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,c){const u=Math.cos(r),d=Math.sin(r);return this.set(n*u,n*d,-n*(u*s+d*c)+s+e,-i*d,i*u,-i*(-d*s+u*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(em.makeScale(e,t)),this}rotate(e){return this.premultiply(em.makeRotation(-e)),this}translate(e,t){return this.premultiply(em.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,1,0,-n,0,t,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const em=new dn;function My(o){for(let e=o.length-1;e>=0;--e)if(o[e]>=65535)return!0;return!1}const f3={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Do(o,e){return new f3[o](e)}function pc(o){return document.createElementNS("http://www.w3.org/1999/xhtml",o)}class Ft{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,c){let u=n[i+0],d=n[i+1],p=n[i+2],f=n[i+3];const g=r[s+0],v=r[s+1],b=r[s+2],y=r[s+3];if(c===0)return e[t+0]=u,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(c===1)return e[t+0]=g,e[t+1]=v,e[t+2]=b,void(e[t+3]=y);if(f!==y||u!==g||d!==v||p!==b){let S=1-c;const M=u*g+d*v+p*b+f*y,w=M>=0?1:-1,T=1-M*M;if(T>Number.EPSILON){const L=Math.sqrt(T),P=Math.atan2(L,M*w);S=Math.sin(S*P)/L,c=Math.sin(c*P)/L}const R=c*w;if(u=u*S+g*R,d=d*S+v*R,p=p*S+b*R,f=f*S+y*R,S===1-c){const L=1/Math.sqrt(u*u+d*d+p*p+f*f);u*=L,d*=L,p*=L,f*=L}}e[t]=u,e[t+1]=d,e[t+2]=p,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,i,r,s){const c=n[i],u=n[i+1],d=n[i+2],p=n[i+3],f=r[s],g=r[s+1],v=r[s+2],b=r[s+3];return e[t]=c*b+p*f+u*v-d*g,e[t+1]=u*b+p*g+d*f-c*v,e[t+2]=d*b+p*v+c*g-u*f,e[t+3]=p*b-c*f-u*g-d*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,i=e._y,r=e._z,s=e._order,c=Math.cos,u=Math.sin,d=c(n/2),p=c(i/2),f=c(r/2),g=u(n/2),v=u(i/2),b=u(r/2);switch(s){case"XYZ":this._x=g*p*f+d*v*b,this._y=d*v*f-g*p*b,this._z=d*p*b+g*v*f,this._w=d*p*f-g*v*b;break;case"YXZ":this._x=g*p*f+d*v*b,this._y=d*v*f-g*p*b,this._z=d*p*b-g*v*f,this._w=d*p*f+g*v*b;break;case"ZXY":this._x=g*p*f-d*v*b,this._y=d*v*f+g*p*b,this._z=d*p*b+g*v*f,this._w=d*p*f-g*v*b;break;case"ZYX":this._x=g*p*f-d*v*b,this._y=d*v*f+g*p*b,this._z=d*p*b-g*v*f,this._w=d*p*f+g*v*b;break;case"YZX":this._x=g*p*f+d*v*b,this._y=d*v*f+g*p*b,this._z=d*p*b-g*v*f,this._w=d*p*f-g*v*b;break;case"XZY":this._x=g*p*f-d*v*b,this._y=d*v*f-g*p*b,this._z=d*p*b+g*v*f,this._w=d*p*f+g*v*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],c=t[5],u=t[9],d=t[2],p=t[6],f=t[10],g=n+c+f;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(p-u)*v,this._y=(r-d)*v,this._z=(s-i)*v}else if(n>c&&n>f){const v=2*Math.sqrt(1+n-c-f);this._w=(p-u)/v,this._x=.25*v,this._y=(i+s)/v,this._z=(r+d)/v}else if(c>f){const v=2*Math.sqrt(1+c-n-f);this._w=(r-d)/v,this._x=(i+s)/v,this._y=.25*v,this._z=(u+p)/v}else{const v=2*Math.sqrt(1+f-n-c);this._w=(s-i)/v,this._x=(r+d)/v,this._y=(u+p)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(nn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,c=t._x,u=t._y,d=t._z,p=t._w;return this._x=n*p+s*c+i*d-r*u,this._y=i*p+s*u+r*c-n*d,this._z=r*p+s*d+n*u-i*c,this._w=s*p-n*c-i*u-r*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let c=s*e._w+n*e._x+i*e._y+r*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const u=1-c*c;if(u<=Number.EPSILON){const v=1-t;return this._w=v*s+t*this._w,this._x=v*n+t*this._x,this._y=v*i+t*this._y,this._z=v*r+t*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(u),p=Math.atan2(d,c),f=Math.sin((1-t)*p)/d,g=Math.sin(t*p)/d;return this._w=s*f+this._w*g,this._x=n*f+this._x*g,this._y=i*f+this._y*g,this._z=r*f+this._z*g,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(r),n*Math.cos(r),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}const Sn=class Sn{constructor(e=0,t=0,n=0){Sn.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Ty.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Ty.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,c=e.z,u=e.w,d=u*t+s*i-c*n,p=u*n+c*t-r*i,f=u*i+r*n-s*t,g=-r*t-s*n-c*i;return this.x=d*u+g*-r+p*-c-f*-s,this.y=p*u+g*-s+f*-r-d*-c,this.z=f*u+g*-c+d*-s-p*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,c=t.y,u=t.z;return this.x=i*u-r*c,this.y=r*s-n*u,this.z=n*c-i*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return tm.copy(this).projectOnVector(e),this.sub(tm)}reflect(e){return this.sub(tm.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};N(Sn,"UNIT_X",Object.freeze(new Sn(1,0,0))),N(Sn,"UNIT_Y",Object.freeze(new Sn(0,1,0))),N(Sn,"UNIT_Z",Object.freeze(new Sn(0,0,1))),N(Sn,"RIGHT",Object.freeze(new Sn(1,0,0))),N(Sn,"UP",Object.freeze(new Sn(0,1,0))),N(Sn,"ZERO",Object.freeze(new Sn(0,0,0))),N(Sn,"ONE",Object.freeze(new Sn(1,1,1))),N(Sn,"NEG_ONE",Object.freeze(new Sn(-1,-1,-1)));let C=Sn;const tm=new C,Ty=new Ft;function Oo(o){return o<.04045?.0773993808*o:Math.pow(.9478672986*o+.0521327014,2.4)}function nm(o){return o<.0031308?12.92*o:1.055*Math.pow(o,.41666)-.055}const m3=new dn().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),g3=new dn().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Ra=new C,v3={[Co]:o=>o,[Ei]:o=>o.convertSRGBToLinear(),[Zf]:function(o){return o.convertSRGBToLinear(),Ra.set(o.r,o.g,o.b).applyMatrix3(g3),o.setRGB(Ra.x,Ra.y,Ra.z)}},y3={[Co]:o=>o,[Ei]:o=>o.convertLinearToSRGB(),[Zf]:function(o){return Ra.set(o.r,o.g,o.b).applyMatrix3(m3),o.setRGB(Ra.x,Ra.y,Ra.z).convertLinearToSRGB()}},En={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(o){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!o},get workingColorSpace(){return Co},set workingColorSpace(o){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(o,e,t){if(this.enabled===!1||e===t||!e||!t)return o;const n=v3[e],i=y3[t];if(n===void 0||i===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return i(n(o))},fromWorkingColorSpace:function(o,e){return this.convert(o,this.workingColorSpace,e)},toWorkingColorSpace:function(o,e){return this.convert(o,e,this.workingColorSpace)}};let Io;class im{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Io===void 0&&(Io=pc("canvas")),Io.width=e.width,Io.height=e.height;const n=Io.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Io}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=pc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let s=0;s<r.length;s++)r[s]=255*Oo(r[s]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(255*Oo(t[n]/255)):t[n]=Oo(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class As{constructor(e=null){this.isSource=!0,this.uuid=Ai(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let r;if(Array.isArray(i)){r=[];for(let s=0,c=i.length;s<c;s++)i[s].isDataTexture?r.push(rm(i[s].image)):r.push(rm(i[s]))}else r=rm(i);n.url=r}return t||(e.images[this.uuid]=n),n}}function rm(o){return typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&o instanceof ImageBitmap?im.getDataURL(o):o.data?{data:Array.from(o.data),width:o.width,height:o.height,type:o.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let x3=0;class Ut extends zi{constructor(e=Ut.DEFAULT_IMAGE,t=Ut.DEFAULT_MAPPING,n=vn,i=vn,r=rt,s=ir,c=ti,u=yn,d=Ut.DEFAULT_ANISOTROPY,p=rr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:x3++}),this.uuid=Ai(),this.name="",this.source=new As(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=d,this.format=c,this.internalFormat=null,this.type=u,this.offset=new ce(0,0),this.repeat=new ce(1,1),this.center=new ce(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=p,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ih)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hi:e.x=e.x-Math.floor(e.x);break;case vn:e.x=e.x<0?0:1;break;case Ro:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case hi:e.y=e.y-Math.floor(e.y);break;case vn:e.y=e.y<0?0:1;break;case Ro:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Ut.DEFAULT_IMAGE=null,Ut.DEFAULT_MAPPING=ih,Ut.DEFAULT_ANISOTROPY=1;class Qe{constructor(e=0,t=0,n=0,i=1){Qe.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const u=e.elements,d=u[0],p=u[4],f=u[8],g=u[1],v=u[5],b=u[9],y=u[2],S=u[6],M=u[10];if(Math.abs(p-g)<.01&&Math.abs(f-y)<.01&&Math.abs(b-S)<.01){if(Math.abs(p+g)<.1&&Math.abs(f+y)<.1&&Math.abs(b+S)<.1&&Math.abs(d+v+M-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(d+1)/2,R=(v+1)/2,L=(M+1)/2,P=(p+g)/4,I=(f+y)/4,V=(b+S)/4;return T>R&&T>L?T<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(T),i=P/n,r=I/n):R>L?R<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(R),n=P/i,r=V/i):L<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(L),n=I/r,i=V/r),this.set(n,i,r,t),this}let w=Math.sqrt((S-b)*(S-b)+(f-y)*(f-y)+(g-p)*(g-p));return Math.abs(w)<.001&&(w=1),this.x=(S-b)/w,this.y=(f-y)/w,this.z=(g-p)/w,this.w=Math.acos((d+v+M-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Rt extends zi{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Qe(0,0,e,t),this.scissorTest=!1,this.viewport=new Qe(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new Ut(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:rt,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new As(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class gh extends Ut{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=At,this.minFilter=At,this.wrapR=vn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class b3 extends Rt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new gh(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class am extends Ut{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=At,this.minFilter=At,this.wrapR=vn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class S3 extends Rt{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new am(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Ey extends Rt{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const r=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=r.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Ar{constructor(e=new C(1/0,1/0,1/0),t=new C(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,c=-1/0;for(let u=0,d=e.length;u<d;u+=3){const p=e[u],f=e[u+1],g=e[u+2];p<t&&(t=p),f<n&&(n=f),g<i&&(i=g),p>r&&(r=p),f>s&&(s=f),g>c&&(c=g)}return this.min.set(t,n,i),this.max.set(r,s,c),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,c=-1/0;for(let u=0,d=e.count;u<d;u++){const p=e.getX(u),f=e.getY(u),g=e.getZ(u);p<t&&(t=p),f<n&&(n=f),g<i&&(i=g),p>r&&(r=p),f>s&&(s=f),g>c&&(c=g)}return this.min.set(t,n,i),this.max.set(r,s,c),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Rs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0)if(t&&n.attributes!=null&&n.attributes.position!==void 0){const r=n.attributes.position;for(let s=0,c=r.count;s<c;s++)Rs.fromBufferAttribute(r,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Rs)}else n.boundingBox===null&&n.computeBoundingBox(),sm.copy(n.boundingBox),sm.applyMatrix4(e.matrixWorld),this.union(sm);const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Rs),Rs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(fc),vh.subVectors(this.max,fc),No.subVectors(e.a,fc),ko.subVectors(e.b,fc),Fo.subVectors(e.c,fc),La.subVectors(ko,No),Pa.subVectors(Fo,ko),Ls.subVectors(No,Fo);let t=[0,-La.z,La.y,0,-Pa.z,Pa.y,0,-Ls.z,Ls.y,La.z,0,-La.x,Pa.z,0,-Pa.x,Ls.z,0,-Ls.x,-La.y,La.x,0,-Pa.y,Pa.x,0,-Ls.y,Ls.x,0];return!!om(t,No,ko,Fo,vh)&&(t=[1,0,0,0,1,0,0,0,1],!!om(t,No,ko,Fo,vh)&&(yh.crossVectors(La,Pa),t=[yh.x,yh.y,yh.z],om(t,No,ko,Fo,vh)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Rs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Rs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Yr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Yr=[new C,new C,new C,new C,new C,new C,new C,new C],Rs=new C,sm=new Ar,No=new C,ko=new C,Fo=new C,La=new C,Pa=new C,Ls=new C,fc=new C,vh=new C,yh=new C,Ps=new C;function om(o,e,t,n,i){for(let r=0,s=o.length-3;r<=s;r+=3){Ps.fromArray(o,r);const c=i.x*Math.abs(Ps.x)+i.y*Math.abs(Ps.y)+i.z*Math.abs(Ps.z),u=e.dot(Ps),d=t.dot(Ps),p=n.dot(Ps);if(Math.max(-Math.max(u,d,p),Math.min(u,d,p))>c)return!1}return!0}const _3=new Ar,mc=new C,lm=new C;class Qr{constructor(e=new C,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):_3.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;mc.subVectors(e,this.center);const t=mc.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=.5*(n-this.radius);this.center.addScaledVector(mc,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(lm.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(mc.copy(e.center).add(lm)),this.expandByPoint(mc.copy(e.center).sub(lm))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Zr=new C,cm=new C,xh=new C,Ca=new C,um=new C,bh=new C,hm=new C;class gc{constructor(e=new C,t=new C(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Zr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zr.copy(this.origin).addScaledVector(this.direction,t),Zr.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){cm.copy(e).add(t).multiplyScalar(.5),xh.copy(t).sub(e).normalize(),Ca.copy(this.origin).sub(cm);const r=.5*e.distanceTo(t),s=-this.direction.dot(xh),c=Ca.dot(this.direction),u=-Ca.dot(xh),d=Ca.lengthSq(),p=Math.abs(1-s*s);let f,g,v,b;if(p>0)if(f=s*u-c,g=s*c-u,b=r*p,f>=0)if(g>=-b)if(g<=b){const y=1/p;f*=y,g*=y,v=f*(f+s*g+2*c)+g*(s*f+g+2*u)+d}else g=r,f=Math.max(0,-(s*g+c)),v=-f*f+g*(g+2*u)+d;else g=-r,f=Math.max(0,-(s*g+c)),v=-f*f+g*(g+2*u)+d;else g<=-b?(f=Math.max(0,-(-s*r+c)),g=f>0?-r:Math.min(Math.max(-r,-u),r),v=-f*f+g*(g+2*u)+d):g<=b?(f=0,g=Math.min(Math.max(-r,-u),r),v=g*(g+2*u)+d):(f=Math.max(0,-(s*r+c)),g=f>0?r:Math.min(Math.max(-r,-u),r),v=-f*f+g*(g+2*u)+d);else g=s>0?-r:r,f=Math.max(0,-(s*g+c)),v=-f*f+g*(g+2*u)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(cm).addScaledVector(xh,g),v}intersectSphere(e,t){Zr.subVectors(e.center,this.origin);const n=Zr.dot(this.direction),i=Zr.dot(Zr)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),c=n-s,u=n+s;return u<0?null:c<0?this.at(u,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0?!0:e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,c,u;const d=1/this.direction.x,p=1/this.direction.y,f=1/this.direction.z,g=this.origin;return d>=0?(n=(e.min.x-g.x)*d,i=(e.max.x-g.x)*d):(n=(e.max.x-g.x)*d,i=(e.min.x-g.x)*d),p>=0?(r=(e.min.y-g.y)*p,s=(e.max.y-g.y)*p):(r=(e.max.y-g.y)*p,s=(e.min.y-g.y)*p),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),f>=0?(c=(e.min.z-g.z)*f,u=(e.max.z-g.z)*f):(c=(e.max.z-g.z)*f,u=(e.min.z-g.z)*f),n>u||c>i?null:((c>n||n!=n)&&(n=c),(u<i||i!=i)&&(i=u),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return this.intersectBox(e,Zr)!==null}intersectTriangle(e,t,n,i,r){um.subVectors(t,e),bh.subVectors(n,e),hm.crossVectors(um,bh);let s,c=this.direction.dot(hm);if(c>0){if(i)return null;s=1}else{if(!(c<0))return null;s=-1,c=-c}Ca.subVectors(this.origin,e);const u=s*this.direction.dot(bh.crossVectors(Ca,bh));if(u<0)return null;const d=s*this.direction.dot(um.cross(Ca));if(d<0||u+d>c)return null;const p=-s*Ca.dot(hm);return p<0?null:this.at(p/c,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class De{constructor(){De.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,i,r,s,c,u,d,p,f,g,v,b,y,S){const M=this.elements;return M[0]=e,M[4]=t,M[8]=n,M[12]=i,M[1]=r,M[5]=s,M[9]=c,M[13]=u,M[2]=d,M[6]=p,M[10]=f,M[14]=g,M[3]=v,M[7]=b,M[11]=y,M[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new De().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/Uo.setFromMatrixColumn(e,0).length(),r=1/Uo.setFromMatrixColumn(e,1).length(),s=1/Uo.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),c=Math.sin(n),u=Math.cos(i),d=Math.sin(i),p=Math.cos(r),f=Math.sin(r);if(e.order==="XYZ"){const g=s*p,v=s*f,b=c*p,y=c*f;t[0]=u*p,t[4]=-u*f,t[8]=d,t[1]=v+b*d,t[5]=g-y*d,t[9]=-c*u,t[2]=y-g*d,t[6]=b+v*d,t[10]=s*u}else if(e.order==="YXZ"){const g=u*p,v=u*f,b=d*p,y=d*f;t[0]=g+y*c,t[4]=b*c-v,t[8]=s*d,t[1]=s*f,t[5]=s*p,t[9]=-c,t[2]=v*c-b,t[6]=y+g*c,t[10]=s*u}else if(e.order==="ZXY"){const g=u*p,v=u*f,b=d*p,y=d*f;t[0]=g-y*c,t[4]=-s*f,t[8]=b+v*c,t[1]=v+b*c,t[5]=s*p,t[9]=y-g*c,t[2]=-s*d,t[6]=c,t[10]=s*u}else if(e.order==="ZYX"){const g=s*p,v=s*f,b=c*p,y=c*f;t[0]=u*p,t[4]=b*d-v,t[8]=g*d+y,t[1]=u*f,t[5]=y*d+g,t[9]=v*d-b,t[2]=-d,t[6]=c*u,t[10]=s*u}else if(e.order==="YZX"){const g=s*u,v=s*d,b=c*u,y=c*d;t[0]=u*p,t[4]=y-g*f,t[8]=b*f+v,t[1]=f,t[5]=s*p,t[9]=-c*p,t[2]=-d*p,t[6]=v*f+b,t[10]=g-y*f}else if(e.order==="XZY"){const g=s*u,v=s*d,b=c*u,y=c*d;t[0]=u*p,t[4]=-f,t[8]=d*p,t[1]=g*f+y,t[5]=s*p,t[9]=v*f-b,t[2]=b*f-v,t[6]=c*p,t[10]=y*f+g}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(w3,e,M3)}lookAt(e,t,n){const i=this.elements;return Ri.subVectors(e,t),Ri.lengthSq()===0&&(Ri.z=1),Ri.normalize(),Da.crossVectors(n,Ri),Da.lengthSq()===0&&(Math.abs(n.z)===1?Ri.x+=1e-4:Ri.z+=1e-4,Ri.normalize(),Da.crossVectors(n,Ri)),Da.normalize(),Sh.crossVectors(Ri,Da),i[0]=Da.x,i[4]=Sh.x,i[8]=Ri.x,i[1]=Da.y,i[5]=Sh.y,i[9]=Ri.y,i[2]=Da.z,i[6]=Sh.z,i[10]=Ri.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],c=n[4],u=n[8],d=n[12],p=n[1],f=n[5],g=n[9],v=n[13],b=n[2],y=n[6],S=n[10],M=n[14],w=n[3],T=n[7],R=n[11],L=n[15],P=i[0],I=i[4],V=i[8],z=i[12],G=i[1],F=i[5],$=i[9],le=i[13],ae=i[2],ye=i[6],pe=i[10],Me=i[14],Ee=i[3],Re=i[7],he=i[11],ne=i[15];return r[0]=s*P+c*G+u*ae+d*Ee,r[4]=s*I+c*F+u*ye+d*Re,r[8]=s*V+c*$+u*pe+d*he,r[12]=s*z+c*le+u*Me+d*ne,r[1]=p*P+f*G+g*ae+v*Ee,r[5]=p*I+f*F+g*ye+v*Re,r[9]=p*V+f*$+g*pe+v*he,r[13]=p*z+f*le+g*Me+v*ne,r[2]=b*P+y*G+S*ae+M*Ee,r[6]=b*I+y*F+S*ye+M*Re,r[10]=b*V+y*$+S*pe+M*he,r[14]=b*z+y*le+S*Me+M*ne,r[3]=w*P+T*G+R*ae+L*Ee,r[7]=w*I+T*F+R*ye+L*Re,r[11]=w*V+T*$+R*pe+L*he,r[15]=w*z+T*le+R*Me+L*ne,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],c=e[5],u=e[9],d=e[13],p=e[2],f=e[6],g=e[10],v=e[14];return e[3]*(+r*u*f-i*d*f-r*c*g+n*d*g+i*c*v-n*u*v)+e[7]*(+t*u*v-t*d*g+r*s*g-i*s*v+i*d*p-r*u*p)+e[11]*(+t*d*f-t*c*v-r*s*f+n*s*v+r*c*p-n*d*p)+e[15]*(-i*c*p-t*u*f+t*c*g+i*s*f-n*s*g+n*u*p)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],c=e[5],u=e[6],d=e[7],p=e[8],f=e[9],g=e[10],v=e[11],b=e[12],y=e[13],S=e[14],M=e[15],w=f*S*d-y*g*d+y*u*v-c*S*v-f*u*M+c*g*M,T=b*g*d-p*S*d-b*u*v+s*S*v+p*u*M-s*g*M,R=p*y*d-b*f*d+b*c*v-s*y*v-p*c*M+s*f*M,L=b*f*u-p*y*u-b*c*g+s*y*g+p*c*S-s*f*S,P=t*w+n*T+i*R+r*L;if(P===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/P;return e[0]=w*I,e[1]=(y*g*r-f*S*r-y*i*v+n*S*v+f*i*M-n*g*M)*I,e[2]=(c*S*r-y*u*r+y*i*d-n*S*d-c*i*M+n*u*M)*I,e[3]=(f*u*r-c*g*r-f*i*d+n*g*d+c*i*v-n*u*v)*I,e[4]=T*I,e[5]=(p*S*r-b*g*r+b*i*v-t*S*v-p*i*M+t*g*M)*I,e[6]=(b*u*r-s*S*r-b*i*d+t*S*d+s*i*M-t*u*M)*I,e[7]=(s*g*r-p*u*r+p*i*d-t*g*d-s*i*v+t*u*v)*I,e[8]=R*I,e[9]=(b*f*r-p*y*r-b*n*v+t*y*v+p*n*M-t*f*M)*I,e[10]=(s*y*r-b*c*r+b*n*d-t*y*d-s*n*M+t*c*M)*I,e[11]=(p*c*r-s*f*r-p*n*d+t*f*d+s*n*v-t*c*v)*I,e[12]=L*I,e[13]=(p*y*i-b*f*i+b*n*g-t*y*g-p*n*S+t*f*S)*I,e[14]=(b*c*i-s*y*i-b*n*u+t*y*u+s*n*S-t*c*S)*I,e[15]=(s*f*i-p*c*i+p*n*u-t*f*u-s*n*g+t*c*g)*I,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,c=e.y,u=e.z,d=r*s,p=r*c;return this.set(d*s+n,d*c-i*u,d*u+i*c,0,d*c+i*u,p*c+n,p*u-i*s,0,d*u-i*c,p*u+i*s,r*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,c=t._z,u=t._w,d=r+r,p=s+s,f=c+c,g=r*d,v=r*p,b=r*f,y=s*p,S=s*f,M=c*f,w=u*d,T=u*p,R=u*f,L=n.x,P=n.y,I=n.z;return i[0]=(1-(y+M))*L,i[1]=(v+R)*L,i[2]=(b-T)*L,i[3]=0,i[4]=(v-R)*P,i[5]=(1-(g+M))*P,i[6]=(S+w)*P,i[7]=0,i[8]=(b+T)*I,i[9]=(S-w)*I,i[10]=(1-(g+y))*I,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=Uo.set(i[0],i[1],i[2]).length();const s=Uo.set(i[4],i[5],i[6]).length(),c=Uo.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],sr.copy(this);const u=1/r,d=1/s,p=1/c;return sr.elements[0]*=u,sr.elements[1]*=u,sr.elements[2]*=u,sr.elements[4]*=d,sr.elements[5]*=d,sr.elements[6]*=d,sr.elements[8]*=p,sr.elements[9]*=p,sr.elements[10]*=p,t.setFromRotationMatrix(sr),n.x=r,n.y=s,n.z=c,this}makePerspective(e,t,n,i,r,s){const c=this.elements,u=2*r/(t-e),d=2*r/(n-i),p=(t+e)/(t-e),f=(n+i)/(n-i),g=-(s+r)/(s-r),v=-2*s*r/(s-r);return c[0]=u,c[4]=0,c[8]=p,c[12]=0,c[1]=0,c[5]=d,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=v,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,i,r,s){const c=this.elements,u=1/(t-e),d=1/(n-i),p=1/(s-r),f=(t+e)*u,g=(n+i)*d,v=(s+r)*p;return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-g,c[2]=0,c[6]=0,c[10]=-2*p,c[14]=-v,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Uo=new C,sr=new De,w3=new C(0,0,0),M3=new C(1,1,1),Da=new C,Sh=new C,Ri=new C,Ay=new De,Ry=new Ft;class jn{constructor(e=0,t=0,n=0,i=jn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,r=i[0],s=i[4],c=i[8],u=i[1],d=i[5],p=i[9],f=i[2],g=i[6],v=i[10];switch(t){case"XYZ":this._y=Math.asin(nn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-p,v),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-nn(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(c,v),this._z=Math.atan2(u,d)):(this._y=Math.atan2(-f,r),this._z=0);break;case"ZXY":this._x=Math.asin(nn(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-f,v),this._z=Math.atan2(-s,d)):(this._y=0,this._z=Math.atan2(u,r));break;case"ZYX":this._y=Math.asin(-nn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(g,v),this._z=Math.atan2(u,r)):(this._x=0,this._z=Math.atan2(-s,d));break;case"YZX":this._z=Math.asin(nn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,d),this._y=Math.atan2(-f,r)):(this._x=0,this._y=Math.atan2(c,v));break;case"XZY":this._z=Math.asin(-nn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(g,d),this._y=Math.atan2(c,r)):(this._x=Math.atan2(-p,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Ay.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ay,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ry.setFromEuler(this),this.setFromQuaternion(Ry,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}jn.DEFAULT_ORDER="XYZ";class _h{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let T3=0;const Ly=new C,zo=new Ft,Kr=new De,wh=new C,vc=new C,E3=new C,A3=new Ft,Py=new C(1,0,0),Cy=new C(0,1,0),Dy=new C(0,0,1),R3={type:"added"},Oy={type:"removed"};class ot extends zi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:T3++}),this.uuid=Ai(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ot.DEFAULT_UP.clone();const e=new C,t=new jn,n=new Ft,i=new C(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new De},normalMatrix:{value:new dn}}),this.matrix=new De,this.matrixWorld=new De,this.matrixAutoUpdate=ot.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ot.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new _h,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={},this.uniforms={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return zo.setFromAxisAngle(e,t),this.quaternion.multiply(zo),this}rotateOnWorldAxis(e,t){return zo.setFromAxisAngle(e,t),this.quaternion.premultiply(zo),this}rotateX(e){return this.rotateOnAxis(Py,e)}rotateY(e){return this.rotateOnAxis(Cy,e)}rotateZ(e){return this.rotateOnAxis(Dy,e)}translateOnAxis(e,t){return Ly.copy(e).applyQuaternion(this.quaternion),this.position.add(Ly.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Py,e)}translateY(e){return this.translateOnAxis(Cy,e)}translateZ(e){return this.translateOnAxis(Dy,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Kr.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?wh.copy(e):wh.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),vc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Kr.lookAt(vc,wh,this.up):Kr.lookAt(wh,vc,this.up),this.quaternion.setFromRotationMatrix(Kr),i&&(Kr.extractRotation(i.matrixWorld),zo.setFromRotationMatrix(Kr),this.quaternion.premultiply(zo.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(R3)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}addObject(e){return this.add(e),e}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Oy)),this}removeObject(e){return this.remove(e),e}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Oy)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Kr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Kr.multiply(e.parent.matrixWorld)),e.applyMatrix4(Kr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const r=this.children[n].getObjectByProperty(e,t);if(r!==void 0)return r}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let i=0,r=this.children.length;i<r;i++){const s=this.children[i].getObjectsByProperty(e,t);s.length>0&&(n=n.concat(s))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vc,e,E3),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vc,A3,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const r=t[n];r.matrixWorldAutoUpdate!==!0&&e!==!0||r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let r=0,s=i.length;r<s;r++){const c=i[r];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(e)),u.uuid}if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let d=0,p=u.length;d<p;d++){const f=u[d];r(e.shapes,f)}else r(e.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,d=this.material.length;u<d;u++)c.push(r(e.materials,this.material[u]));i.material=c}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];i.animations.push(r(e.animations,u))}}if(t){const c=s(e.geometries),u=s(e.materials),d=s(e.textures),p=s(e.images),f=s(e.shapes),g=s(e.skeletons),v=s(e.animations),b=s(e.nodes);c.length>0&&(n.geometries=c),u.length>0&&(n.materials=u),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),f.length>0&&(n.shapes=f),g.length>0&&(n.skeletons=g),v.length>0&&(n.animations=v),b.length>0&&(n.nodes=b)}return n.object=i,n;function s(c){const u=[];for(const d in c){const p=c[d];delete p.metadata,u.push(p)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}ot.DEFAULT_UP=new C(0,1,0),ot.DEFAULT_MATRIX_AUTO_UPDATE=!0,ot.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const or=new C,Jr=new C,dm=new C,$r=new C,Bo=new C,Ho=new C,Iy=new C,pm=new C,fm=new C,mm=new C;class Bi{constructor(e=new C,t=new C,n=new C){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),or.subVectors(e,t),i.cross(or);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){or.subVectors(i,t),Jr.subVectors(n,t),dm.subVectors(e,t);const s=or.dot(or),c=or.dot(Jr),u=or.dot(dm),d=Jr.dot(Jr),p=Jr.dot(dm),f=s*d-c*c;if(f===0)return r.set(-2,-1,-1);const g=1/f,v=(d*u-c*p)*g,b=(s*p-c*u)*g;return r.set(1-v-b,b,v)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,$r),$r.x>=0&&$r.y>=0&&$r.x+$r.y<=1}static getUV(e,t,n,i,r,s,c,u){return this.getBarycoord(e,t,n,i,$r),u.set(0,0),u.addScaledVector(r,$r.x),u.addScaledVector(s,$r.y),u.addScaledVector(c,$r.z),u}static isFrontFacing(e,t,n,i){return or.subVectors(n,t),Jr.subVectors(e,t),or.cross(Jr).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return or.subVectors(this.c,this.b),Jr.subVectors(this.a,this.b),.5*or.cross(Jr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Bi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Bi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,r){return Bi.getUV(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Bi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Bi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,c;Bo.subVectors(i,n),Ho.subVectors(r,n),pm.subVectors(e,n);const u=Bo.dot(pm),d=Ho.dot(pm);if(u<=0&&d<=0)return t.copy(n);fm.subVectors(e,i);const p=Bo.dot(fm),f=Ho.dot(fm);if(p>=0&&f<=p)return t.copy(i);const g=u*f-p*d;if(g<=0&&u>=0&&p<=0)return s=u/(u-p),t.copy(n).addScaledVector(Bo,s);mm.subVectors(e,r);const v=Bo.dot(mm),b=Ho.dot(mm);if(b>=0&&v<=b)return t.copy(r);const y=v*d-u*b;if(y<=0&&d>=0&&b<=0)return c=d/(d-b),t.copy(n).addScaledVector(Ho,c);const S=p*b-v*f;if(S<=0&&f-p>=0&&v-b>=0)return Iy.subVectors(r,i),c=(f-p)/(f-p+(v-b)),t.copy(i).addScaledVector(Iy,c);const M=1/(S+y+g);return s=y*M,c=g*M,t.copy(n).addScaledVector(Bo,s).addScaledVector(Ho,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let L3=0;class on extends zi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:L3++}),this.uuid=Ai(),this.name="",this.type="Material",this.blending=at,this.side=oe,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ss,this.blendDst=nr,this.blendEquation=tr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=rc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=xy,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=fh,this.stencilZFail=fh,this.stencilZPass=fh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const i=this[t];i!==void 0?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(r){const s=[];for(const c in r){const u=r[c];delete u.metadata,s.push(u)}return s}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==at&&(n.blending=this.blending),this.side!==oe&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const r=i(e.textures),s=i(e.images);r.length>0&&(n.textures=r),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const Ny={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},lr={h:0,s:0,l:0},Mh={h:0,s:0,l:0};function gm(o,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+6*(e-o)*t:t<.5?e:t<2/3?o+6*(e-o)*(2/3-t):o}class Pe{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ei){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,En.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=En.workingColorSpace){return this.r=e,this.g=t,this.b=n,En.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=En.workingColorSpace){if(e=Jf(e,1),t=nn(t,0,1),n=nn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,s=2*n-r;this.r=gm(s,r,e+1/3),this.g=gm(s,r,e),this.b=gm(s,r,e-1/3)}return En.toWorkingColorSpace(this,i),this}setStyle(e,t=Ei){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=i[1],c=i[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,En.toWorkingColorSpace(this,t),n(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,En.toWorkingColorSpace(this,t),n(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){const u=parseFloat(r[1])/360,d=parseFloat(r[2])/100,p=parseFloat(r[3])/100;return n(r[4]),this.setHSL(u,d,p,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=i[1],s=r.length;if(s===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,En.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,En.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ei){const n=Ny[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Oo(e.r),this.g=Oo(e.g),this.b=Oo(e.b),this}copyLinearToSRGB(e){return this.r=nm(e.r),this.g=nm(e.g),this.b=nm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ei){return En.fromWorkingColorSpace(Gn.copy(this),e),nn(255*Gn.r,0,255)<<16^nn(255*Gn.g,0,255)<<8^nn(255*Gn.b,0,255)<<0}getHexString(e=Ei){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=En.workingColorSpace){En.fromWorkingColorSpace(Gn.copy(this),t);const n=Gn.r,i=Gn.g,r=Gn.b,s=Math.max(n,i,r),c=Math.min(n,i,r);let u,d;const p=(c+s)/2;if(c===s)u=0,d=0;else{const f=s-c;switch(d=p<=.5?f/(s+c):f/(2-s-c),s){case n:u=(i-r)/f+(i<r?6:0);break;case i:u=(r-n)/f+2;break;case r:u=(n-i)/f+4}u/=6}return e.h=u,e.s=d,e.l=p,e}getRGB(e,t=En.workingColorSpace){return En.fromWorkingColorSpace(Gn.copy(this),t),e.r=Gn.r,e.g=Gn.g,e.b=Gn.b,e}getStyle(e=Ei){En.fromWorkingColorSpace(Gn.copy(this),e);const t=Gn.r,n=Gn.g,i=Gn.b;return e!==Ei?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${255*t|0},${255*n|0},${255*i|0})`}offsetHSL(e,t,n){return this.getHSL(lr),lr.h+=e,lr.s+=t,lr.l+=n,this.setHSL(lr.h,lr.s,lr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(lr),e.getHSL(Mh);const n=dc(lr.h,Mh.h,t),i=dc(lr.s,Mh.s,t),r=dc(lr.l,Mh.l,t);return this.setHSL(n,i,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Gn=new Pe;Pe.NAMES=Ny;class pi extends on{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=sc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const pn=new C,Th=new ce;class $e{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=uc,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Th.fromBufferAttribute(this,t),Th.applyMatrix3(e),this.setXY(t,Th.x,Th.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.applyMatrix3(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.applyMatrix4(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.applyNormalMatrix(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.transformDirection(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=qr(t,this.array)),t}setX(e,t){return this.normalized&&(t=kt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=qr(t,this.array)),t}setY(e,t){return this.normalized&&(t=kt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=qr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=kt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=qr(t,this.array)),t}setW(e,t){return this.normalized&&(t=kt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=kt(t,this.array),n=kt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=kt(t,this.array),n=kt(n,this.array),i=kt(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=kt(t,this.array),n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==uc&&(e.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class P3 extends $e{constructor(e,t,n){super(new Int8Array(e),t,n)}}class C3 extends $e{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class D3 extends $e{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class O3 extends $e{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Eh extends $e{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class I3 extends $e{constructor(e,t,n){super(new Int32Array(e),t,n)}}class vm extends $e{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class N3 extends $e{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class Ge extends $e{constructor(e,t,n){super(new Float32Array(e),t,n)}}class k3 extends $e{constructor(e,t,n){super(new Float64Array(e),t,n)}}let F3=0;const Hi=new De,ym=new ot,jo=new C,Li=new Ar,yc=new Ar,An=new C;class Ke extends zi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:F3++}),this.uuid=Ai(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(My(e)?vm:Eh)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new dn().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Hi.makeRotationFromQuaternion(e),this.applyMatrix4(Hi),this}rotateX(e){return Hi.makeRotationX(e),this.applyMatrix4(Hi),this}rotateY(e){return Hi.makeRotationY(e),this.applyMatrix4(Hi),this}rotateZ(e){return Hi.makeRotationZ(e),this.applyMatrix4(Hi),this}translate(e,t,n){return Hi.makeTranslation(e,t,n),this.applyMatrix4(Hi),this}scale(e,t,n){return Hi.makeScale(e,t,n),this.applyMatrix4(Hi),this}lookAt(e){return ym.lookAt(e),ym.updateMatrix(),this.applyMatrix4(ym.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jo).negate(),this.translate(jo.x,jo.y,jo.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Ge(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ar);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new C(-1/0,-1/0,-1/0),new C(1/0,1/0,1/0));if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const r=t[n];Li.setFromBufferAttribute(r),this.morphTargetsRelative?(An.addVectors(this.boundingBox.min,Li.min),this.boundingBox.expandByPoint(An),An.addVectors(this.boundingBox.max,Li.max),this.boundingBox.expandByPoint(An)):(this.boundingBox.expandByPoint(Li.min),this.boundingBox.expandByPoint(Li.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new C,1/0);if(e){const n=this.boundingSphere.center;if(Li.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++){const c=t[r];yc.setFromBufferAttribute(c),this.morphTargetsRelative?(An.addVectors(Li.min,yc.min),Li.expandByPoint(An),An.addVectors(Li.max,yc.max),Li.expandByPoint(An)):(Li.expandByPoint(yc.min),Li.expandByPoint(yc.max))}Li.getCenter(n);let i=0;for(let r=0,s=e.count;r<s;r++)An.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(An));if(t)for(let r=0,s=t.length;r<s;r++){const c=t[r],u=this.morphTargetsRelative;for(let d=0,p=c.count;d<p;d++)An.fromBufferAttribute(c,d),u&&(jo.fromBufferAttribute(e,d),An.add(jo)),i=Math.max(i,n.distanceToSquared(An))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,r=t.normal.array,s=t.uv.array,c=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new $e(new Float32Array(4*c),4));const u=this.getAttribute("tangent").array,d=[],p=[];for(let G=0;G<c;G++)d[G]=new C,p[G]=new C;const f=new C,g=new C,v=new C,b=new ce,y=new ce,S=new ce,M=new C,w=new C;function T(G,F,$){f.fromArray(i,3*G),g.fromArray(i,3*F),v.fromArray(i,3*$),b.fromArray(s,2*G),y.fromArray(s,2*F),S.fromArray(s,2*$),g.sub(f),v.sub(f),y.sub(b),S.sub(b);const le=1/(y.x*S.y-S.x*y.y);isFinite(le)&&(M.copy(g).multiplyScalar(S.y).addScaledVector(v,-y.y).multiplyScalar(le),w.copy(v).multiplyScalar(y.x).addScaledVector(g,-S.x).multiplyScalar(le),d[G].add(M),d[F].add(M),d[$].add(M),p[G].add(w),p[F].add(w),p[$].add(w))}let R=this.groups;R.length===0&&(R=[{start:0,count:n.length}]);for(let G=0,F=R.length;G<F;++G){const $=R[G],le=$.start;for(let ae=le,ye=le+$.count;ae<ye;ae+=3)T(n[ae+0],n[ae+1],n[ae+2])}const L=new C,P=new C,I=new C,V=new C;function z(G){I.fromArray(r,3*G),V.copy(I);const F=d[G];L.copy(F),L.sub(I.multiplyScalar(I.dot(F))).normalize(),P.crossVectors(V,F);const $=P.dot(p[G])<0?-1:1;u[4*G]=L.x,u[4*G+1]=L.y,u[4*G+2]=L.z,u[4*G+3]=$}for(let G=0,F=R.length;G<F;++G){const $=R[G],le=$.start;for(let ae=le,ye=le+$.count;ae<ye;ae+=3)z(n[ae+0]),z(n[ae+1]),z(n[ae+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new $e(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let g=0,v=n.count;g<v;g++)n.setXYZ(g,0,0,0);const i=new C,r=new C,s=new C,c=new C,u=new C,d=new C,p=new C,f=new C;if(e)for(let g=0,v=e.count;g<v;g+=3){const b=e.getX(g+0),y=e.getX(g+1),S=e.getX(g+2);i.fromBufferAttribute(t,b),r.fromBufferAttribute(t,y),s.fromBufferAttribute(t,S),p.subVectors(s,r),f.subVectors(i,r),p.cross(f),c.fromBufferAttribute(n,b),u.fromBufferAttribute(n,y),d.fromBufferAttribute(n,S),c.add(p),u.add(p),d.add(p),n.setXYZ(b,c.x,c.y,c.z),n.setXYZ(y,u.x,u.y,u.z),n.setXYZ(S,d.x,d.y,d.z)}else for(let g=0,v=t.count;g<v;g+=3)i.fromBufferAttribute(t,g+0),r.fromBufferAttribute(t,g+1),s.fromBufferAttribute(t,g+2),p.subVectors(s,r),f.subVectors(i,r),p.cross(f),n.setXYZ(g+0,p.x,p.y,p.z),n.setXYZ(g+1,p.x,p.y,p.z),n.setXYZ(g+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)An.fromBufferAttribute(e,t),An.normalize(),e.setXYZ(t,An.x,An.y,An.z)}toNonIndexed(){function e(c,u){const d=c.array,p=c.itemSize,f=c.normalized,g=new d.constructor(u.length*p);let v=0,b=0;for(let y=0,S=u.length;y<S;y++){v=c.isInterleavedBufferAttribute?u[y]*c.data.stride+c.offset:u[y]*p;for(let M=0;M<p;M++)g[b++]=d[v++]}return new $e(g,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ke,n=this.index.array,i=this.attributes;for(const c in i){const u=e(i[c],n);t.setAttribute(c,u)}const r=this.morphAttributes;for(const c in r){const u=[],d=r[c];for(let p=0,f=d.length;p<f;p++){const g=e(d[p],n);u.push(g)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let c=0,u=s.length;c<u;c++){const d=s[c];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const d in u)u[d]!==void 0&&(e[d]=u[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const d=n[u];e.data.attributes[u]=d.toJSON(e.data)}const i={};let r=!1;for(const u in this.morphAttributes){const d=this.morphAttributes[u],p=[];for(let f=0,g=d.length;f<g;f++){const v=d[f];p.push(v.toJSON(e.data))}p.length>0&&(i[u]=p,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const d in i){const p=i[d];this.setAttribute(d,p.clone(t))}const r=e.morphAttributes;for(const d in r){const p=[],f=r[d];for(let g=0,v=f.length;g<v;g++)p.push(f[g].clone(t));this.morphAttributes[d]=p}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let d=0,p=s.length;d<p;d++){const f=s[d];this.addGroup(f.start,f.count,f.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ky=new De,Rr=new gc,Ah=new Qr,Fy=new C,xc=new C,bc=new C,Sc=new C,xm=new C,Rh=new C,Lh=new ce,Ph=new ce,Ch=new ce,bm=new C,Dh=new C;class Je extends ot{constructor(e=new Ke,t=new pi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){const s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const c=this.morphTargetInfluences;if(r&&c){Rh.set(0,0,0);for(let u=0,d=r.length;u<d;u++){const p=c[u],f=r[u];p!==0&&(xm.fromBufferAttribute(f,e),s?Rh.addScaledVector(xm,p):Rh.addScaledVector(xm.sub(t),p))}t.add(Rh)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Ah.copy(n.boundingSphere),Ah.applyMatrix4(r),Rr.copy(e.ray).recast(e.near),Ah.containsPoint(Rr.origin)===!1&&(Rr.intersectSphere(Ah,Fy)===null||Rr.origin.distanceToSquared(Fy)>(e.far-e.near)**2))||(ky.copy(r).invert(),Rr.copy(e.ray).applyMatrix4(ky),n.boundingBox!==null&&Rr.intersectsBox(n.boundingBox)===!1))return;let s;const c=n.index,u=n.attributes.position,d=n.attributes.uv,p=n.attributes.uv2,f=n.groups,g=n.drawRange;if(c!==null)if(Array.isArray(i))for(let v=0,b=f.length;v<b;v++){const y=f[v],S=i[y.materialIndex];for(let M=Math.max(y.start,g.start),w=Math.min(c.count,Math.min(y.start+y.count,g.start+g.count));M<w;M+=3){const T=c.getX(M),R=c.getX(M+1),L=c.getX(M+2);s=Oh(this,S,e,Rr,d,p,T,R,L),s&&(s.faceIndex=Math.floor(M/3),s.face.materialIndex=y.materialIndex,t.push(s))}}else for(let v=Math.max(0,g.start),b=Math.min(c.count,g.start+g.count);v<b;v+=3){const y=c.getX(v),S=c.getX(v+1),M=c.getX(v+2);s=Oh(this,i,e,Rr,d,p,y,S,M),s&&(s.faceIndex=Math.floor(v/3),t.push(s))}else if(u!==void 0)if(Array.isArray(i))for(let v=0,b=f.length;v<b;v++){const y=f[v],S=i[y.materialIndex];for(let M=Math.max(y.start,g.start),w=Math.min(u.count,Math.min(y.start+y.count,g.start+g.count));M<w;M+=3)s=Oh(this,S,e,Rr,d,p,M,M+1,M+2),s&&(s.faceIndex=Math.floor(M/3),s.face.materialIndex=y.materialIndex,t.push(s))}else for(let v=Math.max(0,g.start),b=Math.min(u.count,g.start+g.count);v<b;v+=3)s=Oh(this,i,e,Rr,d,p,v,v+1,v+2),s&&(s.faceIndex=Math.floor(v/3),t.push(s))}}function Oh(o,e,t,n,i,r,s,c,u){o.getVertexPosition(s,xc),o.getVertexPosition(c,bc),o.getVertexPosition(u,Sc);const d=function(p,f,g,v,b,y,S,M){let w;if(w=f.side===xe?v.intersectTriangle(S,y,b,!0,M):v.intersectTriangle(b,y,S,f.side===oe,M),w===null)return null;Dh.copy(M),Dh.applyMatrix4(p.matrixWorld);const T=g.ray.origin.distanceTo(Dh);return T<g.near||T>g.far?null:{distance:T,point:Dh.clone(),object:p}}(o,e,t,n,xc,bc,Sc,bm);if(d){i&&(Lh.fromBufferAttribute(i,s),Ph.fromBufferAttribute(i,c),Ch.fromBufferAttribute(i,u),d.uv=Bi.getUV(bm,xc,bc,Sc,Lh,Ph,Ch,new ce)),r&&(Lh.fromBufferAttribute(r,s),Ph.fromBufferAttribute(r,c),Ch.fromBufferAttribute(r,u),d.uv2=Bi.getUV(bm,xc,bc,Sc,Lh,Ph,Ch,new ce));const p={a:s,b:c,c:u,normal:new C,materialIndex:0};Bi.getNormal(xc,bc,Sc,p.normal),d.face=p}return d}class ea extends Ke{constructor(e=1,t=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const c=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const u=[],d=[],p=[],f=[];let g=0,v=0;function b(y,S,M,w,T,R,L,P,I,V,z){const G=R/I,F=L/V,$=R/2,le=L/2,ae=P/2,ye=I+1,pe=V+1;let Me=0,Ee=0;const Re=new C;for(let he=0;he<pe;he++){const ne=he*F-le;for(let me=0;me<ye;me++){const Ae=me*G-$;Re[y]=Ae*w,Re[S]=ne*T,Re[M]=ae,d.push(Re.x,Re.y,Re.z),Re[y]=0,Re[S]=0,Re[M]=P>0?1:-1,p.push(Re.x,Re.y,Re.z),f.push(me/I),f.push(1-he/V),Me+=1}}for(let he=0;he<V;he++)for(let ne=0;ne<I;ne++){const me=g+ne+ye*he,Ae=g+ne+ye*(he+1),Se=g+(ne+1)+ye*(he+1),Ne=g+(ne+1)+ye*he;u.push(me,Ae,Ne),u.push(Ae,Se,Ne),Ee+=6}c.addGroup(v,Ee,z),v+=Ee,g+=Me}b("z","y","x",-1,-1,n,t,e,s,r,0),b("z","y","x",1,-1,n,t,-e,s,r,1),b("x","z","y",1,1,e,n,t,i,s,2),b("x","z","y",1,-1,e,n,-t,i,s,3),b("x","y","z",1,-1,e,t,n,i,r,4),b("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(u),this.setAttribute("position",new Ge(d,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ea(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Go(o){const e={};for(const t in o){e[t]={};for(const n in o[t]){const i=o[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function ni(o){const e={};for(let t=0;t<o.length;t++){const n=Go(o[t]);for(const i in n)e[i]=n[i]}return e}function Uy(o){return o.getRenderTarget()===null&&o.outputEncoding===ht?Ei:Co}const Sm={clone:Go,merge:ni};class xt extends on{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,this.fragmentShader=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Go(e.uniforms),this.uniformsGroups=function(t){const n=[];for(let i=0;i<t.length;i++)n.push(t[i].clone());return n}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const r=this.uniforms[i].value;r&&r.isTexture?t.uniforms[i]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[i]={type:"m4",value:r.toArray()}:t.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Vo extends ot{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new De,this.projectionMatrix=new De,this.projectionMatrixInverse=new De}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Qt extends Vo{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*hc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Es*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*hc*Math.atan(Math.tan(.5*Es*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Es*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(this.view!==null&&this.view.enabled){const u=s.fullWidth,d=s.fullHeight;r+=s.offsetX*i/u,t-=s.offsetY*n/d,i*=s.width/u,n*=s.height/d}const c=this.filmOffset;c!==0&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Wo=-90;class zy extends ot{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const i=new Qt(Wo,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);const r=new Qt(Wo,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);const s=new Qt(Wo,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);const c=new Qt(Wo,1,e,t);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(0,-1,0),this.add(c);const u=new Qt(Wo,1,e,t);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,1),this.add(u);const d=new Qt(Wo,1,e,t);d.layers=this.layers,d.up.set(0,1,0),d.lookAt(0,0,-1),this.add(d)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,s,c,u,d]=this.children,p=e.getRenderTarget(),f=e.toneMapping,g=e.xr.enabled;e.toneMapping=Er,e.xr.enabled=!1;const v=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,r),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,c),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=v,e.setRenderTarget(n,5),e.render(t,d),e.setRenderTarget(p),e.toneMapping=f,e.xr.enabled=g,n.texture.needsPMREMUpdate=!0}}class _c extends Ut{constructor(e,t,n,i,r,s,c,u,d,p){super(e=e!==void 0?e:[],t=t!==void 0?t:wa,n,i,r,s,c,u,d,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class By extends Rt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new _c(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0&&t.generateMipmaps,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:rt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ea(5,5,5),r=new xt({name:"CubemapFromEquirect",uniforms:Go(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:xe,blending:ke});r.uniforms.tEquirect.value=t;const s=new Je(i,r),c=t.minFilter;return t.minFilter===ir&&(t.minFilter=rt),new zy(1,10,this).update(e,s),t.minFilter=c,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}const _m=new C,U3=new C,z3=new dn;class ta{constructor(e=new C(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=_m.subVectors(n,t).cross(U3.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(_m),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||z3.getNormalMatrix(e),i=this.coplanarPoint(_m).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Xo=new Qr,Ih=new C;class wc{constructor(e=new ta,t=new ta,n=new ta,i=new ta,r=new ta,s=new ta){this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(i),c[4].copy(r),c[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],r=n[1],s=n[2],c=n[3],u=n[4],d=n[5],p=n[6],f=n[7],g=n[8],v=n[9],b=n[10],y=n[11],S=n[12],M=n[13],w=n[14],T=n[15];return t[0].setComponents(c-i,f-u,y-g,T-S).normalize(),t[1].setComponents(c+i,f+u,y+g,T+S).normalize(),t[2].setComponents(c+r,f+d,y+v,T+M).normalize(),t[3].setComponents(c-r,f-d,y-v,T-M).normalize(),t[4].setComponents(c-s,f-p,y-b,T-w).normalize(),t[5].setComponents(c+s,f+p,y+b,T+w).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Xo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Xo)}intersectsSprite(e){return Xo.center.set(0,0,0),Xo.radius=.7071067811865476,Xo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Xo)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Ih.x=i.normal.x>0?e.max.x:e.min.x,Ih.y=i.normal.y>0?e.max.y:e.min.y,Ih.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Ih)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Hy(){let o=null,e=!1,t=null,n=null;function i(r,s){t(r,s),n=o.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=o.requestAnimationFrame(i),e=!0)},stop:function(){o.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){o=r}}}function B3(o,e){const t=e.isWebGL2,n=new WeakMap;return{get:function(i){return i.isInterleavedBufferAttribute&&(i=i.data),n.get(i)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);const r=n.get(i);r&&(o.deleteBuffer(r.buffer),n.delete(i))},update:function(i,r){if(i.isGLBufferAttribute){const c=n.get(i);return void((!c||c.version<i.version)&&n.set(i,{buffer:i.buffer,type:i.type,bytesPerElement:i.elementSize,version:i.version}))}i.isInterleavedBufferAttribute&&(i=i.data);const s=n.get(i);s===void 0?n.set(i,function(c,u){const d=c.array,p=c.usage,f=o.createBuffer();let g;if(o.bindBuffer(u,f),o.bufferData(u,d,p),c.onUploadCallback(),d instanceof Float32Array)g=o.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=o.HALF_FLOAT}else g=o.UNSIGNED_SHORT;else if(d instanceof Int16Array)g=o.SHORT;else if(d instanceof Uint32Array)g=o.UNSIGNED_INT;else if(d instanceof Int32Array)g=o.INT;else if(d instanceof Int8Array)g=o.BYTE;else if(d instanceof Uint8Array)g=o.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);g=o.UNSIGNED_BYTE}return{buffer:f,type:g,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(i,r)):s.version<i.version&&(function(c,u,d){const p=u.array,f=u.updateRange;o.bindBuffer(d,c),f.count===-1?o.bufferSubData(d,0,p):(t?o.bufferSubData(d,f.offset*p.BYTES_PER_ELEMENT,p,f.offset,f.count):o.bufferSubData(d,f.offset*p.BYTES_PER_ELEMENT,p.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(s.buffer,i,r),s.version=i.version)}}}class na extends Ke{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,c=Math.floor(n),u=Math.floor(i),d=c+1,p=u+1,f=e/c,g=t/u,v=[],b=[],y=[],S=[];for(let M=0;M<p;M++){const w=M*g-s;for(let T=0;T<d;T++){const R=T*f-r;b.push(R,-w,0),y.push(0,0,1),S.push(T/c),S.push(1-M/u)}}for(let M=0;M<u;M++)for(let w=0;w<c;w++){const T=w+d*M,R=w+d*(M+1),L=w+1+d*(M+1),P=w+1+d*M;v.push(T,R,P),v.push(R,L,P)}this.setIndex(v),this.setAttribute("position",new Ge(b,3)),this.setAttribute("normal",new Ge(y,3)),this.setAttribute("uv",new Ge(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new na(e.width,e.height,e.widthSegments,e.heightSegments)}}const ct={alphamap_fragment:`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`,alphamap_pars_fragment:`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,alphatest_fragment:`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`,alphatest_pars_fragment:`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`,aomap_fragment:`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`,aomap_pars_fragment:`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`,begin_vertex:`
vec3 transformed = vec3( position );
`,beginnormal_vertex:`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`,bsdfs:`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );

    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disney’s reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

#ifdef USE_IRIDESCENCE

	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {

		float alpha = pow2( roughness ); // UE4's roughness

		vec3 halfDir = normalize( lightDir + viewDir );

		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );

		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );

		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

		float D = D_GGX( alpha, dotNH );

		return F * ( V * D );

	}

#endif

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif
`,iridescence_fragment:`

#ifdef USE_IRIDESCENCE

	// XYZ to linear-sRGB color space
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);

	// Assume air interface for top
	// Note: We don't handle the case fresnel0 == 1
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {

		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );

	}

	// Conversion FO/IOR
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );

	}

	// ior is a value between 1.0 and 3.0. 1.0 is air interface
	float IorToFresnel0( float transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));

	}

	// Fresnel equations for dielectric/dielectric interfaces.
	// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html
	// Evaluation XYZ sensitivity curves in Fourier space
	vec3 evalSensitivity( float OPD, vec3 shift ) {

		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );

		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;

		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;

	}

	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {

		vec3 I;

		// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		// Evaluate the cosTheta on the base layer (Snell law)
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );

		// Handle TIR:
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {

			 return vec3( 1.0 );

		}

		float cosTheta2 = sqrt( cosTheta2Sq );

		// First interface
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;

		// Second interface
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) ); // guard against 1.0
		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;

		// Phase shift
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;

		// Compound terms
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );

		// Reflectance term for m = 0 (DC term amplitude)
		vec3 C0 = R12 + Rs;
		I = C0;

		// Reflectance term for m > 0 (pairs of diracs)
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {

			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;

		}

		// Since out of gamut colors might be produced, negative color values are clamped to 0.
		return max( I, vec3( 0.0 ) );

	}

#endif

`,bumpmap_pars_fragment:`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm; // normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`,clipping_planes_fragment:`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`,clipping_planes_pars_fragment:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`,clipping_planes_pars_vertex:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`,clipping_planes_vertex:`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`,color_fragment:`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`,color_pars_fragment:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`,color_pars_vertex:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`,color_vertex:`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`,common:`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

float luminance( const in vec3 rgb ) {

	// assumes rgb is in linear color space with sRGB primaries and D65 white point

	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );

	return dot( weights, rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}

// Mipped Bicubic Texture Filtering by N8
// https://www.shadertoy.com/view/Dl2SDW

float w0( float a ) {

	return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );

}

float w1( float a ) {

	return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );

}

float w2( float a ){

    return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );

}

float w3( float a ) {

	return ( 1.0 / 6.0 ) * ( a * a * a );

}

// g0 and g1 are the two amplitude functions
float g0( float a ) {

	return w0( a ) + w1( a );

}

float g1( float a ) {

	return w2( a ) + w3( a );

}

// h0 and h1 are the two offset functions
float h0( float a ) {

	return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );

}

float h1( float a ) {

    return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );

}

vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {

	uv = uv * texelSize.zw + 0.5;

	vec2 iuv = floor( uv );
    vec2 fuv = fract( uv );

    float g0x = g0( fuv.x );
    float g1x = g1( fuv.x );
    float h0x = h0( fuv.x );
    float h1x = h1( fuv.x );
    float h0y = h0( fuv.y );
    float h1y = h1( fuv.y );

    vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
    vec2 lodFudge = pow( 1.95, lod ) / fullSize;
#if __VERSION__ > 130
	return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
		   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
#else
	return texture2D(tex, uv); //TODO: remove
#endif
}

vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {

#if __VERSION__ > 130
	vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
	vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
	vec2 fLodSizeInv = 1.0 / fLodSize;
	vec2 cLodSizeInv = 1.0 / cLodSize;
	vec2 fullSize = vec2( textureSize( sampler, 0 ) );
	vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
	vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
	return mix( fSample, cSample, fract( lod ) );
#else
	return texture2D(sampler, uv); //TODO: remove
#endif

}
`,cube_uv_reflection_fragment:`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0; // #25071

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		uv.x += filterInt * 3.0 * cubeUV_minTileSize;

		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );

		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;

		#ifdef texture2DGradEXT

			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb; // disable anisotropic filtering

		#else

			return texture2D( envMap, uv ).rgb;

		#endif

	}

	// These defines must match with PMREMGenerator

	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= cubeUV_r1 ) {

			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;

		} else if ( roughness >= cubeUV_r4 ) {

			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;

		} else if ( roughness >= cubeUV_r5 ) {

			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;

		} else if ( roughness >= cubeUV_r6 ) {

			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`,defaultnormal_vertex:`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`,displacementmap_pars_vertex:`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`,displacementmap_vertex:`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`,emissivemap_fragment:`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`,emissivemap_pars_fragment:`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`,encodings_fragment:`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`,encodings_pars_fragment:`

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`,envmap_fragment:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`,envmap_common_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3  envRotationMatrix;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`,envmap_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`,envmap_pars_vertex:`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`,envmap_physical_pars_fragment:`
#if defined( USE_ENVMAP )

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envRotationMatrix*worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec = reflect( - viewDir, normal );

			// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envRotationMatrix*reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`,envmap_vertex:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`,fog_vertex:`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`,fog_pars_vertex:`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`,fog_fragment:`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`,fog_pars_fragment:`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`,gradientmap_pars_fragment:`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );

	#endif

}
`,lightmap_fragment:`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`,lightmap_pars_fragment:`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`,lights_lambert_fragment:`
LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;
`,lights_lambert_pars_fragment:`
varying vec3 vViewPosition;

struct LambertMaterial {

	vec3 diffuseColor;
	float specularStrength;

};

void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
`,lights_pars_begin:`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( LEGACY_LIGHTS )

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#else

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`,lights_toon_fragment:`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`,lights_toon_pars_fragment:`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
`,lights_phong_fragment:`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,lights_phong_pars_fragment:`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,lights_physical_fragment:`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	material.ior = ior;

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARCOLORMAP

			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_IRIDESCENCE

	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;

	#ifdef USE_IRIDESCENCEMAP

		material.iridescence *= texture2D( iridescenceMap, vUv ).r;

	#endif

	#ifdef USE_IRIDESCENCE_THICKNESSMAP

		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;

	#else

		material.iridescenceThickness = iridescenceThicknessMaximum;

	#endif

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEENCOLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEENROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;

	#endif

#endif
`,lights_physical_pars_fragment:`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

	#ifdef IOR
		float ior;
	#endif

	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from 
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Agüera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	#ifdef USE_IRIDESCENCE

		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );

	#else

		vec3 Fr = specularColor;

	#endif

	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );

	#endif

	#ifdef USE_IRIDESCENCE

		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );

	#else

		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );

	#endif

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	#ifdef USE_IRIDESCENCE

		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );

	#else

		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	#endif

	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`,lights_fragment_begin:`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

#ifdef USE_IRIDESCENCE

	float dotNVi = saturate( dot( normal, geometry.viewDir ) );

	if ( material.iridescenceThickness == 0.0 ) {

		material.iridescence = 0.0;

	} else {

		material.iridescence = saturate( material.iridescence );

	}

	if ( material.iridescence > 0.0 ) {

		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );

		// Iridescence F0 approximation
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );

	}

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;

	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif

		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif

		#undef SPOT_LIGHT_MAP_INDEX

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,lights_fragment_maps:`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`,lights_fragment_end:`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`,logdepthbuf_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`,logdepthbuf_pars_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`,logdepthbuf_pars_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`,logdepthbuf_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`,map_fragment:`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`,map_pars_fragment:`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`,map_particle_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`,map_particle_pars_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,metalnessmap_fragment:`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`,metalnessmap_pars_fragment:`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`,morphcolor_vertex:`
#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	vColor *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		#if defined( USE_COLOR_ALPHA )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];

		#elif defined( USE_COLOR )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];

		#endif

	}

#endif
`,morphnormal_vertex:`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`,morphtarget_pars_vertex:`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;

		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {

			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;

			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`,morphtarget_vertex:`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`,normal_fragment_begin:`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`,normal_fragment_maps:`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`,normal_pars_fragment:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_pars_vertex:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_vertex:`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`,normalmap_pars_fragment:`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`,clearcoat_normal_fragment_begin:`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`,clearcoat_normal_fragment_maps:`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`,clearcoat_pars_fragment:`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`,iridescence_pars_fragment:`

#ifdef USE_IRIDESCENCEMAP

	uniform sampler2D iridescenceMap;

#endif

#ifdef USE_IRIDESCENCE_THICKNESSMAP

	uniform sampler2D iridescenceThicknessMap;

#endif
`,output_fragment:`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`,packing:`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}

float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,premultiplied_alpha_fragment:`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`,project_vertex:`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`,dithering_fragment:`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`,dithering_pars_fragment:`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift according to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`,roughnessmap_fragment:`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`,roughnessmap_pars_fragment:`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`,shadowmap_pars_fragment:`
#if NUM_SPOT_LIGHT_COORDS > 0

	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#if NUM_SPOT_LIGHT_MAPS > 0

	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`,shadowmap_pars_vertex:`

#if NUM_SPOT_LIGHT_COORDS > 0

	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`,shadowmap_vertex:`

#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )

	// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;

#endif

#if defined( USE_SHADOWMAP )

	#if NUM_DIR_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif

// spot lights can be evaluated without active shadow mapping (when SpotLight.map is used)

#if NUM_SPOT_LIGHT_COORDS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {

		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

#endif


`,shadowmask_pars_fragment:`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`,skinbase_vertex:`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`,skinning_pars_vertex:`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;

	mat4 getBoneMatrix( const in float i ) {

		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );

		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );

		y = dy * ( y + 0.5 );

		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

		mat4 bone = mat4( v1, v2, v3, v4 );

		return bone;

	}

#endif
`,skinning_vertex:`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`,skinnormal_vertex:`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`,specularmap_fragment:`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`,specularmap_pars_fragment:`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`,tonemapping_fragment:`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`,tonemapping_pars_fragment:`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );
}

vec3 CustomToneMapping( vec3 color ) { return color; }
`,transmission_fragment:`
#ifdef USE_TRANSMISSION

	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		material.transmission *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		material.thickness *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );

	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );

#endif
`,transmission_pars_fragment:`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );

	}

	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( isinf( attenuationDistance ) ) {

			// Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`,uv_pars_fragment:`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`,uv_pars_vertex:`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`,uv_vertex:`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`,uv2_pars_fragment:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`,uv2_pars_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`,uv2_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`,worldpos_vertex:`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`,background_vert:`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,background_frag:`
uniform sampler2D t2D;
uniform float backgroundIntensity;

varying vec2 vUv;

void main() {

	vec4 texColor = texture2D( t2D, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,backgroundCube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,backgroundCube_frag:`

#ifdef ENVMAP_TYPE_CUBE

	uniform samplerCube envMap;

#elif defined( ENVMAP_TYPE_CUBE_UV )

	uniform sampler2D envMap;

#endif

uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3  envRotationMatrix;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 dir = envRotationMatrix * vWorldDirection;

	#ifdef ENVMAP_TYPE_CUBE

		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * dir.x, dir.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 texColor = textureCubeUV( envMap, dir, backgroundBlurriness );

	#else

		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,cube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,cube_frag:`
uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;

varying vec3 vWorldDirection;

void main() {

	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );

	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,depth_vert:`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,depth_frag:`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`,distanceRGBA_vert:`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,distanceRGBA_frag:`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`,equirect_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,equirect_frag:`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,linedashed_vert:`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,linedashed_frag:`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,meshbasic_vert:`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,meshbasic_frag:`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshlambert_vert:`
#define LAMBERT

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshlambert_frag:`
#define LAMBERT

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshmatcap_vert:`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,meshmatcap_frag:`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshnormal_vert:`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,meshnormal_frag:`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`,meshphong_vert:`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshphong_frag:`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshphysical_vert:`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,meshphysical_frag:`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

#if defined(DEBUG_OCCLUSION) && defined(USE_AOMAP)
	gl_FragColor.rgb = vec3(ambientOcclusion);
#endif

#if defined(DEBUG_NORMAL)
	gl_FragColor.rgb = geometry.normal * 0.5 + 0.5;
#endif

#if defined(DEBUG_ROUGHNESS)
	gl_FragColor.rgb = vec3(material.roughness);
#endif

#if defined(DEBUG_METALNESS)
	gl_FragColor.rgb = vec3(metalnessFactor);
#endif

}
`,meshtoon_vert:`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshtoon_frag:`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,points_vert:`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,points_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,shadow_vert:`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,shadow_frag:`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	#include <logdepthbuf_fragment>

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`,sprite_vert:`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,sprite_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`},je={common:{diffuse:{value:new Pe(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new dn},uv2Transform:{value:new dn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ce(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new dn}},sprite:{diffuse:{value:new Pe(16777215)},opacity:{value:1},center:{value:new ce(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new dn}}},cr={basic:{uniforms:ni([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.fog]),vertexShader:ct.meshbasic_vert,fragmentShader:ct.meshbasic_frag},lambert:{uniforms:ni([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.fog,je.lights,{emissive:{value:new Pe(0)}}]),vertexShader:ct.meshlambert_vert,fragmentShader:ct.meshlambert_frag},phong:{uniforms:ni([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.fog,je.lights,{emissive:{value:new Pe(0)},specular:{value:new Pe(1118481)},shininess:{value:30}}]),vertexShader:ct.meshphong_vert,fragmentShader:ct.meshphong_frag},standard:{uniforms:ni([je.common,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.roughnessmap,je.metalnessmap,je.fog,je.lights,{emissive:{value:new Pe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ct.meshphysical_vert,fragmentShader:ct.meshphysical_frag},toon:{uniforms:ni([je.common,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.gradientmap,je.fog,je.lights,{emissive:{value:new Pe(0)}}]),vertexShader:ct.meshtoon_vert,fragmentShader:ct.meshtoon_frag},matcap:{uniforms:ni([je.common,je.bumpmap,je.normalmap,je.displacementmap,je.fog,{matcap:{value:null}}]),vertexShader:ct.meshmatcap_vert,fragmentShader:ct.meshmatcap_frag},points:{uniforms:ni([je.points,je.fog]),vertexShader:ct.points_vert,fragmentShader:ct.points_frag},dashed:{uniforms:ni([je.common,je.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ct.linedashed_vert,fragmentShader:ct.linedashed_frag},depth:{uniforms:ni([je.common,je.displacementmap]),vertexShader:ct.depth_vert,fragmentShader:ct.depth_frag},normal:{uniforms:ni([je.common,je.bumpmap,je.normalmap,je.displacementmap,{opacity:{value:1}}]),vertexShader:ct.meshnormal_vert,fragmentShader:ct.meshnormal_frag},sprite:{uniforms:ni([je.sprite,je.fog]),vertexShader:ct.sprite_vert,fragmentShader:ct.sprite_frag},background:{uniforms:{uvTransform:{value:new dn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ct.background_vert,fragmentShader:ct.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ct.backgroundCube_vert,fragmentShader:ct.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ct.cube_vert,fragmentShader:ct.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ct.equirect_vert,fragmentShader:ct.equirect_frag},distanceRGBA:{uniforms:ni([je.common,je.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ct.distanceRGBA_vert,fragmentShader:ct.distanceRGBA_frag},shadow:{uniforms:ni([je.lights,je.fog,{color:{value:new Pe(0)},opacity:{value:1}}]),vertexShader:ct.shadow_vert,fragmentShader:ct.shadow_frag}};cr.physical={uniforms:ni([cr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ce(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Pe(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ce},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Pe(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Pe(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ct.meshphysical_vert,fragmentShader:ct.meshphysical_frag};const Nh={r:0,b:0,g:0};function H3(o,e,t,n,i,r,s){const c=new Pe(0);let u,d,p=r===!0?0:1,f=null,g=0,v=null;function b(y,S){y.getRGB(Nh,Uy(o)),n.buffers.color.setClear(Nh.r,Nh.g,Nh.b,S,s)}return{getClearColor:function(){return c},setClearColor:function(y,S=1){c.set(y),p=S,b(c,p)},getClearAlpha:function(){return p},setClearAlpha:function(y){p=y,b(c,p)},render:function(y,S){let M=!1,w=S.isScene===!0?S.background:null;w&&w.isTexture&&(w=(S.backgroundBlurriness>0?t:e).get(w));const T=o.xr,R=T.getSession&&T.getSession();R&&R.environmentBlendMode==="additive"&&(w=null),w===null?b(c,p):w&&w.isColor&&(b(w,1),M=!0),(o.autoClear||M)&&o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Ao)?(d===void 0&&(d=new Je(new ea(1,1,1),new xt({name:"BackgroundCubeMaterial",uniforms:Go(cr.backgroundCube.uniforms),vertexShader:cr.backgroundCube.vertexShader,fragmentShader:cr.backgroundCube.fragmentShader,side:xe,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(L,P,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(d)),d.material.uniforms.envMap.value=w,d.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,d.material.toneMapped=w.encoding!==ht,f===w&&g===w.version&&v===o.toneMapping||(d.material.needsUpdate=!0,f=w,g=w.version,v=o.toneMapping),d.layers.enableAll(),y.unshift(d,d.geometry,d.material,0,0,null)):w&&w.isTexture&&(u===void 0&&(u=new Je(new na(2,2),new xt({name:"BackgroundMaterial",uniforms:Go(cr.background.uniforms),vertexShader:cr.background.vertexShader,fragmentShader:cr.background.fragmentShader,side:oe,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=w,u.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,u.material.toneMapped=w.encoding!==ht,w.matrixAutoUpdate===!0&&w.updateMatrix(),u.material.uniforms.uvTransform.value.copy(w.matrix),f===w&&g===w.version&&v===o.toneMapping||(u.material.needsUpdate=!0,f=w,g=w.version,v=o.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}}}function j3(o,e,t,n){const i=o.getParameter(o.MAX_VERTEX_ATTRIBS),r=n.isWebGL2?null:e.get("OES_vertex_array_object"),s=n.isWebGL2||r!==null,c={},u=v(null);let d=u,p=!1;function f(L){return n.isWebGL2?o.bindVertexArray(L):r.bindVertexArrayOES(L)}function g(L){return n.isWebGL2?o.deleteVertexArray(L):r.deleteVertexArrayOES(L)}function v(L){const P=[],I=[],V=[];for(let z=0;z<i;z++)P[z]=0,I[z]=0,V[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:I,attributeDivisors:V,object:L,attributes:{},index:null}}function b(){const L=d.newAttributes;for(let P=0,I=L.length;P<I;P++)L[P]=0}function y(L){S(L,0)}function S(L,P){const I=d.newAttributes,V=d.enabledAttributes,z=d.attributeDivisors;I[L]=1,V[L]===0&&(o.enableVertexAttribArray(L),V[L]=1),z[L]!==P&&((n.isWebGL2?o:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,P),z[L]=P)}function M(){const L=d.newAttributes,P=d.enabledAttributes;for(let I=0,V=P.length;I<V;I++)P[I]!==L[I]&&(o.disableVertexAttribArray(I),P[I]=0)}function w(L,P,I,V,z,G){n.isWebGL2!==!0||I!==o.INT&&I!==o.UNSIGNED_INT?o.vertexAttribPointer(L,P,I,V,z,G):o.vertexAttribIPointer(L,P,I,z,G)}function T(){R(),p=!0,d!==u&&(d=u,f(d.object))}function R(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(L,P,I,V,z){let G=!1;if(s){const F=function($,le,ae){const ye=ae.wireframe===!0;let pe=c[$.id];pe===void 0&&(pe={},c[$.id]=pe);let Me=pe[le.id];Me===void 0&&(Me={},pe[le.id]=Me);let Ee=Me[ye];return Ee===void 0&&(Ee=v(n.isWebGL2?o.createVertexArray():r.createVertexArrayOES()),Me[ye]=Ee),Ee}(V,I,P);d!==F&&(d=F,f(d.object)),G=function($,le,ae,ye){const pe=d.attributes,Me=le.attributes;let Ee=0;const Re=ae.getAttributes();for(const he in Re)if(Re[he].location>=0){const ne=pe[he];let me=Me[he];if(me===void 0&&(he==="instanceMatrix"&&$.instanceMatrix&&(me=$.instanceMatrix),he==="instanceColor"&&$.instanceColor&&(me=$.instanceColor)),ne===void 0||ne.attribute!==me||me&&ne.data!==me.data)return!0;Ee++}return d.attributesNum!==Ee||d.index!==ye}(L,V,I,z),G&&function($,le,ae,ye){const pe={},Me=le.attributes;let Ee=0;const Re=ae.getAttributes();for(const he in Re)if(Re[he].location>=0){let ne=Me[he];ne===void 0&&(he==="instanceMatrix"&&$.instanceMatrix&&(ne=$.instanceMatrix),he==="instanceColor"&&$.instanceColor&&(ne=$.instanceColor));const me={};me.attribute=ne,ne&&ne.data&&(me.data=ne.data),pe[he]=me,Ee++}d.attributes=pe,d.attributesNum=Ee,d.index=ye}(L,V,I,z)}else{const F=P.wireframe===!0;d.geometry===V.id&&d.program===I.id&&d.wireframe===F||(d.geometry=V.id,d.program=I.id,d.wireframe=F,G=!0)}z!==null&&t.update(z,o.ELEMENT_ARRAY_BUFFER),(G||p)&&(p=!1,function(F,$,le,ae){if(n.isWebGL2===!1&&(F.isInstancedMesh||ae.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();const ye=ae.attributes,pe=le.getAttributes(),Me=$.defaultAttributeValues;for(const Ee in pe){const Re=pe[Ee];if(Re.location>=0){let he=ye[Ee];if(he===void 0&&(Ee==="instanceMatrix"&&F.instanceMatrix&&(he=F.instanceMatrix),Ee==="instanceColor"&&F.instanceColor&&(he=F.instanceColor)),he!==void 0){const ne=he.normalized,me=he.itemSize,Ae=t.get(he);if(Ae===void 0)continue;const Se=Ae.buffer,Ne=Ae.type,j=Ae.bytesPerElement;if(he.isInterleavedBufferAttribute){const U=he.data,ie=U.stride,q=he.offset;if(U.isInstancedInterleavedBuffer){for(let H=0;H<Re.locationSize;H++)S(Re.location+H,U.meshPerAttribute);F.isInstancedMesh!==!0&&ae._maxInstanceCount===void 0&&(ae._maxInstanceCount=U.meshPerAttribute*U.count)}else for(let H=0;H<Re.locationSize;H++)y(Re.location+H);o.bindBuffer(o.ARRAY_BUFFER,Se);for(let H=0;H<Re.locationSize;H++)w(Re.location+H,me/Re.locationSize,Ne,ne,ie*j,(q+me/Re.locationSize*H)*j)}else{if(he.isInstancedBufferAttribute){for(let U=0;U<Re.locationSize;U++)S(Re.location+U,he.meshPerAttribute);F.isInstancedMesh!==!0&&ae._maxInstanceCount===void 0&&(ae._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let U=0;U<Re.locationSize;U++)y(Re.location+U);o.bindBuffer(o.ARRAY_BUFFER,Se);for(let U=0;U<Re.locationSize;U++)w(Re.location+U,me/Re.locationSize,Ne,ne,me*j,me/Re.locationSize*U*j)}}else if(Me!==void 0){const ne=Me[Ee];if(ne!==void 0)switch(ne.length){case 2:o.vertexAttrib2fv(Re.location,ne);break;case 3:o.vertexAttrib3fv(Re.location,ne);break;case 4:o.vertexAttrib4fv(Re.location,ne);break;default:o.vertexAttrib1fv(Re.location,ne)}}}}M()}(L,P,I,V),z!==null&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t.get(z).buffer))},reset:T,resetDefaultState:R,dispose:function(){T();for(const L in c){const P=c[L];for(const I in P){const V=P[I];for(const z in V)g(V[z].object),delete V[z];delete P[I]}delete c[L]}},releaseStatesOfGeometry:function(L){if(c[L.id]===void 0)return;const P=c[L.id];for(const I in P){const V=P[I];for(const z in V)g(V[z].object),delete V[z];delete P[I]}delete c[L.id]},releaseStatesOfProgram:function(L){for(const P in c){const I=c[P];if(I[L.id]===void 0)continue;const V=I[L.id];for(const z in V)g(V[z].object),delete V[z];delete I[L.id]}},initAttributes:b,enableAttribute:y,disableUnusedAttributes:M}}function G3(o,e,t,n){const i=n.isWebGL2;let r;this.setMode=function(s){r=s},this.render=function(s,c){o.drawArrays(r,s,c),t.update(c,r,1)},this.renderInstances=function(s,c,u){if(u===0)return;let d,p;if(i)d=o,p="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[p](r,s,c,u),t.update(c,r,u)}}function V3(o,e,t){let n;function i(R){if(R==="highp"){if(o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision>0)return"highp";R="mediump"}return R==="mediump"&&o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const r=typeof WebGL2RenderingContext<"u"&&o instanceof WebGL2RenderingContext;let s=t.precision!==void 0?t.precision:"highp";const c=i(s);c!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",c,"instead."),s=c);const u=r||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,p=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),f=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=o.getParameter(o.MAX_TEXTURE_SIZE),v=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),b=o.getParameter(o.MAX_VERTEX_ATTRIBS),y=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),S=o.getParameter(o.MAX_VARYING_VECTORS),M=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),w=f>0,T=r||e.has("OES_texture_float");return{isWebGL2:r,drawBuffers:u,getMaxAnisotropy:function(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");n=o.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:d,maxTextures:p,maxVertexTextures:f,maxTextureSize:g,maxCubemapSize:v,maxAttributes:b,maxVertexUniforms:y,maxVaryings:S,maxFragmentUniforms:M,vertexTextures:w,floatFragmentTextures:T,floatVertexTextures:w&&T,maxSamples:r?o.getParameter(o.MAX_SAMPLES):0}}function W3(o){const e=this;let t=null,n=0,i=!1,r=!1;const s=new ta,c=new dn,u={value:null,needsUpdate:!1};function d(p,f,g,v){const b=p!==null?p.length:0;let y=null;if(b!==0){if(y=u.value,v!==!0||y===null){const S=g+4*b,M=f.matrixWorldInverse;c.getNormalMatrix(M),(y===null||y.length<S)&&(y=new Float32Array(S));for(let w=0,T=g;w!==b;++w,T+=4)s.copy(p[w]).applyMatrix4(M,c),s.normal.toArray(y,T),y[T+3]=s.constant}u.value=y,u.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,y}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(p,f){const g=p.length!==0||f||n!==0||i;return i=f,n=p.length,g},this.beginShadows=function(){r=!0,d(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(p,f){t=d(p,f,0)},this.setState=function(p,f,g){const v=p.clippingPlanes,b=p.clipIntersection,y=p.clipShadows,S=o.get(p);if(!i||v===null||v.length===0||r&&!y)r?d(null):function(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const M=r?0:n,w=4*M;let T=S.clippingState||null;u.value=T,T=d(v,f,w,g);for(let R=0;R!==w;++R)T[R]=t[R];S.clippingState=T,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=M}}}function X3(o){let e=new WeakMap;function t(i,r){return r===Ta?i.mapping=wa:r===oc&&(i.mapping=Ma),i}function n(i){const r=i.target;r.removeEventListener("dispose",n);const s=e.get(r);s!==void 0&&(e.delete(r),s.dispose())}return{get:function(i){if(i&&i.isTexture&&i.isRenderTargetTexture===!1){const r=i.mapping;if(r===Ta||r===oc){if(e.has(i))return t(e.get(i).texture,i.mapping);{const s=i.image;if(s&&s.height>0){const c=new By(s.height/2);return c.fromEquirectangularTexture(o,i),e.set(i,c),i.addEventListener("dispose",n),t(c.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}class Oa extends Vo{constructor(e=-1,t=1,n=1,i=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,c=i+t,u=i-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=d*this.view.offsetX,s=r+d*this.view.width,c-=p*this.view.offsetY,u=c-p*this.view.height}this.projectionMatrix.makeOrthographic(r,s,c,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const jy=[.125,.215,.35,.446,.526,.582],Mc=20,wm=new Oa,Gy=new Pe;let Mm=null;const Cs=(1+Math.sqrt(5))/2,qo=1/Cs,Vy=[new C(1,1,1),new C(-1,1,1),new C(1,1,-1),new C(-1,1,-1),new C(0,Cs,qo),new C(0,Cs,-qo),new C(qo,0,Cs),new C(-qo,0,Cs),new C(Cs,qo,0),new C(-Cs,qo,0)];class Tm{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){Mm=this._renderer.getRenderTarget(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=qy(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Xy(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Mm),e.scissorTest=!1,kh(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===wa||e.mapping===Ma?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Mm=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:rt,minFilter:rt,generateMipmaps:!1,type:di,format:ti,encoding:rr,depthBuffer:!1},i=Wy(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Wy(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(s){const c=[],u=[],d=[];let p=s;const f=s-4+1+jy.length;for(let g=0;g<f;g++){const v=Math.pow(2,p);u.push(v);let b=1/v;g>s-4?b=jy[g-s+4-1]:g===0&&(b=0),d.push(b);const y=1/(v-2),S=-y,M=1+y,w=[S,S,M,S,M,M,S,S,M,M,S,M],T=6,R=6,L=3,P=2,I=1,V=new Float32Array(L*R*T),z=new Float32Array(P*R*T),G=new Float32Array(I*R*T);for(let $=0;$<T;$++){const le=$%3*2/3-1,ae=$>2?0:-1,ye=[le,ae,0,le+2/3,ae,0,le+2/3,ae+1,0,le,ae,0,le+2/3,ae+1,0,le,ae+1,0];V.set(ye,L*R*$),z.set(w,P*R*$);const pe=[$,$,$,$,$,$];G.set(pe,I*R*$)}const F=new Ke;F.setAttribute("position",new $e(V,L)),F.setAttribute("uv",new $e(z,P)),F.setAttribute("faceIndex",new $e(G,I)),c.push(F),p>4&&p--}return{lodPlanes:c,sizeLods:u,sigmas:d}}(r)),this._blurMaterial=function(s,c,u){const d=new Float32Array(Mc),p=new C(0,1,0);return new xt({name:"SphericalGaussianBlur",defines:{n:Mc,CUBEUV_TEXEL_WIDTH:1/c,CUBEUV_TEXEL_HEIGHT:1/u,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p}},vertexShader:Em(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ke,depthTest:!1,depthWrite:!1})}(r,e,t)}return i}_compileMaterial(e){const t=new Je(this._lodPlanes[0],e);this._renderer.compile(t,wm)}_sceneToCubeUV(e,t,n,i){const r=new Qt(90,1,t,n),s=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,p=u.toneMapping;u.getClearColor(Gy),u.toneMapping=Er,u.autoClear=!1;const f=new pi({name:"PMREM.Background",side:xe,depthWrite:!1,depthTest:!1}),g=new Je(new ea,f);let v=!1;const b=e.background;b?b.isColor&&(f.color.copy(b),e.background=null,v=!0):(f.color.copy(Gy),v=!0);for(let y=0;y<6;y++){const S=y%3;S===0?(r.up.set(0,s[y],0),r.lookAt(c[y],0,0)):S===1?(r.up.set(0,0,s[y]),r.lookAt(0,c[y],0)):(r.up.set(0,s[y],0),r.lookAt(0,0,c[y]));const M=this._cubeSize;kh(i,S*M,y>2?M:0,M,M),u.setRenderTarget(i),v&&u.render(g,r),u.render(e,r)}g.geometry.dispose(),g.material.dispose(),u.toneMapping=p,u.autoClear=d,e.background=b}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===wa||e.mapping===Ma;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=qy()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Xy());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new Je(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const c=this._cubeSize;kh(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(s,wm)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const r=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=Vy[(i-1)%Vy.length];this._blur(e,i-1,i,r,s)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,c){const u=this._renderer,d=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const p=new Je(this._lodPlanes[i],d),f=d.uniforms,g=this._sizeLods[n]-1,v=isFinite(r)?Math.PI/(2*g):2*Math.PI/39,b=r/v,y=isFinite(r)?1+Math.floor(3*b):Mc;y>Mc&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${y} samples when the maximum is set to 20`);const S=[];let M=0;for(let R=0;R<Mc;++R){const L=R/b,P=Math.exp(-L*L/2);S.push(P),R===0?M+=P:R<y&&(M+=2*P)}for(let R=0;R<S.length;R++)S[R]=S[R]/M;f.envMap.value=e.texture,f.samples.value=y,f.weights.value=S,f.latitudinal.value=s==="latitudinal",c&&(f.poleAxis.value=c);const{_lodMax:w}=this;f.dTheta.value=v,f.mipInt.value=w-n;const T=this._sizeLods[i];kh(t,3*T*(i>w-4?i-w+4:0),4*(this._cubeSize-T),3*T,2*T),u.setRenderTarget(t),u.render(p,wm)}}function Wy(o,e,t){const n=new Rt(o,e,t);return n.texture.mapping=Ao,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function kh(o,e,t,n,i){o.viewport.set(e,t,n,i),o.scissor.set(e,t,n,i)}function Xy(){return new xt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Em(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ke,depthTest:!1,depthWrite:!1})}function qy(){return new xt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Em(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ke,depthTest:!1,depthWrite:!1})}function Em(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function q3(o){let e=new WeakMap,t=null;function n(i){const r=i.target;r.removeEventListener("dispose",n);const s=e.get(r);s!==void 0&&(e.delete(r),s.dispose())}return{get:function(i){if(i&&i.isTexture){const r=i.mapping,s=r===Ta||r===oc,c=r===wa||r===Ma;if(s||c){if(i.isRenderTargetTexture&&i.needsPMREMUpdate===!0){i.needsPMREMUpdate=!1;let u=e.get(i);return t===null&&(t=new Tm(o)),u=s?t.fromEquirectangular(i,u):t.fromCubemap(i,u),e.set(i,u),u.texture}if(e.has(i))return e.get(i).texture;{const u=i.image;if(s&&u&&u.height>0||c&&u&&function(d){let p=0;const f=6;for(let g=0;g<f;g++)d[g]!==void 0&&p++;return p===f}(u)){t===null&&(t=new Tm(o));const d=s?t.fromEquirectangular(i):t.fromCubemap(i);return e.set(i,d),i.addEventListener("dispose",n),d.texture}return null}}}return i},dispose:function(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}}}function Y3(o){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=o.getExtension("WEBGL_depth_texture")||o.getExtension("MOZ_WEBGL_depth_texture")||o.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=o.getExtension("WEBGL_compressed_texture_s3tc")||o.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=o.getExtension("WEBGL_compressed_texture_pvrtc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=o.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function Q3(o,e,t,n){const i={},r=new WeakMap;function s(u){const d=u.target;d.index!==null&&e.remove(d.index);for(const f in d.attributes)e.remove(d.attributes[f]);d.removeEventListener("dispose",s),delete i[d.id];const p=r.get(d);p&&(e.remove(p),r.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function c(u){const d=[],p=u.index,f=u.attributes.position;let g=0;if(p!==null){const y=p.array;g=p.version;for(let S=0,M=y.length;S<M;S+=3){const w=y[S+0],T=y[S+1],R=y[S+2];d.push(w,T,T,R,R,w)}}else{const y=f.array;g=f.version;for(let S=0,M=y.length/3-1;S<M;S+=3){const w=S+0,T=S+1,R=S+2;d.push(w,T,T,R,R,w)}}const v=new(My(d)?vm:Eh)(d,1);v.version=g;const b=r.get(u);b&&e.remove(b),r.set(u,v)}return{get:function(u,d){return i[d.id]===!0||(d.addEventListener("dispose",s),i[d.id]=!0,t.memory.geometries++),d},update:function(u){const d=u.attributes;for(const f in d)e.update(d[f],o.ARRAY_BUFFER);const p=u.morphAttributes;for(const f in p){const g=p[f];for(let v=0,b=g.length;v<b;v++)e.update(g[v],o.ARRAY_BUFFER)}},getWireframeAttribute:function(u){const d=r.get(u);if(d){const p=u.index;p!==null&&d.version<p.version&&c(u)}else c(u);return r.get(u)}}}function Z3(o,e,t,n){const i=n.isWebGL2;let r,s,c;this.setMode=function(u){r=u},this.setIndex=function(u){s=u.type,c=u.bytesPerElement},this.render=function(u,d){o.drawElements(r,d,s,u*c),t.update(d,r,1)},this.renderInstances=function(u,d,p){if(p===0)return;let f,g;if(i)f=o,g="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",f===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");f[g](r,d,s,u*c,p),t.update(d,r,p)}}function K3(o){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case o.TRIANGLES:e.triangles+=i*(t/3);break;case o.LINES:e.lines+=i*(t/2);break;case o.LINE_STRIP:e.lines+=i*(t-1);break;case o.LINE_LOOP:e.lines+=i*t;break;case o.POINTS:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function J3(o,e){return o[0]-e[0]}function $3(o,e){return Math.abs(e[1])-Math.abs(o[1])}function eE(o,e,t){const n={},i=new Float32Array(8),r=new WeakMap,s=new Qe,c=[];for(let u=0;u<8;u++)c[u]=[u,0];return{update:function(u,d,p){const f=u.morphTargetInfluences;if(e.isWebGL2===!0){const g=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,v=g!==void 0?g.length:0;let b=r.get(d);if(b===void 0||b.count!==v){b!==void 0&&b.texture.dispose();const M=d.morphAttributes.position!==void 0,w=d.morphAttributes.normal!==void 0,T=d.morphAttributes.color!==void 0,R=d.morphAttributes.position||[],L=d.morphAttributes.normal||[],P=d.morphAttributes.color||[];let I=0;M===!0&&(I=1),w===!0&&(I=2),T===!0&&(I=3);let V=d.attributes.position.count*I,z=1;V>e.maxTextureSize&&(z=Math.ceil(V/e.maxTextureSize),V=e.maxTextureSize);const G=new Float32Array(V*z*4*v),F=new gh(G,V,z,v);F.type=Ti,F.needsUpdate=!0;const $=4*I;for(let le=0;le<v;le++){const ae=R[le],ye=L[le],pe=P[le],Me=V*z*4*le;for(let Ee=0;Ee<ae.count;Ee++){const Re=Ee*$;M===!0&&(s.fromBufferAttribute(ae,Ee),G[Me+Re+0]=s.x,G[Me+Re+1]=s.y,G[Me+Re+2]=s.z,G[Me+Re+3]=0),w===!0&&(s.fromBufferAttribute(ye,Ee),G[Me+Re+4]=s.x,G[Me+Re+5]=s.y,G[Me+Re+6]=s.z,G[Me+Re+7]=0),T===!0&&(s.fromBufferAttribute(pe,Ee),G[Me+Re+8]=s.x,G[Me+Re+9]=s.y,G[Me+Re+10]=s.z,G[Me+Re+11]=pe.itemSize===4?s.w:1)}}b={count:v,texture:F,size:new ce(V,z)},r.set(d,b),d.addEventListener("dispose",function le(){F.dispose(),r.delete(d),d.removeEventListener("dispose",le)})}let y=0;for(let M=0;M<f.length;M++)y+=f[M];const S=d.morphTargetsRelative?1:1-y;p.getUniforms().setValue(o,"morphTargetBaseInfluence",S),p.getUniforms().setValue(o,"morphTargetInfluences",f),p.getUniforms().setValue(o,"morphTargetsTexture",b.texture,t),p.getUniforms().setValue(o,"morphTargetsTextureSize",b.size)}else{const g=f===void 0?0:f.length;let v=n[d.id];if(v===void 0||v.length!==g){v=[];for(let w=0;w<g;w++)v[w]=[w,0];n[d.id]=v}for(let w=0;w<g;w++){const T=v[w];T[0]=w,T[1]=f[w]}v.sort($3);for(let w=0;w<8;w++)w<g&&v[w][1]?(c[w][0]=v[w][0],c[w][1]=v[w][1]):(c[w][0]=Number.MAX_SAFE_INTEGER,c[w][1]=0);c.sort(J3);const b=d.morphAttributes.position,y=d.morphAttributes.normal;let S=0;for(let w=0;w<8;w++){const T=c[w],R=T[0],L=T[1];R!==Number.MAX_SAFE_INTEGER&&L?(b&&d.getAttribute("morphTarget"+w)!==b[R]&&d.setAttribute("morphTarget"+w,b[R]),y&&d.getAttribute("morphNormal"+w)!==y[R]&&d.setAttribute("morphNormal"+w,y[R]),i[w]=L,S+=L):(b&&d.hasAttribute("morphTarget"+w)===!0&&d.deleteAttribute("morphTarget"+w),y&&d.hasAttribute("morphNormal"+w)===!0&&d.deleteAttribute("morphNormal"+w),i[w]=0)}const M=d.morphTargetsRelative?1:1-S;p.getUniforms().setValue(o,"morphTargetBaseInfluence",M),p.getUniforms().setValue(o,"morphTargetInfluences",i)}}}}function tE(o,e,t,n){let i=new WeakMap;function r(s){const c=s.target;c.removeEventListener("dispose",r),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:function(s){const c=n.render.frame,u=s.geometry,d=e.get(s,u);return i.get(d)!==c&&(e.update(d),i.set(d,c)),s.isInstancedMesh&&(s.hasEventListener("dispose",r)===!1&&s.addEventListener("dispose",r),t.update(s.instanceMatrix,o.ARRAY_BUFFER),s.instanceColor!==null&&t.update(s.instanceColor,o.ARRAY_BUFFER)),d},dispose:function(){i=new WeakMap}}}const Yy=new Ut,Qy=new gh,Zy=new am,Ky=new _c,Jy=[],$y=[],ex=new Float32Array(16),tx=new Float32Array(9),nx=new Float32Array(4);function Yo(o,e,t){const n=o[0];if(n<=0||n>0)return o;const i=e*t;let r=Jy[i];if(r===void 0&&(r=new Float32Array(i),Jy[i]=r),e!==0){n.toArray(r,0);for(let s=1,c=0;s!==e;++s)c+=t,o[s].toArray(r,c)}return r}function xn(o,e){if(o.length!==e.length)return!1;for(let t=0,n=o.length;t<n;t++)if(o[t]!==e[t])return!1;return!0}function bn(o,e){for(let t=0,n=e.length;t<n;t++)o[t]=e[t]}function Fh(o,e){let t=$y[e];t===void 0&&(t=new Int32Array(e),$y[e]=t);for(let n=0;n!==e;++n)t[n]=o.allocateTextureUnit();return t}function nE(o,e){const t=this.cache;t[0]!==e&&(o.uniform1f(this.addr,e),t[0]=e)}function iE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(o.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xn(t,e))return;o.uniform2fv(this.addr,e),bn(t,e)}}function rE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(o.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)t[0]===e.r&&t[1]===e.g&&t[2]===e.b||(o.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(xn(t,e))return;o.uniform3fv(this.addr,e),bn(t,e)}}function aE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(o.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xn(t,e))return;o.uniform4fv(this.addr,e),bn(t,e)}}function sE(o,e){const t=this.cache,n=e.elements;if(n===void 0){if(xn(t,e))return;o.uniformMatrix2fv(this.addr,!1,e),bn(t,e)}else{if(xn(t,n))return;nx.set(n),o.uniformMatrix2fv(this.addr,!1,nx),bn(t,n)}}function oE(o,e){const t=this.cache,n=e.elements;if(n===void 0){if(xn(t,e))return;o.uniformMatrix3fv(this.addr,!1,e),bn(t,e)}else{if(xn(t,n))return;tx.set(n),o.uniformMatrix3fv(this.addr,!1,tx),bn(t,n)}}function lE(o,e){const t=this.cache,n=e.elements;if(n===void 0){if(xn(t,e))return;o.uniformMatrix4fv(this.addr,!1,e),bn(t,e)}else{if(xn(t,n))return;ex.set(n),o.uniformMatrix4fv(this.addr,!1,ex),bn(t,n)}}function cE(o,e){const t=this.cache;t[0]!==e&&(o.uniform1i(this.addr,e),t[0]=e)}function uE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(o.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xn(t,e))return;o.uniform2iv(this.addr,e),bn(t,e)}}function hE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(o.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(xn(t,e))return;o.uniform3iv(this.addr,e),bn(t,e)}}function dE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(o.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xn(t,e))return;o.uniform4iv(this.addr,e),bn(t,e)}}function pE(o,e){const t=this.cache;t[0]!==e&&(o.uniform1ui(this.addr,e),t[0]=e)}function fE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(o.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xn(t,e))return;o.uniform2uiv(this.addr,e),bn(t,e)}}function mE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(o.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(xn(t,e))return;o.uniform3uiv(this.addr,e),bn(t,e)}}function gE(o,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(o.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xn(t,e))return;o.uniform4uiv(this.addr,e),bn(t,e)}}function vE(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTexture2D(e||Yy,i)}function yE(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||Zy,i)}function xE(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||Ky,i)}function bE(o,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(o.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||Qy,i)}function SE(o,e){o.uniform1fv(this.addr,e)}function _E(o,e){const t=Yo(e,this.size,2);o.uniform2fv(this.addr,t)}function wE(o,e){const t=Yo(e,this.size,3);o.uniform3fv(this.addr,t)}function ME(o,e){const t=Yo(e,this.size,4);o.uniform4fv(this.addr,t)}function TE(o,e){const t=Yo(e,this.size,4);o.uniformMatrix2fv(this.addr,!1,t)}function EE(o,e){const t=Yo(e,this.size,9);o.uniformMatrix3fv(this.addr,!1,t)}function AE(o,e){const t=Yo(e,this.size,16);o.uniformMatrix4fv(this.addr,!1,t)}function RE(o,e){o.uniform1iv(this.addr,e)}function LE(o,e){o.uniform2iv(this.addr,e)}function PE(o,e){o.uniform3iv(this.addr,e)}function CE(o,e){o.uniform4iv(this.addr,e)}function DE(o,e){o.uniform1uiv(this.addr,e)}function OE(o,e){o.uniform2uiv(this.addr,e)}function IE(o,e){o.uniform3uiv(this.addr,e)}function NE(o,e){o.uniform4uiv(this.addr,e)}function kE(o,e,t){const n=this.cache,i=e.length,r=Fh(t,i);xn(n,r)||(o.uniform1iv(this.addr,r),bn(n,r));for(let s=0;s!==i;++s)t.setTexture2D(e[s]||Yy,r[s])}function FE(o,e,t){const n=this.cache,i=e.length,r=Fh(t,i);xn(n,r)||(o.uniform1iv(this.addr,r),bn(n,r));for(let s=0;s!==i;++s)t.setTexture3D(e[s]||Zy,r[s])}function UE(o,e,t){const n=this.cache,i=e.length,r=Fh(t,i);xn(n,r)||(o.uniform1iv(this.addr,r),bn(n,r));for(let s=0;s!==i;++s)t.setTextureCube(e[s]||Ky,r[s])}function zE(o,e,t){const n=this.cache,i=e.length,r=Fh(t,i);xn(n,r)||(o.uniform1iv(this.addr,r),bn(n,r));for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||Qy,r[s])}class BE{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(i){switch(i){case 5126:return nE;case 35664:return iE;case 35665:return rE;case 35666:return aE;case 35674:return sE;case 35675:return oE;case 35676:return lE;case 5124:case 35670:return cE;case 35667:case 35671:return uE;case 35668:case 35672:return hE;case 35669:case 35673:return dE;case 5125:return pE;case 36294:return fE;case 36295:return mE;case 36296:return gE;case 35678:case 36198:case 36298:case 36306:case 35682:return vE;case 35679:case 36299:case 36307:return yE;case 35680:case 36300:case 36308:case 36293:return xE;case 36289:case 36303:case 36311:case 36292:return bE}}(t.type)}}class HE{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(i){switch(i){case 5126:return SE;case 35664:return _E;case 35665:return wE;case 35666:return ME;case 35674:return TE;case 35675:return EE;case 35676:return AE;case 5124:case 35670:return RE;case 35667:case 35671:return LE;case 35668:case 35672:return PE;case 35669:case 35673:return CE;case 5125:return DE;case 36294:return OE;case 36295:return IE;case 36296:return NE;case 35678:case 36198:case 36298:case 36306:case 35682:return kE;case 35679:case 36299:case 36307:return FE;case 35680:case 36300:case 36308:case 36293:return UE;case 36289:case 36303:case 36311:case 36292:return zE}}(t.type)}}class jE{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const c=i[r];c.setValue(e,t[c.id],n)}}}const Am=/(\w+)(\])?(\[|\.)?/g;function ix(o,e){o.seq.push(e),o.map[e.id]=e}function GE(o,e,t){const n=o.name,i=n.length;for(Am.lastIndex=0;;){const r=Am.exec(n),s=Am.lastIndex;let c=r[1];const u=r[2]==="]",d=r[3];if(u&&(c|=0),d===void 0||d==="["&&s+2===i){ix(t,d===void 0?new BE(c,o,e):new HE(c,o,e));break}{let p=t.map[c];p===void 0&&(p=new jE(c),ix(t,p)),t=p}}}class Uh{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const r=e.getActiveUniform(t,i);GE(r,e.getUniformLocation(t,r.name),this)}}setValue(e,t,n,i){const r=this.map[t];r!==void 0&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const c=t[r],u=n[c.id];u.needsUpdate!==!1&&c.setValue(e,u.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const s=e[i];s.id in t&&n.push(s)}return n}}function rx(o,e,t){const n=o.createShader(e);return o.shaderSource(n,t),o.compileShader(n),n}let VE=0;function ax(o,e,t){const n=o.getShaderParameter(e,o.COMPILE_STATUS),i=o.getShaderInfoLog(e).trim();if(n&&i==="")return"";const r=/ERROR: 0:(\d+)/.exec(i);if(r){const s=parseInt(r[1]);return t.toUpperCase()+`

`+i+`

`+function(c,u){const d=c.split(`
`),p=[],f=Math.max(u-6,0),g=Math.min(u+6,d.length);for(let v=f;v<g;v++){const b=v+1;p.push(`${b===u?">":" "} ${b}: ${d[v]}`)}return p.join(`
`)}(o.getShaderSource(e),s)}return i}function WE(o,e){const t=function(n){switch(n){case rr:return["Linear","( value )"];case ht:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+o+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function XE(o,e){let t;switch(e){case Q1:t="Linear";break;case Z1:t="Reinhard";break;case K1:t="OptimizedCineon";break;case _f:t="ACESFilmic";break;case J1:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+o+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Tc(o){return o!==""}function sx(o,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return o.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ox(o,e){return o.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const qE=/^[ \t]*#include +<([\w\d./]+)>/gm;function Rm(o){return o.replace(qE,YE)}function YE(o,e){const t=ct[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Rm(t)}const QE=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lx(o){return o.replace(QE,ZE)}function ZE(o,e,t,n){let i="";for(let r=parseInt(e);r<parseInt(t);r++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return i}function cx(o){let e="precision "+o.precision+` float;
precision `+o.precision+" int;";return o.precision==="highp"?e+=`
#define HIGH_PRECISION`:o.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:o.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function KE(o,e,t,n){const i=o.getContext(),r=t.defines;let s=t.vertexShader,c=t.fragmentShader;const u=function(z){let G="SHADOWMAP_TYPE_BASIC";return z.shadowMapType===se?G="SHADOWMAP_TYPE_PCF":z.shadowMapType===D?G="SHADOWMAP_TYPE_PCF_SOFT":z.shadowMapType===Q&&(G="SHADOWMAP_TYPE_VSM"),G}(t),d=function(z){let G="ENVMAP_TYPE_CUBE";if(z.envMap)switch(z.envMapMode){case wa:case Ma:G="ENVMAP_TYPE_CUBE";break;case Ao:G="ENVMAP_TYPE_CUBE_UV"}return G}(t),p=function(z){let G="ENVMAP_MODE_REFLECTION";return z.envMap&&z.envMapMode===Ma&&(G="ENVMAP_MODE_REFRACTION"),G}(t),f=function(z){let G="ENVMAP_BLENDING_NONE";if(z.envMap)switch(z.combine){case sc:G="ENVMAP_BLENDING_MULTIPLY";break;case q1:G="ENVMAP_BLENDING_MIX";break;case Y1:G="ENVMAP_BLENDING_ADD"}return G}(t),g=function(z){const G=z.envMapCubeUVHeight;if(G===null)return null;const F=Math.log2(G)-2,$=1/G;return{texelWidth:1/(3*Math.max(Math.pow(2,F),112)),texelHeight:$,maxMip:F}}(t),v=t.isWebGL2?"":function(z){return[z.extensionDerivatives||z.envMapCubeUVHeight||z.bumpMap||z.tangentSpaceNormalMap||z.clearcoatNormalMap||z.flatShading||z.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(z.extensionFragDepth||z.logarithmicDepthBuffer)&&z.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",z.extensionDrawBuffers&&z.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(z.extensionShaderTextureLOD||z.envMap||z.transmission)&&z.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Tc).join(`
`)}(t),b=function(z){const G=[];for(const F in z){const $=z[F];$!==!1&&G.push("#define "+F+" "+$)}return G.join(`
`)}(r),y=i.createProgram();let S,M,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(S=[b].filter(Tc).join(`
`),S.length>0&&(S+=`
`),M=[v,b].filter(Tc).join(`
`),M.length>0&&(M+=`
`)):(S=[cx(t),"#define SHADER_NAME "+t.shaderName,b,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Tc).join(`
`),M=[v,cx(t),"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+p:"",t.envMap?"#define "+f:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Er?"#define TONE_MAPPING":"",t.toneMapping!==Er?ct.tonemapping_pars_fragment:"",t.toneMapping!==Er?XE("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ct.encodings_pars_fragment,WE("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Tc).join(`
`)),s=Rm(s),s=sx(s,t),s=ox(s,t),c=Rm(c),c=sx(c,t),c=ox(c,t),s=lx(s),c=lx(c),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,S=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,M=["#define varying in",t.glslVersion===Kf?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Kf?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+M);const T=w+S+s,R=w+M+c,L=rx(i,i.VERTEX_SHADER,T),P=rx(i,i.FRAGMENT_SHADER,R);if(i.attachShader(y,L),i.attachShader(y,P),t.index0AttributeName!==void 0?i.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y),o.debug.checkShaderErrors){const z=i.getProgramInfoLog(y).trim(),G=i.getShaderInfoLog(L).trim(),F=i.getShaderInfoLog(P).trim();let $=!0,le=!0;if(i.getProgramParameter(y,i.LINK_STATUS)===!1){$=!1;const ae=ax(i,L,"vertex"),ye=ax(i,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(y,i.VALIDATE_STATUS)+`

Program Info Log: `+z+`
`+ae+`
`+ye)}else z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",z):G!==""&&F!==""||(le=!1);le&&(this.diagnostics={runnable:$,programLog:z,vertexShader:{log:G,prefix:S},fragmentShader:{log:F,prefix:M}})}let I,V;return i.deleteShader(L),i.deleteShader(P),this.getUniforms=function(){return I===void 0&&(I=new Uh(i,y)),I},this.getAttributes=function(){return V===void 0&&(V=function(z,G){const F={},$=z.getProgramParameter(G,z.ACTIVE_ATTRIBUTES);for(let le=0;le<$;le++){const ae=z.getActiveAttrib(G,le),ye=ae.name;let pe=1;ae.type===z.FLOAT_MAT2&&(pe=2),ae.type===z.FLOAT_MAT3&&(pe=3),ae.type===z.FLOAT_MAT4&&(pe=4),F[ye]={type:ae.type,location:z.getAttribLocation(G,ye),locationSize:pe}}return F}(i,y)),V},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.name=t.shaderName,this.id=VE++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=L,this.fragmentShader=P,this}let JE=0;class $E{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new eA(e),t.set(e,n)),n}}class eA{constructor(e){this.id=JE++,this.code=e,this.usedTimes=0}}function tA(o,e,t,n,i,r,s){const c=new _h,u=new $E,d=[],p=i.isWebGL2,f=i.logarithmicDepthBuffer,g=i.vertexTextures;let v=i.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(y,S,M,w,T){const R=w.fog,L=T.geometry,P=y.isMeshStandardMaterial?w.environment:null,I=(y.isMeshStandardMaterial?t:e).get(y.envMap||P),V=I&&I.mapping===Ao?I.image.height:null,z=b[y.type];y.precision!==null&&(v=i.getMaxPrecision(y.precision),v!==y.precision&&console.warn("THREE.WebGLProgram.getParameters:",y.precision,"not supported, using",v,"instead."));const G=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,F=G!==void 0?G.length:0;let $,le,ae,ye,pe=0;if(L.morphAttributes.position!==void 0&&(pe=1),L.morphAttributes.normal!==void 0&&(pe=2),L.morphAttributes.color!==void 0&&(pe=3),z){const ne=cr[z];$=ne.vertexShader,le=ne.fragmentShader}else $=y.vertexShader,le=y.fragmentShader,u.update(y),ae=u.getVertexShaderID(y),ye=u.getFragmentShaderID(y);const Me=o.getRenderTarget(),Ee=y.alphaTest>0,Re=y.clearcoat>0,he=y.iridescence>0;return{isWebGL2:p,shaderID:z,shaderName:y.type,vertexShader:$,fragmentShader:le,defines:y.defines,customVertexShaderID:ae,customFragmentShaderID:ye,isRawShaderMaterial:y.isRawShaderMaterial===!0,glslVersion:y.glslVersion,precision:v,instancing:T.isInstancedMesh===!0,instancingColor:T.isInstancedMesh===!0&&T.instanceColor!==null,supportsVertexTextures:g,outputEncoding:Me===null?o.outputEncoding:Me.isXRRenderTarget===!0?Me.texture.encoding:rr,map:!!y.map,matcap:!!y.matcap,envMap:!!I,envMapMode:I&&I.mapping,envMapCubeUVHeight:V,lightMap:!!y.lightMap,aoMap:!!y.aoMap,emissiveMap:!!y.emissiveMap,bumpMap:!!y.bumpMap,normalMap:!!y.normalMap,objectSpaceNormalMap:y.normalMapType===vy,tangentSpaceNormalMap:y.normalMapType===Aa,decodeVideoTexture:!!y.map&&y.map.isVideoTexture===!0&&y.map.encoding===ht,clearcoat:Re,clearcoatMap:Re&&!!y.clearcoatMap,clearcoatRoughnessMap:Re&&!!y.clearcoatRoughnessMap,clearcoatNormalMap:Re&&!!y.clearcoatNormalMap,iridescence:he,iridescenceMap:he&&!!y.iridescenceMap,iridescenceThicknessMap:he&&!!y.iridescenceThicknessMap,displacementMap:!!y.displacementMap,roughnessMap:!!y.roughnessMap,metalnessMap:!!y.metalnessMap,specularMap:!!y.specularMap,specularIntensityMap:!!y.specularIntensityMap,specularColorMap:!!y.specularColorMap,opaque:y.transparent===!1&&y.blending===at,alphaMap:!!y.alphaMap,alphaTest:Ee,gradientMap:!!y.gradientMap,sheen:y.sheen>0,sheenColorMap:!!y.sheenColorMap,sheenRoughnessMap:!!y.sheenRoughnessMap,transmission:y.transmission>0,transmissionMap:!!y.transmissionMap,thicknessMap:!!y.thicknessMap,combine:y.combine,vertexTangents:!!y.normalMap&&!!L.attributes.tangent,vertexColors:y.vertexColors,vertexAlphas:y.vertexColors===!0&&!!L.attributes.color&&L.attributes.color.itemSize===4,vertexUvs:!!(y.map||y.bumpMap||y.normalMap||y.specularMap||y.alphaMap||y.emissiveMap||y.roughnessMap||y.metalnessMap||y.clearcoatMap||y.clearcoatRoughnessMap||y.clearcoatNormalMap||y.iridescenceMap||y.iridescenceThicknessMap||y.displacementMap||y.transmissionMap||y.thicknessMap||y.specularIntensityMap||y.specularColorMap||y.sheenColorMap||y.sheenRoughnessMap),uvsVertexOnly:!(y.map||y.bumpMap||y.normalMap||y.specularMap||y.alphaMap||y.emissiveMap||y.roughnessMap||y.metalnessMap||y.clearcoatNormalMap||y.iridescenceMap||y.iridescenceThicknessMap||y.transmission>0||y.transmissionMap||y.thicknessMap||y.specularIntensityMap||y.specularColorMap||y.sheen>0||y.sheenColorMap||y.sheenRoughnessMap||!y.displacementMap),fog:!!R,useFog:y.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:!!y.flatShading,sizeAttenuation:y.sizeAttenuation,logarithmicDepthBuffer:f,skinning:T.isSkinnedMesh===!0,morphTargets:L.morphAttributes.position!==void 0,morphNormals:L.morphAttributes.normal!==void 0,morphColors:L.morphAttributes.color!==void 0,morphTargetsCount:F,morphTextureStride:pe,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:y.dithering,shadowMapEnabled:o.shadowMap.enabled&&M.length>0,shadowMapType:o.shadowMap.type,toneMapping:y.toneMapped?o.toneMapping:Er,useLegacyLights:o.useLegacyLights,premultipliedAlpha:y.premultipliedAlpha,doubleSided:y.side===_e,flipSided:y.side===xe,useDepthPacking:!!y.depthPacking,depthPacking:y.depthPacking||0,index0AttributeName:y.index0AttributeName,extensionDerivatives:y.extensions&&y.extensions.derivatives,extensionFragDepth:y.extensions&&y.extensions.fragDepth,extensionDrawBuffers:y.extensions&&y.extensions.drawBuffers,extensionShaderTextureLOD:y.extensions&&y.extensions.shaderTextureLOD,rendererExtensionFragDepth:p||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||n.has("EXT_shader_texture_lod"),customProgramCacheKey:y.customProgramCacheKey()}},getProgramCacheKey:function(y){const S=[];if(y.shaderID?S.push(y.shaderID):(S.push(y.customVertexShaderID),S.push(y.customFragmentShaderID)),y.defines!==void 0)for(const M in y.defines)S.push(M),S.push(y.defines[M]);return y.isRawShaderMaterial===!1&&(function(M,w){M.push(w.precision),M.push(w.outputEncoding),M.push(w.envMapMode),M.push(w.envMapCubeUVHeight),M.push(w.combine),M.push(w.vertexUvs),M.push(w.fogExp2),M.push(w.sizeAttenuation),M.push(w.morphTargetsCount),M.push(w.morphAttributeCount),M.push(w.numDirLights),M.push(w.numPointLights),M.push(w.numSpotLights),M.push(w.numSpotLightMaps),M.push(w.numHemiLights),M.push(w.numRectAreaLights),M.push(w.numDirLightShadows),M.push(w.numPointLightShadows),M.push(w.numSpotLightShadows),M.push(w.numSpotLightShadowsWithMaps),M.push(w.shadowMapType),M.push(w.toneMapping),M.push(w.numClippingPlanes),M.push(w.numClipIntersection),M.push(w.depthPacking)}(S,y),function(M,w){c.disableAll(),w.isWebGL2&&c.enable(0),w.supportsVertexTextures&&c.enable(1),w.instancing&&c.enable(2),w.instancingColor&&c.enable(3),w.map&&c.enable(4),w.matcap&&c.enable(5),w.envMap&&c.enable(6),w.lightMap&&c.enable(7),w.aoMap&&c.enable(8),w.emissiveMap&&c.enable(9),w.bumpMap&&c.enable(10),w.normalMap&&c.enable(11),w.objectSpaceNormalMap&&c.enable(12),w.tangentSpaceNormalMap&&c.enable(13),w.clearcoat&&c.enable(14),w.clearcoatMap&&c.enable(15),w.clearcoatRoughnessMap&&c.enable(16),w.clearcoatNormalMap&&c.enable(17),w.iridescence&&c.enable(18),w.iridescenceMap&&c.enable(19),w.iridescenceThicknessMap&&c.enable(20),w.displacementMap&&c.enable(21),w.specularMap&&c.enable(22),w.roughnessMap&&c.enable(23),w.metalnessMap&&c.enable(24),w.gradientMap&&c.enable(25),w.alphaMap&&c.enable(26),w.alphaTest&&c.enable(27),w.vertexColors&&c.enable(28),w.vertexAlphas&&c.enable(29),w.vertexUvs&&c.enable(30),w.vertexTangents&&c.enable(31),w.uvsVertexOnly&&c.enable(32),M.push(c.mask),c.disableAll(),w.fog&&c.enable(0),w.useFog&&c.enable(1),w.flatShading&&c.enable(2),w.logarithmicDepthBuffer&&c.enable(3),w.skinning&&c.enable(4),w.morphTargets&&c.enable(5),w.morphNormals&&c.enable(6),w.morphColors&&c.enable(7),w.premultipliedAlpha&&c.enable(8),w.shadowMapEnabled&&c.enable(9),w.useLegacyLights&&c.enable(10),w.doubleSided&&c.enable(11),w.flipSided&&c.enable(12),w.useDepthPacking&&c.enable(13),w.dithering&&c.enable(14),w.specularIntensityMap&&c.enable(15),w.specularColorMap&&c.enable(16),w.transmission&&c.enable(17),w.transmissionMap&&c.enable(18),w.thicknessMap&&c.enable(19),w.sheen&&c.enable(20),w.sheenColorMap&&c.enable(21),w.sheenRoughnessMap&&c.enable(22),w.decodeVideoTexture&&c.enable(23),w.opaque&&c.enable(24),M.push(c.mask)}(S,y),S.push(o.outputEncoding)),S.push(y.customProgramCacheKey),S.join()},getUniforms:function(y){const S=b[y.type];let M;if(S){const w=cr[S];M=Sm.clone(w.uniforms)}else M=y.uniforms;return M},acquireProgram:function(y,S){let M;for(let w=0,T=d.length;w<T;w++){const R=d[w];if(R.cacheKey===S){M=R,++M.usedTimes;break}}return M===void 0&&(M=new KE(o,S,y,r),d.push(M)),M},releaseProgram:function(y){if(--y.usedTimes==0){const S=d.indexOf(y);d[S]=d[d.length-1],d.pop(),y.destroy()}},releaseShaderCache:function(y){u.remove(y)},programs:d,dispose:function(){u.dispose()}}}function nA(){let o=new WeakMap;return{get:function(e){let t=o.get(e);return t===void 0&&(t={},o.set(e,t)),t},remove:function(e){o.delete(e)},update:function(e,t,n){o.get(e)[t]=n},dispose:function(){o=new WeakMap}}}function iA(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.material.id!==e.material.id?o.material.id-e.material.id:o.z!==e.z?o.z-e.z:o.id-e.id}function ux(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?e.z-o.z:o.id-e.id}function hx(){const o=[];let e=0;const t=[],n=[],i=[];function r(s,c,u,d,p,f){let g=o[e];return g===void 0?(g={id:s.id,object:s,geometry:c,material:u,groupOrder:d,renderOrder:s.renderOrder,z:p,group:f},o[e]=g):(g.id=s.id,g.object=s,g.geometry=c,g.material=u,g.groupOrder=d,g.renderOrder=s.renderOrder,g.z=p,g.group=f),e++,g}return{opaque:t,transmissive:n,transparent:i,init:function(){e=0,t.length=0,n.length=0,i.length=0},push:function(s,c,u,d,p,f){const g=r(s,c,u,d,p,f);u.transmission>0?n.push(g):u.transparent===!0?i.push(g):t.push(g)},unshift:function(s,c,u,d,p,f){const g=r(s,c,u,d,p,f);u.transmission>0?n.unshift(g):u.transparent===!0?i.unshift(g):t.unshift(g)},finish:function(){for(let s=e,c=o.length;s<c;s++){const u=o[s];if(u.id===null)break;u.id=null,u.object=null,u.geometry=null,u.material=null,u.group=null}},sort:function(s,c){t.length>1&&t.sort(s||iA),n.length>1&&n.sort(c||ux),i.length>1&&i.sort(c||ux)}}}function rA(){let o=new WeakMap;return{get:function(e,t){const n=o.get(e);let i;return n===void 0?(i=new hx,o.set(e,[i])):t>=n.length?(i=new hx,n.push(i)):i=n[t],i},dispose:function(){o=new WeakMap}}}function aA(){const o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new C,color:new Pe};break;case"SpotLight":t={position:new C,direction:new C,color:new Pe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new C,color:new Pe,distance:0,decay:0};break;case"HemisphereLight":t={direction:new C,skyColor:new Pe,groundColor:new Pe};break;case"RectAreaLight":t={color:new Pe,position:new C,halfWidth:new C,halfHeight:new C}}return o[e.id]=t,t}}}let sA=0;function oA(o,e){return(e.castShadow?2:0)-(o.castShadow?2:0)+(e.map?1:0)-(o.map?1:0)}function lA(o,e){const t=new aA,n=function(){const u={};return{get:function(d){if(u[d.id]!==void 0)return u[d.id];let p;switch(d.type){case"DirectionalLight":case"SpotLight":p={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ce};break;case"PointLight":p={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ce,shadowCameraNear:1,shadowCameraFar:1e3}}return u[d.id]=p,p}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)i.probe.push(new C);const r=new C,s=new De,c=new De;return{setup:function(u,d){let p=0,f=0,g=0;for(let z=0;z<9;z++)i.probe[z].set(0,0,0);let v=0,b=0,y=0,S=0,M=0,w=0,T=0,R=0,L=0,P=0;u.sort(oA);const I=d===!0?Math.PI:1;for(let z=0,G=u.length;z<G;z++){const F=u[z],$=F.color,le=F.intensity,ae=F.distance,ye=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)p+=$.r*le*I,f+=$.g*le*I,g+=$.b*le*I;else if(F.isLightProbe)for(let pe=0;pe<9;pe++)i.probe[pe].addScaledVector(F.sh.coefficients[pe],le);else if(F.isDirectionalLight){const pe=t.get(F);if(pe.color.copy(F.color).multiplyScalar(F.intensity*I),F.castShadow){const Me=F.shadow,Ee=n.get(F);Ee.shadowBias=Me.bias,Ee.shadowNormalBias=Me.normalBias,Ee.shadowRadius=Me.radius,Ee.shadowMapSize=Me.mapSize,i.directionalShadow[v]=Ee,i.directionalShadowMap[v]=ye,i.directionalShadowMatrix[v]=F.shadow.matrix,w++}i.directional[v]=pe,v++}else if(F.isSpotLight){const pe=t.get(F);pe.position.setFromMatrixPosition(F.matrixWorld),pe.color.copy($).multiplyScalar(le*I),pe.distance=ae,pe.coneCos=Math.cos(F.angle),pe.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),pe.decay=F.decay,i.spot[y]=pe;const Me=F.shadow;if(F.map&&(i.spotLightMap[L]=F.map,L++,Me.updateMatrices(F),F.castShadow&&P++),i.spotLightMatrix[y]=Me.matrix,F.castShadow){const Ee=n.get(F);Ee.shadowBias=Me.bias,Ee.shadowNormalBias=Me.normalBias,Ee.shadowRadius=Me.radius,Ee.shadowMapSize=Me.mapSize,i.spotShadow[y]=Ee,i.spotShadowMap[y]=ye,R++}y++}else if(F.isRectAreaLight){const pe=t.get(F);pe.color.copy($).multiplyScalar(le),pe.halfWidth.set(.5*F.width,0,0),pe.halfHeight.set(0,.5*F.height,0),i.rectArea[S]=pe,S++}else if(F.isPointLight){const pe=t.get(F);if(pe.color.copy(F.color).multiplyScalar(F.intensity*I),pe.distance=F.distance,pe.decay=F.decay,F.castShadow){const Me=F.shadow,Ee=n.get(F);Ee.shadowBias=Me.bias,Ee.shadowNormalBias=Me.normalBias,Ee.shadowRadius=Me.radius,Ee.shadowMapSize=Me.mapSize,Ee.shadowCameraNear=Me.camera.near,Ee.shadowCameraFar=Me.camera.far,i.pointShadow[b]=Ee,i.pointShadowMap[b]=ye,i.pointShadowMatrix[b]=F.shadow.matrix,T++}i.point[b]=pe,b++}else if(F.isHemisphereLight){const pe=t.get(F);pe.skyColor.copy(F.color).multiplyScalar(le*I),pe.groundColor.copy(F.groundColor).multiplyScalar(le*I),i.hemi[M]=pe,M++}}S>0&&(e.isWebGL2||o.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=je.LTC_FLOAT_1,i.rectAreaLTC2=je.LTC_FLOAT_2):o.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=je.LTC_HALF_1,i.rectAreaLTC2=je.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=p,i.ambient[1]=f,i.ambient[2]=g;const V=i.hash;V.directionalLength===v&&V.pointLength===b&&V.spotLength===y&&V.rectAreaLength===S&&V.hemiLength===M&&V.numDirectionalShadows===w&&V.numPointShadows===T&&V.numSpotShadows===R&&V.numSpotMaps===L||(i.directional.length=v,i.spot.length=y,i.rectArea.length=S,i.point.length=b,i.hemi.length=M,i.directionalShadow.length=w,i.directionalShadowMap.length=w,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=R,i.spotShadowMap.length=R,i.directionalShadowMatrix.length=w,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=R+L-P,i.spotLightMap.length=L,i.numSpotLightShadowsWithMaps=P,V.directionalLength=v,V.pointLength=b,V.spotLength=y,V.rectAreaLength=S,V.hemiLength=M,V.numDirectionalShadows=w,V.numPointShadows=T,V.numSpotShadows=R,V.numSpotMaps=L,i.version=sA++)},setupView:function(u,d){let p=0,f=0,g=0,v=0,b=0;const y=d.matrixWorldInverse;for(let S=0,M=u.length;S<M;S++){const w=u[S];if(w.isDirectionalLight){const T=i.directional[p];T.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(y),p++}else if(w.isSpotLight){const T=i.spot[g];T.position.setFromMatrixPosition(w.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(y),g++}else if(w.isRectAreaLight){const T=i.rectArea[v];T.position.setFromMatrixPosition(w.matrixWorld),T.position.applyMatrix4(y),c.identity(),s.copy(w.matrixWorld),s.premultiply(y),c.extractRotation(s),T.halfWidth.set(.5*w.width,0,0),T.halfHeight.set(0,.5*w.height,0),T.halfWidth.applyMatrix4(c),T.halfHeight.applyMatrix4(c),v++}else if(w.isPointLight){const T=i.point[f];T.position.setFromMatrixPosition(w.matrixWorld),T.position.applyMatrix4(y),f++}else if(w.isHemisphereLight){const T=i.hemi[b];T.direction.setFromMatrixPosition(w.matrixWorld),T.direction.transformDirection(y),b++}}},state:i}}function dx(o,e){const t=new lA(o,e),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:function(r){t.setup(n,r)},setupLightsView:function(r){t.setupView(n,r)},pushLight:function(r){n.push(r)},pushShadow:function(r){i.push(r)}}}function cA(o,e){let t=new WeakMap;return{get:function(n,i=0){const r=t.get(n);let s;return r===void 0?(s=new dx(o,e),t.set(n,[s])):i>=r.length?(s=new dx(o,e),r.push(s)):s=r[i],s},dispose:function(){t=new WeakMap}}}class zh extends on{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ar,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Lm extends on{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new C,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const uA=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,hA=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function dA(o,e,t){let n=new wc;const i=new ce,r=new ce,s=new Qe,c=new zh({depthPacking:ph}),u=new Lm,d={},p=t.maxTextureSize,f={[oe]:xe,[xe]:oe,[_e]:_e},g=new xt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ce},radius:{value:4}},vertexShader:uA,fragmentShader:hA}),v=g.clone();v.defines.HORIZONTAL_PASS=1;const b=new Ke;b.setAttribute("position",new $e(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Je(b,g),S=this;function M(R,L){const P=e.update(y);g.defines.VSM_SAMPLES!==R.blurSamples&&(g.defines.VSM_SAMPLES=R.blurSamples,v.defines.VSM_SAMPLES=R.blurSamples,g.needsUpdate=!0,v.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Rt(i.x,i.y)),g.uniforms.shadow_pass.value=R.map.texture,g.uniforms.resolution.value=R.mapSize,g.uniforms.radius.value=R.radius,o.setRenderTarget(R.mapPass),o.clear(),o.renderBufferDirect(L,null,P,g,y,null),v.uniforms.shadow_pass.value=R.mapPass.texture,v.uniforms.resolution.value=R.mapSize,v.uniforms.radius.value=R.radius,o.setRenderTarget(R.map),o.clear(),o.renderBufferDirect(L,null,P,v,y,null)}function w(R,L,P,I,V,z){let G=null;const F=P.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(F!==void 0)G=F;else if(G=P.isPointLight===!0?u:c,o.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){const $=G.uuid,le=L.uuid;let ae=d[$];ae===void 0&&(ae={},d[$]=ae);let ye=ae[le];ye===void 0&&(ye=G.clone(),ae[le]=ye),G=ye}return G.visible=L.visible,G.wireframe=L.wireframe,G.side=z===Q?L.shadowSide!==null?L.shadowSide:L.side:L.shadowSide!==null?L.shadowSide:f[L.side],G.alphaMap=L.alphaMap,G.alphaTest=L.alphaTest,G.map=L.map,G.clipShadows=L.clipShadows,G.clippingPlanes=L.clippingPlanes,G.clipIntersection=L.clipIntersection,G.displacementMap=L.displacementMap,G.displacementScale=L.displacementScale,G.displacementBias=L.displacementBias,G.wireframeLinewidth=L.wireframeLinewidth,G.linewidth=L.linewidth,P.isPointLight===!0&&G.isMeshDistanceMaterial===!0&&(G.referencePosition.setFromMatrixPosition(P.matrixWorld),G.nearDistance=I,G.farDistance=V),G}function T(R,L,P,I,V){if(R.visible===!1)return;if(R.layers.test(L.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&V===Q)&&(!R.frustumCulled||n.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,R.matrixWorld);const G=e.update(R),F=R.material;if(Array.isArray(F)){const $=G.groups;for(let le=0,ae=$.length;le<ae;le++){const ye=$[le],pe=F[ye.materialIndex];if(pe&&pe.visible){const Me=w(R,pe,I,P.near,P.far,V);o.renderBufferDirect(P,null,G,Me,R,ye)}}}else if(F.visible){const $=w(R,F,I,P.near,P.far,V);o.renderBufferDirect(P,null,G,$,R,null)}}const z=R.children;for(let G=0,F=z.length;G<F;G++)T(z[G],L,P,I,V)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=se,this.render=function(R,L,P){if(S.enabled===!1||S.autoUpdate===!1&&S.needsUpdate===!1||R.length===0)return;const I=o.getRenderTarget(),V=o.getActiveCubeFace(),z=o.getActiveMipmapLevel(),G=o.state;G.setBlending(ke),G.buffers.color.setClear(1,1,1,1),G.buffers.depth.setTest(!0),G.setScissorTest(!1);for(let F=0,$=R.length;F<$;F++){const le=R[F],ae=le.shadow;if(ae===void 0){console.warn("THREE.WebGLShadowMap:",le,"has no shadow.");continue}if(ae.autoUpdate===!1&&ae.needsUpdate===!1)continue;i.copy(ae.mapSize);const ye=ae.getFrameExtents();if(i.multiply(ye),r.copy(ae.mapSize),(i.x>p||i.y>p)&&(i.x>p&&(r.x=Math.floor(p/ye.x),i.x=r.x*ye.x,ae.mapSize.x=r.x),i.y>p&&(r.y=Math.floor(p/ye.y),i.y=r.y*ye.y,ae.mapSize.y=r.y)),ae.map===null){const Me=this.type!==Q?{minFilter:At,magFilter:At}:{};ae.map=new Rt(i.x,i.y,Me),ae.map.texture.name=le.name+".shadowMap",ae.camera.updateProjectionMatrix()}o.setRenderTarget(ae.map),o.clear();const pe=ae.getViewportCount();for(let Me=0;Me<pe;Me++){const Ee=ae.getViewport(Me);s.set(r.x*Ee.x,r.y*Ee.y,r.x*Ee.z,r.y*Ee.w),G.viewport(s),ae.updateMatrices(le,Me),n=ae.getFrustum(),T(L,P,ae.camera,le,this.type)}ae.isPointLightShadow!==!0&&this.type===Q&&M(ae,P),ae.needsUpdate=!1}S.needsUpdate=!1,o.setRenderTarget(I,V,z)}}function pA(o,e,t){const n=t.isWebGL2,i=new function(){let O=!1;const W=new Qe;let Y=null;const ee=new Qe(0,0,0,0);return{setMask:function(te){Y===te||O||(o.colorMask(te,te,te,te),Y=te)},setLocked:function(te){O=te},setClear:function(te,de,Oe,ze,Ve){Ve===!0&&(te*=ze,de*=ze,Oe*=ze),W.set(te,de,Oe,ze),ee.equals(W)===!1&&(o.clearColor(te,de,Oe,ze),ee.copy(W))},reset:function(){O=!1,Y=null,ee.set(-1,0,0,0)}}},r=new function(){let O=!1,W=null,Y=null,ee=null;return{setTest:function(te){te?Se(o.DEPTH_TEST):Ne(o.DEPTH_TEST)},setMask:function(te){W===te||O||(o.depthMask(te),W=te)},setFunc:function(te){if(Y!==te){switch(te){case xf:o.depthFunc(o.NEVER);break;case bf:o.depthFunc(o.ALWAYS);break;case th:o.depthFunc(o.LESS);break;case rc:o.depthFunc(o.LEQUAL);break;case ac:o.depthFunc(o.EQUAL);break;case Sf:o.depthFunc(o.GEQUAL);break;case X1:o.depthFunc(o.GREATER);break;case nh:o.depthFunc(o.NOTEQUAL);break;default:o.depthFunc(o.LEQUAL)}Y=te}},setLocked:function(te){O=te},setClear:function(te){ee!==te&&(o.clearDepth(te),ee=te)},reset:function(){O=!1,W=null,Y=null,ee=null}}},s=new function(){let O=!1,W=null,Y=null,ee=null,te=null,de=null,Oe=null,ze=null,Ve=null;return{setTest:function(Be){O||(Be?Se(o.STENCIL_TEST):Ne(o.STENCIL_TEST))},setMask:function(Be){W===Be||O||(o.stencilMask(Be),W=Be)},setFunc:function(Be,nt,lt){Y===Be&&ee===nt&&te===lt||(o.stencilFunc(Be,nt,lt),Y=Be,ee=nt,te=lt)},setOp:function(Be,nt,lt){de===Be&&Oe===nt&&ze===lt||(o.stencilOp(Be,nt,lt),de=Be,Oe=nt,ze=lt)},setLocked:function(Be){O=Be},setClear:function(Be){Ve!==Be&&(o.clearStencil(Be),Ve=Be)},reset:function(){O=!1,W=null,Y=null,ee=null,te=null,de=null,Oe=null,ze=null,Ve=null}}},c=new WeakMap,u=new WeakMap;let d={},p={},f=new WeakMap,g=[],v=null,b=!1,y=null,S=null,M=null,w=null,T=null,R=null,L=null,P=!1,I=null,V=null,z=null,G=null,F=null;const $=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let le=!1,ae=0;const ye=o.getParameter(o.VERSION);ye.indexOf("WebGL")!==-1?(ae=parseFloat(/^WebGL (\d)/.exec(ye)[1]),le=ae>=1):ye.indexOf("OpenGL ES")!==-1&&(ae=parseFloat(/^OpenGL ES (\d)/.exec(ye)[1]),le=ae>=2);let pe=null,Me={};const Ee=o.getParameter(o.SCISSOR_BOX),Re=o.getParameter(o.VIEWPORT),he=new Qe().fromArray(Ee),ne=new Qe().fromArray(Re);function me(O,W,Y){const ee=new Uint8Array(4),te=o.createTexture();o.bindTexture(O,te),o.texParameteri(O,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(O,o.TEXTURE_MAG_FILTER,o.NEAREST);for(let de=0;de<Y;de++)o.texImage2D(W+de,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,ee);return te}const Ae={};function Se(O){d[O]!==!0&&(o.enable(O),d[O]=!0)}function Ne(O){d[O]!==!1&&(o.disable(O),d[O]=!1)}Ae[o.TEXTURE_2D]=me(o.TEXTURE_2D,o.TEXTURE_2D,1),Ae[o.TEXTURE_CUBE_MAP]=me(o.TEXTURE_CUBE_MAP,o.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),r.setClear(1),s.setClear(0),Se(o.DEPTH_TEST),r.setFunc(rc),q(!1),H(Ue),Se(o.CULL_FACE),ie(ke);const j={[tr]:o.FUNC_ADD,[Eo]:o.FUNC_SUBTRACT,[Xe]:o.FUNC_REVERSE_SUBTRACT};if(n)j[tt]=o.MIN,j[st]=o.MAX;else{const O=e.get("EXT_blend_minmax");O!==null&&(j[tt]=O.MIN_EXT,j[st]=O.MAX_EXT)}const U={[Yt]:o.ZERO,[sn]:o.ONE,[bs]:o.SRC_COLOR,[Ss]:o.SRC_ALPHA,[W1]:o.SRC_ALPHA_SATURATE,[G1]:o.DST_COLOR,[_s]:o.DST_ALPHA,[Tr]:o.ONE_MINUS_SRC_COLOR,[nr]:o.ONE_MINUS_SRC_ALPHA,[V1]:o.ONE_MINUS_DST_COLOR,[j1]:o.ONE_MINUS_DST_ALPHA};function ie(O,W,Y,ee,te,de,Oe,ze){if(O!==ke){if(b===!1&&(Se(o.BLEND),b=!0),O===xs)te=te||W,de=de||Y,Oe=Oe||ee,W===S&&te===T||(o.blendEquationSeparate(j[W],j[te]),S=W,T=te),Y===M&&ee===w&&de===R&&Oe===L||(o.blendFuncSeparate(U[Y],U[ee],U[de],U[Oe]),M=Y,w=ee,R=de,L=Oe),y=O,P=!1;else if(O!==y||ze!==P){if(S===tr&&T===tr||(o.blendEquation(o.FUNC_ADD),S=tr,T=tr),ze)switch(O){case at:o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case gn:o.blendFunc(o.ONE,o.ONE);break;case ei:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case er:o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}else switch(O){case at:o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case gn:o.blendFunc(o.SRC_ALPHA,o.ONE);break;case ei:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case er:o.blendFunc(o.ZERO,o.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}M=null,w=null,R=null,L=null,y=O,P=ze}}else b===!0&&(Ne(o.BLEND),b=!1)}function q(O){I!==O&&(O?o.frontFace(o.CW):o.frontFace(o.CCW),I=O)}function H(O){O!==Fe?(Se(o.CULL_FACE),O!==V&&(O===Ue?o.cullFace(o.BACK):O===vt?o.cullFace(o.FRONT):o.cullFace(o.FRONT_AND_BACK))):Ne(o.CULL_FACE),V=O}function J(O,W,Y){O?(Se(o.POLYGON_OFFSET_FILL),G===W&&F===Y||(o.polygonOffset(W,Y),G=W,F=Y)):Ne(o.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:r,stencil:s},enable:Se,disable:Ne,bindFramebuffer:function(O,W){return p[O]!==W&&(o.bindFramebuffer(O,W),p[O]=W,n&&(O===o.DRAW_FRAMEBUFFER&&(p[o.FRAMEBUFFER]=W),O===o.FRAMEBUFFER&&(p[o.DRAW_FRAMEBUFFER]=W)),!0)},drawBuffers:function(O,W){let Y=g,ee=!1;if(O)if(Y=f.get(W),Y===void 0&&(Y=[],f.set(W,Y)),O.isWebGLMultipleRenderTargets){const te=O.texture;if(Y.length!==te.length||Y[0]!==o.COLOR_ATTACHMENT0){for(let de=0,Oe=te.length;de<Oe;de++)Y[de]=o.COLOR_ATTACHMENT0+de;Y.length=te.length,ee=!0}}else Y[0]!==o.COLOR_ATTACHMENT0&&(Y[0]=o.COLOR_ATTACHMENT0,ee=!0);else Y[0]!==o.BACK&&(Y[0]=o.BACK,ee=!0);ee&&(t.isWebGL2?o.drawBuffers(Y):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Y))},useProgram:function(O){return v!==O&&(o.useProgram(O),v=O,!0)},setBlending:ie,setMaterial:function(O,W){O.side===_e?Ne(o.CULL_FACE):Se(o.CULL_FACE);let Y=O.side===xe;W&&(Y=!Y),q(Y),O.blending===at&&O.transparent===!1?ie(ke):ie(O.blending,O.blendEquation,O.blendSrc,O.blendDst,O.blendEquationAlpha,O.blendSrcAlpha,O.blendDstAlpha,O.premultipliedAlpha),r.setFunc(O.depthFunc),r.setTest(O.depthTest),r.setMask(O.depthWrite),i.setMask(O.colorWrite);const ee=O.stencilWrite;s.setTest(ee),ee&&(s.setMask(O.stencilWriteMask),s.setFunc(O.stencilFunc,O.stencilRef,O.stencilFuncMask),s.setOp(O.stencilFail,O.stencilZFail,O.stencilZPass)),J(O.polygonOffset,O.polygonOffsetFactor,O.polygonOffsetUnits),O.alphaToCoverage===!0?Se(o.SAMPLE_ALPHA_TO_COVERAGE):Ne(o.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:H,setLineWidth:function(O){O!==z&&(le&&o.lineWidth(O),z=O)},setPolygonOffset:J,setScissorTest:function(O){O?Se(o.SCISSOR_TEST):Ne(o.SCISSOR_TEST)},activeTexture:function(O){O===void 0&&(O=o.TEXTURE0+$-1),pe!==O&&(o.activeTexture(O),pe=O)},bindTexture:function(O,W,Y){Y===void 0&&(Y=pe===null?o.TEXTURE0+$-1:pe);let ee=Me[Y];ee===void 0&&(ee={type:void 0,texture:void 0},Me[Y]=ee),ee.type===O&&ee.texture===W||(pe!==Y&&(o.activeTexture(Y),pe=Y),o.bindTexture(O,W||Ae[O]),ee.type=O,ee.texture=W)},unbindTexture:function(){const O=Me[pe];O!==void 0&&O.type!==void 0&&(o.bindTexture(O.type,null),O.type=void 0,O.texture=void 0)},compressedTexImage2D:function(){try{o.compressedTexImage2D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexImage3D:function(){try{o.compressedTexImage3D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage2D:function(){try{o.texImage2D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage3D:function(){try{o.texImage3D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},updateUBOMapping:function(O,W){let Y=u.get(W);Y===void 0&&(Y=new WeakMap,u.set(W,Y));let ee=Y.get(O);ee===void 0&&(ee=o.getUniformBlockIndex(W,O.name),Y.set(O,ee))},uniformBlockBinding:function(O,W){const Y=u.get(W).get(O);c.get(W)!==Y&&(o.uniformBlockBinding(W,Y,O.__bindingPointIndex),c.set(W,Y))},texStorage2D:function(){try{o.texStorage2D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texStorage3D:function(){try{o.texStorage3D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage2D:function(){try{o.texSubImage2D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage3D:function(){try{o.texSubImage3D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage2D:function(){try{o.compressedTexSubImage2D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage3D:function(){try{o.compressedTexSubImage3D.apply(o,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},scissor:function(O){he.equals(O)===!1&&(o.scissor(O.x,O.y,O.z,O.w),he.copy(O))},viewport:function(O){ne.equals(O)===!1&&(o.viewport(O.x,O.y,O.z,O.w),ne.copy(O))},reset:function(){o.disable(o.BLEND),o.disable(o.CULL_FACE),o.disable(o.DEPTH_TEST),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SCISSOR_TEST),o.disable(o.STENCIL_TEST),o.disable(o.SAMPLE_ALPHA_TO_COVERAGE),o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ONE,o.ZERO),o.blendFuncSeparate(o.ONE,o.ZERO,o.ONE,o.ZERO),o.colorMask(!0,!0,!0,!0),o.clearColor(0,0,0,0),o.depthMask(!0),o.depthFunc(o.LESS),o.clearDepth(1),o.stencilMask(4294967295),o.stencilFunc(o.ALWAYS,0,4294967295),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.clearStencil(0),o.cullFace(o.BACK),o.frontFace(o.CCW),o.polygonOffset(0,0),o.activeTexture(o.TEXTURE0),o.bindFramebuffer(o.FRAMEBUFFER,null),n===!0&&(o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(o.READ_FRAMEBUFFER,null)),o.useProgram(null),o.lineWidth(1),o.scissor(0,0,o.canvas.width,o.canvas.height),o.viewport(0,0,o.canvas.width,o.canvas.height),d={},pe=null,Me={},p={},f=new WeakMap,g=[],v=null,b=!1,y=null,S=null,M=null,w=null,T=null,R=null,L=null,P=!1,I=null,V=null,z=null,G=null,F=null,he.set(0,0,o.canvas.width,o.canvas.height),ne.set(0,0,o.canvas.width,o.canvas.height),i.reset(),r.reset(),s.reset()}}}function fA(o,e,t,n,i,r,s){const c=i.isWebGL2,u=i.maxTextures,d=i.maxCubemapSize,p=i.maxTextureSize,f=i.maxSamples,g=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,v=typeof navigator<"u"&&/OculusBrowser/g.test(navigator.userAgent),b=new WeakMap;let y;const S=new WeakMap;let M=!1;try{M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(j,U){return M?new OffscreenCanvas(j,U):pc("canvas")}function T(j,U,ie,q){let H=1;if((j.width>q||j.height>q)&&(H=q/Math.max(j.width,j.height)),H<1||U===!0){if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap){const J=U?wy:Math.floor,O=J(H*j.width),W=J(H*j.height);y===void 0&&(y=w(O,W));const Y=ie?w(O,W):y;return Y.width=O,Y.height=W,Y.getContext("2d").drawImage(j,0,0,O,W),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+j.width+"x"+j.height+") to ("+O+"x"+W+")."),Y}return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+j.width+"x"+j.height+")."),j}return j}function R(j){return $f(j.width)&&$f(j.height)}function L(j,U){return j.generateMipmaps&&U&&j.minFilter!==At&&j.minFilter!==rt}function P(j){o.generateMipmap(j)}function I(j,U,ie,q,H=!1){if(c===!1)return U;if(j!==null){if(o[j]!==void 0)return o[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let J=U;return U===o.RED&&(ie===o.FLOAT&&(J=o.R32F),ie===o.HALF_FLOAT&&(J=o.R16F),ie===o.UNSIGNED_BYTE&&(J=o.R8)),U===o.RG&&(ie===o.FLOAT&&(J=o.RG32F),ie===o.HALF_FLOAT&&(J=o.RG16F),ie===o.UNSIGNED_BYTE&&(J=o.RG8)),U===o.RGBA&&(ie===o.FLOAT&&(J=o.RGBA32F),ie===o.HALF_FLOAT&&(J=o.RGBA16F),ie===o.UNSIGNED_BYTE&&(J=q===ht&&H===!1?o.SRGB8_ALPHA8:o.RGBA8),ie===o.UNSIGNED_SHORT_4_4_4_4&&(J=o.RGBA4),ie===o.UNSIGNED_SHORT_5_5_5_1&&(J=o.RGB5_A1)),J!==o.R16F&&J!==o.R32F&&J!==o.RG16F&&J!==o.RG32F&&J!==o.RGBA16F&&J!==o.RGBA32F||e.get("EXT_color_buffer_float"),J}function V(j,U,ie){return L(j,ie)===!0||j.isFramebufferTexture&&j.minFilter!==At&&j.minFilter!==rt?Math.log2(Math.max(U.width,U.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?U.mipmaps.length:1}function z(j){return j===At||j===lc||j===Lo?o.NEAREST:o.LINEAR}function G(j){const U=j.target;U.removeEventListener("dispose",G),function(ie){const q=n.get(ie);if(q.__webglInit===void 0)return;const H=ie.source,J=S.get(H);if(J){const O=J[q.__cacheKey];O.usedTimes--,O.usedTimes===0&&$(ie),Object.keys(J).length===0&&S.delete(H)}n.remove(ie)}(U),U.isVideoTexture&&b.delete(U)}function F(j){const U=j.target;U.removeEventListener("dispose",F),function(ie){const q=ie.texture,H=n.get(ie),J=n.get(q);if(J.__webglTexture!==void 0&&(o.deleteTexture(J.__webglTexture),s.memory.textures--),ie.depthTexture&&ie.depthTexture.dispose(),ie.isWebGLCubeRenderTarget)for(let O=0;O<6;O++)o.deleteFramebuffer(H.__webglFramebuffer[O]),H.__webglDepthbuffer&&o.deleteRenderbuffer(H.__webglDepthbuffer[O]);else{if(o.deleteFramebuffer(H.__webglFramebuffer),H.__webglDepthbuffer&&o.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&o.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let O=0;O<H.__webglColorRenderbuffer.length;O++)H.__webglColorRenderbuffer[O]&&o.deleteRenderbuffer(H.__webglColorRenderbuffer[O]);H.__webglDepthRenderbuffer&&o.deleteRenderbuffer(H.__webglDepthRenderbuffer)}if(ie.isWebGLMultipleRenderTargets)for(let O=0,W=q.length;O<W;O++){const Y=n.get(q[O]);Y.__webglTexture&&(o.deleteTexture(Y.__webglTexture),s.memory.textures--),n.remove(q[O])}n.remove(q),n.remove(ie)}(U)}function $(j){const U=n.get(j);o.deleteTexture(U.__webglTexture);const ie=j.source;delete S.get(ie)[U.__cacheKey],s.memory.textures--}let le=0;function ae(j,U){const ie=n.get(j);if(j.isVideoTexture&&function(q){const H=s.render.frame;b.get(q)!==H&&(b.set(q,H),q.update())}(j),j.isRenderTargetTexture===!1&&j.version>0&&ie.__version!==j.version){const q=j.image;if(q===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(q.complete!==!1)return void Re(ie,j,U);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(o.TEXTURE_2D,ie.__webglTexture,o.TEXTURE0+U)}const ye={[hi]:o.REPEAT,[vn]:o.CLAMP_TO_EDGE,[Ro]:o.MIRRORED_REPEAT},pe={[At]:o.NEAREST,[lc]:o.NEAREST_MIPMAP_NEAREST,[Lo]:o.NEAREST_MIPMAP_LINEAR,[rt]:o.LINEAR,[rh]:o.LINEAR_MIPMAP_NEAREST,[ir]:o.LINEAR_MIPMAP_LINEAR};function Me(j,U,ie){if(ie?(o.texParameteri(j,o.TEXTURE_WRAP_S,ye[U.wrapS]),o.texParameteri(j,o.TEXTURE_WRAP_T,ye[U.wrapT]),j!==o.TEXTURE_3D&&j!==o.TEXTURE_2D_ARRAY||o.texParameteri(j,o.TEXTURE_WRAP_R,ye[U.wrapR]),o.texParameteri(j,o.TEXTURE_MAG_FILTER,pe[U.magFilter]),o.texParameteri(j,o.TEXTURE_MIN_FILTER,pe[U.minFilter])):(o.texParameteri(j,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(j,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),j!==o.TEXTURE_3D&&j!==o.TEXTURE_2D_ARRAY||o.texParameteri(j,o.TEXTURE_WRAP_R,o.CLAMP_TO_EDGE),U.wrapS===vn&&U.wrapT===vn||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),o.texParameteri(j,o.TEXTURE_MAG_FILTER,z(U.magFilter)),o.texParameteri(j,o.TEXTURE_MIN_FILTER,z(U.minFilter)),U.minFilter!==At&&U.minFilter!==rt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const q=e.get("EXT_texture_filter_anisotropic");if(U.magFilter===At||U.minFilter!==Lo&&U.minFilter!==ir||U.type===Ti&&e.has("OES_texture_float_linear")===!1||c===!1&&U.type===di&&e.has("OES_texture_half_float_linear")===!1)return;(U.anisotropy>1||n.get(U).__currentAnisotropy)&&(o.texParameterf(j,q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(U.anisotropy,i.getMaxAnisotropy())),n.get(U).__currentAnisotropy=U.anisotropy)}}function Ee(j,U){let ie=!1;j.__webglInit===void 0&&(j.__webglInit=!0,U.addEventListener("dispose",G));const q=U.source;let H=S.get(q);H===void 0&&(H={},S.set(q,H));const J=function(O){const W=[];return W.push(O.wrapS),W.push(O.wrapT),W.push(O.wrapR||0),W.push(O.magFilter),W.push(O.minFilter),W.push(O.anisotropy),W.push(O.internalFormat),W.push(O.format),W.push(O.type),W.push(O.generateMipmaps),W.push(O.premultiplyAlpha),W.push(O.flipY),W.push(O.unpackAlignment),W.push(O.encoding),W.join()}(U);if(J!==j.__cacheKey){H[J]===void 0&&(H[J]={texture:o.createTexture(),usedTimes:0},s.memory.textures++,ie=!0),H[J].usedTimes++;const O=H[j.__cacheKey];O!==void 0&&(H[j.__cacheKey].usedTimes--,O.usedTimes===0&&$(U)),j.__cacheKey=J,j.__webglTexture=H[J].texture}return ie}function Re(j,U,ie){let q=o.TEXTURE_2D;(U.isDataArrayTexture||U.isCompressedArrayTexture)&&(q=o.TEXTURE_2D_ARRAY),U.isData3DTexture&&(q=o.TEXTURE_3D);const H=Ee(j,U),J=U.source;t.bindTexture(q,j.__webglTexture,o.TEXTURE0+ie);const O=n.get(J);if(J.version!==O.__version||H===!0){t.activeTexture(o.TEXTURE0+ie),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,U.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,U.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,U.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE);const W=function(et){return!c&&(et.wrapS!==vn||et.wrapT!==vn||et.minFilter!==At&&et.minFilter!==rt)}(U)&&R(U.image)===!1;let Y=T(U.image,W,!1,p);Y=Ne(U,Y);const ee=R(Y)||c,te=r.convert(U.format,U.encoding);let de,Oe=r.convert(U.type),ze=I(U.internalFormat,te,Oe,U.encoding,U.isVideoTexture);Me(q,U,ee);const Ve=U.mipmaps,Be=c&&U.isVideoTexture!==!0,nt=O.__version===void 0||H===!0,lt=V(U,Y,ee);if(U.isDepthTexture)ze=o.DEPTH_COMPONENT,c?ze=U.type===Ti?o.DEPTH_COMPONENT32F:U.type===Vr?o.DEPTH_COMPONENT24:U.type===Wr?o.DEPTH24_STENCIL8:o.DEPTH_COMPONENT16:U.type===Ti&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),U.format===Xr&&ze===o.DEPTH_COMPONENT&&U.type!==ah&&U.type!==Vr&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),U.type=Vr,Oe=r.convert(U.type)),U.format===Ea&&ze===o.DEPTH_COMPONENT&&(ze=o.DEPTH_STENCIL,U.type!==Wr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),U.type=Wr,Oe=r.convert(U.type))),nt&&(Be?t.texStorage2D(o.TEXTURE_2D,1,ze,Y.width,Y.height):t.texImage2D(o.TEXTURE_2D,0,ze,Y.width,Y.height,0,te,Oe,null));else if(U.isDataTexture)if(Ve.length>0&&ee){Be&&nt&&t.texStorage2D(o.TEXTURE_2D,lt,ze,Ve[0].width,Ve[0].height);for(let et=0,pt=Ve.length;et<pt;et++)de=Ve[et],Be?t.texSubImage2D(o.TEXTURE_2D,et,0,0,de.width,de.height,te,Oe,de.data):t.texImage2D(o.TEXTURE_2D,et,ze,de.width,de.height,0,te,Oe,de.data);U.generateMipmaps=!1}else Be?(nt&&t.texStorage2D(o.TEXTURE_2D,lt,ze,Y.width,Y.height),t.texSubImage2D(o.TEXTURE_2D,0,0,0,Y.width,Y.height,te,Oe,Y.data)):t.texImage2D(o.TEXTURE_2D,0,ze,Y.width,Y.height,0,te,Oe,Y.data);else if(U.isCompressedTexture)if(U.isCompressedArrayTexture){Be&&nt&&t.texStorage3D(o.TEXTURE_2D_ARRAY,lt,ze,Ve[0].width,Ve[0].height,Y.depth);for(let et=0,pt=Ve.length;et<pt;et++)de=Ve[et],U.format!==ti?te!==null?Be?t.compressedTexSubImage3D(o.TEXTURE_2D_ARRAY,et,0,0,0,de.width,de.height,Y.depth,te,de.data,0,0):t.compressedTexImage3D(o.TEXTURE_2D_ARRAY,et,ze,de.width,de.height,Y.depth,0,de.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Be?t.texSubImage3D(o.TEXTURE_2D_ARRAY,et,0,0,0,de.width,de.height,Y.depth,te,Oe,de.data):t.texImage3D(o.TEXTURE_2D_ARRAY,et,ze,de.width,de.height,Y.depth,0,te,Oe,de.data)}else{Be&&nt&&t.texStorage2D(o.TEXTURE_2D,lt,ze,Ve[0].width,Ve[0].height);for(let et=0,pt=Ve.length;et<pt;et++)de=Ve[et],U.format!==ti?te!==null?Be?t.compressedTexSubImage2D(o.TEXTURE_2D,et,0,0,de.width,de.height,te,de.data):t.compressedTexImage2D(o.TEXTURE_2D,et,ze,de.width,de.height,0,de.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Be?t.texSubImage2D(o.TEXTURE_2D,et,0,0,de.width,de.height,te,Oe,de.data):t.texImage2D(o.TEXTURE_2D,et,ze,de.width,de.height,0,te,Oe,de.data)}else if(U.isDataArrayTexture)Be?(nt&&t.texStorage3D(o.TEXTURE_2D_ARRAY,lt,ze,Y.width,Y.height,Y.depth),t.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,0,Y.width,Y.height,Y.depth,te,Oe,Y.data)):t.texImage3D(o.TEXTURE_2D_ARRAY,0,ze,Y.width,Y.height,Y.depth,0,te,Oe,Y.data);else if(U.isData3DTexture)Be?(nt&&t.texStorage3D(o.TEXTURE_3D,lt,ze,Y.width,Y.height,Y.depth),t.texSubImage3D(o.TEXTURE_3D,0,0,0,0,Y.width,Y.height,Y.depth,te,Oe,Y.data)):t.texImage3D(o.TEXTURE_3D,0,ze,Y.width,Y.height,Y.depth,0,te,Oe,Y.data);else if(U.isFramebufferTexture){if(nt)if(Be)t.texStorage2D(o.TEXTURE_2D,lt,ze,Y.width,Y.height);else{let et=Y.width,pt=Y.height;for(let Ct=0;Ct<lt;Ct++)t.texImage2D(o.TEXTURE_2D,Ct,ze,et,pt,0,te,Oe,null),et>>=1,pt>>=1}}else if(Ve.length>0&&ee){Be&&nt&&t.texStorage2D(o.TEXTURE_2D,lt,ze,Ve[0].width,Ve[0].height);for(let et=0,pt=Ve.length;et<pt;et++)de=Ve[et],Be?t.texSubImage2D(o.TEXTURE_2D,et,0,0,te,Oe,de):t.texImage2D(o.TEXTURE_2D,et,ze,te,Oe,de);U.generateMipmaps=!1}else Be?(nt&&t.texStorage2D(o.TEXTURE_2D,lt,ze,Y.width,Y.height),t.texSubImage2D(o.TEXTURE_2D,0,0,0,te,Oe,Y)):t.texImage2D(o.TEXTURE_2D,0,ze,te,Oe,Y);L(U,ee)&&P(q),O.__version=J.version,U.onUpdate&&U.onUpdate(U)}j.__version=U.version}function he(j,U,ie,q,H){const J=r.convert(ie.format,ie.encoding),O=r.convert(ie.type),W=I(ie.internalFormat,J,O,ie.encoding);n.get(U).__hasExternalTextures||(H===o.TEXTURE_3D||H===o.TEXTURE_2D_ARRAY?t.texImage3D(H,0,W,U.width,U.height,U.depth,0,J,O,null):t.texImage2D(H,0,W,U.width,U.height,0,J,O,null)),t.bindFramebuffer(o.FRAMEBUFFER,j),Se(U)?g.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,q,H,n.get(ie).__webglTexture,0,Ae(U)):(H===o.TEXTURE_2D||H>=o.TEXTURE_CUBE_MAP_POSITIVE_X&&H<=o.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&o.framebufferTexture2D(o.FRAMEBUFFER,q,H,n.get(ie).__webglTexture,0),t.bindFramebuffer(o.FRAMEBUFFER,null)}function ne(j,U,ie){if(o.bindRenderbuffer(o.RENDERBUFFER,j),U.depthBuffer&&!U.stencilBuffer){let q=o.DEPTH_COMPONENT16;if(ie||Se(U)){const H=U.depthTexture;H&&H.isDepthTexture&&(H.type===Ti?q=o.DEPTH_COMPONENT32F:H.type===Vr&&(q=o.DEPTH_COMPONENT24));const J=Ae(U);Se(U)?g.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,J,q,U.width,U.height):o.renderbufferStorageMultisample(o.RENDERBUFFER,J,q,U.width,U.height)}else o.renderbufferStorage(o.RENDERBUFFER,q,U.width,U.height);o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,j)}else if(U.depthBuffer&&U.stencilBuffer){const q=Ae(U);ie&&Se(U)===!1?o.renderbufferStorageMultisample(o.RENDERBUFFER,q,o.DEPTH24_STENCIL8,U.width,U.height):Se(U)?g.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,q,o.DEPTH24_STENCIL8,U.width,U.height):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,U.width,U.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,j)}else{const q=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let H=0;H<q.length;H++){const J=q[H],O=r.convert(J.format,J.encoding),W=r.convert(J.type),Y=I(J.internalFormat,O,W,J.encoding),ee=Ae(U);ie&&Se(U)===!1?o.renderbufferStorageMultisample(o.RENDERBUFFER,ee,Y,U.width,U.height):Se(U)?g.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,ee,Y,U.width,U.height):o.renderbufferStorage(o.RENDERBUFFER,Y,U.width,U.height)}}o.bindRenderbuffer(o.RENDERBUFFER,null)}function me(j){const U=n.get(j),ie=j.isWebGLCubeRenderTarget===!0;if(j.depthTexture&&!U.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");(function(q,H){if(H&&H.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(o.FRAMEBUFFER,q),!H.depthTexture||!H.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(H.depthTexture).__webglTexture&&H.depthTexture.image.width===H.width&&H.depthTexture.image.height===H.height||(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),ae(H.depthTexture,0);const J=n.get(H.depthTexture).__webglTexture,O=Ae(H);if(H.depthTexture.format===Xr)Se(H)?g.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,J,0,O):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,J,0);else{if(H.depthTexture.format!==Ea)throw new Error("Unknown depthTexture format");Se(H)?g.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,J,0,O):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,J,0)}})(U.__webglFramebuffer,j)}else if(ie){U.__webglDepthbuffer=[];for(let q=0;q<6;q++)t.bindFramebuffer(o.FRAMEBUFFER,U.__webglFramebuffer[q]),U.__webglDepthbuffer[q]=o.createRenderbuffer(),ne(U.__webglDepthbuffer[q],j,!1)}else t.bindFramebuffer(o.FRAMEBUFFER,U.__webglFramebuffer),U.__webglDepthbuffer=o.createRenderbuffer(),ne(U.__webglDepthbuffer,j,!1);t.bindFramebuffer(o.FRAMEBUFFER,null)}function Ae(j){return Math.min(f,j.samples)}function Se(j){const U=n.get(j);return c&&j.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&U.__useRenderToTexture!==!1}function Ne(j,U){const ie=j.encoding,q=j.format,H=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||j.format===mh||ie!==rr&&(ie===ht?c===!1?e.has("EXT_sRGB")===!0&&q===ti?(j.format=mh,j.minFilter=rt,j.generateMipmaps=!1):U=im.sRGBToLinear(U):q===ti&&H===yn||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),U}this.allocateTextureUnit=function(){const j=le;return j>=u&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+u),le+=1,j},this.resetTextureUnits=function(){le=0},this.setTexture2D=ae,this.setTexture2DArray=function(j,U){const ie=n.get(j);j.version>0&&ie.__version!==j.version?Re(ie,j,U):t.bindTexture(o.TEXTURE_2D_ARRAY,ie.__webglTexture,o.TEXTURE0+U)},this.setTexture3D=function(j,U){const ie=n.get(j);j.version>0&&ie.__version!==j.version?Re(ie,j,U):t.bindTexture(o.TEXTURE_3D,ie.__webglTexture,o.TEXTURE0+U)},this.setTextureCube=function(j,U){const ie=n.get(j);j.version>0&&ie.__version!==j.version?function(q,H,J){if(H.image.length!==6)return;const O=Ee(q,H),W=H.source;t.bindTexture(o.TEXTURE_CUBE_MAP,q.__webglTexture,o.TEXTURE0+J);const Y=n.get(W);if(W.version!==Y.__version||O===!0){t.activeTexture(o.TEXTURE0+J),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,H.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,H.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE);const ee=H.isCompressedTexture||H.image[0].isCompressedTexture,te=H.image[0]&&H.image[0].isDataTexture,de=[];for(let Ze=0;Ze<6;Ze++)de[Ze]=ee||te?te?H.image[Ze].image:H.image[Ze]:T(H.image[Ze],!1,!0,d),de[Ze]=Ne(H,de[Ze]);const Oe=de[0],ze=R(Oe)||c,Ve=r.convert(H.format,H.encoding),Be=r.convert(H.type),nt=I(H.internalFormat,Ve,Be,H.encoding),lt=c&&H.isVideoTexture!==!0,et=Y.__version===void 0||O===!0;let pt,Ct=V(H,Oe,ze);if(Me(o.TEXTURE_CUBE_MAP,H,ze),ee){lt&&et&&t.texStorage2D(o.TEXTURE_CUBE_MAP,Ct,nt,Oe.width,Oe.height);for(let Ze=0;Ze<6;Ze++){pt=de[Ze].mipmaps;for(let Dt=0;Dt<pt.length;Dt++){const ue=pt[Dt];H.format!==ti?Ve!==null?lt?t.compressedTexSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt,0,0,ue.width,ue.height,Ve,ue.data):t.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt,nt,ue.width,ue.height,0,ue.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):lt?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt,0,0,ue.width,ue.height,Ve,Be,ue.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt,nt,ue.width,ue.height,0,Ve,Be,ue.data)}}}else{pt=H.mipmaps,lt&&et&&(pt.length>0&&Ct++,t.texStorage2D(o.TEXTURE_CUBE_MAP,Ct,nt,de[0].width,de[0].height));for(let Ze=0;Ze<6;Ze++)if(te){lt?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,0,0,de[Ze].width,de[Ze].height,Ve,Be,de[Ze].data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,nt,de[Ze].width,de[Ze].height,0,Ve,Be,de[Ze].data);for(let Dt=0;Dt<pt.length;Dt++){const ue=pt[Dt].image[Ze].image;lt?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt+1,0,0,ue.width,ue.height,Ve,Be,ue.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt+1,nt,ue.width,ue.height,0,Ve,Be,ue.data)}}else{lt?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,0,0,Ve,Be,de[Ze]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,nt,Ve,Be,de[Ze]);for(let Dt=0;Dt<pt.length;Dt++){const ue=pt[Dt];lt?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt+1,0,0,Ve,Be,ue.image[Ze]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,Dt+1,nt,Ve,Be,ue.image[Ze])}}}L(H,ze)&&P(o.TEXTURE_CUBE_MAP),Y.__version=W.version,H.onUpdate&&H.onUpdate(H)}q.__version=H.version}(ie,j,U):t.bindTexture(o.TEXTURE_CUBE_MAP,ie.__webglTexture,o.TEXTURE0+U)},this.rebindTextures=function(j,U,ie){const q=n.get(j);U!==void 0&&he(q.__webglFramebuffer,j,j.texture,o.COLOR_ATTACHMENT0,o.TEXTURE_2D),ie!==void 0&&me(j)},this.setupRenderTarget=function(j){const U=j.texture,ie=n.get(j),q=n.get(U);j.addEventListener("dispose",F),j.isWebGLMultipleRenderTargets!==!0&&(q.__webglTexture===void 0&&(q.__webglTexture=o.createTexture()),q.__version=U.version,s.memory.textures++);const H=j.isWebGLCubeRenderTarget===!0,J=j.isWebGLMultipleRenderTargets===!0,O=R(j)||c;if(H){ie.__webglFramebuffer=[];for(let W=0;W<6;W++)ie.__webglFramebuffer[W]=o.createFramebuffer()}else{if(ie.__webglFramebuffer=o.createFramebuffer(),J)if(i.drawBuffers){const W=j.texture;for(let Y=0,ee=W.length;Y<ee;Y++){const te=n.get(W[Y]);te.__webglTexture===void 0&&(te.__webglTexture=o.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&j.samples>0&&Se(j)===!1){const W=J?U:[U];ie.__webglMultisampledFramebuffer=o.createFramebuffer(),ie.__webglColorRenderbuffer=[],t.bindFramebuffer(o.FRAMEBUFFER,ie.__webglMultisampledFramebuffer);for(let Y=0;Y<W.length;Y++){const ee=W[Y];ie.__webglColorRenderbuffer[Y]=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,ie.__webglColorRenderbuffer[Y]);const te=r.convert(ee.format,ee.encoding),de=r.convert(ee.type),Oe=I(ee.internalFormat,te,de,ee.encoding,j.isXRRenderTarget===!0),ze=Ae(j);o.renderbufferStorageMultisample(o.RENDERBUFFER,ze,Oe,j.width,j.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+Y,o.RENDERBUFFER,ie.__webglColorRenderbuffer[Y])}o.bindRenderbuffer(o.RENDERBUFFER,null),j.depthBuffer&&(ie.__webglDepthRenderbuffer=o.createRenderbuffer(),ne(ie.__webglDepthRenderbuffer,j,!0)),t.bindFramebuffer(o.FRAMEBUFFER,null)}}if(H){t.bindTexture(o.TEXTURE_CUBE_MAP,q.__webglTexture),Me(o.TEXTURE_CUBE_MAP,U,O);for(let W=0;W<6;W++)he(ie.__webglFramebuffer[W],j,U,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+W);L(U,O)&&P(o.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(J){const W=j.texture;for(let Y=0,ee=W.length;Y<ee;Y++){const te=W[Y],de=n.get(te);t.bindTexture(o.TEXTURE_2D,de.__webglTexture),Me(o.TEXTURE_2D,te,O),he(ie.__webglFramebuffer,j,te,o.COLOR_ATTACHMENT0+Y,o.TEXTURE_2D),L(te,O)&&P(o.TEXTURE_2D)}t.unbindTexture()}else{let W=o.TEXTURE_2D;(j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(c?W=j.isWebGL3DRenderTarget?o.TEXTURE_3D:o.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(W,q.__webglTexture),Me(W,U,O),he(ie.__webglFramebuffer,j,U,o.COLOR_ATTACHMENT0,W),L(U,O)&&P(W),t.unbindTexture()}j.depthBuffer&&me(j)},this.updateRenderTargetMipmap=function(j){const U=R(j)||c,ie=j.isWebGLMultipleRenderTargets===!0?j.texture:[j.texture];for(let q=0,H=ie.length;q<H;q++){const J=ie[q];if(L(J,U)){const O=j.isWebGLCubeRenderTarget?o.TEXTURE_CUBE_MAP:o.TEXTURE_2D,W=n.get(J).__webglTexture;t.bindTexture(O,W),P(O),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function(j){if(c&&j.samples>0&&Se(j)===!1){const U=j.isWebGLMultipleRenderTargets?j.texture:[j.texture],ie=j.width,q=j.height;let H=o.COLOR_BUFFER_BIT;const J=[],O=j.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,W=n.get(j),Y=j.isWebGLMultipleRenderTargets===!0;if(Y)for(let ee=0;ee<U.length;ee++)t.bindFramebuffer(o.FRAMEBUFFER,W.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+ee,o.RENDERBUFFER,null),t.bindFramebuffer(o.FRAMEBUFFER,W.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+ee,o.TEXTURE_2D,null,0);t.bindFramebuffer(o.READ_FRAMEBUFFER,W.__webglMultisampledFramebuffer),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,W.__webglFramebuffer);for(let ee=0;ee<U.length;ee++){J.push(o.COLOR_ATTACHMENT0+ee),j.depthBuffer&&J.push(O);const te=W.__ignoreDepthValues!==void 0&&W.__ignoreDepthValues;if(te===!1&&(j.depthBuffer&&(H|=o.DEPTH_BUFFER_BIT),j.stencilBuffer&&(H|=o.STENCIL_BUFFER_BIT)),Y&&o.framebufferRenderbuffer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,W.__webglColorRenderbuffer[ee]),te===!0&&(o.invalidateFramebuffer(o.READ_FRAMEBUFFER,[O]),o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,[O])),Y){const de=n.get(U[ee]).__webglTexture;o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,de,0)}o.blitFramebuffer(0,0,ie,q,0,0,ie,q,H,o.NEAREST),v&&o.invalidateFramebuffer(o.READ_FRAMEBUFFER,J)}if(t.bindFramebuffer(o.READ_FRAMEBUFFER,null),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),Y)for(let ee=0;ee<U.length;ee++){t.bindFramebuffer(o.FRAMEBUFFER,W.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+ee,o.RENDERBUFFER,W.__webglColorRenderbuffer[ee]);const te=n.get(U[ee]).__webglTexture;t.bindFramebuffer(o.FRAMEBUFFER,W.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+ee,o.TEXTURE_2D,te,0)}t.bindFramebuffer(o.DRAW_FRAMEBUFFER,W.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=me,this.setupFrameBufferTexture=he,this.useMultisampledRTT=Se}function px(o,e,t){const n=t.isWebGL2;return{convert:function(i,r=null){let s;if(i===yn)return o.UNSIGNED_BYTE;if(i===ny)return o.UNSIGNED_SHORT_4_4_4_4;if(i===iy)return o.UNSIGNED_SHORT_5_5_5_1;if(i===$1)return o.BYTE;if(i===ey)return o.SHORT;if(i===ah)return o.UNSIGNED_SHORT;if(i===ty)return o.INT;if(i===Vr)return o.UNSIGNED_INT;if(i===Ti)return o.FLOAT;if(i===di)return n?o.HALF_FLOAT:(s=e.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(i===ry)return o.ALPHA;if(i===ti)return o.RGBA;if(i===ay)return o.LUMINANCE;if(i===sy)return o.LUMINANCE_ALPHA;if(i===Xr)return o.DEPTH_COMPONENT;if(i===Ea)return o.DEPTH_STENCIL;if(i===mh)return s=e.get("EXT_sRGB"),s!==null?s.SRGB_ALPHA_EXT:null;if(i===wf)return o.RED;if(i===oy)return o.RED_INTEGER;if(i===ly)return o.RG;if(i===cy)return o.RG_INTEGER;if(i===uy)return o.RGBA_INTEGER;if(i===sh||i===oh||i===lh||i===ch)if(r===ht){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s===null)return null;if(i===sh)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===oh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===lh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===ch)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),s===null)return null;if(i===sh)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===oh)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===lh)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===ch)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===Mf||i===Tf||i===Ef||i===Af){if(s=e.get("WEBGL_compressed_texture_pvrtc"),s===null)return null;if(i===Mf)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Tf)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Ef)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Af)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===hy)return s=e.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(i===Rf||i===Lf){if(s=e.get("WEBGL_compressed_texture_etc"),s===null)return null;if(i===Rf)return r===ht?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===Lf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(i===Pf||i===Cf||i===Df||i===Of||i===If||i===Nf||i===kf||i===Ff||i===Uf||i===zf||i===Bf||i===Hf||i===jf||i===Gf){if(s=e.get("WEBGL_compressed_texture_astc"),s===null)return null;if(i===Pf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Cf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Df)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===Of)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===If)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===Nf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===kf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===Ff)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===Uf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===zf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===Bf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===Hf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===jf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===Gf)return r===ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===uh){if(s=e.get("EXT_texture_compression_bptc"),s===null)return null;if(i===uh)return r===ht?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(i===dy||i===Vf||i===Wf||i===Xf){if(s=e.get("EXT_texture_compression_rgtc"),s===null)return null;if(i===uh)return s.COMPRESSED_RED_RGTC1_EXT;if(i===Vf)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===Wf)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Xf)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Wr?n?o.UNSIGNED_INT_24_8:(s=e.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null):o[i]!==void 0?o[i]:null}}}class fx extends Qt{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Vn extends ot{constructor(){super(),this.isGroup=!0,this.type="Group"}}const mA={type:"move"};class Pm{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Vn,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Vn,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new C,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new C),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Vn,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new C,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new C),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const c=this._targetRay,u=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){s=!0;for(const y of e.hand.values()){const S=t.getJointPose(y,n),M=this._getHandJoint(d,y);S!==null&&(M.matrix.fromArray(S.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),M.jointRadius=S.radius),M.visible=S!==null}const p=d.joints["index-finger-tip"],f=d.joints["thumb-tip"],g=p.position.distanceTo(f.position),v=.02,b=.005;d.inputState.pinching&&g>v+b?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&g<=v-b&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(u.matrix.fromArray(r.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),r.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(r.linearVelocity)):u.hasLinearVelocity=!1,r.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(r.angularVelocity)):u.hasAngularVelocity=!1));c!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&r!==null&&(i=r),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(mA)))}return c!==null&&(c.visible=i!==null),u!==null&&(u.visible=r!==null),d!==null&&(d.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Vn;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Ec extends Ut{constructor(e,t,n,i,r,s,c,u,d,p){if((p=p!==void 0?p:Xr)!==Xr&&p!==Ea)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&p===Xr&&(n=Vr),n===void 0&&p===Ea&&(n=Wr),super(null,i,r,s,c,u,p,n,d),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:At,this.minFilter=u!==void 0?u:At,this.flipY=!1,this.generateMipmaps=!1}}class gA extends zi{constructor(e,t){super();const n=this;let i=null,r=1,s=null,c="local-floor",u=1,d=null,p=null,f=null,g=null,v=null,b=null;const y=t.getContextAttributes();let S=null,M=null;const w=[],T=[],R=new Set,L=new Map,P=new Qt;P.layers.enable(1),P.viewport=new Qe;const I=new Qt;I.layers.enable(2),I.viewport=new Qe;const V=[P,I],z=new fx;z.layers.enable(1),z.layers.enable(2);let G=null,F=null;function $(he){const ne=T.indexOf(he.inputSource);if(ne===-1)return;const me=w[ne];me!==void 0&&me.dispatchEvent({type:he.type,data:he.inputSource})}function le(){i.removeEventListener("select",$),i.removeEventListener("selectstart",$),i.removeEventListener("selectend",$),i.removeEventListener("squeeze",$),i.removeEventListener("squeezestart",$),i.removeEventListener("squeezeend",$),i.removeEventListener("end",le),i.removeEventListener("inputsourceschange",ae);for(let he=0;he<w.length;he++){const ne=T[he];ne!==null&&(T[he]=null,w[he].disconnect(ne))}G=null,F=null,e.setRenderTarget(S),v=null,g=null,f=null,i=null,M=null,Re.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function ae(he){for(let ne=0;ne<he.removed.length;ne++){const me=he.removed[ne],Ae=T.indexOf(me);Ae>=0&&(T[Ae]=null,w[Ae].disconnect(me))}for(let ne=0;ne<he.added.length;ne++){const me=he.added[ne];let Ae=T.indexOf(me);if(Ae===-1){for(let Ne=0;Ne<w.length;Ne++){if(Ne>=T.length){T.push(me),Ae=Ne;break}if(T[Ne]===null){T[Ne]=me,Ae=Ne;break}}if(Ae===-1)break}const Se=w[Ae];Se&&Se.connect(me)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(he){let ne=w[he];return ne===void 0&&(ne=new Pm,w[he]=ne),ne.getTargetRaySpace()},this.getControllerGrip=function(he){let ne=w[he];return ne===void 0&&(ne=new Pm,w[he]=ne),ne.getGripSpace()},this.getHand=function(he){let ne=w[he];return ne===void 0&&(ne=new Pm,w[he]=ne),ne.getHandSpace()},this.setFramebufferScaleFactor=function(he){r=he,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(he){c=he,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||s},this.setReferenceSpace=function(he){d=he},this.getBaseLayer=function(){return g!==null?g:v},this.getBinding=function(){return f},this.getFrame=function(){return b},this.getSession=function(){return i},this.setSession=async function(he){if(i=he,i!==null){if(S=e.getRenderTarget(),i.addEventListener("select",$),i.addEventListener("selectstart",$),i.addEventListener("selectend",$),i.addEventListener("squeeze",$),i.addEventListener("squeezestart",$),i.addEventListener("squeezeend",$),i.addEventListener("end",le),i.addEventListener("inputsourceschange",ae),y.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ne={antialias:i.renderState.layers!==void 0||y.antialias,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:r};v=new XRWebGLLayer(i,t,ne),i.updateRenderState({baseLayer:v}),M=new Rt(v.framebufferWidth,v.framebufferHeight,{format:ti,type:yn,encoding:e.outputEncoding,stencilBuffer:y.stencil})}else{let ne=null,me=null,Ae=null;y.depth&&(Ae=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ne=y.stencil?Ea:Xr,me=y.stencil?Wr:Vr);const Se={colorFormat:t.RGBA8,depthFormat:Ae,scaleFactor:r};f=new XRWebGLBinding(i,t),g=f.createProjectionLayer(Se),i.updateRenderState({layers:[g]}),M=new Rt(g.textureWidth,g.textureHeight,{format:ti,type:yn,depthTexture:new Ec(g.textureWidth,g.textureHeight,me,void 0,void 0,void 0,void 0,void 0,void 0,ne),stencilBuffer:y.stencil,encoding:e.outputEncoding,samples:y.antialias?4:0}),e.properties.get(M).__ignoreDepthValues=g.ignoreDepthValues}M.isXRRenderTarget=!0,this.setFoveation(u),d=null,s=await i.requestReferenceSpace(c),Re.setContext(i),Re.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const ye=new C,pe=new C;function Me(he,ne){ne===null?he.matrixWorld.copy(he.matrix):he.matrixWorld.multiplyMatrices(ne.matrixWorld,he.matrix),he.matrixWorldInverse.copy(he.matrixWorld).invert()}this.updateCamera=function(he){if(i===null)return;z.near=I.near=P.near=he.near,z.far=I.far=P.far=he.far,G===z.near&&F===z.far||(i.updateRenderState({depthNear:z.near,depthFar:z.far}),G=z.near,F=z.far);const ne=he.parent,me=z.cameras;Me(z,ne);for(let Se=0;Se<me.length;Se++)Me(me[Se],ne);z.matrixWorld.decompose(z.position,z.quaternion,z.scale),he.matrix.copy(z.matrix),he.matrix.decompose(he.position,he.quaternion,he.scale);const Ae=he.children;for(let Se=0,Ne=Ae.length;Se<Ne;Se++)Ae[Se].updateMatrixWorld(!0);me.length===2?function(Se,Ne,j){ye.setFromMatrixPosition(Ne.matrixWorld),pe.setFromMatrixPosition(j.matrixWorld);const U=ye.distanceTo(pe),ie=Ne.projectionMatrix.elements,q=j.projectionMatrix.elements,H=ie[14]/(ie[10]-1),J=ie[14]/(ie[10]+1),O=(ie[9]+1)/ie[5],W=(ie[9]-1)/ie[5],Y=(ie[8]-1)/ie[0],ee=(q[8]+1)/q[0],te=H*Y,de=H*ee,Oe=U/(-Y+ee),ze=Oe*-Y;Ne.matrixWorld.decompose(Se.position,Se.quaternion,Se.scale),Se.translateX(ze),Se.translateZ(Oe),Se.matrixWorld.compose(Se.position,Se.quaternion,Se.scale),Se.matrixWorldInverse.copy(Se.matrixWorld).invert();const Ve=H+Oe,Be=J+Oe,nt=te-ze,lt=de+(U-ze),et=O*J/Be*Ve,pt=W*J/Be*Ve;Se.projectionMatrix.makePerspective(nt,lt,et,pt,Ve,Be)}(z,P,I):z.projectionMatrix.copy(P.projectionMatrix)},this.getCamera=function(){return z},this.getFoveation=function(){if(g!==null||v!==null)return u},this.setFoveation=function(he){u=he,g!==null&&(g.fixedFoveation=he),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=he)},this.getPlanes=function(){return R};let Ee=null;const Re=new Hy;Re.setAnimationLoop(function(he,ne){if(p=ne.getViewerPose(d||s),b=ne,p!==null){const me=p.views;v!==null&&(e.setRenderTargetFramebuffer(M,v.framebuffer),e.setRenderTarget(M));let Ae=!1;me.length!==z.cameras.length&&(z.cameras.length=0,Ae=!0);for(let Se=0;Se<me.length;Se++){const Ne=me[Se];let j=null;if(v!==null)j=v.getViewport(Ne);else{const ie=f.getViewSubImage(g,Ne);j=ie.viewport,Se===0&&(e.setRenderTargetTextures(M,ie.colorTexture,g.ignoreDepthValues?void 0:ie.depthStencilTexture),e.setRenderTarget(M))}let U=V[Se];U===void 0&&(U=new Qt,U.layers.enable(Se),U.viewport=new Qe,V[Se]=U),U.matrix.fromArray(Ne.transform.matrix),U.projectionMatrix.fromArray(Ne.projectionMatrix),U.viewport.set(j.x,j.y,j.width,j.height),Se===0&&z.matrix.copy(U.matrix),Ae===!0&&z.cameras.push(U)}}for(let me=0;me<w.length;me++){const Ae=T[me],Se=w[me];Ae!==null&&Se!==void 0&&Se.update(Ae,ne,d||s)}if(Ee&&Ee(he,ne),ne.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:ne.detectedPlanes});let me=null;for(const Ae of R)ne.detectedPlanes.has(Ae)||(me===null&&(me=[]),me.push(Ae));if(me!==null)for(const Ae of me)R.delete(Ae),L.delete(Ae),n.dispatchEvent({type:"planeremoved",data:Ae});for(const Ae of ne.detectedPlanes)if(R.has(Ae)){const Se=L.get(Ae);Ae.lastChangedTime>Se&&(L.set(Ae,Ae.lastChangedTime),n.dispatchEvent({type:"planechanged",data:Ae}))}else R.add(Ae),L.set(Ae,ne.lastChangedTime),n.dispatchEvent({type:"planeadded",data:Ae})}b=null}),this.setAnimationLoop=function(he){Ee=he},this.dispose=function(){}}}function vA(o,e){function t(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,i.side===xe&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),i.side===xe&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);const r=e.get(i).envMap;if(r&&(n.envMap.value=r,n.flipEnvMap.value=r.isCubeTexture&&r.isRenderTargetTexture===!1?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;const u=o.useLegacyLights===!0?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*u}let s,c;i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?s=i.map:i.specularMap?s=i.specularMap:i.displacementMap?s=i.displacementMap:i.normalMap?s=i.normalMap:i.bumpMap?s=i.bumpMap:i.roughnessMap?s=i.roughnessMap:i.metalnessMap?s=i.metalnessMap:i.alphaMap?s=i.alphaMap:i.emissiveMap?s=i.emissiveMap:i.clearcoatMap?s=i.clearcoatMap:i.clearcoatNormalMap?s=i.clearcoatNormalMap:i.clearcoatRoughnessMap?s=i.clearcoatRoughnessMap:i.iridescenceMap?s=i.iridescenceMap:i.iridescenceThicknessMap?s=i.iridescenceThicknessMap:i.specularIntensityMap?s=i.specularIntensityMap:i.specularColorMap?s=i.specularColorMap:i.transmissionMap?s=i.transmissionMap:i.thicknessMap?s=i.thicknessMap:i.sheenColorMap?s=i.sheenColorMap:i.sheenRoughnessMap&&(s=i.sheenRoughnessMap),s!==void 0&&(s.isWebGLRenderTarget&&(s=s.texture),s.matrixAutoUpdate===!0&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),i.aoMap?c=i.aoMap:i.lightMap&&(c=i.lightMap),c!==void 0&&(c.isWebGLRenderTarget&&(c=c.texture),c.matrixAutoUpdate===!0&&c.updateMatrix(),n.uv2Transform.value.copy(c.matrix))}return{refreshFogUniforms:function(n,i){i.color.getRGB(n.fogColor.value,Uy(o)),i.isFog?(n.fogNear.value=i.near,n.fogFar.value=i.far):i.isFogExp2&&(n.fogDensity.value=i.density)},refreshMaterialUniforms:function(n,i,r,s,c){i.isMeshBasicMaterial||i.isMeshLambertMaterial?t(n,i):i.isMeshToonMaterial?(t(n,i),function(u,d){d.gradientMap&&(u.gradientMap.value=d.gradientMap)}(n,i)):i.isMeshPhongMaterial?(t(n,i),function(u,d){u.specular.value.copy(d.specular),u.shininess.value=Math.max(d.shininess,1e-4)}(n,i)):i.isMeshStandardMaterial?(t(n,i),function(u,d){u.roughness.value=d.roughness,u.metalness.value=d.metalness,d.roughnessMap&&(u.roughnessMap.value=d.roughnessMap),d.metalnessMap&&(u.metalnessMap.value=d.metalnessMap),e.get(d).envMap&&(u.envMapIntensity.value=d.envMapIntensity)}(n,i),i.isMeshPhysicalMaterial&&function(u,d,p){u.ior.value=d.ior,d.sheen>0&&(u.sheenColor.value.copy(d.sheenColor).multiplyScalar(d.sheen),u.sheenRoughness.value=d.sheenRoughness,d.sheenColorMap&&(u.sheenColorMap.value=d.sheenColorMap),d.sheenRoughnessMap&&(u.sheenRoughnessMap.value=d.sheenRoughnessMap)),d.clearcoat>0&&(u.clearcoat.value=d.clearcoat,u.clearcoatRoughness.value=d.clearcoatRoughness,d.clearcoatMap&&(u.clearcoatMap.value=d.clearcoatMap),d.clearcoatRoughnessMap&&(u.clearcoatRoughnessMap.value=d.clearcoatRoughnessMap),d.clearcoatNormalMap&&(u.clearcoatNormalScale.value.copy(d.clearcoatNormalScale),u.clearcoatNormalMap.value=d.clearcoatNormalMap,d.side===xe&&u.clearcoatNormalScale.value.negate())),d.iridescence>0&&(u.iridescence.value=d.iridescence,u.iridescenceIOR.value=d.iridescenceIOR,u.iridescenceThicknessMinimum.value=d.iridescenceThicknessRange[0],u.iridescenceThicknessMaximum.value=d.iridescenceThicknessRange[1],d.iridescenceMap&&(u.iridescenceMap.value=d.iridescenceMap),d.iridescenceThicknessMap&&(u.iridescenceThicknessMap.value=d.iridescenceThicknessMap)),d.transmission>0&&(u.transmission.value=d.transmission,u.transmissionSamplerMap.value=p.texture,u.transmissionSamplerSize.value.set(p.width,p.height),d.transmissionMap&&(u.transmissionMap.value=d.transmissionMap),u.thickness.value=d.thickness,d.thicknessMap&&(u.thicknessMap.value=d.thicknessMap),u.attenuationDistance.value=d.attenuationDistance,u.attenuationColor.value.copy(d.attenuationColor)),u.specularIntensity.value=d.specularIntensity,u.specularColor.value.copy(d.specularColor),d.specularIntensityMap&&(u.specularIntensityMap.value=d.specularIntensityMap),d.specularColorMap&&(u.specularColorMap.value=d.specularColorMap)}(n,i,c)):i.isMeshMatcapMaterial?(t(n,i),function(u,d){d.matcap&&(u.matcap.value=d.matcap)}(n,i)):i.isMeshDepthMaterial?t(n,i):i.isMeshDistanceMaterial?(t(n,i),function(u,d){u.referencePosition.value.copy(d.referencePosition),u.nearDistance.value=d.nearDistance,u.farDistance.value=d.farDistance}(n,i)):i.isMeshNormalMaterial?t(n,i):i.isLineBasicMaterial?(function(u,d){u.diffuse.value.copy(d.color),u.opacity.value=d.opacity}(n,i),i.isLineDashedMaterial&&function(u,d){u.dashSize.value=d.dashSize,u.totalSize.value=d.dashSize+d.gapSize,u.scale.value=d.scale}(n,i)):i.isPointsMaterial?function(u,d,p,f){u.diffuse.value.copy(d.color),u.opacity.value=d.opacity,u.size.value=d.size*p,u.scale.value=.5*f,d.map&&(u.map.value=d.map),d.alphaMap&&(u.alphaMap.value=d.alphaMap),d.alphaTest>0&&(u.alphaTest.value=d.alphaTest);let g;d.map?g=d.map:d.alphaMap&&(g=d.alphaMap),g!==void 0&&(g.matrixAutoUpdate===!0&&g.updateMatrix(),u.uvTransform.value.copy(g.matrix))}(n,i,r,s):i.isSpriteMaterial?function(u,d){u.diffuse.value.copy(d.color),u.opacity.value=d.opacity,u.rotation.value=d.rotation,d.map&&(u.map.value=d.map),d.alphaMap&&(u.alphaMap.value=d.alphaMap),d.alphaTest>0&&(u.alphaTest.value=d.alphaTest);let p;d.map?p=d.map:d.alphaMap&&(p=d.alphaMap),p!==void 0&&(p.matrixAutoUpdate===!0&&p.updateMatrix(),u.uvTransform.value.copy(p.matrix))}(n,i):i.isShadowMaterial?(n.color.value.copy(i.color),n.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function yA(o,e,t,n){let i={},r={},s=[];const c=t.isWebGL2?o.getParameter(o.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(f,g,v){const b=f.value;if(v[g]===void 0){if(typeof b=="number")v[g]=b;else{const y=Array.isArray(b)?b:[b],S=[];for(let M=0;M<y.length;M++)S.push(y[M].clone());v[g]=S}return!0}if(typeof b=="number"){if(v[g]!==b)return v[g]=b,!0}else{const y=Array.isArray(v[g])?v[g]:[v[g]],S=Array.isArray(b)?b:[b];for(let M=0;M<y.length;M++){const w=y[M];if(w.equals(S[M])===!1)return w.copy(S[M]),!0}}return!1}function d(f){const g={boundary:0,storage:0};return typeof f=="number"?(g.boundary=4,g.storage=4):f.isVector2?(g.boundary=8,g.storage=8):f.isVector3||f.isColor?(g.boundary=16,g.storage=12):f.isVector4?(g.boundary=16,g.storage=16):f.isMatrix3?(g.boundary=48,g.storage=48):f.isMatrix4?(g.boundary=64,g.storage=64):f.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",f),g}function p(f){const g=f.target;g.removeEventListener("dispose",p);const v=s.indexOf(g.__bindingPointIndex);s.splice(v,1),o.deleteBuffer(i[g.id]),delete i[g.id],delete r[g.id]}return{bind:function(f,g){const v=g.program;n.uniformBlockBinding(f,v)},update:function(f,g){let v=i[f.id];v===void 0&&(function(S){const M=S.uniforms;let w=0;const T=16;let R=0;for(let L=0,P=M.length;L<P;L++){const I=M[L],V={boundary:0,storage:0},z=Array.isArray(I.value)?I.value:[I.value];for(let G=0,F=z.length;G<F;G++){const $=d(z[G]);V.boundary+=$.boundary,V.storage+=$.storage}I.__data=new Float32Array(V.storage/Float32Array.BYTES_PER_ELEMENT),I.__offset=w,L>0&&(R=w%T,R!==0&&T-R-V.boundary<0&&(w+=T-R,I.__offset=w)),w+=V.storage}R=w%T,R>0&&(w+=T-R),S.__size=w,S.__cache={}}(f),v=function(S){const M=function(){for(let L=0;L<c;L++)if(s.indexOf(L)===-1)return s.push(L),L;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();S.__bindingPointIndex=M;const w=o.createBuffer(),T=S.__size,R=S.usage;return o.bindBuffer(o.UNIFORM_BUFFER,w),o.bufferData(o.UNIFORM_BUFFER,T,R),o.bindBuffer(o.UNIFORM_BUFFER,null),o.bindBufferBase(o.UNIFORM_BUFFER,M,w),w}(f),i[f.id]=v,f.addEventListener("dispose",p));const b=g.program;n.updateUBOMapping(f,b);const y=e.render.frame;r[f.id]!==y&&(function(S){const M=i[S.id],w=S.uniforms,T=S.__cache;o.bindBuffer(o.UNIFORM_BUFFER,M);for(let R=0,L=w.length;R<L;R++){const P=w[R];if(u(P,R,T)===!0){const I=P.__offset,V=Array.isArray(P.value)?P.value:[P.value];let z=0;for(let G=0;G<V.length;G++){const F=V[G],$=d(F);typeof F=="number"?(P.__data[0]=F,o.bufferSubData(o.UNIFORM_BUFFER,I+z,P.__data)):F.isMatrix3?(P.__data[0]=F.elements[0],P.__data[1]=F.elements[1],P.__data[2]=F.elements[2],P.__data[3]=F.elements[0],P.__data[4]=F.elements[3],P.__data[5]=F.elements[4],P.__data[6]=F.elements[5],P.__data[7]=F.elements[0],P.__data[8]=F.elements[6],P.__data[9]=F.elements[7],P.__data[10]=F.elements[8],P.__data[11]=F.elements[0]):(F.toArray(P.__data,z),z+=$.storage/Float32Array.BYTES_PER_ELEMENT)}o.bufferSubData(o.UNIFORM_BUFFER,I,P.__data)}}o.bindBuffer(o.UNIFORM_BUFFER,null)}(f),r[f.id]=y)},dispose:function(){for(const f in i)o.deleteBuffer(i[f]);s=[],i={},r={}}}}function Bh(o={}){this.isWebGLRenderer=!0;const e=o.canvas!==void 0?o.canvas:function(){const X=pc("canvas");return X.style.display="block",X}(),t=o.context!==void 0?o.context:null,n=o.depth===void 0||o.depth,i=o.stencil===void 0||o.stencil,r=o.antialias!==void 0&&o.antialias,s=o.premultipliedAlpha===void 0||o.premultipliedAlpha,c=o.preserveDrawingBuffer!==void 0&&o.preserveDrawingBuffer,u=o.powerPreference!==void 0?o.powerPreference:"default",d=o.failIfMajorPerformanceCaveat!==void 0&&o.failIfMajorPerformanceCaveat;let p;p=t!==null?t.getContextAttributes().alpha:o.alpha!==void 0&&o.alpha;let f=null,g=null;const v=[],b=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=rr,this.useLegacyLights=!0,this.toneMapping=Er,this.toneMappingExposure=1;const y=this;let S=!1,M=0,w=0,T=null,R=-1,L=null;const P=new Qe,I=new Qe;let V=null,z=e.width,G=e.height,F=1,$=null,le=null;const ae=new Qe(0,0,z,G),ye=new Qe(0,0,z,G);let pe=!1;const Me=new wc;let Ee=!1,Re=!1,he=null;const ne=new De,me=new C,Ae={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Se(){return T===null?F:1}let Ne,j,U,ie,q,H,J,O,W,Y,ee,te,de,Oe,ze,Ve,Be,nt,lt,et,pt,Ct,Ze,Dt,ue=t;function Qa(X,be){for(let Te=0;Te<X.length;Te++){const we=X[Te],Le=e.getContext(we,be);if(Le!==null)return Le}return null}try{const X={alpha:!0,depth:n,stencil:i,antialias:r,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${ve}`),e.addEventListener("webglcontextlost",H_,!1),e.addEventListener("webglcontextrestored",j_,!1),e.addEventListener("webglcontextcreationerror",G_,!1),ue===null){const be=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&be.shift(),ue=Qa(be,X),ue===null)throw Qa(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ue.getShaderPrecisionFormat===void 0&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}function Za(){Ne=new Y3(ue),j=new V3(ue,Ne,o),Ne.init(j),Ct=new px(ue,Ne,j),U=new pA(ue,Ne,j),ie=new K3(ue),q=new nA,H=new fA(ue,Ne,U,q,j,Ct,ie),J=new X3(y),O=new q3(y),W=new B3(ue,j),Ze=new j3(ue,Ne,W,j),Y=new Q3(ue,W,ie,Ze),ee=new tE(ue,Y,W,ie),lt=new eE(ue,j,H),Ve=new W3(q),te=new tA(y,J,O,Ne,j,Ze,Ve),de=new vA(y,q),Oe=new rA,ze=new cA(Ne,j),nt=new H3(y,J,O,U,ee,p,s),Be=new dA(y,ee,j),Dt=new yA(ue,ie,j,U),et=new G3(ue,Ne,ie,j),pt=new Z3(ue,Ne,ie,j),ie.programs=te.programs,y.capabilities=j,y.extensions=Ne,y.properties=q,y.renderLists=Oe,y.shadowMap=Be,y.state=U,y.info=ie}Za();const Di=new gA(y,ue);function H_(X){X.preventDefault(),S=!0}function j_(){S=!1;const X=ie.autoReset,be=Be.enabled,Te=Be.autoUpdate,we=Be.needsUpdate,Le=Be.type;Za(),ie.autoReset=X,Be.enabled=be,Be.autoUpdate=Te,Be.needsUpdate=we,Be.type=Le}function G_(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function V_(X){const be=X.target;be.removeEventListener("dispose",V_),function(Te){(function(we){const Le=q.get(we).programs;Le!==void 0&&(Le.forEach(function(Ye){te.releaseProgram(Ye)}),we.isShaderMaterial&&te.releaseShaderCache(we))})(Te),q.remove(Te)}(be)}this.xr=Di,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const X=Ne.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){const X=Ne.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(X){X!==void 0&&(F=X,this.setSize(z,G,!1))},this.getSize=function(X){return X.set(z,G)},this.setSize=function(X,be,Te=!0){Di.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(z=X,G=be,e.width=Math.floor(X*F),e.height=Math.floor(be*F),Te===!0&&(e.style.width=X+"px",e.style.height=be+"px"),this.setViewport(0,0,X,be))},this.getDrawingBufferSize=function(X){return X.set(z*F,G*F).floor()},this.setDrawingBufferSize=function(X,be,Te){z=X,G=be,F=Te,e.width=Math.floor(X*Te),e.height=Math.floor(be*Te),this.setViewport(0,0,X,be)},this.getCurrentViewport=function(X){return X.copy(P)},this.getViewport=function(X){return X.copy(ae)},this.setViewport=function(X,be,Te,we){X.isVector4?ae.set(X.x,X.y,X.z,X.w):ae.set(X,be,Te,we),U.viewport(P.copy(ae).multiplyScalar(F).floor())},this.getScissor=function(X){return X.copy(ye)},this.setScissor=function(X,be,Te,we){X.isVector4?ye.set(X.x,X.y,X.z,X.w):ye.set(X,be,Te,we),U.scissor(I.copy(ye).multiplyScalar(F).floor())},this.getScissorTest=function(){return pe},this.setScissorTest=function(X){U.setScissorTest(pe=X)},this.setOpaqueSort=function(X){$=X},this.setTransparentSort=function(X){le=X},this.getClearColor=function(X){return X.copy(nt.getClearColor())},this.setClearColor=function(){nt.setClearColor.apply(nt,arguments)},this.getClearAlpha=function(){return nt.getClearAlpha()},this.setClearAlpha=function(){nt.setClearAlpha.apply(nt,arguments)},this.clear=function(X=!0,be=!0,Te=!0){let we=0;X&&(we|=ue.COLOR_BUFFER_BIT),be&&(we|=ue.DEPTH_BUFFER_BIT),Te&&(we|=ue.STENCIL_BUFFER_BIT),ue.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",H_,!1),e.removeEventListener("webglcontextrestored",j_,!1),e.removeEventListener("webglcontextcreationerror",G_,!1),Oe.dispose(),ze.dispose(),q.dispose(),J.dispose(),O.dispose(),ee.dispose(),Ze.dispose(),Dt.dispose(),te.dispose(),Di.dispose(),Di.removeEventListener("sessionstart",W_),Di.removeEventListener("sessionend",X_),he&&(he.dispose(),he=null),oo.stop()},this.renderBufferDirect=function(X,be,Te,we,Le,Ye){be===null&&(be=Ae);const ut=Le.isMesh&&Le.matrixWorld.determinant()<0,ft=function(Nn,Ka,gr,it,_n){Ka.isScene!==!0&&(Ka=Ae),H.resetTextureUnits();const pg=Ka.fog,Y5=it.isMeshStandardMaterial?Ka.environment:null,Q5=T===null?y.outputEncoding:T.isXRRenderTarget===!0?T.texture.encoding:rr,Yd=(it.isMeshStandardMaterial?O:J).get(it.envMap||Y5),Z5=it.vertexColors===!0&&!!gr.attributes.color&&gr.attributes.color.itemSize===4,K5=!!it.normalMap&&!!gr.attributes.tangent,J5=!!gr.morphAttributes.position,$5=!!gr.morphAttributes.normal,eO=!!gr.morphAttributes.color,tO=it.toneMapped?y.toneMapping:Er,Z_=gr.morphAttributes.position||gr.morphAttributes.normal||gr.morphAttributes.color,nO=Z_!==void 0?Z_.length:0,Nt=q.get(it),iO=g.state.lights;if(Ee===!0&&(Re===!0||Nn!==L)){const Ht=Nn===L&&it.id===R;Ve.setState(it,Nn,Ht)}let ua=!1;it.version===Nt.__version?Nt.needsLights&&Nt.lightsStateVersion!==iO.state.version||Nt.outputEncoding!==Q5||_n.isInstancedMesh&&Nt.instancing===!1?ua=!0:_n.isInstancedMesh||Nt.instancing!==!0?_n.isSkinnedMesh&&Nt.skinning===!1?ua=!0:_n.isSkinnedMesh||Nt.skinning!==!0?Nt.envMap!==Yd||it.fog===!0&&Nt.fog!==pg?ua=!0:Nt.numClippingPlanes===void 0||Nt.numClippingPlanes===Ve.numPlanes&&Nt.numIntersection===Ve.numIntersection?(Nt.vertexAlphas!==Z5||Nt.vertexTangents!==K5||Nt.morphTargets!==J5||Nt.morphNormals!==$5||Nt.morphColors!==eO||Nt.toneMapping!==tO||j.isWebGL2===!0&&Nt.morphTargetsCount!==nO)&&(ua=!0):ua=!0:ua=!0:ua=!0:(ua=!0,Nt.__version=it.version);let lo=Nt.currentProgram;ua===!0&&(lo=Xd(it,Ka,_n));let K_=!1,su=!1,fg=!1;const kn=lo.getUniforms(),co=Nt.uniforms;if(U.useProgram(lo.program)&&(K_=!0,su=!0,fg=!0),it.id!==R&&(R=it.id,su=!0),K_||L!==Nn){if(kn.setValue(ue,"projectionMatrix",Nn.projectionMatrix),j.logarithmicDepthBuffer&&kn.setValue(ue,"logDepthBufFC",2/(Math.log(Nn.far+1)/Math.LN2)),L!==Nn&&(L=Nn,su=!0,fg=!0),it.isShaderMaterial||it.isMeshPhongMaterial||it.isMeshToonMaterial||it.isMeshStandardMaterial||it.envMap){const Ht=kn.map.cameraPosition;Ht!==void 0&&Ht.setValue(ue,me.setFromMatrixPosition(Nn.matrixWorld))}(it.isMeshPhongMaterial||it.isMeshToonMaterial||it.isMeshLambertMaterial||it.isMeshBasicMaterial||it.isMeshStandardMaterial||it.isShaderMaterial)&&kn.setValue(ue,"isOrthographic",Nn.isOrthographicCamera===!0),(it.isMeshPhongMaterial||it.isMeshToonMaterial||it.isMeshLambertMaterial||it.isMeshBasicMaterial||it.isMeshStandardMaterial||it.isShaderMaterial||it.isShadowMaterial||_n.isSkinnedMesh)&&kn.setValue(ue,"viewMatrix",Nn.matrixWorldInverse)}if(_n.isSkinnedMesh){kn.setOptional(ue,_n,"bindMatrix"),kn.setOptional(ue,_n,"bindMatrixInverse");const Ht=_n.skeleton;Ht&&(j.floatVertexTextures?(Ht.boneTexture===null&&Ht.computeBoneTexture(),kn.setValue(ue,"boneTexture",Ht.boneTexture,H),kn.setValue(ue,"boneTextureSize",Ht.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const mg=gr.morphAttributes;(mg.position!==void 0||mg.normal!==void 0||mg.color!==void 0&&j.isWebGL2===!0)&&lt.update(_n,gr,lo),(su||Nt.receiveShadow!==_n.receiveShadow)&&(Nt.receiveShadow=_n.receiveShadow,kn.setValue(ue,"receiveShadow",_n.receiveShadow)),it.isMeshGouraudMaterial&&it.envMap!==null&&(co.envMap.value=Yd,co.flipEnvMap.value=Yd.isCubeTexture&&Yd.isRenderTargetTexture===!1?-1:1),su&&(kn.setValue(ue,"toneMappingExposure",y.toneMappingExposure),Nt.needsLights&&function(Ht,yi){Ht.ambientLightColor.needsUpdate=yi,Ht.lightProbe.needsUpdate=yi,Ht.directionalLights.needsUpdate=yi,Ht.directionalLightShadows.needsUpdate=yi,Ht.pointLights.needsUpdate=yi,Ht.pointLightShadows.needsUpdate=yi,Ht.spotLights.needsUpdate=yi,Ht.spotLightShadows.needsUpdate=yi,Ht.rectAreaLights.needsUpdate=yi,Ht.hemisphereLights.needsUpdate=yi}(co,fg),pg&&it.fog===!0&&de.refreshFogUniforms(co,pg),de.refreshMaterialUniforms(co,it,F,G,he),Uh.upload(ue,Nt.uniformsList,co,H)),it.isShaderMaterial&&it.uniformsNeedUpdate===!0&&(Uh.upload(ue,Nt.uniformsList,co,H),it.uniformsNeedUpdate=!1),it.isSpriteMaterial&&kn.setValue(ue,"center",_n.center),kn.setValue(ue,"modelViewMatrix",_n.modelViewMatrix),kn.setValue(ue,"normalMatrix",_n.normalMatrix),kn.setValue(ue,"modelMatrix",_n.matrixWorld),kn.setValue(ue,"envRotationMatrix",Ka.envRotationMatrix);const J_=_n.uniforms;for(let Ht in J_)kn.setValue(ue,Ht,J_[Ht]);if(it.isShaderMaterial||it.isRawShaderMaterial){const Ht=it.uniformsGroups;for(let yi=0,rO=Ht.length;yi<rO;yi++)if(j.isWebGL2){const $_=Ht[yi];Dt.update($_,lo),Dt.bind($_,lo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return lo}(X,be,Te,we,Le);U.setMaterial(we,ut);let Mt=Te.index,Bt=1;we.wireframe===!0&&(Mt=Y.getWireframeAttribute(Te),Bt=2);const Pt=Te.drawRange,St=Te.attributes.position;let Qn=Pt.start*Bt,mr=(Pt.start+Pt.count)*Bt;Ye!==null&&(Qn=Math.max(Qn,Ye.start*Bt),mr=Math.min(mr,(Ye.start+Ye.count)*Bt)),Mt!==null?(Qn=Math.max(Qn,0),mr=Math.min(mr,Mt.count)):St!=null&&(Qn=Math.max(Qn,0),mr=Math.min(mr,St.count));const si=mr-Qn;if(si<0||si===1/0)return;let qd;Ze.setup(Le,we,ft,Te,Mt);let Pn=et;if(Mt!==null&&(qd=W.get(Mt),Pn=pt,Pn.setIndex(qd)),Le.isMesh)we.wireframe===!0?(U.setLineWidth(we.wireframeLinewidth*Se()),Pn.setMode(ue.LINES)):Pn.setMode(ue.TRIANGLES);else if(Le.isLine){let Nn=we.linewidth;Nn===void 0&&(Nn=1),U.setLineWidth(Nn*Se()),Le.isLineSegments?Pn.setMode(ue.LINES):Le.isLineLoop?Pn.setMode(ue.LINE_LOOP):Pn.setMode(ue.LINE_STRIP)}else Le.isPoints?Pn.setMode(ue.POINTS):Le.isSprite&&Pn.setMode(ue.TRIANGLES);if(Le.isInstancedMesh)Pn.renderInstances(Qn,si,Le.count);else if(Te.isInstancedBufferGeometry){const Nn=Te._maxInstanceCount!==void 0?Te._maxInstanceCount:1/0,Ka=Math.min(Te.instanceCount,Nn);Pn.renderInstances(Qn,si,Ka)}else Pn.render(Qn,si)},this.compile=function(X,be){function Te(we,Le,Ye){we.transparent===!0&&we.side===_e&&we.forceSinglePass===!1?(we.side=xe,we.needsUpdate=!0,Xd(we,Le,Ye),we.side=oe,we.needsUpdate=!0,Xd(we,Le,Ye),we.side=_e):Xd(we,Le,Ye)}g=ze.get(X),g.init(),b.push(g),X.traverseVisible(function(we){we.isLight&&we.layers.test(be.layers)&&(g.pushLight(we),we.castShadow&&g.pushShadow(we))}),g.setupLights(y.useLegacyLights),X.traverse(function(we){const Le=we.material;if(Le)if(Array.isArray(Le))for(let Ye=0;Ye<Le.length;Ye++)Te(Le[Ye],X,we);else Te(Le,X,we)}),b.pop(),g=null};let dg=null;function W_(){oo.stop()}function X_(){oo.start()}const oo=new Hy;function q_(X,be,Te,we){if(X.visible===!1)return;if(X.layers.test(be.layers)){if(X.isGroup)Te=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(be);else if(X.isLight)g.pushLight(X),X.castShadow&&g.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||Me.intersectsSprite(X)){we&&me.setFromMatrixPosition(X.matrixWorld).applyMatrix4(ne);const Ye=ee.update(X),ut=X.material;ut.visible&&f.push(X,Ye,ut,Te,me.z,null)}}else if((X.isMesh||X.isLine||X.isPoints)&&(X.isSkinnedMesh&&X.skeleton.frame!==ie.render.frame&&(X.skeleton.update(),X.skeleton.frame=ie.render.frame),!X.frustumCulled||Me.intersectsObject(X))){we&&me.setFromMatrixPosition(X.matrixWorld).applyMatrix4(ne);const Ye=ee.update(X),ut=X.material;if(Array.isArray(ut)){const ft=Ye.groups;for(let Mt=0,Bt=ft.length;Mt<Bt;Mt++){const Pt=ft[Mt],St=ut[Pt.materialIndex];St&&St.visible&&f.push(X,Ye,St,Te,me.z,Pt)}}else ut.visible&&f.push(X,Ye,ut,Te,me.z,null)}}const Le=X.children;for(let Ye=0,ut=Le.length;Ye<ut;Ye++)q_(Le[Ye],be,Te,we)}function Y_(X,be,Te,we){const Le=X.opaque,Ye=X.transmissive,ut=X.transparent;g.setupLightsView(Te),Ee===!0&&Ve.setGlobalState(y.clippingPlanes,Te),Ye.length>0&&function(ft,Mt,Bt){const Pt=j.isWebGL2;he===null&&(he=new Rt(1024,1024,{generateMipmaps:!0,type:Ne.has("EXT_color_buffer_half_float")?di:yn,minFilter:ir,samples:Pt&&r===!0?4:0}));const St=y.getRenderTarget();y.setRenderTarget(he),y.clear();const Qn=y.toneMapping;y.toneMapping=Er,Wd(ft,Mt,Bt),y.toneMapping=Qn,H.updateMultisampleRenderTarget(he),H.updateRenderTargetMipmap(he),y.setRenderTarget(St)}(Le,be,Te),we&&U.viewport(P.copy(we)),Le.length>0&&Wd(Le,be,Te),Ye.length>0&&Wd(Ye,be,Te),ut.length>0&&Wd(ut,be,Te),U.buffers.depth.setTest(!0),U.buffers.depth.setMask(!0),U.buffers.color.setMask(!0),U.setPolygonOffset(!1)}function Wd(X,be,Te){const we=be.isScene===!0?be.overrideMaterial:null;for(let Le=0,Ye=X.length;Le<Ye;Le++){const ut=X[Le],ft=ut.object,Mt=ut.geometry,Bt=we===null?ut.material:we,Pt=ut.group;ft.layers.test(Te.layers)&&q5(ft,be,Te,Mt,Bt,Pt)}}function q5(X,be,Te,we,Le,Ye){X.onBeforeRender(y,be,Te,we,Le,Ye),X.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),Le.onBeforeRender(y,be,Te,we,X,Ye),Le.transparent===!0&&Le.side===_e&&Le.forceSinglePass===!1?(Le.side=xe,Le.needsUpdate=!0,y.renderBufferDirect(Te,be,we,Le,X,Ye),Le.side=oe,Le.needsUpdate=!0,y.renderBufferDirect(Te,be,we,Le,X,Ye),Le.side=_e):y.renderBufferDirect(Te,be,we,Le,X,Ye),X.onAfterRender(y,be,Te,we,Le,Ye)}function Xd(X,be,Te){be.isScene!==!0&&(be=Ae);const we=q.get(X),Le=g.state.lights,Ye=g.state.shadowsArray,ut=Le.state.version,ft=te.getParameters(X,Le.state,Ye,be,Te),Mt=te.getProgramCacheKey(ft);let Bt=we.programs;we.environment=X.isMeshStandardMaterial?be.environment:null,we.fog=be.fog,we.envMap=(X.isMeshStandardMaterial?O:J).get(X.envMap||we.environment),Bt===void 0&&(X.addEventListener("dispose",V_),Bt=new Map,we.programs=Bt);let Pt=Bt.get(Mt);if(Pt!==void 0){if(we.currentProgram===Pt&&we.lightsStateVersion===ut)return Q_(X,ft),Pt}else ft.uniforms=te.getUniforms(X),X.onBuild(Te,ft,y),X.onBeforeCompile(ft,y),Pt=te.acquireProgram(ft,Mt),Bt.set(Mt,Pt),we.uniforms=ft.uniforms;const St=we.uniforms;(X.isShaderMaterial||X.isRawShaderMaterial)&&X.clipping!==!0||(St.clippingPlanes=Ve.uniform),Q_(X,ft),we.needsLights=function(si){return si.isMeshLambertMaterial||si.isMeshToonMaterial||si.isMeshPhongMaterial||si.isMeshStandardMaterial||si.isShadowMaterial||si.isShaderMaterial&&si.lights===!0}(X),we.lightsStateVersion=ut,we.needsLights&&(St.ambientLightColor.value=Le.state.ambient,St.lightProbe.value=Le.state.probe,St.directionalLights.value=Le.state.directional,St.directionalLightShadows.value=Le.state.directionalShadow,St.spotLights.value=Le.state.spot,St.spotLightShadows.value=Le.state.spotShadow,St.rectAreaLights.value=Le.state.rectArea,St.ltc_1.value=Le.state.rectAreaLTC1,St.ltc_2.value=Le.state.rectAreaLTC2,St.pointLights.value=Le.state.point,St.pointLightShadows.value=Le.state.pointShadow,St.hemisphereLights.value=Le.state.hemi,St.directionalShadowMap.value=Le.state.directionalShadowMap,St.directionalShadowMatrix.value=Le.state.directionalShadowMatrix,St.spotShadowMap.value=Le.state.spotShadowMap,St.spotLightMatrix.value=Le.state.spotLightMatrix,St.spotLightMap.value=Le.state.spotLightMap,St.pointShadowMap.value=Le.state.pointShadowMap,St.pointShadowMatrix.value=Le.state.pointShadowMatrix);const Qn=Pt.getUniforms(),mr=Uh.seqWithValue(Qn.seq,St);return we.currentProgram=Pt,we.uniformsList=mr,Pt}function Q_(X,be){const Te=q.get(X);Te.outputEncoding=be.outputEncoding,Te.instancing=be.instancing,Te.skinning=be.skinning,Te.morphTargets=be.morphTargets,Te.morphNormals=be.morphNormals,Te.morphColors=be.morphColors,Te.morphTargetsCount=be.morphTargetsCount,Te.numClippingPlanes=be.numClippingPlanes,Te.numIntersection=be.numClipIntersection,Te.vertexAlphas=be.vertexAlphas,Te.vertexTangents=be.vertexTangents,Te.toneMapping=be.toneMapping}oo.setAnimationLoop(function(X){dg&&dg(X)}),typeof self<"u"&&oo.setContext(self),this.setAnimationLoop=function(X){dg=X,Di.setAnimationLoop(X),X===null?oo.stop():oo.start()},Di.addEventListener("sessionstart",W_),Di.addEventListener("sessionend",X_),this.render=function(X,be){if(be!==void 0&&be.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(S===!0)return;X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),be.parent===null&&be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),Di.enabled===!0&&Di.isPresenting===!0&&(Di.cameraAutoUpdate===!0&&Di.updateCamera(be),be=Di.getCamera()),X.isScene===!0&&X.onBeforeRender(y,X,be,T),g=ze.get(X,b.length),g.init(),b.push(g),ne.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),Me.setFromProjectionMatrix(ne),Re=this.localClippingEnabled,Ee=Ve.init(this.clippingPlanes,Re),f=Oe.get(X,v.length),f.init(),v.push(f),q_(X,be,0,y.sortObjects),f.finish(),y.sortObjects===!0&&f.sort($,le),Ee===!0&&Ve.beginShadows();const Te=g.state.shadowsArray;if(Be.render(Te,X,be),Ee===!0&&Ve.endShadows(),this.info.autoReset===!0&&this.info.reset(),nt.render(f,X),g.setupLights(y.useLegacyLights),be.isArrayCamera){const we=be.cameras;for(let Le=0,Ye=we.length;Le<Ye;Le++){const ut=we[Le];Y_(f,X,ut,ut.viewport)}}else Y_(f,X,be);T!==null&&(H.updateMultisampleRenderTarget(T),H.updateRenderTargetMipmap(T)),X.isScene===!0&&X.onAfterRender(y,X,be),Ze.resetDefaultState(),R=-1,L=null,b.pop(),g=b.length>0?b[b.length-1]:null,v.pop(),f=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(X,be,Te){q.get(X.texture).__webglTexture=be,q.get(X.depthTexture).__webglTexture=Te;const we=q.get(X);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=Te===void 0,we.__autoAllocateDepthBuffer||Ne.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(X,be){const Te=q.get(X);Te.__webglFramebuffer=be,Te.__useDefaultFramebuffer=be===void 0},this.setRenderTarget=function(X,be=0,Te=0){T=X,M=be,w=Te;let we=!0,Le=null,Ye=!1,ut=!1;if(X){const ft=q.get(X);ft.__useDefaultFramebuffer!==void 0?(U.bindFramebuffer(ue.FRAMEBUFFER,null),we=!1):ft.__webglFramebuffer===void 0?H.setupRenderTarget(X):ft.__hasExternalTextures&&H.rebindTextures(X,q.get(X.texture).__webglTexture,q.get(X.depthTexture).__webglTexture);const Mt=X.texture;(Mt.isData3DTexture||Mt.isDataArrayTexture||Mt.isCompressedArrayTexture)&&(ut=!0);const Bt=q.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(Le=Bt[be],Ye=!0):Le=j.isWebGL2&&X.samples>0&&H.useMultisampledRTT(X)===!1?q.get(X).__webglMultisampledFramebuffer:Bt,P.copy(X.viewport),I.copy(X.scissor),V=X.scissorTest}else P.copy(ae).multiplyScalar(F).floor(),I.copy(ye).multiplyScalar(F).floor(),V=pe;if(U.bindFramebuffer(ue.FRAMEBUFFER,Le)&&j.drawBuffers&&we&&U.drawBuffers(X,Le),U.viewport(P),U.scissor(I),U.setScissorTest(V),Ye){const ft=q.get(X.texture);ue.framebufferTexture2D(ue.FRAMEBUFFER,ue.COLOR_ATTACHMENT0,ue.TEXTURE_CUBE_MAP_POSITIVE_X+be,ft.__webglTexture,Te)}else if(ut){const ft=q.get(X.texture),Mt=be||0;ue.framebufferTextureLayer(ue.FRAMEBUFFER,ue.COLOR_ATTACHMENT0,ft.__webglTexture,Te||0,Mt)}R=-1},this.readRenderTargetPixels=function(X,be,Te,we,Le,Ye,ut){if(!X||!X.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ft=q.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&ut!==void 0&&(ft=ft[ut]),ft){U.bindFramebuffer(ue.FRAMEBUFFER,ft);try{const Mt=X.texture,Bt=Mt.format,Pt=Mt.type;if(Bt!==ti&&Ct.convert(Bt)!==ue.getParameter(ue.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const St=Pt===di&&(Ne.has("EXT_color_buffer_half_float")||j.isWebGL2&&Ne.has("EXT_color_buffer_float"));if(!(Pt===yn||Ct.convert(Pt)===ue.getParameter(ue.IMPLEMENTATION_COLOR_READ_TYPE)||Pt===Ti&&(j.isWebGL2||Ne.has("OES_texture_float")||Ne.has("WEBGL_color_buffer_float"))||St))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");be>=0&&be<=X.width-we&&Te>=0&&Te<=X.height-Le&&ue.readPixels(be,Te,we,Le,Ct.convert(Bt),Ct.convert(Pt),Ye)}finally{const Mt=T!==null?q.get(T).__webglFramebuffer:null;U.bindFramebuffer(ue.FRAMEBUFFER,Mt)}}},this.copyFramebufferToTexture=function(X,be,Te=0){const we=Math.pow(2,-Te),Le=Math.floor(be.image.width*we),Ye=Math.floor(be.image.height*we);H.setTexture2D(be,0),ue.copyTexSubImage2D(ue.TEXTURE_2D,Te,0,0,X.x,X.y,Le,Ye),U.unbindTexture()},this.copyTextureToTexture=function(X,be,Te,we=0){const Le=be.image.width,Ye=be.image.height,ut=Ct.convert(Te.format),ft=Ct.convert(Te.type);H.setTexture2D(Te,0),ue.pixelStorei(ue.UNPACK_FLIP_Y_WEBGL,Te.flipY),ue.pixelStorei(ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Te.premultiplyAlpha),ue.pixelStorei(ue.UNPACK_ALIGNMENT,Te.unpackAlignment),be.isDataTexture?ue.texSubImage2D(ue.TEXTURE_2D,we,X.x,X.y,Le,Ye,ut,ft,be.image.data):be.isCompressedTexture?ue.compressedTexSubImage2D(ue.TEXTURE_2D,we,X.x,X.y,be.mipmaps[0].width,be.mipmaps[0].height,ut,be.mipmaps[0].data):ue.texSubImage2D(ue.TEXTURE_2D,we,X.x,X.y,ut,ft,be.image),we===0&&Te.generateMipmaps&&ue.generateMipmap(ue.TEXTURE_2D),U.unbindTexture()},this.copyTextureToTexture3D=function(X,be,Te,we,Le=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ye=X.max.x-X.min.x+1,ut=X.max.y-X.min.y+1,ft=X.max.z-X.min.z+1,Mt=Ct.convert(we.format),Bt=Ct.convert(we.type);let Pt;if(we.isData3DTexture)H.setTexture3D(we,0),Pt=ue.TEXTURE_3D;else{if(!we.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");H.setTexture2DArray(we,0),Pt=ue.TEXTURE_2D_ARRAY}ue.pixelStorei(ue.UNPACK_FLIP_Y_WEBGL,we.flipY),ue.pixelStorei(ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),ue.pixelStorei(ue.UNPACK_ALIGNMENT,we.unpackAlignment);const St=ue.getParameter(ue.UNPACK_ROW_LENGTH),Qn=ue.getParameter(ue.UNPACK_IMAGE_HEIGHT),mr=ue.getParameter(ue.UNPACK_SKIP_PIXELS),si=ue.getParameter(ue.UNPACK_SKIP_ROWS),qd=ue.getParameter(ue.UNPACK_SKIP_IMAGES),Pn=Te.isCompressedTexture?Te.mipmaps[0]:Te.image;ue.pixelStorei(ue.UNPACK_ROW_LENGTH,Pn.width),ue.pixelStorei(ue.UNPACK_IMAGE_HEIGHT,Pn.height),ue.pixelStorei(ue.UNPACK_SKIP_PIXELS,X.min.x),ue.pixelStorei(ue.UNPACK_SKIP_ROWS,X.min.y),ue.pixelStorei(ue.UNPACK_SKIP_IMAGES,X.min.z),Te.isDataTexture||Te.isData3DTexture?ue.texSubImage3D(Pt,Le,be.x,be.y,be.z,Ye,ut,ft,Mt,Bt,Pn.data):Te.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ue.compressedTexSubImage3D(Pt,Le,be.x,be.y,be.z,Ye,ut,ft,Mt,Pn.data)):ue.texSubImage3D(Pt,Le,be.x,be.y,be.z,Ye,ut,ft,Mt,Bt,Pn),ue.pixelStorei(ue.UNPACK_ROW_LENGTH,St),ue.pixelStorei(ue.UNPACK_IMAGE_HEIGHT,Qn),ue.pixelStorei(ue.UNPACK_SKIP_PIXELS,mr),ue.pixelStorei(ue.UNPACK_SKIP_ROWS,si),ue.pixelStorei(ue.UNPACK_SKIP_IMAGES,qd),Le===0&&we.generateMipmaps&&ue.generateMipmap(Pt),U.unbindTexture()},this.initTexture=function(X){X.isCubeTexture?H.setTextureCube(X,0):X.isData3DTexture?H.setTexture3D(X,0):X.isDataArrayTexture||X.isCompressedArrayTexture?H.setTexture2DArray(X,0):H.setTexture2D(X,0),U.unbindTexture()},this.resetState=function(){M=0,w=0,T=null,U.reset(),Ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(Bh.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(o){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!o}}});class mx extends Bh{}mx.prototype.isWebGL1Renderer=!0;class Hh{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Pe(e),this.density=t}clone(){return new Hh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class jh{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Pe(e),this.near=t,this.far=n}clone(){return new jh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Ds extends ot{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.envRotationMatrix=new dn,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.envRotationMatrix!==null&&(this.envRotationMatrix=e.envRotationMatrix.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class Qo{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=uc,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ai()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ai()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ai()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ii=new C;class ri{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ii.fromBufferAttribute(this,t),ii.applyMatrix4(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ii.fromBufferAttribute(this,t),ii.applyNormalMatrix(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ii.fromBufferAttribute(this,t),ii.transformDirection(e),this.setXYZ(t,ii.x,ii.y,ii.z);return this}setX(e,t){return this.normalized&&(t=kt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=qr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=qr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=qr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=qr(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=kt(t,this.array),n=kt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=kt(t,this.array),n=kt(n,this.array),i=kt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=kt(t,this.array),n=kt(n,this.array),i=kt(i,this.array),r=kt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(e===void 0){const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return new $e(new this.array.constructor(t),this.itemSize,this.normalized)}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ri(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Cm extends on{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Pe(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Zo;const Ac=new C,Ko=new C,Jo=new C,$o=new ce,Rc=new ce,gx=new De,Gh=new C,Lc=new C,Vh=new C,vx=new ce,Dm=new ce,yx=new ce;class xx extends ot{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Zo===void 0){Zo=new Ke;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Qo(t,5);Zo.setIndex([0,1,2,0,2,3]),Zo.setAttribute("position",new ri(n,3,0,!1)),Zo.setAttribute("uv",new ri(n,2,3,!1))}this.geometry=Zo,this.material=e!==void 0?e:new Cm,this.center=new ce(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ko.setFromMatrixScale(this.matrixWorld),gx.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Jo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ko.multiplyScalar(-Jo.z);const n=this.material.rotation;let i,r;n!==0&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;Wh(Gh.set(-.5,-.5,0),Jo,s,Ko,i,r),Wh(Lc.set(.5,-.5,0),Jo,s,Ko,i,r),Wh(Vh.set(.5,.5,0),Jo,s,Ko,i,r),vx.set(0,0),Dm.set(1,0),yx.set(1,1);let c=e.ray.intersectTriangle(Gh,Lc,Vh,!1,Ac);if(c===null&&(Wh(Lc.set(-.5,.5,0),Jo,s,Ko,i,r),Dm.set(0,1),c=e.ray.intersectTriangle(Gh,Vh,Lc,!1,Ac),c===null))return;const u=e.ray.origin.distanceTo(Ac);u<e.near||u>e.far||t.push({distance:u,point:Ac.clone(),uv:Bi.getUV(Ac,Gh,Lc,Vh,vx,Dm,yx,new ce),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Wh(o,e,t,n,i,r){$o.subVectors(o,t).addScalar(.5).multiply(n),i!==void 0?(Rc.x=r*$o.x-i*$o.y,Rc.y=i*$o.x+r*$o.y):Rc.copy($o),o.copy(e),o.x+=Rc.x,o.y+=Rc.y,o.applyMatrix4(gx)}const Xh=new C,bx=new C;class Sx extends ot{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Xh.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Xh);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Xh.setFromMatrixPosition(e.matrixWorld),bx.setFromMatrixPosition(this.matrixWorld);const n=Xh.distanceTo(bx)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),!(n>=s))break;t[i-1].object.visible=!1,t[i].object.visible=!0}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];t.object.levels.push({object:s.object.uuid,distance:s.distance,hysteresis:s.hysteresis})}return t}}const _x=new C,wx=new Qe,Mx=new Qe,xA=new C,Tx=new De;class qh extends Je{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new De,this.bindMatrixInverse=new De}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Qe,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;wx.fromBufferAttribute(i.attributes.skinIndex,e),Mx.fromBufferAttribute(i.attributes.skinWeight,e),_x.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const s=Mx.getComponent(r);if(s!==0){const c=wx.getComponent(r);Tx.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(xA.copy(_x).applyMatrix4(Tx),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}class el extends ot{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ia extends Ut{constructor(e=null,t=1,n=1,i,r,s,c,u,d=At,p=At,f,g){super(null,s,c,u,d,p,i,r,f,g),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Ex=new De,bA=new De;class tl{constructor(e=[],t=[]){this.uuid=Ai(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new De)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new De;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const c=e[r]?e[r].matrixWorld:bA;Ex.multiplyMatrices(c,t[r]),Ex.toArray(n,16*r)}i!==null&&(i.needsUpdate=!0)}clone(){return new tl(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=_y(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Ia(t,e,e,ti,Ti);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const r=e.bones[n];let s=t[r];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),s=new el),this.bones.push(s),this.boneInverses.push(new De().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const s=t[i];e.bones.push(s.uuid);const c=n[i];e.boneInverses.push(c.toArray())}return e}}class Na extends $e{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ax=new De,Rx=new De,Yh=[],SA=new De,Pc=new Je;class Qh extends Je{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Na(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let i=0;i<n;i++)this.setMatrixAt(i,SA)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Pc.geometry=this.geometry,Pc.material=this.material,Pc.material!==void 0)for(let r=0;r<i;r++){this.getMatrixAt(r,Ax),Rx.multiplyMatrices(n,Ax),Pc.matrixWorld=Rx,Pc.raycast(e,Yh);for(let s=0,c=Yh.length;s<c;s++){const u=Yh[s];u.instanceId=r,u.object=this,t.push(u)}Yh.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Na(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class In extends on{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pe(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Lx=new C,Px=new C,Cx=new De,Om=new gc,Zh=new Qr;class Lr extends ot{constructor(e=new Ke,t=new In){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,r=t.count;i<r;i++)Lx.fromBufferAttribute(t,i-1),Px.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Lx.distanceTo(Px);e.setAttribute("lineDistance",new Ge(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Zh.copy(n.boundingSphere),Zh.applyMatrix4(i),Zh.radius+=r,e.ray.intersectsSphere(Zh)===!1)return;Cx.copy(i).invert(),Om.copy(e.ray).applyMatrix4(Cx);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,d=new C,p=new C,f=new C,g=new C,v=this.isLineSegments?2:1,b=n.index,y=n.attributes.position;if(b!==null)for(let S=Math.max(0,s.start),M=Math.min(b.count,s.start+s.count)-1;S<M;S+=v){const w=b.getX(S),T=b.getX(S+1);if(d.fromBufferAttribute(y,w),p.fromBufferAttribute(y,T),Om.distanceSqToSegment(d,p,g,f)>u)continue;g.applyMatrix4(this.matrixWorld);const R=e.ray.origin.distanceTo(g);R<e.near||R>e.far||t.push({distance:R,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}else for(let S=Math.max(0,s.start),M=Math.min(y.count,s.start+s.count)-1;S<M;S+=v){if(d.fromBufferAttribute(y,S),p.fromBufferAttribute(y,S+1),Om.distanceSqToSegment(d,p,g,f)>u)continue;g.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(g);w<e.near||w>e.far||t.push({distance:w,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){const s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}}const Dx=new C,Ox=new C;class ur extends Lr{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,r=t.count;i<r;i+=2)Dx.fromBufferAttribute(t,i),Ox.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Dx.distanceTo(Ox);e.setAttribute("lineDistance",new Ge(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Im extends Lr{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Kh extends on{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Pe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Ix=new De,Nm=new gc,Jh=new Qr,$h=new C;class km extends ot{constructor(e=new Ke,t=new Kh){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Jh.copy(n.boundingSphere),Jh.applyMatrix4(i),Jh.radius+=r,e.ray.intersectsSphere(Jh)===!1)return;Ix.copy(i).invert(),Nm.copy(e.ray).applyMatrix4(Ix);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,d=n.index,p=n.attributes.position;if(d!==null)for(let f=Math.max(0,s.start),g=Math.min(d.count,s.start+s.count);f<g;f++){const v=d.getX(f);$h.fromBufferAttribute(p,v),Nx($h,v,u,i,e,t,this)}else for(let f=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);f<g;f++)$h.fromBufferAttribute(p,f),Nx($h,f,u,i,e,t,this)}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){const s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}}function Nx(o,e,t,n,i,r,s){const c=Nm.distanceSqToPoint(o);if(c<t){const u=new C;Nm.closestPointToPoint(o,u),u.applyMatrix4(n);const d=i.ray.origin.distanceTo(u);if(d<i.near||d>i.far)return;r.push({distance:d,distanceToRay:Math.sqrt(c),point:u,index:e,face:null,object:s})}}class _A extends Ut{constructor(e,t,n,i,r,s,c,u,d){super(e,t,n,i,r,s,c,u,d),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:rt,this.magFilter=r!==void 0?r:rt,this.generateMipmaps=!1;const p=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function f(){p.needsUpdate=!0,e.requestVideoFrameCallback(f)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class wA extends Ut{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=At,this.minFilter=At,this.generateMipmaps=!1,this.needsUpdate=!0}}class Fm extends Ut{constructor(e,t,n,i,r,s,c,u,d,p,f,g){super(null,s,c,u,d,p,i,r,f,g),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class MA extends Fm{constructor(e,t,n,i,r,s){super(e,t,n,r,s),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=vn}}class TA extends Ut{constructor(e,t,n,i,r,s,c,u,d){super(e,t,n,i,r,s,c,u,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ji{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let s;s=t||e*n[r-1];let c,u=0,d=r-1;for(;u<=d;)if(i=Math.floor(u+(d-u)/2),c=n[i]-s,c<0)u=i+1;else{if(!(c>0)){d=i;break}d=i-1}if(i=d,n[i]===s)return i/(r-1);const p=n[i];return(i+(s-p)/(n[i+1]-p))/(r-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),c=this.getPoint(r),u=t||(s.isVector2?new ce:new C);return u.copy(c).sub(s).normalize(),u}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new C,i=[],r=[],s=[],c=new C,u=new De;for(let v=0;v<=e;v++){const b=v/e;i[v]=this.getTangentAt(b,new C)}r[0]=new C,s[0]=new C;let d=Number.MAX_VALUE;const p=Math.abs(i[0].x),f=Math.abs(i[0].y),g=Math.abs(i[0].z);p<=d&&(d=p,n.set(1,0,0)),f<=d&&(d=f,n.set(0,1,0)),g<=d&&n.set(0,0,1),c.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],c),s[0].crossVectors(i[0],r[0]);for(let v=1;v<=e;v++){if(r[v]=r[v-1].clone(),s[v]=s[v-1].clone(),c.crossVectors(i[v-1],i[v]),c.length()>Number.EPSILON){c.normalize();const b=Math.acos(nn(i[v-1].dot(i[v]),-1,1));r[v].applyMatrix4(u.makeRotationAxis(c,b))}s[v].crossVectors(i[v],r[v])}if(t===!0){let v=Math.acos(nn(r[0].dot(r[e]),-1,1));v/=e,i[0].dot(c.crossVectors(r[0],r[e]))>0&&(v=-v);for(let b=1;b<=e;b++)r[b].applyMatrix4(u.makeRotationAxis(i[b],v*b)),s[b].crossVectors(i[b],r[b])}return{tangents:i,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class ed extends ji{constructor(e=0,t=0,n=1,i=1,r=0,s=2*Math.PI,c=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=c,this.aRotation=u}getPoint(e,t){const n=t||new ce,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),this.aClockwise!==!0||s||(r===i?r=-i:r-=i);const c=this.aStartAngle+e*r;let u=this.aX+this.xRadius*Math.cos(c),d=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const p=Math.cos(this.aRotation),f=Math.sin(this.aRotation),g=u-this.aX,v=d-this.aY;u=g*p-v*f+this.aX,d=g*f+v*p+this.aY}return n.set(u,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class kx extends ed{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Um(){let o=0,e=0,t=0,n=0;function i(r,s,c,u){o=r,e=c,t=-3*r+3*s-2*c-u,n=2*r-2*s+c+u}return{initCatmullRom:function(r,s,c,u,d){i(s,c,d*(c-r),d*(u-s))},initNonuniformCatmullRom:function(r,s,c,u,d,p,f){let g=(s-r)/d-(c-r)/(d+p)+(c-s)/p,v=(c-s)/p-(u-s)/(p+f)+(u-c)/f;g*=p,v*=p,i(s,c,g,v)},calc:function(r){const s=r*r;return o+e*r+t*s+n*(s*r)}}}const td=new C,zm=new Um,Bm=new Um,Hm=new Um;class Fx extends ji{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new C){const n=t,i=this.points,r=i.length,s=(r-(this.closed?0:1))*e;let c,u,d=Math.floor(s),p=s-d;this.closed?d+=d>0?0:(Math.floor(Math.abs(d)/r)+1)*r:p===0&&d===r-1&&(d=r-2,p=1),this.closed||d>0?c=i[(d-1)%r]:(td.subVectors(i[0],i[1]).add(i[0]),c=td);const f=i[d%r],g=i[(d+1)%r];if(this.closed||d+2<r?u=i[(d+2)%r]:(td.subVectors(i[r-1],i[r-2]).add(i[r-1]),u=td),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let b=Math.pow(c.distanceToSquared(f),v),y=Math.pow(f.distanceToSquared(g),v),S=Math.pow(g.distanceToSquared(u),v);y<1e-4&&(y=1),b<1e-4&&(b=y),S<1e-4&&(S=y),zm.initNonuniformCatmullRom(c.x,f.x,g.x,u.x,b,y,S),Bm.initNonuniformCatmullRom(c.y,f.y,g.y,u.y,b,y,S),Hm.initNonuniformCatmullRom(c.z,f.z,g.z,u.z,b,y,S)}else this.curveType==="catmullrom"&&(zm.initCatmullRom(c.x,f.x,g.x,u.x,this.tension),Bm.initCatmullRom(c.y,f.y,g.y,u.y,this.tension),Hm.initCatmullRom(c.z,f.z,g.z,u.z,this.tension));return n.set(zm.calc(p),Bm.calc(p),Hm.calc(p)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new C().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ux(o,e,t,n,i){const r=.5*(n-e),s=.5*(i-t),c=o*o;return(2*t-2*n+r+s)*(o*c)+(-3*t+3*n-2*r-s)*c+r*o+t}function Cc(o,e,t,n){return function(i,r){const s=1-i;return s*s*r}(o,e)+function(i,r){return 2*(1-i)*i*r}(o,t)+function(i,r){return i*i*r}(o,n)}function Dc(o,e,t,n,i){return function(r,s){const c=1-r;return c*c*c*s}(o,e)+function(r,s){const c=1-r;return 3*c*c*r*s}(o,t)+function(r,s){return 3*(1-r)*r*r*s}(o,n)+function(r,s){return r*r*r*s}(o,i)}class jm extends ji{constructor(e=new ce,t=new ce,n=new ce,i=new ce){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ce){const n=t,i=this.v0,r=this.v1,s=this.v2,c=this.v3;return n.set(Dc(e,i.x,r.x,s.x,c.x),Dc(e,i.y,r.y,s.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class zx extends ji{constructor(e=new C,t=new C,n=new C,i=new C){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new C){const n=t,i=this.v0,r=this.v1,s=this.v2,c=this.v3;return n.set(Dc(e,i.x,r.x,s.x,c.x),Dc(e,i.y,r.y,s.y,c.y),Dc(e,i.z,r.z,s.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class nd extends ji{constructor(e=new ce,t=new ce){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ce){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ce){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Bx extends ji{constructor(e=new C,t=new C){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new C){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new C){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gm extends ji{constructor(e=new ce,t=new ce,n=new ce){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ce){const n=t,i=this.v0,r=this.v1,s=this.v2;return n.set(Cc(e,i.x,r.x,s.x),Cc(e,i.y,r.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class id extends ji{constructor(e=new C,t=new C,n=new C){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new C){const n=t,i=this.v0,r=this.v1,s=this.v2;return n.set(Cc(e,i.x,r.x,s.x),Cc(e,i.y,r.y,s.y),Cc(e,i.z,r.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Vm extends ji{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ce){const n=t,i=this.points,r=(i.length-1)*e,s=Math.floor(r),c=r-s,u=i[s===0?s:s-1],d=i[s],p=i[s>i.length-2?i.length-1:s+1],f=i[s>i.length-3?i.length-1:s+2];return n.set(Ux(c,u.x,d.x,p.x,f.x),Ux(c,u.y,d.y,p.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new ce().fromArray(i))}return this}}class Hx extends ji{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new nd(t,e))}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const s=i[r]-n,c=this.curves[r],u=c.getLength(),d=u===0?0:1-s/u;return c.getPointAt(d,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],c=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,u=s.getPoints(c);for(let d=0;d<u.length;d++){const p=u[d];n&&n.equals(p)||(t.push(p),n=p)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new a[i.type]().fromJSON(i))}return this}}class Oc extends Hx{constructor(e){super(),this.type="Path",this.currentPoint=new ce,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new nd(this.currentPoint.clone(),new ce(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new Gm(this.currentPoint.clone(),new ce(e,t),new ce(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){const c=new jm(this.currentPoint.clone(),new ce(e,t),new ce(n,i),new ce(r,s));return this.curves.push(c),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Vm(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+c,t+u,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,c,u){const d=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(e+d,t+p,n,i,r,s,c,u),this}absellipse(e,t,n,i,r,s,c,u){const d=new ed(e,t,n,i,r,s,c,u);if(this.curves.length>0){const f=d.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(d);const p=d.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Os extends Ke{constructor(e=[new ce(0,-.5),new ce(.5,0),new ce(0,.5)],t=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=nn(i,0,2*Math.PI);const r=[],s=[],c=[],u=[],d=[],p=1/t,f=new C,g=new ce,v=new C,b=new C,y=new C;let S=0,M=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:S=e[w+1].x-e[w].x,M=e[w+1].y-e[w].y,v.x=1*M,v.y=-S,v.z=0*M,y.copy(v),v.normalize(),u.push(v.x,v.y,v.z);break;case e.length-1:u.push(y.x,y.y,y.z);break;default:S=e[w+1].x-e[w].x,M=e[w+1].y-e[w].y,v.x=1*M,v.y=-S,v.z=0*M,b.copy(v),v.x+=y.x,v.y+=y.y,v.z+=y.z,v.normalize(),u.push(v.x,v.y,v.z),y.copy(b)}for(let w=0;w<=t;w++){const T=n+w*p*i,R=Math.sin(T),L=Math.cos(T);for(let P=0;P<=e.length-1;P++){f.x=e[P].x*R,f.y=e[P].y,f.z=e[P].x*L,s.push(f.x,f.y,f.z),g.x=w/t,g.y=P/(e.length-1),c.push(g.x,g.y);const I=u[3*P+0]*R,V=u[3*P+1],z=u[3*P+0]*L;d.push(I,V,z)}}for(let w=0;w<t;w++)for(let T=0;T<e.length-1;T++){const R=T+w*e.length,L=R,P=R+e.length,I=R+e.length+1,V=R+1;r.push(L,P,V),r.push(I,V,P)}this.setIndex(r),this.setAttribute("position",new Ge(s,3)),this.setAttribute("uv",new Ge(c,2)),this.setAttribute("normal",new Ge(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Os(e.points,e.segments,e.phiStart,e.phiLength)}}class nl extends Os{constructor(e=1,t=1,n=4,i=8){const r=new Oc;r.absarc(0,-t/2,e,1.5*Math.PI,0),r.absarc(0,t/2,e,0,.5*Math.PI),super(r.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new nl(e.radius,e.length,e.capSegments,e.radialSegments)}}class il extends Ke{constructor(e=1,t=32,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],s=[],c=[],u=[],d=new C,p=new ce;s.push(0,0,0),c.push(0,0,1),u.push(.5,.5);for(let f=0,g=3;f<=t;f++,g+=3){const v=n+f/t*i;d.x=e*Math.cos(v),d.y=e*Math.sin(v),s.push(d.x,d.y,d.z),c.push(0,0,1),p.x=(s[g]/e+1)/2,p.y=(s[g+1]/e+1)/2,u.push(p.x,p.y)}for(let f=1;f<=t;f++)r.push(f,f+1,0);this.setIndex(r),this.setAttribute("position",new Ge(s,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new il(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ka extends Ke{constructor(e=1,t=1,n=1,i=32,r=1,s=!1,c=0,u=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:c,thetaLength:u};const d=this;i=Math.floor(i),r=Math.floor(r);const p=[],f=[],g=[],v=[];let b=0;const y=[],S=n/2;let M=0;function w(T){const R=b,L=new ce,P=new C;let I=0;const V=T===!0?e:t,z=T===!0?1:-1;for(let F=1;F<=i;F++)f.push(0,S*z,0),g.push(0,z,0),v.push(.5,.5),b++;const G=b;for(let F=0;F<=i;F++){const $=F/i*u+c,le=Math.cos($),ae=Math.sin($);P.x=V*ae,P.y=S*z,P.z=V*le,f.push(P.x,P.y,P.z),g.push(0,z,0),L.x=.5*le+.5,L.y=.5*ae*z+.5,v.push(L.x,L.y),b++}for(let F=0;F<i;F++){const $=R+F,le=G+F;T===!0?p.push(le,le+1,$):p.push(le+1,le,$),I+=3}d.addGroup(M,I,T===!0?1:2),M+=I}(function(){const T=new C,R=new C;let L=0;const P=(t-e)/n;for(let I=0;I<=r;I++){const V=[],z=I/r,G=z*(t-e)+e;for(let F=0;F<=i;F++){const $=F/i,le=$*u+c,ae=Math.sin(le),ye=Math.cos(le);R.x=G*ae,R.y=-z*n+S,R.z=G*ye,f.push(R.x,R.y,R.z),T.set(ae,P,ye).normalize(),g.push(T.x,T.y,T.z),v.push($,1-z),V.push(b++)}y.push(V)}for(let I=0;I<i;I++)for(let V=0;V<r;V++){const z=y[V][I],G=y[V+1][I],F=y[V+1][I+1],$=y[V][I+1];p.push(z,G,$),p.push(G,F,$),L+=6}d.addGroup(M,L,0),M+=L})(),s===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(p),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(g,3)),this.setAttribute("uv",new Ge(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ka(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class rl extends ka{constructor(e=1,t=1,n=32,i=1,r=!1,s=0,c=2*Math.PI){super(0,e,t,n,i,r,s,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:c}}static fromJSON(e){return new rl(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Pr extends Ke{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],s=[];function c(g,v,b,y){const S=y+1,M=[];for(let w=0;w<=S;w++){M[w]=[];const T=g.clone().lerp(b,w/S),R=v.clone().lerp(b,w/S),L=S-w;for(let P=0;P<=L;P++)M[w][P]=P===0&&w===S?T:T.clone().lerp(R,P/L)}for(let w=0;w<S;w++)for(let T=0;T<2*(S-w)-1;T++){const R=Math.floor(T/2);T%2==0?(u(M[w][R+1]),u(M[w+1][R]),u(M[w][R])):(u(M[w][R+1]),u(M[w+1][R+1]),u(M[w+1][R]))}}function u(g){r.push(g.x,g.y,g.z)}function d(g,v){const b=3*g;v.x=e[b+0],v.y=e[b+1],v.z=e[b+2]}function p(g,v,b,y){y<0&&g.x===1&&(s[v]=g.x-1),b.x===0&&b.z===0&&(s[v]=y/2/Math.PI+.5)}function f(g){return Math.atan2(g.z,-g.x)}(function(g){const v=new C,b=new C,y=new C;for(let S=0;S<t.length;S+=3)d(t[S+0],v),d(t[S+1],b),d(t[S+2],y),c(v,b,y,g)})(i),function(g){const v=new C;for(let b=0;b<r.length;b+=3)v.x=r[b+0],v.y=r[b+1],v.z=r[b+2],v.normalize().multiplyScalar(g),r[b+0]=v.x,r[b+1]=v.y,r[b+2]=v.z}(n),function(){const g=new C;for(let b=0;b<r.length;b+=3){g.x=r[b+0],g.y=r[b+1],g.z=r[b+2];const y=f(g)/2/Math.PI+.5,S=(v=g,Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))/Math.PI+.5);s.push(y,1-S)}var v;(function(){const b=new C,y=new C,S=new C,M=new C,w=new ce,T=new ce,R=new ce;for(let L=0,P=0;L<r.length;L+=9,P+=6){b.set(r[L+0],r[L+1],r[L+2]),y.set(r[L+3],r[L+4],r[L+5]),S.set(r[L+6],r[L+7],r[L+8]),w.set(s[P+0],s[P+1]),T.set(s[P+2],s[P+3]),R.set(s[P+4],s[P+5]),M.copy(b).add(y).add(S).divideScalar(3);const I=f(M);p(w,P+0,b,I),p(T,P+2,y,I),p(R,P+4,S,I)}})(),function(){for(let b=0;b<s.length;b+=6){const y=s[b+0],S=s[b+2],M=s[b+4],w=Math.max(y,S,M),T=Math.min(y,S,M);w>.9&&T<.1&&(y<.2&&(s[b+0]+=1),S<.2&&(s[b+2]+=1),M<.2&&(s[b+4]+=1))}}()}(),this.setAttribute("position",new Ge(r,3)),this.setAttribute("normal",new Ge(r.slice(),3)),this.setAttribute("uv",new Ge(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pr(e.vertices,e.indices,e.radius,e.details)}}class al extends Pr{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new al(e.radius,e.detail)}}const rd=new C,ad=new C,Wm=new C,sd=new Bi;class Xm extends Ke{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),r=Math.cos(Es*t),s=e.getIndex(),c=e.getAttribute("position"),u=s?s.count:c.count,d=[0,0,0],p=["a","b","c"],f=new Array(3),g={},v=[];for(let b=0;b<u;b+=3){s?(d[0]=s.getX(b),d[1]=s.getX(b+1),d[2]=s.getX(b+2)):(d[0]=b,d[1]=b+1,d[2]=b+2);const{a:y,b:S,c:M}=sd;if(y.fromBufferAttribute(c,d[0]),S.fromBufferAttribute(c,d[1]),M.fromBufferAttribute(c,d[2]),sd.getNormal(Wm),f[0]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,f[1]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,f[2]=`${Math.round(M.x*i)},${Math.round(M.y*i)},${Math.round(M.z*i)}`,f[0]!==f[1]&&f[1]!==f[2]&&f[2]!==f[0])for(let w=0;w<3;w++){const T=(w+1)%3,R=f[w],L=f[T],P=sd[p[w]],I=sd[p[T]],V=`${R}_${L}`,z=`${L}_${R}`;z in g&&g[z]?(Wm.dot(g[z].normal)<=r&&(v.push(P.x,P.y,P.z),v.push(I.x,I.y,I.z)),g[z]=null):V in g||(g[V]={index0:d[w],index1:d[T],normal:Wm.clone()})}}for(const b in g)if(g[b]){const{index0:y,index1:S}=g[b];rd.fromBufferAttribute(c,y),ad.fromBufferAttribute(c,S),v.push(rd.x,rd.y,rd.z),v.push(ad.x,ad.y,ad.z)}this.setAttribute("position",new Ge(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ia extends Oc{constructor(e){super(e),this.uuid=Ai(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new Oc().fromJSON(i))}return this}}const EA=function(o,e,t=2){const n=e&&e.length,i=n?e[0]*t:o.length;let r=jx(o,0,i,t,!0);const s=[];if(!r||r.next===r.prev)return s;let c,u,d,p,f,g,v;if(n&&(r=function(b,y,S,M){const w=[];let T,R,L,P,I;for(T=0,R=y.length;T<R;T++)L=y[T]*M,P=T<R-1?y[T+1]*M:b.length,I=jx(b,L,P,M,!1),I===I.next&&(I.steiner=!0),w.push(IA(I));for(w.sort(CA),T=0;T<w.length;T++)S=DA(w[T],S);return S}(o,e,r,t)),o.length>80*t){c=d=o[0],u=p=o[1];for(let b=t;b<i;b+=t)f=o[b],g=o[b+1],f<c&&(c=f),g<u&&(u=g),f>d&&(d=f),g>p&&(p=g);v=Math.max(d-c,p-u),v=v!==0?32767/v:0}return Ic(r,s,t,c,u,v,0),s};function jx(o,e,t,n,i){let r,s;if(i===function(c,u,d,p){let f=0;for(let g=u,v=d-p;g<d;g+=p)f+=(c[v]-c[g])*(c[g+1]+c[v+1]),v=g;return f}(o,e,t,n)>0)for(r=e;r<t;r+=n)s=Wx(r,o[r],o[r+1],s);else for(r=t-n;r>=e;r-=n)s=Wx(r,o[r],o[r+1],s);return s&&od(s,s.next)&&(kc(s),s=s.next),s}function Is(o,e){if(!o)return o;e||(e=o);let t,n=o;do if(t=!1,n.steiner||!od(n,n.next)&&Jt(n.prev,n,n.next)!==0)n=n.next;else{if(kc(n),n=e=n.prev,n===n.next)break;t=!0}while(t||n!==e);return e}function Ic(o,e,t,n,i,r,s){if(!o)return;!s&&r&&function(p,f,g,v){let b=p;do b.z===0&&(b.z=qm(b.x,b.y,f,g,v)),b.prevZ=b.prev,b.nextZ=b.next,b=b.next;while(b!==p);b.prevZ.nextZ=null,b.prevZ=null,function(y){let S,M,w,T,R,L,P,I,V=1;do{for(M=y,y=null,R=null,L=0;M;){for(L++,w=M,P=0,S=0;S<V&&(P++,w=w.nextZ,w);S++);for(I=V;P>0||I>0&&w;)P!==0&&(I===0||!w||M.z<=w.z)?(T=M,M=M.nextZ,P--):(T=w,w=w.nextZ,I--),R?R.nextZ=T:y=T,T.prevZ=R,R=T;M=w}R.nextZ=null,V*=2}while(L>1)}(b)}(o,n,i,r);let c,u,d=o;for(;o.prev!==o.next;)if(c=o.prev,u=o.next,r?RA(o,n,i,r):AA(o))e.push(c.i/t|0),e.push(o.i/t|0),e.push(u.i/t|0),kc(o),o=u.next,d=u.next;else if((o=u)===d){s?s===1?Ic(o=LA(Is(o),e,t),e,t,n,i,r,2):s===2&&PA(o,e,t,n,i,r):Ic(Is(o),e,t,n,i,r,1);break}}function AA(o){const e=o.prev,t=o,n=o.next;if(Jt(e,t,n)>=0)return!1;const i=e.x,r=t.x,s=n.x,c=e.y,u=t.y,d=n.y,p=i<r?i<s?i:s:r<s?r:s,f=c<u?c<d?c:d:u<d?u:d,g=i>r?i>s?i:s:r>s?r:s,v=c>u?c>d?c:d:u>d?u:d;let b=n.next;for(;b!==e;){if(b.x>=p&&b.x<=g&&b.y>=f&&b.y<=v&&sl(i,c,r,u,s,d,b.x,b.y)&&Jt(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function RA(o,e,t,n){const i=o.prev,r=o,s=o.next;if(Jt(i,r,s)>=0)return!1;const c=i.x,u=r.x,d=s.x,p=i.y,f=r.y,g=s.y,v=c<u?c<d?c:d:u<d?u:d,b=p<f?p<g?p:g:f<g?f:g,y=c>u?c>d?c:d:u>d?u:d,S=p>f?p>g?p:g:f>g?f:g,M=qm(v,b,e,t,n),w=qm(y,S,e,t,n);let T=o.prevZ,R=o.nextZ;for(;T&&T.z>=M&&R&&R.z<=w;){if(T.x>=v&&T.x<=y&&T.y>=b&&T.y<=S&&T!==i&&T!==s&&sl(c,p,u,f,d,g,T.x,T.y)&&Jt(T.prev,T,T.next)>=0||(T=T.prevZ,R.x>=v&&R.x<=y&&R.y>=b&&R.y<=S&&R!==i&&R!==s&&sl(c,p,u,f,d,g,R.x,R.y)&&Jt(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;T&&T.z>=M;){if(T.x>=v&&T.x<=y&&T.y>=b&&T.y<=S&&T!==i&&T!==s&&sl(c,p,u,f,d,g,T.x,T.y)&&Jt(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;R&&R.z<=w;){if(R.x>=v&&R.x<=y&&R.y>=b&&R.y<=S&&R!==i&&R!==s&&sl(c,p,u,f,d,g,R.x,R.y)&&Jt(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function LA(o,e,t){let n=o;do{const i=n.prev,r=n.next.next;!od(i,r)&&Gx(i,n,n.next,r)&&Nc(i,r)&&Nc(r,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(r.i/t|0),kc(n),kc(n.next),n=o=r),n=n.next}while(n!==o);return Is(n)}function PA(o,e,t,n,i,r){let s=o;do{let c=s.next.next;for(;c!==s.prev;){if(s.i!==c.i&&NA(s,c)){let u=Vx(s,c);return s=Is(s,s.next),u=Is(u,u.next),Ic(s,e,t,n,i,r,0),void Ic(u,e,t,n,i,r,0)}c=c.next}s=s.next}while(s!==o)}function CA(o,e){return o.x-e.x}function DA(o,e){const t=function(i,r){let s,c=r,u=-1/0;const d=i.x,p=i.y;do{if(p<=c.y&&p>=c.next.y&&c.next.y!==c.y){const S=c.x+(p-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(S<=d&&S>u&&(u=S,s=c.x<c.next.x?c:c.next,S===d))return s}c=c.next}while(c!==r);if(!s)return null;const f=s,g=s.x,v=s.y;let b,y=1/0;c=s;do d>=c.x&&c.x>=g&&d!==c.x&&sl(p<v?d:u,p,g,v,p<v?u:d,p,c.x,c.y)&&(b=Math.abs(p-c.y)/(d-c.x),Nc(c,i)&&(b<y||b===y&&(c.x>s.x||c.x===s.x&&OA(s,c)))&&(s=c,y=b)),c=c.next;while(c!==f);return s}(o,e);if(!t)return e;const n=Vx(t,o);return Is(n,n.next),Is(t,t.next)}function OA(o,e){return Jt(o.prev,o,e.prev)<0&&Jt(e.next,o,o.next)<0}function qm(o,e,t,n,i){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-t)*i|0)|o<<8))|o<<4))|o<<2))|o<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function IA(o){let e=o,t=o;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==o);return t}function sl(o,e,t,n,i,r,s,c){return(i-s)*(e-c)>=(o-s)*(r-c)&&(o-s)*(n-c)>=(t-s)*(e-c)&&(t-s)*(r-c)>=(i-s)*(n-c)}function NA(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!function(t,n){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==n.i&&i.next.i!==n.i&&Gx(i,i.next,t,n))return!0;i=i.next}while(i!==t);return!1}(o,e)&&(Nc(o,e)&&Nc(e,o)&&function(t,n){let i=t,r=!1;const s=(t.x+n.x)/2,c=(t.y+n.y)/2;do i.y>c!=i.next.y>c&&i.next.y!==i.y&&s<(i.next.x-i.x)*(c-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==t);return r}(o,e)&&(Jt(o.prev,o,e.prev)||Jt(o,e.prev,e))||od(o,e)&&Jt(o.prev,o,o.next)>0&&Jt(e.prev,e,e.next)>0)}function Jt(o,e,t){return(e.y-o.y)*(t.x-e.x)-(e.x-o.x)*(t.y-e.y)}function od(o,e){return o.x===e.x&&o.y===e.y}function Gx(o,e,t,n){const i=cd(Jt(o,e,t)),r=cd(Jt(o,e,n)),s=cd(Jt(t,n,o)),c=cd(Jt(t,n,e));return i!==r&&s!==c||!(i!==0||!ld(o,t,e))||!(r!==0||!ld(o,n,e))||!(s!==0||!ld(t,o,n))||!(c!==0||!ld(t,e,n))}function ld(o,e,t){return e.x<=Math.max(o.x,t.x)&&e.x>=Math.min(o.x,t.x)&&e.y<=Math.max(o.y,t.y)&&e.y>=Math.min(o.y,t.y)}function cd(o){return o>0?1:o<0?-1:0}function Nc(o,e){return Jt(o.prev,o,o.next)<0?Jt(o,e,o.next)>=0&&Jt(o,o.prev,e)>=0:Jt(o,e,o.prev)<0||Jt(o,o.next,e)<0}function Vx(o,e){const t=new Ym(o.i,o.x,o.y),n=new Ym(e.i,e.x,e.y),i=o.next,r=e.prev;return o.next=e,e.prev=o,t.next=i,i.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function Wx(o,e,t,n){const i=new Ym(o,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function kc(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Ym(o,e,t){this.i=o,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Cr{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return .5*n}static isClockWise(e){return Cr.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];Xx(e),qx(n,e);let s=e.length;t.forEach(Xx);for(let u=0;u<t.length;u++)i.push(s),s+=t[u].length,qx(n,t[u]);const c=EA(n,i);for(let u=0;u<c.length;u+=3)r.push(c.slice(u,u+3));return r}}function Xx(o){const e=o.length;e>2&&o[e-1].equals(o[0])&&o.pop()}function qx(o,e){for(let t=0;t<e.length;t++)o.push(e[t].x),o.push(e[t].y)}class ol extends Ke{constructor(e=new ia([new ce(.5,.5),new ce(-.5,.5),new ce(-.5,-.5),new ce(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let c=0,u=e.length;c<u;c++)s(e[c]);function s(c){const u=[],d=t.curveSegments!==void 0?t.curveSegments:12,p=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let g=t.bevelEnabled===void 0||t.bevelEnabled,v=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:v-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,S=t.bevelSegments!==void 0?t.bevelSegments:3;const M=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:kA;let T,R,L,P,I,V=!1;M&&(T=M.getSpacedPoints(p),V=!0,g=!1,R=M.computeFrenetFrames(p,!1),L=new C,P=new C,I=new C),g||(S=0,v=0,b=0,y=0);const z=c.extractPoints(d);let G=z.shape;const F=z.holes;if(!Cr.isClockWise(G)){G=G.reverse();for(let q=0,H=F.length;q<H;q++){const J=F[q];Cr.isClockWise(J)&&(F[q]=J.reverse())}}const $=Cr.triangulateShape(G,F),le=G;for(let q=0,H=F.length;q<H;q++){const J=F[q];G=G.concat(J)}function ae(q,H,J){return H||console.error("THREE.ExtrudeGeometry: vec does not exist"),q.clone().addScaledVector(H,J)}const ye=G.length,pe=$.length;function Me(q,H,J){let O,W,Y;const ee=q.x-H.x,te=q.y-H.y,de=J.x-q.x,Oe=J.y-q.y,ze=ee*ee+te*te,Ve=ee*Oe-te*de;if(Math.abs(Ve)>Number.EPSILON){const Be=Math.sqrt(ze),nt=Math.sqrt(de*de+Oe*Oe),lt=H.x-te/Be,et=H.y+ee/Be,pt=((J.x-Oe/nt-lt)*Oe-(J.y+de/nt-et)*de)/(ee*Oe-te*de);O=lt+ee*pt-q.x,W=et+te*pt-q.y;const Ct=O*O+W*W;if(Ct<=2)return new ce(O,W);Y=Math.sqrt(Ct/2)}else{let Be=!1;ee>Number.EPSILON?de>Number.EPSILON&&(Be=!0):ee<-Number.EPSILON?de<-Number.EPSILON&&(Be=!0):Math.sign(te)===Math.sign(Oe)&&(Be=!0),Be?(O=-te,W=ee,Y=Math.sqrt(ze)):(O=ee,W=te,Y=Math.sqrt(ze/2))}return new ce(O/Y,W/Y)}const Ee=[];for(let q=0,H=le.length,J=H-1,O=q+1;q<H;q++,J++,O++)J===H&&(J=0),O===H&&(O=0),Ee[q]=Me(le[q],le[J],le[O]);const Re=[];let he,ne=Ee.concat();for(let q=0,H=F.length;q<H;q++){const J=F[q];he=[];for(let O=0,W=J.length,Y=W-1,ee=O+1;O<W;O++,Y++,ee++)Y===W&&(Y=0),ee===W&&(ee=0),he[O]=Me(J[O],J[Y],J[ee]);Re.push(he),ne=ne.concat(he)}for(let q=0;q<S;q++){const H=q/S,J=v*Math.cos(H*Math.PI/2),O=b*Math.sin(H*Math.PI/2)+y;for(let W=0,Y=le.length;W<Y;W++){const ee=ae(le[W],Ee[W],O);Se(ee.x,ee.y,-J)}for(let W=0,Y=F.length;W<Y;W++){const ee=F[W];he=Re[W];for(let te=0,de=ee.length;te<de;te++){const Oe=ae(ee[te],he[te],O);Se(Oe.x,Oe.y,-J)}}}const me=b+y;for(let q=0;q<ye;q++){const H=g?ae(G[q],ne[q],me):G[q];V?(P.copy(R.normals[0]).multiplyScalar(H.x),L.copy(R.binormals[0]).multiplyScalar(H.y),I.copy(T[0]).add(P).add(L),Se(I.x,I.y,I.z)):Se(H.x,H.y,0)}for(let q=1;q<=p;q++)for(let H=0;H<ye;H++){const J=g?ae(G[H],ne[H],me):G[H];V?(P.copy(R.normals[q]).multiplyScalar(J.x),L.copy(R.binormals[q]).multiplyScalar(J.y),I.copy(T[q]).add(P).add(L),Se(I.x,I.y,I.z)):Se(J.x,J.y,f/p*q)}for(let q=S-1;q>=0;q--){const H=q/S,J=v*Math.cos(H*Math.PI/2),O=b*Math.sin(H*Math.PI/2)+y;for(let W=0,Y=le.length;W<Y;W++){const ee=ae(le[W],Ee[W],O);Se(ee.x,ee.y,f+J)}for(let W=0,Y=F.length;W<Y;W++){const ee=F[W];he=Re[W];for(let te=0,de=ee.length;te<de;te++){const Oe=ae(ee[te],he[te],O);V?Se(Oe.x,Oe.y+T[p-1].y,T[p-1].x+J):Se(Oe.x,Oe.y,f+J)}}}function Ae(q,H){let J=q.length;for(;--J>=0;){const O=J;let W=J-1;W<0&&(W=q.length-1);for(let Y=0,ee=p+2*S;Y<ee;Y++){const te=ye*Y,de=ye*(Y+1);j(H+O+te,H+W+te,H+W+de,H+O+de)}}}function Se(q,H,J){u.push(q),u.push(H),u.push(J)}function Ne(q,H,J){U(q),U(H),U(J);const O=i.length/3,W=w.generateTopUV(n,i,O-3,O-2,O-1);ie(W[0]),ie(W[1]),ie(W[2])}function j(q,H,J,O){U(q),U(H),U(O),U(H),U(J),U(O);const W=i.length/3,Y=w.generateSideWallUV(n,i,W-6,W-3,W-2,W-1);ie(Y[0]),ie(Y[1]),ie(Y[3]),ie(Y[1]),ie(Y[2]),ie(Y[3])}function U(q){i.push(u[3*q+0]),i.push(u[3*q+1]),i.push(u[3*q+2])}function ie(q){r.push(q.x),r.push(q.y)}(function(){const q=i.length/3;if(g){let H=0,J=ye*H;for(let O=0;O<pe;O++){const W=$[O];Ne(W[2]+J,W[1]+J,W[0]+J)}H=p+2*S,J=ye*H;for(let O=0;O<pe;O++){const W=$[O];Ne(W[0]+J,W[1]+J,W[2]+J)}}else{for(let H=0;H<pe;H++){const J=$[H];Ne(J[2],J[1],J[0])}for(let H=0;H<pe;H++){const J=$[H];Ne(J[0]+ye*p,J[1]+ye*p,J[2]+ye*p)}}n.addGroup(q,i.length/3-q,0)})(),function(){const q=i.length/3;let H=0;Ae(le,H),H+=le.length;for(let J=0,O=F.length;J<O;J++){const W=F[J];Ae(W,H),H+=W.length}n.addGroup(q,i.length/3-q,1)}()}this.setAttribute("position",new Ge(i,3)),this.setAttribute("uv",new Ge(r,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(t,n,i){if(i.shapes=[],Array.isArray(t))for(let r=0,s=t.length;r<s;r++){const c=t[r];i.shapes.push(c.uuid)}else i.shapes.push(t.uuid);return i.options=Object.assign({},n),n.extrudePath!==void 0&&(i.options.extrudePath=n.extrudePath.toJSON()),i}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const c=t[e.shapes[r]];n.push(c)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new a[i.type]().fromJSON(i)),new ol(n,e.options)}}const kA={generateTopUV:function(o,e,t,n,i){const r=e[3*t],s=e[3*t+1],c=e[3*n],u=e[3*n+1],d=e[3*i],p=e[3*i+1];return[new ce(r,s),new ce(c,u),new ce(d,p)]},generateSideWallUV:function(o,e,t,n,i,r){const s=e[3*t],c=e[3*t+1],u=e[3*t+2],d=e[3*n],p=e[3*n+1],f=e[3*n+2],g=e[3*i],v=e[3*i+1],b=e[3*i+2],y=e[3*r],S=e[3*r+1],M=e[3*r+2];return Math.abs(c-p)<Math.abs(s-d)?[new ce(s,1-u),new ce(d,1-f),new ce(g,1-b),new ce(y,1-M)]:[new ce(c,1-u),new ce(p,1-f),new ce(v,1-b),new ce(S,1-M)]}};class ll extends Pr{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ll(e.radius,e.detail)}}class Ns extends Pr{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ns(e.radius,e.detail)}}class cl extends Ke{constructor(e=.5,t=1,n=32,i=1,r=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:s},n=Math.max(3,n);const c=[],u=[],d=[],p=[];let f=e;const g=(t-e)/(i=Math.max(1,i)),v=new C,b=new ce;for(let y=0;y<=i;y++){for(let S=0;S<=n;S++){const M=r+S/n*s;v.x=f*Math.cos(M),v.y=f*Math.sin(M),u.push(v.x,v.y,v.z),d.push(0,0,1),b.x=(v.x/t+1)/2,b.y=(v.y/t+1)/2,p.push(b.x,b.y)}f+=g}for(let y=0;y<i;y++){const S=y*(n+1);for(let M=0;M<n;M++){const w=M+S,T=w,R=w+n+1,L=w+n+2,P=w+1;c.push(T,R,P),c.push(R,L,P)}}this.setIndex(c),this.setAttribute("position",new Ge(u,3)),this.setAttribute("normal",new Ge(d,3)),this.setAttribute("uv",new Ge(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cl(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ul extends Ke{constructor(e=new ia([new ce(0,.5),new ce(-.5,-.5),new ce(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],s=[];let c=0,u=0;if(Array.isArray(e)===!1)d(e);else for(let p=0;p<e.length;p++)d(e[p]),this.addGroup(c,u,p),c+=u,u=0;function d(p){const f=i.length/3,g=p.extractPoints(t);let v=g.shape;const b=g.holes;Cr.isClockWise(v)===!1&&(v=v.reverse());for(let S=0,M=b.length;S<M;S++){const w=b[S];Cr.isClockWise(w)===!0&&(b[S]=w.reverse())}const y=Cr.triangulateShape(v,b);for(let S=0,M=b.length;S<M;S++){const w=b[S];v=v.concat(w)}for(let S=0,M=v.length;S<M;S++){const w=v[S];i.push(w.x,w.y,0),r.push(0,0,1),s.push(w.x,w.y)}for(let S=0,M=y.length;S<M;S++){const w=y[S],T=w[0]+f,R=w[1]+f,L=w[2]+f;n.push(T,R,L),u+=3}}this.setIndex(n),this.setAttribute("position",new Ge(i,3)),this.setAttribute("normal",new Ge(r,3)),this.setAttribute("uv",new Ge(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(t,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const s=t[e.shapes[i]];n.push(s)}return new ul(n,e.curveSegments)}}class Fa extends Ke{constructor(e=1,t=32,n=16,i=0,r=2*Math.PI,s=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(s+c,Math.PI);let d=0;const p=[],f=new C,g=new C,v=[],b=[],y=[],S=[];for(let M=0;M<=n;M++){const w=[],T=M/n;let R=0;M==0&&s==0?R=.5/t:M==n&&u==Math.PI&&(R=-.5/t);for(let L=0;L<=t;L++){const P=L/t;f.x=-e*Math.cos(i+P*r)*Math.sin(s+T*c),f.y=e*Math.cos(s+T*c),f.z=e*Math.sin(i+P*r)*Math.sin(s+T*c),b.push(f.x,f.y,f.z),g.copy(f).normalize(),y.push(g.x,g.y,g.z),S.push(P+R,1-T),w.push(d++)}p.push(w)}for(let M=0;M<n;M++)for(let w=0;w<t;w++){const T=p[M][w+1],R=p[M][w],L=p[M+1][w],P=p[M+1][w+1];(M!==0||s>0)&&v.push(T,R,P),(M!==n-1||u<Math.PI)&&v.push(R,L,P)}this.setIndex(v),this.setAttribute("position",new Ge(b,3)),this.setAttribute("normal",new Ge(y,3)),this.setAttribute("uv",new Ge(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fa(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class hl extends Pr{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hl(e.radius,e.detail)}}class dl extends Ke{constructor(e=1,t=.4,n=12,i=48,r=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const s=[],c=[],u=[],d=[],p=new C,f=new C,g=new C;for(let v=0;v<=n;v++)for(let b=0;b<=i;b++){const y=b/i*r,S=v/n*Math.PI*2;f.x=(e+t*Math.cos(S))*Math.cos(y),f.y=(e+t*Math.cos(S))*Math.sin(y),f.z=t*Math.sin(S),c.push(f.x,f.y,f.z),p.x=e*Math.cos(y),p.y=e*Math.sin(y),g.subVectors(f,p).normalize(),u.push(g.x,g.y,g.z),d.push(b/i),d.push(v/n)}for(let v=1;v<=n;v++)for(let b=1;b<=i;b++){const y=(i+1)*v+b-1,S=(i+1)*(v-1)+b-1,M=(i+1)*(v-1)+b,w=(i+1)*v+b;s.push(y,S,w),s.push(S,M,w)}this.setIndex(s),this.setAttribute("position",new Ge(c,3)),this.setAttribute("normal",new Ge(u,3)),this.setAttribute("uv",new Ge(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dl(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class pl extends Ke{constructor(e=1,t=.4,n=64,i=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);const c=[],u=[],d=[],p=[],f=new C,g=new C,v=new C,b=new C,y=new C,S=new C,M=new C;for(let T=0;T<=n;++T){const R=T/n*r*Math.PI*2;w(R,r,s,e,v),w(R+.01,r,s,e,b),S.subVectors(b,v),M.addVectors(b,v),y.crossVectors(S,M),M.crossVectors(y,S),y.normalize(),M.normalize();for(let L=0;L<=i;++L){const P=L/i*Math.PI*2,I=-t*Math.cos(P),V=t*Math.sin(P);f.x=v.x+(I*M.x+V*y.x),f.y=v.y+(I*M.y+V*y.y),f.z=v.z+(I*M.z+V*y.z),u.push(f.x,f.y,f.z),g.subVectors(f,v).normalize(),d.push(g.x,g.y,g.z),p.push(T/n),p.push(L/i)}}for(let T=1;T<=n;T++)for(let R=1;R<=i;R++){const L=(i+1)*(T-1)+(R-1),P=(i+1)*T+(R-1),I=(i+1)*T+R,V=(i+1)*(T-1)+R;c.push(L,P,V),c.push(P,I,V)}function w(T,R,L,P,I){const V=Math.cos(T),z=Math.sin(T),G=L/R*T,F=Math.cos(G);I.x=P*(2+F)*.5*V,I.y=P*(2+F)*z*.5,I.z=P*Math.sin(G)*.5}this.setIndex(c),this.setAttribute("position",new Ge(u,3)),this.setAttribute("normal",new Ge(d,3)),this.setAttribute("uv",new Ge(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pl(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class fl extends Ke{constructor(e=new id(new C(-1,-1,0),new C(-1,1,0),new C(1,1,0)),t=64,n=1,i=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const c=new C,u=new C,d=new ce;let p=new C;const f=[],g=[],v=[],b=[];function y(S){p=e.getPointAt(S/t,p);const M=s.normals[S],w=s.binormals[S];for(let T=0;T<=i;T++){const R=T/i*Math.PI*2,L=Math.sin(R),P=-Math.cos(R);u.x=P*M.x+L*w.x,u.y=P*M.y+L*w.y,u.z=P*M.z+L*w.z,u.normalize(),g.push(u.x,u.y,u.z),c.x=p.x+n*u.x,c.y=p.y+n*u.y,c.z=p.z+n*u.z,f.push(c.x,c.y,c.z)}}(function(){for(let S=0;S<t;S++)y(S);y(r===!1?t:0),function(){for(let S=0;S<=t;S++)for(let M=0;M<=i;M++)d.x=S/t,d.y=M/i,v.push(d.x,d.y)}(),function(){for(let S=1;S<=t;S++)for(let M=1;M<=i;M++){const w=(i+1)*(S-1)+(M-1),T=(i+1)*S+(M-1),R=(i+1)*S+M,L=(i+1)*(S-1)+M;b.push(w,T,L),b.push(T,R,L)}}()})(),this.setIndex(b),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(g,3)),this.setAttribute("uv",new Ge(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new fl(new a[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Qm extends Ke{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new C,r=new C;if(e.index!==null){const s=e.attributes.position,c=e.index;let u=e.groups;u.length===0&&(u=[{start:0,count:c.count,materialIndex:0}]);for(let d=0,p=u.length;d<p;++d){const f=u[d],g=f.start;for(let v=g,b=g+f.count;v<b;v+=3)for(let y=0;y<3;y++){const S=c.getX(v+y),M=c.getX(v+(y+1)%3);i.fromBufferAttribute(s,S),r.fromBufferAttribute(s,M),Yx(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let c=0,u=s.count/3;c<u;c++)for(let d=0;d<3;d++){const p=3*c+d,f=3*c+(d+1)%3;i.fromBufferAttribute(s,p),r.fromBufferAttribute(s,f),Yx(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Ge(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Yx(o,e,t){const n=`${o.x},${o.y},${o.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${o.x},${o.y},${o.z}`;return t.has(n)!==!0&&t.has(i)!==!0&&(t.add(n),t.add(i),!0)}class Qx extends on{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Pe(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Zx extends xt{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class zt extends on{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Aa,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ra extends zt{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ce(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return nn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Pe(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Pe(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pe(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Fc extends on{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Pe(16777215),this.specular=new Pe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Aa,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=sc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Kx extends on{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pe(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Aa,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Zm extends on{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Aa,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Km extends on{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Pe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Aa,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=sc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Jx extends on{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pe(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Aa,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $x extends In{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Gi(o,e,t){return Jm(o)?new o.constructor(o.subarray(e,t!==void 0?t:o.length)):o.slice(e,t)}function ks(o,e,t){return!o||!t&&o.constructor===e?o:typeof e.BYTES_PER_ELEMENT=="number"?new e(o):Array.prototype.slice.call(o)}function Jm(o){return ArrayBuffer.isView(o)&&!(o instanceof DataView)}function eb(o){const e=o.length,t=new Array(e);for(let n=0;n!==e;++n)t[n]=n;return t.sort(function(n,i){return o[n]-o[i]}),t}function $m(o,e,t){const n=o.length,i=new o.constructor(n);for(let r=0,s=0;s!==n;++r){const c=t[r]*e;for(let u=0;u!==e;++u)i[s++]=o[c+u]}return i}function e0(o,e,t,n){let i=1,r=o[0];for(;r!==void 0&&r[n]===void 0;)r=o[i++];if(r===void 0)return;let s=r[n];if(s!==void 0)if(Array.isArray(s))do s=r[n],s!==void 0&&(e.push(r.time),t.push.apply(t,s)),r=o[i++];while(r!==void 0);else if(s.toArray!==void 0)do s=r[n],s!==void 0&&(e.push(r.time),s.toArray(t,t.length)),r=o[i++];while(r!==void 0);else do s=r[n],s!==void 0&&(e.push(r.time),t.push(s)),r=o[i++];while(r!==void 0)}const FA={arraySlice:Gi,convertArray:ks,isTypedArray:Jm,getKeyframeOrder:eb,sortedArray:$m,flattenJSON:e0,subclip:function(o,e,t,n,i=30){const r=o.clone();r.name=e;const s=[];for(let u=0;u<r.tracks.length;++u){const d=r.tracks[u],p=d.getValueSize(),f=[],g=[];for(let v=0;v<d.times.length;++v){const b=d.times[v]*i;if(!(b<t||b>=n)){f.push(d.times[v]);for(let y=0;y<p;++y)g.push(d.values[v*p+y])}}f.length!==0&&(d.times=ks(f,d.times.constructor),d.values=ks(g,d.values.constructor),s.push(d))}r.tracks=s;let c=1/0;for(let u=0;u<r.tracks.length;++u)c>r.tracks[u].times[0]&&(c=r.tracks[u].times[0]);for(let u=0;u<r.tracks.length;++u)r.tracks[u].shift(-1*c);return r.resetDuration(),r},makeClipAdditive:function(o,e=0,t=o,n=30){n<=0&&(n=30);const i=t.tracks.length,r=e/n;for(let s=0;s<i;++s){const c=t.tracks[s],u=c.ValueTypeName;if(u==="bool"||u==="string")continue;const d=o.tracks.find(function(M){return M.name===c.name&&M.ValueTypeName===u});if(d===void 0)continue;let p=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=f/3);let g=0;const v=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);const b=c.times.length-1;let y;if(r<=c.times[0]){const M=p,w=f-p;y=Gi(c.values,M,w)}else if(r>=c.times[b]){const M=b*f+p,w=M+f-p;y=Gi(c.values,M,w)}else{const M=c.createInterpolant(),w=p,T=f-p;M.evaluate(r),y=Gi(M.resultBuffer,w,T)}u==="quaternion"&&new Ft().fromArray(y).normalize().conjugate().toArray(y);const S=d.times.length;for(let M=0;M<S;++M){const w=M*v+g;if(u==="quaternion")Ft.multiplyQuaternionsFlat(d.values,w,y,0,d.values,w);else{const T=v-2*g;for(let R=0;R<T;++R)d.values[w+R]-=y[R]}}}return o.blendMode=Yf,o}};class ml{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let c=n+2;;){if(i===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const c=t[1];e<c&&(n=2,r=c);for(let u=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const c=n+s>>>1;e<t[c]?s=c:n=c+1}if(i=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class tb extends ml{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ms,endingEnd:Ms}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,c=i[r],u=i[s];if(c===void 0)switch(this.getSettings_().endingStart){case Ts:r=e,c=2*t-n;break;case cc:r=i.length-2,c=t+i[r]-i[r+1];break;default:r=e,c=n}if(u===void 0)switch(this.getSettings_().endingEnd){case Ts:s=e,u=2*n-t;break;case cc:s=1,u=n+i[1]-i[0];break;default:s=e-1,u=t}const d=.5*(n-t),p=this.valueSize;this._weightPrev=d/(t-c),this._weightNext=d/(u-n),this._offsetPrev=r*p,this._offsetNext=s*p}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,c=this.valueSize,u=e*c,d=u-c,p=this._offsetPrev,f=this._offsetNext,g=this._weightPrev,v=this._weightNext,b=(n-t)/(i-t),y=b*b,S=y*b,M=-g*S+2*g*y-g*b,w=(1+g)*S+(-1.5-2*g)*y+(-.5+g)*b+1,T=(-1-v)*S+(1.5+v)*y+.5*b,R=v*S-v*y;for(let L=0;L!==c;++L)r[L]=M*s[p+L]+w*s[d+L]+T*s[u+L]+R*s[f+L];return r}}class t0 extends ml{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,c=this.valueSize,u=e*c,d=u-c,p=(n-t)/(i-t),f=1-p;for(let g=0;g!==c;++g)r[g]=s[d+g]*f+s[u+g]*p;return r}}class nb extends ml{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class hr{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ks(t,this.TimeBufferType),this.values=ks(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ks(e.times,Array),values:ks(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new nb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new t0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new tb(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Po:t=this.InterpolantFactoryMethodDiscrete;break;case ws:t=this.InterpolantFactoryMethodLinear;break;case hh:t=this.InterpolantFactoryMethodSmooth}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Po;case this.InterpolantFactoryMethodLinear:return ws;case this.InterpolantFactoryMethodSmooth:return hh}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;s!==-1&&n[s]>t;)--s;if(++s,r!==0||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const c=this.getValueSize();this.times=Gi(n,r,s),this.values=Gi(this.values,r*c,s*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let c=0;c!==r;c++){const u=n[c];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,u),e=!1;break}if(s!==null&&s>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,u,s),e=!1;break}s=u}if(i!==void 0&&Jm(i))for(let c=0,u=i.length;c!==u;++c){const d=i[c];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,d),e=!1;break}}return e}optimize(){const e=Gi(this.times),t=Gi(this.values),n=this.getValueSize(),i=this.getInterpolation()===hh,r=e.length-1;let s=1;for(let c=1;c<r;++c){let u=!1;const d=e[c];if(d!==e[c+1]&&(c!==1||d!==e[0]))if(i)u=!0;else{const p=c*n,f=p-n,g=p+n;for(let v=0;v!==n;++v){const b=t[p+v];if(b!==t[f+v]||b!==t[g+v]){u=!0;break}}}if(u){if(c!==s){e[s]=e[c];const p=c*n,f=s*n;for(let g=0;g!==n;++g)t[f+g]=t[p+g]}++s}}if(r>0){e[s]=e[r];for(let c=r*n,u=s*n,d=0;d!==n;++d)t[u+d]=t[c+d];++s}return s!==e.length?(this.times=Gi(e,0,s),this.values=Gi(t,0,s*n)):(this.times=e,this.values=t),this}clone(){const e=Gi(this.times,0),t=Gi(this.values,0),n=new this.constructor(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}hr.prototype.TimeBufferType=Float32Array,hr.prototype.ValueBufferType=Float32Array,hr.prototype.DefaultInterpolation=ws;class Fs extends hr{}Fs.prototype.ValueTypeName="bool",Fs.prototype.ValueBufferType=Array,Fs.prototype.DefaultInterpolation=Po,Fs.prototype.InterpolantFactoryMethodLinear=void 0,Fs.prototype.InterpolantFactoryMethodSmooth=void 0;class n0 extends hr{}n0.prototype.ValueTypeName="color";class Us extends hr{}Us.prototype.ValueTypeName="number";class ib extends ml{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,c=this.valueSize,u=(n-t)/(i-t);let d=e*c;for(let p=d+c;d!==p;d+=4)Ft.slerpFlat(r,0,s,d-c,s,d,u);return r}}class aa extends hr{InterpolantFactoryMethodLinear(e){return new ib(this.times,this.values,this.getValueSize(),e)}}aa.prototype.ValueTypeName="quaternion",aa.prototype.DefaultInterpolation=ws,aa.prototype.InterpolantFactoryMethodSmooth=void 0;class zs extends hr{}zs.prototype.ValueTypeName="string",zs.prototype.ValueBufferType=Array,zs.prototype.DefaultInterpolation=Po,zs.prototype.InterpolantFactoryMethodLinear=void 0,zs.prototype.InterpolantFactoryMethodSmooth=void 0;class Bs extends hr{}Bs.prototype.ValueTypeName="vector";class Hs{constructor(e,t=-1,n,i=qf){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Ai(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,c=n.length;s!==c;++s)t.push(UA(n[s]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=n.length;r!==s;++r)t.push(hr.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,s=[];for(let c=0;c<r;c++){let u=[],d=[];u.push((c+r-1)%r,c,(c+1)%r),d.push(0,1,0);const p=eb(u);u=$m(u,1,p),d=$m(d,1,p),i||u[0]!==0||(u.push(r),d.push(d[0])),s.push(new Us(".morphTargetInfluences["+t[c].name+"]",u,d).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let c=0,u=e.length;c<u;c++){const d=e[c],p=d.name.match(r);if(p&&p.length>1){const f=p[1];let g=i[f];g||(i[f]=g=[]),g.push(d)}}const s=[];for(const c in i)s.push(this.CreateFromMorphTargetSequence(c,i[c],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(p,f,g,v,b){if(g.length!==0){const y=[],S=[];e0(g,y,S,v),y.length!==0&&b.push(new p(f,y,S))}},i=[],r=e.name||"default",s=e.fps||30,c=e.blendMode;let u=e.length||-1;const d=e.hierarchy||[];for(let p=0;p<d.length;p++){const f=d[p].keys;if(f&&f.length!==0)if(f[0].morphTargets){const g={};let v;for(v=0;v<f.length;v++)if(f[v].morphTargets)for(let b=0;b<f[v].morphTargets.length;b++)g[f[v].morphTargets[b]]=-1;for(const b in g){const y=[],S=[];for(let M=0;M!==f[v].morphTargets.length;++M){const w=f[v];y.push(w.time),S.push(w.morphTarget===b?1:0)}i.push(new Us(".morphTargetInfluence["+b+"]",y,S))}u=g.length*s}else{const g=".bones["+t[p].name+"]";n(Bs,g+".position",f,"pos",i),n(aa,g+".quaternion",f,"rot",i),n(Bs,g+".scale",f,"scl",i)}}return i.length===0?null:new this(r,u,i,c)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UA(o){if(o.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Us;case"vector":case"vector2":case"vector3":case"vector4":return Bs;case"color":return n0;case"quaternion":return aa;case"bool":case"boolean":return Fs;case"string":return zs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(o.type);if(o.times===void 0){const t=[],n=[];e0(o.keys,t,n,"value"),o.times=t,o.values=n}return e.parse!==void 0?e.parse(o):new e(o.name,o.times,o.values,o.interpolation)}const Ua={enabled:!1,files:{},add:function(o,e){this.enabled!==!1&&(this.files[o]=e)},get:function(o){if(this.enabled!==!1)return this.files[o]},remove:function(o){delete this.files[o]},clear:function(){this.files={}}};class i0{constructor(e,t,n){const i=this;let r,s=!1,c=0,u=0;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(p){u++,s===!1&&i.onStart!==void 0&&i.onStart(p,c,u),s=!0},this.itemEnd=function(p){c++,i.onProgress!==void 0&&i.onProgress(p,c,u),c===u&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(p){i.onError!==void 0&&i.onError(p)},this.resolveURL=function(p){return r?r(p):p},this.setURLModifier=function(p){return r=p,this},this.addHandler=function(p,f){return d.push(p,f),this},this.removeHandler=function(p){const f=d.indexOf(p);return f!==-1&&d.splice(f,2),this},this.getHandler=function(p){for(let f=0,g=d.length;f<g;f+=2){const v=d[f],b=d[f+1];if(v.global&&(v.lastIndex=0),v.test(p))return b}return null}}}const rb=new i0;class Wn{constructor(e){this.manager=e!==void 0?e:rb,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,r){n.load(e,i,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}async function ab(o){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(o)})}const sa={};class zA extends Error{constructor(e,t){super(e),this.response=t}}class ai extends Wn{constructor(e){super(e)}load(e,t,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=Ua.get(e);if(s===void 0&&r)return this.manager.itemStart(e),void(this.responseType==="arraybuffer"?async function(p){return new Promise((f,g)=>{const v=new FileReader;v.onload=()=>f(v.result),v.onerror=g,v.readAsArrayBuffer(p)})}(r):async function(p){return new Promise((f,g)=>{const v=new FileReader;v.onload=()=>f(v.result),v.onerror=g,v.readAsText(p)})}(r)).then(p=>{Ua.add(e,p),t&&t(p),this.manager.itemEnd(e)});if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(sa[e]!==void 0)return void sa[e].push({onLoad:t,onProgress:n,onError:i});sa[e]=[],sa[e].push({onLoad:t,onProgress:n,onError:i});const c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,d=this.responseType;fetch(c).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const f=sa[e],g=p.body.getReader(),v=p.headers.get("Content-Length")||p.headers.get("X-File-Size"),b=v?parseInt(v):0,y=b!==0;let S=0;const M=new ReadableStream({start(w){(function T(){g.read().then(({done:R,value:L})=>{if(R)w.close();else{S+=L.byteLength;const P=new ProgressEvent("progress",{lengthComputable:y,loaded:S,total:b});for(let I=0,V=f.length;I<V;I++){const z=f[I];z.onProgress&&z.onProgress(P)}w.enqueue(L),T()}})})()}});return new Response(M)}throw new zA(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(f=>new DOMParser().parseFromString(f,u));case"json":return p.json();default:if(u===void 0)return p.text();{const f=/charset="?([^;"\s]*)"?/i.exec(u),g=f&&f[1]?f[1].toLowerCase():void 0,v=new TextDecoder(g);return p.arrayBuffer().then(b=>v.decode(b))}}}).then(p=>{Ua.add(e,p);const f=sa[e];delete sa[e];for(let g=0,v=f.length;g<v;g++){const b=f[g];b.onLoad&&b.onLoad(p)}}).catch(p=>{const f=sa[e];if(f===void 0)throw this.manager.itemError(e),p;delete sa[e];for(let g=0,v=f.length;g<v;g++){const b=f[g];b.onError&&b.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class BA extends Wn{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new ai(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(u){i?i(u):console.error(u),r.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Hs.parse(e[n]);t.push(i)}return t}}class HA extends Wn{constructor(e){super(e)}load(e,t,n,i){const r=this,s=[],c=new Fm,u=new ai(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(r.withCredentials);let d=0;function p(f){u.load(e[f],function(g){const v=r.parse(g,!0);s[f]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},d+=1,d===6&&(v.mipmapCount===1&&(c.minFilter=rt),c.image=s,c.format=v.format,c.needsUpdate=!0,t&&t(c))},n,i)}if(Array.isArray(e))for(let f=0,g=e.length;f<g;++f)p(f);else u.load(e,function(f){const g=r.parse(f,!0);if(g.isCubemap){const v=g.mipmaps.length/g.mipmapCount;for(let b=0;b<v;b++){s[b]={mipmaps:[]};for(let y=0;y<g.mipmapCount;y++)s[b].mipmaps.push(g.mipmaps[b*g.mipmapCount+y]),s[b].format=g.format,s[b].width=g.width,s[b].height=g.height}c.image=s}else c.image.width=g.width,c.image.height=g.height,c.mipmaps=g.mipmaps;g.mipmapCount===1&&(c.minFilter=rt),c.format=g.format,c.needsUpdate=!0,t&&t(c)},n,i);return c}}class Uc extends Wn{constructor(e){super(e)}load(e,t,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,c=Ua.get(e);if(c!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(c),s.manager.itemEnd(e)},0),c;const u=pc("img");function d(){f(),Ua.add(e,this),t&&t(this),s.manager.itemEnd(e)}function p(g){f(),i&&i(g),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){u.removeEventListener("load",d,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",d,!1),u.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),s.manager.itemStart(e),r?ab(r).then(g=>{u.src=g}):u.src=e,u}}class jA extends Wn{constructor(e){super(e)}load(e,t,n,i){const r=new _c,s=new Uc(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let c=0;function u(d){s.load(e[d],function(p){r.images[d]=p,c++,c===6&&(r.needsUpdate=!0,t&&t(r))},void 0,i)}for(let d=0;d<e.length;++d)u(d);return r}}class sb extends Wn{constructor(e){super(e)}load(e,t,n,i,r){const s=this,c=new Ia,u=new ai(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(s.withCredentials),u.load(e,function(d){const p=s.parse(d);p&&(p.image!==void 0?c.image=p.image:p.data!==void 0&&(c.image.width=p.width,c.image.height=p.height,c.image.data=p.data),c.wrapS=p.wrapS!==void 0?p.wrapS:vn,c.wrapT=p.wrapT!==void 0?p.wrapT:vn,c.magFilter=p.magFilter!==void 0?p.magFilter:rt,c.minFilter=p.minFilter!==void 0?p.minFilter:rt,c.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.encoding!==void 0&&(c.encoding=p.encoding),p.flipY!==void 0&&(c.flipY=p.flipY),p.format!==void 0&&(c.format=p.format),p.type!==void 0&&(c.type=p.type),p.mipmaps!==void 0&&(c.mipmaps=p.mipmaps,c.minFilter=ir),p.mipmapCount===1&&(c.minFilter=rt),p.generateMipmaps!==void 0&&(c.generateMipmaps=p.generateMipmaps),c.needsUpdate=!0,t&&t(c,p))},n,i,r),c}}class ud extends Wn{constructor(e){super(e)}load(e,t,n,i,r){const s=new Ut,c=new Uc(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(u){s.image=u,s.needsUpdate=!0,t!==void 0&&t(s)},n,i,r),s}}class za extends ot{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Pe(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class ob extends za{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ot.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pe(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const r0=new De,lb=new C,cb=new C;class a0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ce(512,512),this.map=null,this.mapPass=null,this.matrix=new De,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wc,this._frameExtents=new ce(1,1),this._viewportCount=1,this._viewports=[new Qe(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;lb.setFromMatrixPosition(e.matrixWorld),t.position.copy(lb),cb.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(cb),t.updateMatrixWorld(),r0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r0),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(r0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class GA extends a0{constructor(){super(new Qt(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*hc*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class hd extends za{constructor(e,t,n=0,i=Math.PI/3,r=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ot.DEFAULT_UP),this.updateMatrix(),this.target=new ot,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new GA}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const ub=new De,zc=new C,s0=new C;class VA extends a0{constructor(){super(new Qt(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ce(4,2),this._viewportCount=6,this._viewports=[new Qe(2,1,1,1),new Qe(0,1,1,1),new Qe(3,1,1,1),new Qe(1,1,1,1),new Qe(3,0,1,1),new Qe(1,0,1,1)],this._cubeDirections=[new C(1,0,0),new C(-1,0,0),new C(0,0,1),new C(0,0,-1),new C(0,1,0),new C(0,-1,0)],this._cubeUps=[new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,0,1),new C(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),zc.setFromMatrixPosition(e.matrixWorld),n.position.copy(zc),s0.copy(n.position),s0.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(s0),n.updateMatrixWorld(),i.makeTranslation(-zc.x,-zc.y,-zc.z),ub.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ub)}}class Bc extends za{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new VA}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class WA extends a0{constructor(){super(new Oa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class dd extends za{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ot.DEFAULT_UP),this.updateMatrix(),this.target=new ot,this.shadow=new WA}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class o0 extends za{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class hb extends za{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class db{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new C)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*r*1.092548),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],n*r*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*r),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],.858086*n*r),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class pd extends za{constructor(e=new db,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class fd extends Wn{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new ai(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(u){i?i(u):console.error(u),r.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const i=fd.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Pe().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const s=e.uniforms[r];switch(i.uniforms[r]={},s.type){case"t":i.uniforms[r].value=n(s.value);break;case"c":i.uniforms[r].value=new Pe().setHex(s.value);break;case"v2":i.uniforms[r].value=new ce().fromArray(s.value);break;case"v3":i.uniforms[r].value=new C().fromArray(s.value);break;case"v4":i.uniforms[r].value=new Qe().fromArray(s.value);break;case"m3":i.uniforms[r].value=new dn().fromArray(s.value);break;case"m4":i.uniforms[r].value=new De().fromArray(s.value);break;default:i.uniforms[r].value=s.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new ce().fromArray(r)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new ce().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:Qx,SpriteMaterial:Cm,RawShaderMaterial:Zx,ShaderMaterial:xt,PointsMaterial:Kh,MeshPhysicalMaterial:ra,MeshStandardMaterial:zt,MeshPhongMaterial:Fc,MeshToonMaterial:Kx,MeshNormalMaterial:Zm,MeshLambertMaterial:Km,MeshDepthMaterial:zh,MeshDistanceMaterial:Lm,MeshBasicMaterial:pi,MeshMatcapMaterial:Jx,LineDashedMaterial:$x,LineBasicMaterial:In,Material:on}[e]}}class js{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class md extends Ke{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class pb extends Wn{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new ai(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(u){i?i(u):console.error(u),r.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(f,g){if(t[g]!==void 0)return t[g];const v=f.interleavedBuffers[g],b=function(M,w){if(n[w]!==void 0)return n[w];const T=M.arrayBuffers,R=T[w],L=new Uint32Array(R).buffer;return n[w]=L,L}(f,v.buffer),y=Do(v.type,b),S=new Qo(y,v.stride);return S.uuid=v.uuid,t[g]=S,S}const r=e.isInstancedBufferGeometry?new md:new Ke,s=e.data.index;if(s!==void 0){const f=Do(s.type,s.array);r.setIndex(new $e(f,1))}const c=e.data.attributes;for(const f in c){const g=c[f];let v;if(g.isInterleavedBufferAttribute){const b=i(e.data,g.data);v=new ri(b,g.itemSize,g.offset,g.normalized)}else{const b=Do(g.type,g.array);v=new(g.isInstancedBufferAttribute?Na:$e)(b,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),g.usage!==void 0&&v.setUsage(g.usage),g.updateRange!==void 0&&(v.updateRange.offset=g.updateRange.offset,v.updateRange.count=g.updateRange.count),r.setAttribute(f,v)}const u=e.data.morphAttributes;if(u)for(const f in u){const g=u[f],v=[];for(let b=0,y=g.length;b<y;b++){const S=g[b];let M;if(S.isInterleavedBufferAttribute){const w=i(e.data,S.data);M=new ri(w,S.itemSize,S.offset,S.normalized)}else{const w=Do(S.type,S.array);M=new $e(w,S.itemSize,S.normalized)}S.name!==void 0&&(M.name=S.name),v.push(M)}r.morphAttributes[f]=v}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let f=0,g=d.length;f!==g;++f){const v=d[f];r.addGroup(v.start,v.count,v.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const f=new C;p.center!==void 0&&f.fromArray(p.center),r.boundingSphere=new Qr(f,p.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}class XA extends Wn{constructor(e){super(e)}load(e,t,n,i){const r=this,s=this.path===""?js.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const c=new ai(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(u){let d=null;try{d=JSON.parse(u)}catch(f){return i!==void 0&&i(f),void console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message)}const p=d.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry")return i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);r.parse(d,t)},n,i)}async loadAsync(e,t){const n=this.path===""?js.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new ai(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(e,t),s=JSON.parse(r),c=s.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,function(){t!==void 0&&t(d)}),c=this.parseTextures(e.textures,s),u=this.parseMaterials(e.materials,c),d=this.parseObject(e.object,r,u,c,n),p=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,p),t!==void 0){let f=!1;for(const g in s)if(s[g].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(d)}return d}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,r),c=this.parseMaterials(e.materials,s),u=this.parseObject(e.object,i,c,s,t),d=this.parseSkeletons(e.skeletons,u);return this.bindSkeletons(u,d),u}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const r=new ia().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(r){r.isBone&&(i[r.uuid]=r)}),e!==void 0)for(let r=0,s=e.length;r<s;r++){const c=new tl().fromJSON(e[r],i);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new pb;for(let r=0,s=e.length;r<s;r++){let c;const u=e[r];switch(u.type){case"BufferGeometry":case"InstancedBufferGeometry":c=i.parse(u);break;default:u.type in l?c=l[u.type].fromJSON(u,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${u.type}"`)}c.uuid=u.uuid,u.name!==void 0&&(c.name=u.name),u.userData!==void 0&&(c.userData=u.userData),n[u.uuid]=c}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const r=new fd;r.setTextures(t);for(let s=0,c=e.length;s<c;s++){const u=e[s];n[u.uuid]===void 0&&(n[u.uuid]=r.parse(u)),i[u.uuid]=n[u.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],r=Hs.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function s(c){if(typeof c=="string"){const u=c;return function(d){return n.manager.itemStart(d),r.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:n.resourcePath+u)}return c.data?{data:Do(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new i0(t);r=new Uc(c),r.setCrossOrigin(this.crossOrigin);for(let u=0,d=e.length;u<d;u++){const p=e[u],f=p.url;if(Array.isArray(f)){const g=[];for(let v=0,b=f.length;v<b;v++){const y=s(f[v]);y!==null&&(y instanceof HTMLImageElement?g.push(y):g.push(new Ia(y.data,y.width,y.height)))}i[p.uuid]=new As(g)}else{const g=s(p.url);i[p.uuid]=new As(g)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(s){if(typeof s=="string"){const c=s,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await i.loadAsync(u)}return s.data?{data:Do(s.type,s.data),width:s.width,height:s.height}:null}if(e!==void 0&&e.length>0){i=new Uc(this.manager),i.setCrossOrigin(this.crossOrigin);for(let s=0,c=e.length;s<c;s++){const u=e[s],d=u.url;if(Array.isArray(d)){const p=[];for(let f=0,g=d.length;f<g;f++){const v=d[f],b=await r(v);b!==null&&(b instanceof HTMLImageElement?p.push(b):p.push(new Ia(b.data,b.width,b.height)))}n[u.uuid]=new As(p)}else{const p=await r(u.url);n[u.uuid]=new As(p)}}}return n}parseTextures(e,t){function n(r,s){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),s[r])}const i={};if(e!==void 0)for(let r=0,s=e.length;r<s;r++){const c=e[r];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const u=t[c.image],d=u.data;let p;Array.isArray(d)?(p=new _c,d.length===6&&(p.needsUpdate=!0)):(p=d&&d.data?new Ia:new Ut,d&&(p.needsUpdate=!0)),p.source=u,p.uuid=c.uuid,c.name!==void 0&&(p.name=c.name),c.mapping!==void 0&&(p.mapping=n(c.mapping,qA)),c.offset!==void 0&&p.offset.fromArray(c.offset),c.repeat!==void 0&&p.repeat.fromArray(c.repeat),c.center!==void 0&&p.center.fromArray(c.center),c.rotation!==void 0&&(p.rotation=c.rotation),c.wrap!==void 0&&(p.wrapS=n(c.wrap[0],fb),p.wrapT=n(c.wrap[1],fb)),c.format!==void 0&&(p.format=c.format),c.internalFormat!==void 0&&(p.internalFormat=c.internalFormat),c.type!==void 0&&(p.type=c.type),c.encoding!==void 0&&(p.encoding=c.encoding),c.minFilter!==void 0&&(p.minFilter=n(c.minFilter,mb)),c.magFilter!==void 0&&(p.magFilter=n(c.magFilter,mb)),c.anisotropy!==void 0&&(p.anisotropy=c.anisotropy),c.flipY!==void 0&&(p.flipY=c.flipY),c.generateMipmaps!==void 0&&(p.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(p.unpackAlignment=c.unpackAlignment),c.userData!==void 0&&(p.userData=c.userData),i[c.uuid]=p}return i}parseObject(e,t,n,i,r){let s,c,u;function d(g){return t[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",g),t[g]}function p(g){if(g!==void 0){if(Array.isArray(g)){const v=[];for(let b=0,y=g.length;b<y;b++){const S=g[b];n[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),v.push(n[S])}return v}return n[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),n[g]}}function f(g){return i[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",g),i[g]}switch(e.type){case"Scene":s=new Ds,e.background!==void 0&&(Number.isInteger(e.background)?s.background=new Pe(e.background):s.background=f(e.background)),e.environment!==void 0&&(s.environment=f(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?s.fog=new jh(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(s.fog=new Hh(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(s.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(s.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":s=new Qt(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(s.focus=e.focus),e.zoom!==void 0&&(s.zoom=e.zoom),e.filmGauge!==void 0&&(s.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(s.filmOffset=e.filmOffset),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new Oa(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(s.zoom=e.zoom),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new o0(e.color,e.intensity);break;case"DirectionalLight":s=new dd(e.color,e.intensity);break;case"PointLight":s=new Bc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new hb(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new hd(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new ob(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=new pd().fromJSON(e);break;case"SkinnedMesh":c=d(e.geometry),u=p(e.material),s=new qh(c,u),e.bindMode!==void 0&&(s.bindMode=e.bindMode),e.bindMatrix!==void 0&&s.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(s.skeleton=e.skeleton);break;case"Mesh":c=d(e.geometry),u=p(e.material),s=new Je(c,u);break;case"InstancedMesh":c=d(e.geometry),u=p(e.material);const g=e.count,v=e.instanceMatrix,b=e.instanceColor;s=new Qh(c,u,g),s.instanceMatrix=new Na(new Float32Array(v.array),16),b!==void 0&&(s.instanceColor=new Na(new Float32Array(b.array),b.itemSize));break;case"LOD":s=new Sx;break;case"Line":s=new Lr(d(e.geometry),p(e.material));break;case"LineLoop":s=new Im(d(e.geometry),p(e.material));break;case"LineSegments":s=new ur(d(e.geometry),p(e.material));break;case"PointCloud":case"Points":s=new km(d(e.geometry),p(e.material));break;case"Sprite":s=new xx(p(e.material));break;case"Group":s=new Vn;break;case"Bone":s=new el;break;default:s=new ot}if(s.uuid=e.uuid,e.name!==void 0&&(s.name=e.name),e.matrix!==void 0?(s.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(e.position!==void 0&&s.position.fromArray(e.position),e.rotation!==void 0&&s.rotation.fromArray(e.rotation),e.quaternion!==void 0&&s.quaternion.fromArray(e.quaternion),e.scale!==void 0&&s.scale.fromArray(e.scale)),e.castShadow!==void 0&&(s.castShadow=e.castShadow),e.receiveShadow!==void 0&&(s.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(s.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(s.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(s.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(s.visible=e.visible),e.frustumCulled!==void 0&&(s.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(s.renderOrder=e.renderOrder),e.userData!==void 0&&(s.userData=e.userData),e.layers!==void 0&&(s.layers.mask=e.layers),e.children!==void 0){const g=e.children;for(let v=0;v<g.length;v++)s.add(this.parseObject(g[v],t,n,i,r))}if(e.animations!==void 0){const g=e.animations;for(let v=0;v<g.length;v++){const b=g[v];s.animations.push(r[b])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(s.autoUpdate=e.autoUpdate);const g=e.levels;for(let v=0;v<g.length;v++){const b=g[v],y=s.getObjectByProperty("uuid",b.object);y!==void 0&&s.addLevel(y,b.distance,b.hysteresis)}}return s}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}}const qA={UVMapping:ih,CubeReflectionMapping:wa,CubeRefractionMapping:Ma,EquirectangularReflectionMapping:Ta,EquirectangularRefractionMapping:oc,CubeUVReflectionMapping:Ao},fb={RepeatWrapping:hi,ClampToEdgeWrapping:vn,MirroredRepeatWrapping:Ro},mb={NearestFilter:At,NearestMipmapNearestFilter:lc,NearestMipmapLinearFilter:Lo,LinearFilter:rt,LinearMipmapNearestFilter:rh,LinearMipmapLinearFilter:ir};class gb extends Wn{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=Ua.get(e);if(s!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(s),r.manager.itemEnd(e)},0),s;const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,fetch(e,c).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(u){Ua.add(e,u),t&&t(u),r.manager.itemEnd(e)}).catch(function(u){i&&i(u),r.manager.itemError(e),r.manager.itemEnd(e)}),r.manager.itemStart(e)}}let gd;class l0{static getContext(){return gd===void 0&&(gd=new(window.AudioContext||window.webkitAudioContext)),gd}static setContext(e){gd=e}}class vb extends Wn{constructor(e){super(e)}load(e,t,n,i,r){const s=this,c=new ai(this.manager);c.setResponseType("arraybuffer"),c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(u){try{const d=u.slice(0);l0.getContext().decodeAudioData(d,function(p){t(p)})}catch(d){i?i(d):console.error(d),s.manager.itemError(e)}},n,i,r==null?void 0:r.mainFile)}}class YA extends pd{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const i=new Pe().set(e),r=new Pe().set(t),s=new C(i.r,i.g,i.b),c=new C(r.r,r.g,r.b),u=Math.sqrt(Math.PI),d=u*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(c).multiplyScalar(u),this.sh.coefficients[1].copy(s).sub(c).multiplyScalar(d)}}class QA extends pd{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=new Pe().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const yb=new De,xb=new De,Gs=new De;class ZA{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Qt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Qt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Gs.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,r=t.near*Math.tan(Es*t.fov*.5)/t.zoom;let s,c;xb.elements[12]=-n,yb.elements[12]=n,s=-r*t.aspect+i,c=r*t.aspect+i,Gs.elements[0]=2*t.near/(c-s),Gs.elements[8]=(c+s)/(c-s),this.cameraL.projectionMatrix.copy(Gs),s=-r*t.aspect-i,c=r*t.aspect-i,Gs.elements[0]=2*t.near/(c-s),Gs.elements[8]=(c+s)/(c-s),this.cameraR.projectionMatrix.copy(Gs)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(xb),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(yb)}}class bb{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Sb(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Sb();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Sb(){return(typeof performance>"u"?Date:performance).now()}const Vs=new C,_b=new Ft,KA=new C,Ws=new C;class vd extends ot{constructor(){super(),this.type="AudioListener",this.context=l0.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new bb}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Vs,_b,KA),Ws.set(0,0,-1).applyQuaternion(_b),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Vs.x,i),t.positionY.linearRampToValueAtTime(Vs.y,i),t.positionZ.linearRampToValueAtTime(Vs.z,i),t.forwardX.linearRampToValueAtTime(Ws.x,i),t.forwardY.linearRampToValueAtTime(Ws.y,i),t.forwardZ.linearRampToValueAtTime(Ws.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Vs.x,Vs.y,Vs.z),t.setOrientation(Ws.x,Ws.y,Ws.z,n.x,n.y,n.z)}}class c0 extends ot{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl!==!1)return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl!==!1)return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Xs=new C,wb=new Ft,JA=new C,qs=new C;class Mb extends c0{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Xs,wb,JA),qs.set(0,0,1).applyQuaternion(wb);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Xs.x,n),t.positionY.linearRampToValueAtTime(Xs.y,n),t.positionZ.linearRampToValueAtTime(Xs.z,n),t.orientationX.linearRampToValueAtTime(qs.x,n),t.orientationY.linearRampToValueAtTime(qs.y,n),t.orientationZ.linearRampToValueAtTime(qs.z,n)}else t.setPosition(Xs.x,Xs.y,Xs.z),t.setOrientation(qs.x,qs.y,qs.z)}}class $A{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Tb{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let s=this.cumulativeWeight;if(s===0){for(let c=0;c!==i;++c)n[r+c]=n[c];s=t}else{s+=t;const c=t/s;this._mixBufferRegion(n,r,0,c,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const u=t*this._origIndex;this._mixBufferRegion(n,i,u,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let u=t,d=t+t;u!==d;++u)if(n[u]!==n[u+t]){c.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){Ft.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const s=this._workIndex*r;Ft.multiplyQuaternionsFlat(e,s,e,t,e,n),Ft.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){const s=1-i;for(let c=0;c!==r;++c){const u=t+c;e[u]=e[u]*s+e[n+c]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){const c=t+s;e[c]=e[c]+e[n+s]*i}}}const u0="\\[\\]\\.:\\/",eR=new RegExp("["+u0+"]","g"),h0="[^"+u0+"]",tR="[^"+u0.replace("\\.","")+"]",nR=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",h0)+/(WCOD+)?/.source.replace("WCOD",tR)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",h0)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",h0)+"$"),iR=["material","materials","bones","map"];class dt{constructor(e,t,n){this.path=t,this.parsedPath=n||dt.parseTrackName(t),this.node=dt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new dt.Composite(e,t,n):new dt(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(eR,"")}static parseTrackName(e){const t=nR.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const r=n.nodeName.substring(i+1);iR.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let s=0;s<r.length;s++){const c=r[s];if(c.name===t||c.uuid===t)return c;const u=n(c.children);if(u)return u}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=dt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let d=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===d){d=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(e[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(d!==void 0){if(e[d]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[d]}}const s=e[i];if(s===void 0){const d=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+i+" but it wasn't found.",e)}let c=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}dt.Composite=class{constructor(o,e,t){const n=t||dt.parseTrackName(e);this._targetGroup=o,this._bindings=o.subscribe_(e,n)}getValue(o,e){this.bind();const t=this._targetGroup.nCachedObjects_,n=this._bindings[t];n!==void 0&&n.getValue(o,e)}setValue(o,e){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=t.length;n!==i;++n)t[n].setValue(o,e)}bind(){const o=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=o.length;e!==t;++e)o[e].bind()}unbind(){const o=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=o.length;e!==t;++e)o[e].unbind()}},dt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},dt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},dt.prototype.GetterByBindingType=[dt.prototype._getValue_direct,dt.prototype._getValue_array,dt.prototype._getValue_arrayElement,dt.prototype._getValue_toArray],dt.prototype.SetterByBindingTypeAndVersioning=[[dt.prototype._setValue_direct,dt.prototype._setValue_direct_setNeedsUpdate,dt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dt.prototype._setValue_array,dt.prototype._setValue_array_setNeedsUpdate,dt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dt.prototype._setValue_arrayElement,dt.prototype._setValue_arrayElement_setNeedsUpdate,dt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dt.prototype._setValue_fromArray,dt.prototype._setValue_fromArray_setNeedsUpdate,dt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class rR{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Ai(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let c,u=e.length,d=this.nCachedObjects_;for(let p=0,f=arguments.length;p!==f;++p){const g=arguments[p],v=g.uuid;let b=t[v];if(b===void 0){b=u++,t[v]=b,e.push(g);for(let y=0,S=s;y!==S;++y)r[y].push(new dt(g,n[y],i[y]))}else if(b<d){c=e[b];const y=--d,S=e[y];t[S.uuid]=b,e[b]=S,t[v]=y,e[y]=g;for(let M=0,w=s;M!==w;++M){const T=r[M],R=T[y];let L=T[b];T[b]=R,L===void 0&&(L=new dt(g,n[M],i[M])),T[y]=L}}else e[b]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,c=arguments.length;s!==c;++s){const u=arguments[s],d=u.uuid,p=t[d];if(p!==void 0&&p>=r){const f=r++,g=e[f];t[g.uuid]=p,e[p]=g,t[d]=f,e[f]=u;for(let v=0,b=i;v!==b;++v){const y=n[v],S=y[f],M=y[p];y[p]=S,y[f]=M}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=e.length;for(let c=0,u=arguments.length;c!==u;++c){const d=arguments[c].uuid,p=t[d];if(p!==void 0)if(delete t[d],p<r){const f=--r,g=e[f],v=--s,b=e[v];t[g.uuid]=p,e[p]=g,t[b.uuid]=f,e[f]=b,e.pop();for(let y=0,S=i;y!==S;++y){const M=n[y],w=M[f],T=M[v];M[p]=w,M[f]=T,M.pop()}}else{const f=--s,g=e[f];f>0&&(t[g.uuid]=p),e[p]=g,e.pop();for(let v=0,b=i;v!==b;++v){const y=n[v];y[p]=y[f],y.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(i!==void 0)return r[i];const s=this._paths,c=this._parsedPaths,u=this._objects,d=u.length,p=this.nCachedObjects_,f=new Array(d);i=r.length,n[e]=i,s.push(e),c.push(t),r.push(f);for(let g=p,v=u.length;g!==v;++g){const b=u[g];f[g]=new dt(b,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,r=this._parsedPaths,s=this._bindings,c=s.length-1,u=s[c];t[e[c]]=n,s[n]=u,s.pop(),r[n]=r[c],r.pop(),i[n]=i[c],i.pop()}}}class aR{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,s=r.length,c=new Array(s),u={endingStart:Ms,endingEnd:Ms};for(let d=0;d!==s;++d){const p=r[d].createInterpolant(null);c[d]=p,p.settings=u}this._interpolantSettings=u,this._interpolants=c,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=fy,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,r=e._clip.duration,s=r/i,c=i/r;e.warp(1,s,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,s=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=i._lendControlInterpolant(),this._timeScaleInterpolant=c);const u=c.parameterPositions,d=c.sampleValues;return u[0]=r,u[1]=r+n,d[0]=e/s,d[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(r!==null){const u=(e-r)*n;u<0||n===0?t=0:(this._startTime=null,t=n*u)}t*=this._updateTimeScale(e);const s=this._updateTime(t),c=this._updateWeight(e);if(c>0){const u=this._interpolants,d=this._propertyBindings;if(this.blendMode===Yf)for(let p=0,f=u.length;p!==f;++p)u[p].evaluate(s),d[p].accumulateAdditive(c);else for(let p=0,f=u.length;p!==f;++p)u[p].evaluate(s),d[p].accumulate(i,c)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const s=n===my;if(e===0)return r===-1?i:s&&(1&r)==1?t-i:i;if(n===py){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){const c=Math.floor(i/t);i-=t*c,r+=Math.abs(c);const u=this.repetitions-r;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const d=e<0;this._setEndings(d,!d,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=i;if(s&&(1&r)==1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Ts,i.endingEnd=Ts):(i.endingStart=e?this.zeroSlopeAtStart?Ts:Ms:cc,i.endingEnd=t?this.zeroSlopeAtEnd?Ts:Ms:cc)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const c=s.parameterPositions,u=s.sampleValues;return c[0]=r,u[0]=t,c[1]=r+e,u[1]=n,this}}const sR=new Float32Array(1);class oR extends zi{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,c=e._interpolants,u=n.uuid,d=this._bindingsByRootAndName;let p=d[u];p===void 0&&(p={},d[u]=p);for(let f=0;f!==r;++f){const g=i[f],v=g.name;let b=p[v];if(b!==void 0)++b.referenceCount,s[f]=b;else{if(b=s[f],b!==void 0){b._cacheIndex===null&&(++b.referenceCount,this._addInactiveBinding(b,u,v));continue}const y=t&&t._propertyBindings[f].binding.parsedPath;b=new Tb(dt.create(n,v,y),g.ValueTypeName,g.getValueSize()),++b.referenceCount,this._addInactiveBinding(b,u,v),s[f]=b}c[f].resultBuffer=b.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];r.useCount++==0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];--r.useCount==0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let s=r[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{const c=s.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,s=this._actionsByClip,c=s[r],u=c.knownActions,d=u[u.length-1],p=e._byClipCacheIndex;d._byClipCacheIndex=p,u[p]=d,u.pop(),e._byClipCacheIndex=null,delete c.actionByRoot[(e._localRoot||this._root).uuid],u.length===0&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];--r.referenceCount==0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[t];s===void 0&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,c=s[i],u=t[t.length-1],d=e._cacheIndex;u._cacheIndex=d,t[d]=u,t.pop(),delete c[r],Object.keys(c).length===0&&delete s[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new t0(new Float32Array(2),new Float32Array(2),1,sR),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let s=typeof e=="string"?Hs.findByName(i,e):e;const c=s!==null?s.uuid:e,u=this._actionsByClip[c];let d=null;if(n===void 0&&(n=s!==null?s.blendMode:qf),u!==void 0){const f=u.actionByRoot[r];if(f!==void 0&&f.blendMode===n)return f;d=u.knownActions[0],s===null&&(s=d._clip)}if(s===null)return null;const p=new aR(this,s,t,n);return this._bindAction(p,d),this._addInactiveAction(p,c,r),p}existingAction(e,t){const n=t||this._root,i=n.uuid,r=typeof e=="string"?Hs.findByName(n,e):e,s=r?r.uuid:e,c=this._actionsByClip[s];return c!==void 0&&c.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let d=0;d!==n;++d)t[d]._update(i,e,r,s);const c=this._bindings,u=this._nActiveBindings;for(let d=0;d!==u;++d)c[d].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(r!==void 0){const s=r.knownActions;for(let c=0,u=s.length;c!==u;++c){const d=s[c];this._deactivateAction(d);const p=d._cacheIndex,f=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,f._cacheIndex=p,t[p]=f,t.pop(),this._removeInactiveBindingsForAction(d)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const r in n){const s=n[r].actionByRoot[t];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}const i=this._bindingsByRootAndName[t];if(i!==void 0)for(const r in i){const s=i[r];s.restoreOriginalState(),this._removeInactiveBinding(s)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class He{constructor(e){this.value=e}clone(){return new He(this.value.clone===void 0?this.value:this.value.clone())}}let lR=0;class cR extends zi{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:lR++}),this.name="",this.usage=uc,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++)this.uniforms.push(t[n].clone());return this}clone(){return new this.constructor().copy(this)}}class Eb extends Qo{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class uR{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class hR{constructor(e,t,n=0,i=1/0){this.ray=new gc(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new _h,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return d0(e,this,n,t),n.sort(Ab),n}intersectObjects(e,t=!0,n=[]){for(let i=0,r=e.length;i<r;i++)d0(e[i],this,n,t);return n.sort(Ab),n}}function Ab(o,e){return o.distance-e.distance}function d0(o,e,t,n){if(o.layers.test(e.layers)&&o.raycast(e,t),n===!0){const i=o.children;for(let r=0,s=i.length;r<s;r++)d0(i[r],e,t,!0)}}class Rb{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(nn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class dR{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const Lb=new ce;class pR{constructor(e=new ce(1/0,1/0),t=new ce(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Lb.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Lb).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Pb=new C,yd=new C;class fR{constructor(e=new C,t=new C){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Pb.subVectors(e,this.start),yd.subVectors(this.end,this.start);const n=yd.dot(yd);let i=yd.dot(Pb)/n;return t&&(i=nn(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Cb=new C;class Db extends ot{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Ke,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,c=1,u=32;s<u;s++,c++){const d=s/u*Math.PI*2,p=c/u*Math.PI*2;i.push(Math.cos(d),Math.sin(d),1,Math.cos(p),Math.sin(p),1)}n.setAttribute("position",new Ge(i,3));const r=new In({fog:!1,toneMapped:!1});this.cone=new ur(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Cb.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Cb),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ba=new C,xd=new De,p0=new De;class mR extends ur{constructor(e){const t=Ob(e),n=new Ke,i=[],r=[],s=new Pe(0,0,1),c=new Pe(0,1,0);for(let u=0;u<t.length;u++){const d=t[u];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(c.r,c.g,c.b))}n.setAttribute("position",new Ge(i,3)),n.setAttribute("color",new Ge(r,3)),super(n,new In({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");p0.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<t.length;r++){const c=t[r];c.parent&&c.parent.isBone&&(xd.multiplyMatrices(p0,c.matrixWorld),Ba.setFromMatrixPosition(xd),i.setXYZ(s,Ba.x,Ba.y,Ba.z),xd.multiplyMatrices(p0,c.parent.matrixWorld),Ba.setFromMatrixPosition(xd),i.setXYZ(s+1,Ba.x,Ba.y,Ba.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ob(o){const e=[];o.isBone===!0&&e.push(o);for(let t=0;t<o.children.length;t++)e.push.apply(e,Ob(o.children[t]));return e}class Ib extends Je{constructor(e,t,n){super(new Fa(t,4,2),new pi({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const gR=new C,Nb=new Pe,kb=new Pe;class vR extends ot{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Ns(t);i.rotateY(.5*Math.PI),this.material=new pi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),s=new Float32Array(3*r.count);i.setAttribute("color",new $e(s,3)),this.add(new Je(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Nb.copy(this.light.color),kb.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const r=n<i/2?Nb:kb;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(gR.setFromMatrixPosition(this.light.matrixWorld).negate())}}class yR extends ur{constructor(e=10,t=10,n=4473924,i=8947848){n=new Pe(n),i=new Pe(i);const r=t/2,s=e/t,c=e/2,u=[],d=[];for(let f=0,g=0,v=-c;f<=t;f++,v+=s){u.push(-c,0,v,c,0,v),u.push(v,0,-c,v,0,c);const b=f===r?n:i;b.toArray(d,g),g+=3,b.toArray(d,g),g+=3,b.toArray(d,g),g+=3,b.toArray(d,g),g+=3}const p=new Ke;p.setAttribute("position",new Ge(u,3)),p.setAttribute("color",new Ge(d,3)),super(p,new In({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class xR extends ur{constructor(e=10,t=16,n=8,i=64,r=4473924,s=8947848){r=new Pe(r),s=new Pe(s);const c=[],u=[];if(t>1)for(let p=0;p<t;p++){const f=p/t*(2*Math.PI),g=Math.sin(f)*e,v=Math.cos(f)*e;c.push(0,0,0),c.push(g,0,v);const b=1&p?r:s;u.push(b.r,b.g,b.b),u.push(b.r,b.g,b.b)}for(let p=0;p<n;p++){const f=1&p?r:s,g=e-e/n*p;for(let v=0;v<i;v++){let b=v/i*(2*Math.PI),y=Math.sin(b)*g,S=Math.cos(b)*g;c.push(y,0,S),u.push(f.r,f.g,f.b),b=(v+1)/i*(2*Math.PI),y=Math.sin(b)*g,S=Math.cos(b)*g,c.push(y,0,S),u.push(f.r,f.g,f.b)}}const d=new Ke;d.setAttribute("position",new Ge(c,3)),d.setAttribute("color",new Ge(u,3)),super(d,new In({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const Fb=new C,bd=new C,Ub=new C;class zb extends ot{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Ke;i.setAttribute("position",new Ge([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new In({fog:!1,toneMapped:!1});this.lightPlane=new Lr(i,r),this.add(this.lightPlane),i=new Ke,i.setAttribute("position",new Ge([0,0,0,0,0,1],3)),this.targetLine=new Lr(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Fb.setFromMatrixPosition(this.light.matrixWorld),bd.setFromMatrixPosition(this.light.target.matrixWorld),Ub.subVectors(bd,Fb),this.lightPlane.lookAt(bd),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bd),this.targetLine.scale.z=Ub.length()}}const Sd=new C,rn=new Vo;class bR extends ur{constructor(e){const t=new Ke,n=new In({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function c(b,y){u(b),u(y)}function u(b){i.push(0,0,0),r.push(0,0,0),s[b]===void 0&&(s[b]=[]),s[b].push(i.length/3-1)}c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4"),t.setAttribute("position",new Ge(i,3)),t.setAttribute("color",new Ge(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const d=new Pe(16755200),p=new Pe(16711680),f=new Pe(43775),g=new Pe(16777215),v=new Pe(3355443);this.setColors(d,p,f,g,v)}setColors(e,t,n,i,r){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;rn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ln("c",t,e,rn,0,0,-1),ln("t",t,e,rn,0,0,1),ln("n1",t,e,rn,-1,-1,-1),ln("n2",t,e,rn,1,-1,-1),ln("n3",t,e,rn,-1,1,-1),ln("n4",t,e,rn,1,1,-1),ln("f1",t,e,rn,-1,-1,1),ln("f2",t,e,rn,1,-1,1),ln("f3",t,e,rn,-1,1,1),ln("f4",t,e,rn,1,1,1),ln("u1",t,e,rn,.7,1.1,-1),ln("u2",t,e,rn,-.7,1.1,-1),ln("u3",t,e,rn,0,2,-1),ln("cf1",t,e,rn,-1,0,1),ln("cf2",t,e,rn,1,0,1),ln("cf3",t,e,rn,0,-1,1),ln("cf4",t,e,rn,0,1,1),ln("cn1",t,e,rn,-1,0,-1),ln("cn2",t,e,rn,1,0,-1),ln("cn3",t,e,rn,0,-1,-1),ln("cn4",t,e,rn,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ln(o,e,t,n,i,r,s){Sd.set(i,r,s).unproject(n);const c=e[o];if(c!==void 0){const u=t.getAttribute("position");for(let d=0,p=c.length;d<p;d++)u.setXYZ(c[d],Sd.x,Sd.y,Sd.z)}}const _d=new Ar;class SR extends ur{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Ke;r.setIndex(new $e(n,1)),r.setAttribute("position",new $e(i,3)),super(r,new In({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_d.setFromObject(this.object),_d.isEmpty())return;const t=_d.min,n=_d.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class _R extends ur{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Ke;i.setIndex(new $e(n,1)),i.setAttribute("position",new Ge([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new In({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class wR extends Lr{constructor(e,t=1,n=16776960){const i=n,r=new Ke;r.setAttribute("position",new Ge([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new In({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const s=new Ke;s.setAttribute("position",new Ge([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),s.computeBoundingSphere(),this.add(new Je(s,new pi({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Bb=new C;let wd,f0;class MR extends ot{constructor(e=new C(0,0,1),t=new C(0,0,0),n=1,i=16776960,r=.2*n,s=.2*r){super(),this.type="ArrowHelper",wd===void 0&&(wd=new Ke,wd.setAttribute("position",new Ge([0,0,0,0,1,0],3)),f0=new ka(0,.5,1,5,1),f0.translate(0,-.5,0)),this.position.copy(t),this.line=new Lr(wd,new In({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Je(f0,new pi({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Bb.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Bb,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class TR extends ur{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Ke;n.setAttribute("position",new Ge(t,3)),n.setAttribute("color",new Ge([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new In({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new Pe,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ER{constructor(){this.type="ShapePath",this.color=new Pe,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Oc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S,M){const w=M.length;let T=!1;for(let R=w-1,L=0;L<w;R=L++){let P=M[R],I=M[L],V=I.x-P.x,z=I.y-P.y;if(Math.abs(z)>Number.EPSILON){if(z<0&&(P=M[L],V=-V,I=M[R],z=-z),S.y<P.y||S.y>I.y)continue;if(S.y===P.y){if(S.x===P.x)return!0}else{const G=z*(S.x-P.x)-V*(S.y-P.y);if(G===0)return!0;if(G<0)continue;T=!T}}else{if(S.y!==P.y)continue;if(I.x<=S.x&&S.x<=P.x||P.x<=S.x&&S.x<=I.x)return!0}}return T}const n=Cr.isClockWise,i=this.subPaths;if(i.length===0)return[];let r,s,c;const u=[];if(i.length===1)return s=i[0],c=new ia,c.curves=s.curves,u.push(c),u;let d=!n(i[0].getPoints());d=e?!d:d;const p=[],f=[];let g,v,b=[],y=0;f[y]=void 0,b[y]=[];for(let S=0,M=i.length;S<M;S++)s=i[S],g=s.getPoints(),r=n(g),r=e?!r:r,r?(!d&&f[y]&&y++,f[y]={s:new ia,p:g},f[y].s.curves=s.curves,d&&y++,b[y]=[]):b[y].push({h:s,p:g[0]});if(!f[0])return function(S){const M=[];for(let w=0,T=S.length;w<T;w++){const R=S[w],L=new ia;L.curves=R.curves,M.push(L)}return M}(i);if(f.length>1){let S=!1,M=0;for(let w=0,T=f.length;w<T;w++)p[w]=[];for(let w=0,T=f.length;w<T;w++){const R=b[w];for(let L=0;L<R.length;L++){const P=R[L];let I=!0;for(let V=0;V<f.length;V++)t(P.p,f[V].p)&&(w!==V&&M++,I?(I=!1,p[V].push(P)):S=!0);I&&p[w].push(P)}}M>0&&S===!1&&(b=p)}for(let S=0,M=f.length;S<M;S++){c=f[S].s,u.push(c),v=b[S];for(let w=0,T=v.length;w<T;w++)c.holes.push(v[w].h)}return u}}const oa=AR();function AR(){const o=new ArrayBuffer(4),e=new Float32Array(o),t=new Uint32Array(o),n=new Uint32Array(512),i=new Uint32Array(512);for(let u=0;u<256;++u){const d=u-127;d<-27?(n[u]=0,n[256|u]=32768,i[u]=24,i[256|u]=24):d<-14?(n[u]=1024>>-d-14,n[256|u]=1024>>-d-14|32768,i[u]=-d-1,i[256|u]=-d-1):d<=15?(n[u]=d+15<<10,n[256|u]=d+15<<10|32768,i[u]=13,i[256|u]=13):d<128?(n[u]=31744,n[256|u]=64512,i[u]=24,i[256|u]=24):(n[u]=31744,n[256|u]=64512,i[u]=13,i[256|u]=13)}const r=new Uint32Array(2048),s=new Uint32Array(64),c=new Uint32Array(64);for(let u=1;u<1024;++u){let d=u<<13,p=0;for(;!(8388608&d);)d<<=1,p-=8388608;d&=-8388609,p+=947912704,r[u]=d|p}for(let u=1024;u<2048;++u)r[u]=939524096+(u-1024<<13);for(let u=1;u<31;++u)s[u]=u<<23;s[31]=1199570944,s[32]=2147483648;for(let u=33;u<63;++u)s[u]=2147483648+(u-32<<23);s[63]=3347054592;for(let u=1;u<64;++u)u!==32&&(c[u]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:r,exponentTable:s,offsetTable:c}}const Hc={toHalfFloat:function(o){Math.abs(o)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),o=nn(o,-65504,65504),oa.floatView[0]=o;const e=oa.uint32View[0],t=e>>23&511;return oa.baseTable[t]+((8388607&e)>>oa.shiftTable[t])},fromHalfFloat:function(o){const e=o>>10;return oa.uint32View[0]=oa.mantissaTable[oa.offsetTable[e]+(1023&o)]+oa.exponentTable[e],oa.floatView[0]}};class RR extends ea{constructor(e,t,n,i,r,s){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,i,r,s)}}class LR extends nl{constructor(e,t,n,i){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,i)}}class PR extends il{constructor(e,t,n,i){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,i)}}class CR extends rl{constructor(e,t,n,i,r,s,c){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,i,r,s,c)}}class DR extends ka{constructor(e,t,n,i,r,s,c,u){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,i,r,s,c,u)}}class OR extends al{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class IR extends ol{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class NR extends ll{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class kR extends Os{constructor(e,t,n,i){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,i)}}class FR extends Ns{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class UR extends na{constructor(e,t,n,i){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,i)}}class zR extends Pr{constructor(e,t,n,i){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,i)}}class BR extends cl{constructor(e,t,n,i,r,s){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,i,r,s)}}class HR extends ul{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class jR extends Fa{constructor(e,t,n,i,r,s,c){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,i,r,s,c)}}class GR extends hl{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class VR extends dl{constructor(e,t,n,i,r){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,i,r)}}class WR extends pl{constructor(e,t,n,i,r,s){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,i,r,s)}}class XR extends fl{constructor(e,t,n,i,r){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,i,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ve}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ve);class qR{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,i){return e[0]*t+e[1]*n+e[2]*i}dot4(e,t,n,i,r){return e[0]*t+e[1]*n+e[2]*i+e[3]*r}noise(e,t){let n,i,r;const s=(e+t)*(.5*(Math.sqrt(3)-1)),c=Math.floor(e+s),u=Math.floor(t+s),d=(3-Math.sqrt(3))/6,p=(c+u)*d,f=e-(c-p),g=t-(u-p);let v,b;f>g?(v=1,b=0):(v=0,b=1);const y=f-v+d,S=g-b+d,M=f-1+2*d,w=g-1+2*d,T=255&c,R=255&u,L=this.perm[T+this.perm[R]]%12,P=this.perm[T+v+this.perm[R+b]]%12,I=this.perm[T+1+this.perm[R+1]]%12;let V=.5-f*f-g*g;V<0?n=0:(V*=V,n=V*V*this.dot(this.grad3[L],f,g));let z=.5-y*y-S*S;z<0?i=0:(z*=z,i=z*z*this.dot(this.grad3[P],y,S));let G=.5-M*M-w*w;return G<0?r=0:(G*=G,r=G*G*this.dot(this.grad3[I],M,w)),70*(n+i+r)}noise3d(e,t,n){let i,r,s,c;const u=(e+t+n)*.3333333333333333,d=Math.floor(e+u),p=Math.floor(t+u),f=Math.floor(n+u),g=1/6,v=(d+p+f)*g,b=e-(d-v),y=t-(p-v),S=n-(f-v);let M,w,T,R,L,P;b>=y?y>=S?(M=1,w=0,T=0,R=1,L=1,P=0):b>=S?(M=1,w=0,T=0,R=1,L=0,P=1):(M=0,w=0,T=1,R=1,L=0,P=1):y<S?(M=0,w=0,T=1,R=0,L=1,P=1):b<S?(M=0,w=1,T=0,R=0,L=1,P=1):(M=0,w=1,T=0,R=1,L=1,P=0);const I=b-M+g,V=y-w+g,z=S-T+g,G=b-R+2*g,F=y-L+2*g,$=S-P+2*g,le=b-1+.5,ae=y-1+.5,ye=S-1+.5,pe=255&d,Me=255&p,Ee=255&f,Re=this.perm[pe+this.perm[Me+this.perm[Ee]]]%12,he=this.perm[pe+M+this.perm[Me+w+this.perm[Ee+T]]]%12,ne=this.perm[pe+R+this.perm[Me+L+this.perm[Ee+P]]]%12,me=this.perm[pe+1+this.perm[Me+1+this.perm[Ee+1]]]%12;let Ae=.6-b*b-y*y-S*S;Ae<0?i=0:(Ae*=Ae,i=Ae*Ae*this.dot3(this.grad3[Re],b,y,S));let Se=.6-I*I-V*V-z*z;Se<0?r=0:(Se*=Se,r=Se*Se*this.dot3(this.grad3[he],I,V,z));let Ne=.6-G*G-F*F-$*$;Ne<0?s=0:(Ne*=Ne,s=Ne*Ne*this.dot3(this.grad3[ne],G,F,$));let j=.6-le*le-ae*ae-ye*ye;return j<0?c=0:(j*=j,c=j*j*this.dot3(this.grad3[me],le,ae,ye)),32*(i+r+s+c)}noise4d(e,t,n,i){const r=this.grad4,s=this.simplex,c=this.perm,u=(Math.sqrt(5)-1)/4,d=(5-Math.sqrt(5))/20;let p,f,g,v,b;const y=(e+t+n+i)*u,S=Math.floor(e+y),M=Math.floor(t+y),w=Math.floor(n+y),T=Math.floor(i+y),R=(S+M+w+T)*d,L=e-(S-R),P=t-(M-R),I=n-(w-R),V=i-(T-R),z=(L>P?32:0)+(L>I?16:0)+(P>I?8:0)+(L>V?4:0)+(P>V?2:0)+(I>V?1:0),G=s[z][0]>=3?1:0,F=s[z][1]>=3?1:0,$=s[z][2]>=3?1:0,le=s[z][3]>=3?1:0,ae=s[z][0]>=2?1:0,ye=s[z][1]>=2?1:0,pe=s[z][2]>=2?1:0,Me=s[z][3]>=2?1:0,Ee=s[z][0]>=1?1:0,Re=s[z][1]>=1?1:0,he=s[z][2]>=1?1:0,ne=s[z][3]>=1?1:0,me=L-G+d,Ae=P-F+d,Se=I-$+d,Ne=V-le+d,j=L-ae+2*d,U=P-ye+2*d,ie=I-pe+2*d,q=V-Me+2*d,H=L-Ee+3*d,J=P-Re+3*d,O=I-he+3*d,W=V-ne+3*d,Y=L-1+4*d,ee=P-1+4*d,te=I-1+4*d,de=V-1+4*d,Oe=255&S,ze=255&M,Ve=255&w,Be=255&T,nt=c[Oe+c[ze+c[Ve+c[Be]]]]%32,lt=c[Oe+G+c[ze+F+c[Ve+$+c[Be+le]]]]%32,et=c[Oe+ae+c[ze+ye+c[Ve+pe+c[Be+Me]]]]%32,pt=c[Oe+Ee+c[ze+Re+c[Ve+he+c[Be+ne]]]]%32,Ct=c[Oe+1+c[ze+1+c[Ve+1+c[Be+1]]]]%32;let Ze=.6-L*L-P*P-I*I-V*V;Ze<0?p=0:(Ze*=Ze,p=Ze*Ze*this.dot4(r[nt],L,P,I,V));let Dt=.6-me*me-Ae*Ae-Se*Se-Ne*Ne;Dt<0?f=0:(Dt*=Dt,f=Dt*Dt*this.dot4(r[lt],me,Ae,Se,Ne));let ue=.6-j*j-U*U-ie*ie-q*q;ue<0?g=0:(ue*=ue,g=ue*ue*this.dot4(r[et],j,U,ie,q));let Qa=.6-H*H-J*J-O*O-W*W;Qa<0?v=0:(Qa*=Qa,v=Qa*Qa*this.dot4(r[pt],H,J,O,W));let Za=.6-Y*Y-ee*ee-te*te-de*de;return Za<0?b=0:(Za*=Za,b=Za*Za*this.dot4(r[Ct],Y,ee,te,de)),27*(p+f+g+v+b)}}class YR extends ot{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const gl=new C,Hb=new De,jb=new De,Gb=new C,Vb=new C;class QR{constructor(e={}){const t=this;let n,i,r,s;const c={objects:new WeakMap},u=e.element!==void 0?e.element:document.createElement("div");function d(f,g,v){if(f.isCSS2DObject){gl.setFromMatrixPosition(f.matrixWorld),gl.applyMatrix4(jb);const b=f.visible===!0&&gl.z>=-1&&gl.z<=1&&f.layers.test(v.layers)===!0;if(f.element.style.display=b===!0?"":"none",b===!0){f.onBeforeRender(t,g,v);const S=f.element;S.style.transform="translate(-50%,-50%) translate("+(gl.x*r+r)+"px,"+(-gl.y*s+s)+"px)",S.parentNode!==u&&u.appendChild(S),f.onAfterRender(t,g,v)}const y={distanceToCameraSquared:p(v,f)};c.objects.set(f,y)}for(let b=0,y=f.children.length;b<y;b++)d(f.children[b],g,v)}function p(f,g){return Gb.setFromMatrixPosition(f.matrixWorld),Vb.setFromMatrixPosition(g.matrixWorld),Gb.distanceToSquared(Vb)}u.style.overflow="hidden",this.domElement=u,this.getSize=function(){return{width:n,height:i}},this.render=function(f,g){f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),g.parent===null&&g.matrixWorldAutoUpdate===!0&&g.updateMatrixWorld(),Hb.copy(g.matrixWorldInverse),jb.multiplyMatrices(g.projectionMatrix,Hb),d(f,f,g),function(v){const b=function(S){const M=[];return S.traverse(function(w){w.isCSS2DObject&&M.push(w)}),M}(v).sort(function(S,M){return S.renderOrder!==M.renderOrder?M.renderOrder-S.renderOrder:c.objects.get(S).distanceToCameraSquared-c.objects.get(M).distanceToCameraSquared}),y=b.length;for(let S=0,M=b.length;S<M;S++)b[S].element.style.zIndex=y-S}(f)},this.setSize=function(f,g){n=f,i=g,r=n/2,s=i/2,u.style.width=f+"px",u.style.height=g+"px"}}}const Wb=new C,ZR=new Ft,Xb=new C;class qb extends ot{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}class KR extends qb{constructor(e){super(e),this.isCSS3DSprite=!0,this.rotation2D=0}copy(e,t){return super.copy(e,t),this.rotation2D=e.rotation2D,this}}const Dr=new De,JR=new De;class $R{constructor(e={}){const t=this;let n,i,r,s;const c={camera:{fov:0,style:""},objects:new WeakMap},u=e.element!==void 0?e.element:document.createElement("div");u.style.overflow="hidden",this.domElement=u;const d=document.createElement("div");d.style.transformOrigin="0 0",d.style.pointerEvents="none",u.appendChild(d);const p=document.createElement("div");function f(y){return Math.abs(y)<1e-10?0:y}function g(y){const S=y.elements;return"matrix3d("+f(S[0])+","+f(-S[1])+","+f(S[2])+","+f(S[3])+","+f(S[4])+","+f(-S[5])+","+f(S[6])+","+f(S[7])+","+f(S[8])+","+f(-S[9])+","+f(S[10])+","+f(S[11])+","+f(S[12])+","+f(-S[13])+","+f(S[14])+","+f(S[15])+")"}function v(y){const S=y.elements;return"translate(-50%,-50%)"+("matrix3d("+f(S[0])+","+f(S[1])+","+f(S[2])+","+f(S[3])+","+f(-S[4])+","+f(-S[5])+","+f(-S[6])+","+f(-S[7])+","+f(S[8])+","+f(S[9])+","+f(S[10])+","+f(S[11])+","+f(S[12])+","+f(S[13])+","+f(S[14])+","+f(S[15])+")")}function b(y,S,M,w){if(y.isCSS3DObject){const T=y.visible===!0&&y.layers.test(M.layers)===!0;if(y.element.style.display=T===!0?"":"none",T===!0){let R;y.onBeforeRender(t,S,M),y.isCSS3DSprite?(Dr.copy(M.matrixWorldInverse),Dr.transpose(),y.rotation2D!==0&&Dr.multiply(JR.makeRotationZ(y.rotation2D)),y.matrixWorld.decompose(Wb,ZR,Xb),Dr.setPosition(Wb),Dr.scale(Xb),Dr.elements[3]=0,Dr.elements[7]=0,Dr.elements[11]=0,Dr.elements[15]=1,R=v(Dr)):R=v(y.matrixWorld);const L=y.element,P=c.objects.get(y);if(P===void 0||P.style!==R){L.style.transform=R;const I={style:R};c.objects.set(y,I)}L.parentNode!==p&&p.appendChild(L),y.onAfterRender(t,S,M)}}for(let T=0,R=y.children.length;T<R;T++)b(y.children[T],S,M)}p.style.transformStyle="preserve-3d",d.appendChild(p),this.getSize=function(){return{width:n,height:i}},this.render=function(y,S){const M=S.projectionMatrix.elements[5]*s;let w,T;c.camera.fov!==M&&(d.style.perspective=S.isPerspectiveCamera?M+"px":"",c.camera.fov=M),S.view&&S.view.enabled?(d.style.transform=`translate( ${-S.view.offsetX*(n/S.view.width)}px, ${-S.view.offsetY*(i/S.view.height)}px )`,d.style.transform+=`scale( ${S.view.fullWidth/S.view.width}, ${S.view.fullHeight/S.view.height} )`):d.style.transform="",y.matrixWorldAutoUpdate===!0&&y.updateMatrixWorld(),S.parent===null&&S.matrixWorldAutoUpdate===!0&&S.updateMatrixWorld(),S.isOrthographicCamera&&(w=-(S.right+S.left)/2,T=(S.top+S.bottom)/2);const R=S.view&&S.view.enabled?S.view.height/S.view.fullHeight:1,L=S.isOrthographicCamera?`scale( ${R} )scale(`+M+")translate("+f(w)+"px,"+f(T)+"px)"+g(S.matrixWorldInverse):`scale( ${R} )translateZ(`+M+"px)"+g(S.matrixWorldInverse),P=L+"translate("+r+"px,"+s+"px)";c.camera.style!==P&&(p.style.transform=P,c.camera.style=P),b(y,y,S)},this.setSize=function(y,S){n=y,i=S,r=n/2,s=i/2,u.style.width=y+"px",u.style.height=S+"px",d.style.width=y+"px",d.style.height=S+"px",p.style.width=y+"px",p.style.height=S+"px"}}}class Yb{constructor(){this.id=0,this.object=null,this.z=0,this.renderOrder=0}}class Qb{constructor(){this.id=0,this.v1=new Ys,this.v2=new Ys,this.v3=new Ys,this.normalModel=new C,this.vertexNormalsModel=[new C,new C,new C],this.vertexNormalsLength=0,this.color=new Pe,this.material=null,this.uvs=[new ce,new ce,new ce],this.z=0,this.renderOrder=0}}class Ys{constructor(){this.position=new C,this.positionWorld=new C,this.positionScreen=new Qe,this.visible=!0}copy(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)}}class Zb{constructor(){this.id=0,this.v1=new Ys,this.v2=new Ys,this.vertexColors=[new Pe,new Pe],this.material=null,this.z=0,this.renderOrder=0}}class Kb{constructor(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new ce,this.material=null,this.renderOrder=0}}class eL{constructor(){let e,t,n,i,r,s,c,u,d,p,f,g=0,v=0,b=0,y=0,S=0;const M={objects:[],lights:[],elements:[]},w=new C,T=new Qe,R=new Ar(new C(-1,-1,-1),new C(1,1,1)),L=new Ar,P=new Array(3),I=new De,V=new De,z=new De,G=new wc,F=[],$=[],le=[],ae=[],ye=[],pe=new function(){const ne=[],me=[],Ae=[];let Se=null;const Ne=new dn;function j(q){const H=q.position,J=q.positionWorld,O=q.positionScreen;J.copy(H).applyMatrix4(f),O.copy(J).applyMatrix4(V);const W=1/O.w;O.x*=W,O.y*=W,O.z*=W,q.visible=O.x>=-1&&O.x<=1&&O.y>=-1&&O.y<=1&&O.z>=-1&&O.z<=1}function U(q,H,J){return q.visible===!0||H.visible===!0||J.visible===!0||(P[0]=q.positionScreen,P[1]=H.positionScreen,P[2]=J.positionScreen,R.intersectsBox(L.setFromPoints(P)))}function ie(q,H,J){return(J.positionScreen.x-q.positionScreen.x)*(H.positionScreen.y-q.positionScreen.y)-(J.positionScreen.y-q.positionScreen.y)*(H.positionScreen.x-q.positionScreen.x)<0}return{setObject:function(q){Se=q,Ne.getNormalMatrix(Se.matrixWorld),ne.length=0,me.length=0,Ae.length=0},projectVertex:j,checkTriangleVisibility:U,checkBackfaceCulling:ie,pushVertex:function(q,H,J){n=function(){if(i===v){const O=new Ys;return $.push(O),v++,i++,O}return $[i++]}(),n.position.set(q,H,J),j(n)},pushNormal:function(q,H,J){ne.push(q,H,J)},pushColor:function(q,H,J){me.push(q,H,J)},pushUv:function(q,H){Ae.push(q,H)},pushLine:function(q,H){const J=$[q],O=$[H];J.positionScreen.copy(J.position).applyMatrix4(z),O.positionScreen.copy(O.position).applyMatrix4(z),function(W,Y){let ee=0,te=1;const de=W.z+W.w,Oe=Y.z+Y.w,ze=-W.z+W.w,Ve=-Y.z+Y.w;return de>=0&&Oe>=0&&ze>=0&&Ve>=0||!(de<0&&Oe<0||ze<0&&Ve<0)&&(de<0?ee=Math.max(ee,de/(de-Oe)):Oe<0&&(te=Math.min(te,de/(de-Oe))),ze<0?ee=Math.max(ee,ze/(ze-Ve)):Ve<0&&(te=Math.min(te,ze/(ze-Ve))),!(te<ee)&&(W.lerp(Y,ee),Y.lerp(W,1-te),!0))}(J.positionScreen,O.positionScreen)===!0&&(J.positionScreen.multiplyScalar(1/J.positionScreen.w),O.positionScreen.multiplyScalar(1/O.positionScreen.w),c=function(){if(u===y){const W=new Zb;return ae.push(W),y++,u++,W}return ae[u++]}(),c.id=Se.id,c.v1.copy(J),c.v2.copy(O),c.z=Math.max(J.positionScreen.z,O.positionScreen.z),c.renderOrder=Se.renderOrder,c.material=Se.material,Se.material.vertexColors&&(c.vertexColors[0].fromArray(me,3*q),c.vertexColors[1].fromArray(me,3*H)),M.elements.push(c))},pushTriangle:function(q,H,J,O){const W=$[q],Y=$[H],ee=$[J];if(U(W,Y,ee)!==!1&&(O.side===_e||ie(W,Y,ee)===!0)){r=function(){if(s===b){const te=new Qb;return le.push(te),b++,s++,te}return le[s++]}(),r.id=Se.id,r.v1.copy(W),r.v2.copy(Y),r.v3.copy(ee),r.z=(W.positionScreen.z+Y.positionScreen.z+ee.positionScreen.z)/3,r.renderOrder=Se.renderOrder,w.subVectors(ee.position,Y.position),T.subVectors(W.position,Y.position),w.cross(T),r.normalModel.copy(w),r.normalModel.applyMatrix3(Ne).normalize();for(let te=0;te<3;te++){const de=r.vertexNormalsModel[te];de.fromArray(ne,3*arguments[te]),de.applyMatrix3(Ne).normalize(),r.uvs[te].fromArray(Ae,2*arguments[te])}r.vertexNormalsLength=3,r.material=O,O.vertexColors&&r.color.fromArray(me,3*q),M.elements.push(r)}}}};function Me(ne){if(ne.visible===!1)return;if(ne.isLight)M.lights.push(ne);else if(ne.isMesh||ne.isLine||ne.isPoints){if(ne.material.visible===!1||ne.frustumCulled===!0&&G.intersectsObject(ne)===!1)return;Ee(ne)}else if(ne.isSprite){if(ne.material.visible===!1||ne.frustumCulled===!0&&G.intersectsSprite(ne)===!1)return;Ee(ne)}const me=ne.children;for(let Ae=0,Se=me.length;Ae<Se;Ae++)Me(me[Ae])}function Ee(ne){e=function(){if(t===g){const me=new Yb;return F.push(me),g++,t++,me}return F[t++]}(),e.id=ne.id,e.object=ne,w.setFromMatrixPosition(ne.matrixWorld),w.applyMatrix4(V),e.z=w.z,e.renderOrder=ne.renderOrder,M.objects.push(e)}function Re(ne,me,Ae){const Se=1/ne.w;ne.z*=Se,ne.z>=-1&&ne.z<=1&&(d=function(){if(p===S){const Ne=new Kb;return ye.push(Ne),S++,p++,Ne}return ye[p++]}(),d.id=me.id,d.x=ne.x*Se,d.y=ne.y*Se,d.z=ne.z,d.renderOrder=me.renderOrder,d.object=me,d.rotation=me.rotation,d.scale.x=me.scale.x*Math.abs(d.x-(ne.x+Ae.projectionMatrix.elements[0])/(ne.w+Ae.projectionMatrix.elements[12])),d.scale.y=me.scale.y*Math.abs(d.y-(ne.y+Ae.projectionMatrix.elements[5])/(ne.w+Ae.projectionMatrix.elements[13])),d.material=me.material,M.elements.push(d))}function he(ne,me){return ne.renderOrder!==me.renderOrder?ne.renderOrder-me.renderOrder:ne.z!==me.z?me.z-ne.z:ne.id!==me.id?ne.id-me.id:0}this.projectScene=function(ne,me,Ae,Se){s=0,u=0,p=0,M.elements.length=0,ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),me.parent===null&&me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),I.copy(me.matrixWorldInverse),V.multiplyMatrices(me.projectionMatrix,I),G.setFromProjectionMatrix(V),t=0,M.objects.length=0,M.lights.length=0,Me(ne),Ae===!0&&M.objects.sort(he);const Ne=M.objects;for(let j=0,U=Ne.length;j<U;j++){const ie=Ne[j].object,q=ie.geometry;if(pe.setObject(ie),f=ie.matrixWorld,i=0,ie.isMesh){let H=ie.material;const J=Array.isArray(H),O=q.attributes,W=q.groups;if(O.position===void 0)continue;const Y=O.position.array;for(let ee=0,te=Y.length;ee<te;ee+=3){let de=Y[ee],Oe=Y[ee+1],ze=Y[ee+2];const Ve=q.morphAttributes.position;if(Ve!==void 0){const Be=q.morphTargetsRelative,nt=ie.morphTargetInfluences;for(let lt=0,et=Ve.length;lt<et;lt++){const pt=nt[lt];if(pt===0)continue;const Ct=Ve[lt];Be?(de+=Ct.getX(ee/3)*pt,Oe+=Ct.getY(ee/3)*pt,ze+=Ct.getZ(ee/3)*pt):(de+=(Ct.getX(ee/3)-Y[ee])*pt,Oe+=(Ct.getY(ee/3)-Y[ee+1])*pt,ze+=(Ct.getZ(ee/3)-Y[ee+2])*pt)}}pe.pushVertex(de,Oe,ze)}if(O.normal!==void 0){const ee=O.normal.array;for(let te=0,de=ee.length;te<de;te+=3)pe.pushNormal(ee[te],ee[te+1],ee[te+2])}if(O.color!==void 0){const ee=O.color.array;for(let te=0,de=ee.length;te<de;te+=3)pe.pushColor(ee[te],ee[te+1],ee[te+2])}if(O.uv!==void 0){const ee=O.uv.array;for(let te=0,de=ee.length;te<de;te+=2)pe.pushUv(ee[te],ee[te+1])}if(q.index!==null){const ee=q.index.array;if(W.length>0)for(let te=0;te<W.length;te++){const de=W[te];if(H=J===!0?ie.material[de.materialIndex]:ie.material,H!==void 0)for(let Oe=de.start,ze=de.start+de.count;Oe<ze;Oe+=3)pe.pushTriangle(ee[Oe],ee[Oe+1],ee[Oe+2],H)}else for(let te=0,de=ee.length;te<de;te+=3)pe.pushTriangle(ee[te],ee[te+1],ee[te+2],H)}else if(W.length>0)for(let ee=0;ee<W.length;ee++){const te=W[ee];if(H=J===!0?ie.material[te.materialIndex]:ie.material,H!==void 0)for(let de=te.start,Oe=te.start+te.count;de<Oe;de+=3)pe.pushTriangle(de,de+1,de+2,H)}else for(let ee=0,te=Y.length/3;ee<te;ee+=3)pe.pushTriangle(ee,ee+1,ee+2,H)}else if(ie.isLine){z.multiplyMatrices(V,f);const H=q.attributes;if(H.position!==void 0){const J=H.position.array;for(let O=0,W=J.length;O<W;O+=3)pe.pushVertex(J[O],J[O+1],J[O+2]);if(H.color!==void 0){const O=H.color.array;for(let W=0,Y=O.length;W<Y;W+=3)pe.pushColor(O[W],O[W+1],O[W+2])}if(q.index!==null){const O=q.index.array;for(let W=0,Y=O.length;W<Y;W+=2)pe.pushLine(O[W],O[W+1])}else{const O=ie.isLineSegments?2:1;for(let W=0,Y=J.length/3-1;W<Y;W+=O)pe.pushLine(W,W+1)}}}else if(ie.isPoints){z.multiplyMatrices(V,f);const H=q.attributes;if(H.position!==void 0){const J=H.position.array;for(let O=0,W=J.length;O<W;O+=3)T.set(J[O],J[O+1],J[O+2],1),T.applyMatrix4(z),Re(T,ie,me)}}else ie.isSprite&&(ie.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,ie.matrixWorld),T.set(f.elements[12],f.elements[13],f.elements[14],1),T.applyMatrix4(V),Re(T,ie,me))}return Se===!0&&M.elements.sort(he),M}}}function tL(){throw new Error("BufferGeometryUtils: computeTangents renamed to computeMikkTSpaceTangents.")}function nL(o,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!o.hasAttribute("position")||!o.hasAttribute("normal")||!o.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function n(s){if(s.normalized||s.isInterleavedBufferAttribute){const c=new Float32Array(s.getCount()*s.itemSize);for(let u=0,d=0;u<s.getCount();u++)c[d++]=s.getX(u),c[d++]=s.getY(u),s.itemSize>2&&(c[d++]=s.getZ(u));return c}return s.array instanceof Float32Array?s.array:new Float32Array(s.array)}const i=o.index?o.toNonIndexed():o,r=e.generateTangents(n(i.attributes.position),n(i.attributes.normal),n(i.attributes.uv));if(t)for(let s=3;s<r.length;s+=4)r[s]*=-1;return i.setAttribute("tangent",new $e(r,4)),o!==i&&o.copy(i),o}function iL(o,e=!1){const t=o[0].index!==null,n=new Set(Object.keys(o[0].attributes)),i=new Set(Object.keys(o[0].morphAttributes)),r={},s={},c=o[0].morphTargetsRelative,u=new Ke;let d=0;for(let p=0;p<o.length;++p){const f=o[p];let g=0;if(t!==(f.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const v in f.attributes){if(!n.has(v))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;r[v]===void 0&&(r[v]=[]),r[v].push(f.attributes[v]),g++}if(g!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". Make sure all geometries have the same number of attributes."),null;if(c!==f.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const v in f.morphAttributes){if(!i.has(v))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+".  .morphAttributes must be consistent throughout all geometries."),null;s[v]===void 0&&(s[v]=[]),s[v].push(f.morphAttributes[v])}if(e){let v;if(t)v=f.index.count;else{if(f.attributes.position===void 0)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+p+". The geometry must have either an index or a position attribute"),null;v=f.attributes.position.count}u.addGroup(d,v,p),d+=v}}if(t){let p=0;const f=[];for(let g=0;g<o.length;++g){const v=o[g].index;for(let b=0;b<v.count;++b)f.push(v.getX(b)+p);p+=o[g].attributes.position.count}u.setIndex(f)}for(const p in r){const f=m0(r[p]);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+p+" attribute."),null;u.setAttribute(p,f)}for(const p in s){const f=s[p][0].length;if(f===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[p]=[];for(let g=0;g<f;++g){const v=[];for(let y=0;y<s[p].length;++y)v.push(s[p][y][g]);const b=m0(v);if(!b)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+p+" morphAttribute."),null;u.morphAttributes[p].push(b)}}return u}function m0(o){let e,t,n,i=0;for(let c=0;c<o.length;++c){const u=o[c];if(u.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=u.array.constructor),e!==u.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=u.itemSize),t!==u.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=u.normalized),n!==u.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=u.array.length}const r=new e(i);let s=0;for(let c=0;c<o.length;++c)r.set(o[c].array,s),s+=o[c].array.length;return new $e(r,t,n)}function Md(o){return o.isInstancedInterleavedBufferAttribute||o.isInterleavedBufferAttribute?Td(o):o.isInstancedBufferAttribute?new Na().copy(o):new $e().copy(o)}function rL(o){let e,t=0,n=0;for(let d=0,p=o.length;d<p;++d){const f=o[d];if(e===void 0&&(e=f.array.constructor),e!==f.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=f.array.length,n+=f.itemSize}const i=new Qo(new e(t),n);let r=0;const s=[],c=["getX","getY","getZ","getW"],u=["setX","setY","setZ","setW"];for(let d=0,p=o.length;d<p;d++){const f=o[d],g=f.itemSize,v=f.count,b=new ri(i,g,r,f.normalized);s.push(b),r+=g;for(let y=0;y<v;y++)for(let S=0;S<g;S++)b[u[S]](y,f[c[S]](y))}return s}function Td(o){const e=o.data.array.constructor,t=o.count,n=o.itemSize,i=o.normalized,r=new e(t*n);let s;s=o.isInstancedInterleavedBufferAttribute?new Na(r,n,i,o.meshPerAttribute):new $e(r,n,i);for(let c=0;c<t;c++)s.setX(c,o.getX(c)),n>=2&&s.setY(c,o.getY(c)),n>=3&&s.setZ(c,o.getZ(c)),n>=4&&s.setW(c,o.getW(c));return s}function aL(o){const e=o.attributes,t=o.morphTargets,n=new Map;for(const i in e){const r=e[i];r.isInterleavedBufferAttribute&&(n.has(r)||n.set(r,Td(r)),e[i]=n.get(r))}for(const i in t){const r=t[i];r.isInterleavedBufferAttribute&&(n.has(r)||n.set(r,Td(r)),t[i]=n.get(r))}}function sL(o){let e=0;for(const n in o.attributes){const i=o.getAttribute(n);e+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}const t=o.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function oL(o,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},n=o.getIndex(),i=o.getAttribute("position"),r=n?n.count:i.count;let s=0;const c=Object.keys(o.attributes),u={},d={},p=[],f=["getX","getY","getZ","getW"],g=["setX","setY","setZ","setW"];for(let S=0,M=c.length;S<M;S++){const w=c[S],T=o.attributes[w];u[w]=new $e(new T.array.constructor(T.count*T.itemSize),T.itemSize,T.normalized);const R=o.morphAttributes[w];R&&(d[w]=new $e(new R.array.constructor(R.count*R.itemSize),R.itemSize,R.normalized))}const v=Math.log10(1/e),b=Math.pow(10,v);for(let S=0;S<r;S++){const M=n?n.getX(S):S;let w="";for(let T=0,R=c.length;T<R;T++){const L=c[T],P=o.getAttribute(L),I=P.itemSize;for(let V=0;V<I;V++)w+=~~(P[f[V]](M)*b)+","}if(w in t)p.push(t[w]);else{for(let T=0,R=c.length;T<R;T++){const L=c[T],P=o.getAttribute(L),I=o.morphAttributes[L],V=P.itemSize,z=u[L],G=d[L];for(let F=0;F<V;F++){const $=f[F],le=g[F];if(z[le](s,P[$](M)),I)for(let ae=0,ye=I.length;ae<ye;ae++)G[ae][le](s,I[ae][$](M))}}t[w]=s,p.push(s),s++}}const y=o.clone();for(const S in o.attributes){const M=u[S];if(y.setAttribute(S,new $e(M.array.slice(0,s*M.itemSize),M.itemSize,M.normalized)),S in d)for(let w=0;w<d[S].length;w++){const T=d[S][w];y.morphAttributes[S][w]=new $e(T.array.slice(0,s*T.itemSize),T.itemSize,T.normalized)}}return y.setIndex(p),y}function g0(o,e){if(e===gy)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===dh||e===Qf){let t=o.getIndex();if(t===null){const s=[],c=o.getAttribute("position");if(c===void 0)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o;for(let u=0;u<c.count;u++)s.push(u);o.setIndex(s),t=o.getIndex()}const n=t.count-2,i=[];if(e===dh)for(let s=1;s<=n;s++)i.push(t.getX(0)),i.push(t.getX(s)),i.push(t.getX(s+1));else for(let s=0;s<n;s++)s%2==0?(i.push(t.getX(s)),i.push(t.getX(s+1)),i.push(t.getX(s+2))):(i.push(t.getX(s+2)),i.push(t.getX(s+1)),i.push(t.getX(s)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=o.clone();return r.setIndex(i),r.clearGroups(),r}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}function lL(o){const e=new C,t=new C,n=new C,i=new C,r=new C,s=new C,c=new C,u=new C,d=new C;function p(Me,Ee,Re,he,ne,me,Ae,Se){e.fromBufferAttribute(Ee,ne),t.fromBufferAttribute(Ee,me),n.fromBufferAttribute(Ee,Ae);const Ne=Me.morphTargetInfluences;if(Re&&Ne){c.set(0,0,0),u.set(0,0,0),d.set(0,0,0);for(let j=0,U=Re.length;j<U;j++){const ie=Ne[j],q=Re[j];ie!==0&&(i.fromBufferAttribute(q,ne),r.fromBufferAttribute(q,me),s.fromBufferAttribute(q,Ae),he?(c.addScaledVector(i,ie),u.addScaledVector(r,ie),d.addScaledVector(s,ie)):(c.addScaledVector(i.sub(e),ie),u.addScaledVector(r.sub(t),ie),d.addScaledVector(s.sub(n),ie)))}e.add(c),t.add(u),n.add(d)}Me.isSkinnedMesh&&(Me.boneTransform(ne,e),Me.boneTransform(me,t),Me.boneTransform(Ae,n)),Se[3*ne+0]=e.x,Se[3*ne+1]=e.y,Se[3*ne+2]=e.z,Se[3*me+0]=t.x,Se[3*me+1]=t.y,Se[3*me+2]=t.z,Se[3*Ae+0]=n.x,Se[3*Ae+1]=n.y,Se[3*Ae+2]=n.z}const f=o.geometry,g=o.material;let v,b,y;const S=f.index,M=f.attributes.position,w=f.morphAttributes.position,T=f.morphTargetsRelative,R=f.attributes.normal,L=f.morphAttributes.position,P=f.groups,I=f.drawRange;let V,z,G,F,$,le,ae;const ye=new Float32Array(M.count*M.itemSize),pe=new Float32Array(R.count*R.itemSize);if(S!==null)if(Array.isArray(g))for(V=0,G=P.length;V<G;V++)for($=P[V],le=Math.max($.start,I.start),ae=Math.min($.start+$.count,I.start+I.count),z=le,F=ae;z<F;z+=3)v=S.getX(z),b=S.getX(z+1),y=S.getX(z+2),p(o,M,w,T,v,b,y,ye),p(o,R,L,T,v,b,y,pe);else for(le=Math.max(0,I.start),ae=Math.min(S.count,I.start+I.count),V=le,G=ae;V<G;V+=3)v=S.getX(V),b=S.getX(V+1),y=S.getX(V+2),p(o,M,w,T,v,b,y,ye),p(o,R,L,T,v,b,y,pe);else if(Array.isArray(g))for(V=0,G=P.length;V<G;V++)for($=P[V],le=Math.max($.start,I.start),ae=Math.min($.start+$.count,I.start+I.count),z=le,F=ae;z<F;z+=3)v=z,b=z+1,y=z+2,p(o,M,w,T,v,b,y,ye),p(o,R,L,T,v,b,y,pe);else for(le=Math.max(0,I.start),ae=Math.min(M.count,I.start+I.count),V=le,G=ae;V<G;V+=3)v=V,b=V+1,y=V+2,p(o,M,w,T,v,b,y,ye),p(o,R,L,T,v,b,y,pe);return{positionAttribute:M,normalAttribute:R,morphedPositionAttribute:new Ge(ye,3),morphedNormalAttribute:new Ge(pe,3)}}function Jb(o){if(o.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),o;let e=o.groups;if(e=e.sort((s,c)=>s.materialIndex!==c.materialIndex?s.materialIndex-c.materialIndex:s.start-c.start),o.getIndex()===null){const s=o.getAttribute("position"),c=[];for(let u=0;u<s.count;u+=3)c.push(u,u+1,u+2);o.setIndex(c)}const t=o.getIndex(),n=[];for(let s=0;s<e.length;s++){const c=e[s],u=c.start,d=u+c.count;for(let p=u;p<d;p++)n.push(t.getX(p))}o.dispose(),o.setIndex(n);let i=0;for(let s=0;s<e.length;s++){const c=e[s];c.start=i,i+=c.count}let r=e[0];o.groups=[r];for(let s=1;s<e.length;s++){const c=e[s];r.materialIndex===c.materialIndex?r.count+=c.count:(r=c,o.groups.push(r))}return o}function cL(o,e=Math.PI/3){const t=Math.cos(e),n=100*(1+1e-10),i=[new C,new C,new C],r=new C,s=new C,c=new C,u=new C;function d(y){return`${~~(y.x*n)},${~~(y.y*n)},${~~(y.z*n)}`}const p=o.toNonIndexed(),f=p.attributes.position,g={};for(let y=0,S=f.count/3;y<S;y++){const M=3*y,w=i[0].fromBufferAttribute(f,M+0),T=i[1].fromBufferAttribute(f,M+1),R=i[2].fromBufferAttribute(f,M+2);r.subVectors(R,T),s.subVectors(w,T);const L=new C().crossVectors(r,s).normalize();for(let P=0;P<3;P++){const I=d(i[P]);I in g||(g[I]=[]),g[I].push(L)}}const v=new Float32Array(3*f.count),b=new $e(v,3,!1);for(let y=0,S=f.count/3;y<S;y++){const M=3*y,w=i[0].fromBufferAttribute(f,M+0),T=i[1].fromBufferAttribute(f,M+1),R=i[2].fromBufferAttribute(f,M+2);r.subVectors(R,T),s.subVectors(w,T),c.crossVectors(r,s).normalize();for(let L=0;L<3;L++){const P=g[d(i[L])];u.set(0,0,0);for(let I=0,V=P.length;I<V;I++){const z=P[I];c.dot(z)>t&&u.add(z)}u.normalize(),b.setXYZ(M+L,u.x,u.y,u.z)}}return p.setAttribute("normal",b),p}const $b=new Pe,eS=new De;function uL(o){const e=new Vn,t=o.count,n=o.geometry,i=o.material;for(let r=0;r<t;r++){const s=new Je(n,i);o.getMatrixAt(r,s.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),e.add(s)}return e.copy(o),e.updateMatrixWorld(),e}function hL(o){if(Array.isArray(o.material)===!1)return console.warn("THREE.SceneUtils.createMeshesFromMultiMaterialMesh(): The given mesh has no multiple materials."),o;const e=new Vn;e.copy(o);const t=Jb(o.geometry),n=t.index,i=t.groups,r=Object.keys(t.attributes);for(let s=0;s<i.length;s++){const c=i[s],u=c.start,d=u+c.count,p=new Ke,f=o.material[c.materialIndex];for(let v=0;v<r.length;v++){const b=r[v],y=t.attributes[b],S=y.itemSize,M=c.count*S,w=new y.array.constructor(M),T=new $e(w,S);for(let R=u,L=0;R<d;R++,L++){const P=n.getX(R);S>=1&&T.setX(L,y.getX(P)),S>=2&&T.setY(L,y.getY(P)),S>=3&&T.setZ(L,y.getZ(P)),S>=4&&T.setW(L,y.getW(P))}p.setAttribute(b,T)}const g=new Je(p,f);e.add(g)}return e}function dL(o,e){const t=new Vn;for(let n=0,i=e.length;n<i;n++)t.add(new Je(o,e[n]));return t}function pL(o,e,t){let n=t;const i=new C;return o.updateWorldMatrix(!0,!0),o.traverseVisible(r=>{const{geometry:s}=r;if(s!==void 0){const{position:c}=s.attributes;if(c!==void 0)for(let u=0,d=c.count;u<d;u++)r.isMesh?r.getVertexPosition(u,i):i.fromBufferAttribute(c,u),r.isSkinnedMesh||i.applyMatrix4(r.matrixWorld),n=e(n,i)}}),n}function fL(o,e){const t=Md(o.instanceMatrix),n=o.instanceColor?Md(o.instanceColor):null,i=new Map;for(const s in o.geometry.attributes){const c=o.geometry.attributes[s];c.isInstancedBufferAttribute&&i.set(c,Md(c))}const r=[];for(let s=0;s<o.count;s++)r.push(s);r.sort(e);for(let s=0;s<r.length;s++){const c=r[s];eS.fromArray(t.array,c*o.instanceMatrix.itemSize),eS.toArray(o.instanceMatrix.array,s*o.instanceMatrix.itemSize),o.instanceColor&&($b.fromArray(n.array,c*o.instanceColor.itemSize),$b.toArray(o.instanceColor.array,s*o.instanceColor.itemSize));for(const u in o.geometry.attributes){const d=o.geometry.attributes[u];if(d.isInstancedBufferAttribute){const p=i.get(d);d.setX(s,p.getX(c)),d.itemSize>1&&d.setY(s,p.getY(c)),d.itemSize>2&&d.setZ(s,p.getZ(c)),d.itemSize>3&&d.setW(s,p.getW(c))}}}}function _t(o,e,t=!1){for(let n in e){let i=e[n];if(i===void 0)continue;let r=n.split("-"),s=o,c=s;for(let u=0,d=r.length;u<d;u++)(t||c.hasOwnProperty(r[u]))&&(s=c[r[u]],u==d-1&&(s&&s.copy?s.copy(i):s instanceof Object?Object.assign(s,i):c[r[u]]=i),c=s)}return o}function mL(...o){let e=new Pe;return o.length===1?e.set(o[0]):o.length===3&&e.setRGB(o[0],o[1],o[2]),e}function gL(o,e){return new ce(o,e??o)}function tS(o,e,t){return new C(o,e??o,t??o)}function vL(o,e,t,n){return new Qe(o,e??o,t??o,n??o)}function nS(o,e,t){return new jn(o,e,t)}function yL(o,e,t,n){return new Ft(o,e,t,n)}function xL(o,e,t){let n={};o.traverse(s=>{var c;if(s.visible&&s.isMesh&&s.geometry){if(t&&t(s))return;let u=s.geometry.uuid+((c=s.material)==null?void 0:c.name);n[u]==null&&(n[u]={geometry:s.geometry,material:s.material,group:[]}),n[u].group.push(s)}});let i=0,r=new Vn;for(let s in n){let c=n[s],{geometry:u,material:d,group:p}=c,f=new Qh(u,d,p.length);for(let g=p.length;g--;)p[g].updateWorldMatrix(!0,!1),f.setMatrixAt(g,p[g].matrixWorld);_t(f,e),r.add(f),i+=p.length}return r}function Ed(o){let e=o.split(".");return e.length>1?e.pop():""}function iS(o){let e=o.lastIndexOf("/");return e!==-1?o.substring(0,e):""}function v0(o,e){let t=o.split("/").pop();return e?t.replace(e,"").replace(".",""):t}function bL(){let o=new Ke;return o.setAttribute("position",new Ge([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new Ge([0,2,0,0,2,0],2)),o}class rS{constructor(e,t,n){N(this,"texture");N(this,"texCoords");N(this,"meshCoords");this.texture=e,this.texCoords=t,this.meshCoords=n}}const SL={x:.5,y:.5};class aS{constructor(e,t){N(this,"json");N(this,"texture");N(this,"_spriteFrames",{});N(this,"_animations",{});this.json=e,this.texture=t;let n=e.meta.size,i=e.meta.scale/Math.max(n.w,n.h),r=e.frames;for(let s in r){let{frame:c,sourceSize:u,spriteSourceSize:d,anchor:p}=r[s],f=c.x/n.w,g=c.y/n.h,v=c.w/n.w,b=c.h/n.h,y=u,S=d,M=p||SL,w=i;this._spriteFrames[s]=new rS(t,new Qe(f,1-(g+b),v,b),new Qe(S.x+.5*S.w-y.w*M.x,-(S.y+.5*S.h-y.h*M.y),S.w,S.h).multiplyScalar(w))}for(let s in e.animations)this._animations[s]=e.animations[s].map(c=>this._spriteFrames[c])}getAnimation(e){return this._animations[e]}getSpriteFrame(e){return this._spriteFrames[e]}}class Ha{constructor(){N(this,"name","")}}class sS extends Ha{constructor(){super(...arguments);N(this,"extensions",["json"])}load({url:t,file:n,onLoad:i,onProgress:r,onError:s}){return new ai().load(t,c=>i(JSON.parse(c)),r,s,n)}}class oS extends Ha{constructor(){super(...arguments);N(this,"extensions",["png","jpg","webp","avif"])}load({url:t,file:n,onLoad:i,onProgress:r,onError:s,settings:c}){new ud().load(t,u=>i(Object.assign(u,c)),r,s,n)}}var lS=function(o){return URL.createObjectURL(new Blob([o],{type:"text/javascript"}))};try{URL.revokeObjectURL(lS(""))}catch{lS=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var Vi=Uint8Array,ja=Uint16Array,y0=Uint32Array,cS=new Vi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),uS=new Vi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),_L=new Vi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hS=function(o,e){for(var t=new ja(31),n=0;n<31;++n)t[n]=e+=1<<o[n-1];var i=new y0(t[30]);for(n=1;n<30;++n)for(var r=t[n];r<t[n+1];++r)i[r]=r-t[n]<<5|n;return[t,i]},dS=hS(cS,2),pS=dS[0],wL=dS[1];pS[28]=258,wL[258]=28;for(var fS=hS(uS,0),ML=fS[0],x0=(fS[1],new ja(32768)),Gt=0;Gt<32768;++Gt){var Qs=(43690&Gt)>>>1|(21845&Gt)<<1;Qs=(61680&(Qs=(52428&Qs)>>>2|(13107&Qs)<<2))>>>4|(3855&Qs)<<4,x0[Gt]=((65280&Qs)>>>8|(255&Qs)<<8)>>>1}var jc=function(o,e,t){for(var n=o.length,i=0,r=new ja(e);i<n;++i)++r[o[i]-1];var s,c=new ja(e);for(i=0;i<e;++i)c[i]=c[i-1]+r[i-1]<<1;if(t){s=new ja(1<<e);var u=15-e;for(i=0;i<n;++i)if(o[i])for(var d=i<<4|o[i],p=e-o[i],f=c[o[i]-1]++<<p,g=f|(1<<p)-1;f<=g;++f)s[x0[f]>>>u]=d}else for(s=new ja(n),i=0;i<n;++i)o[i]&&(s[i]=x0[c[o[i]-1]++]>>>15-o[i]);return s},Gc=new Vi(288);for(Gt=0;Gt<144;++Gt)Gc[Gt]=8;for(Gt=144;Gt<256;++Gt)Gc[Gt]=9;for(Gt=256;Gt<280;++Gt)Gc[Gt]=7;for(Gt=280;Gt<288;++Gt)Gc[Gt]=8;var mS=new Vi(32);for(Gt=0;Gt<32;++Gt)mS[Gt]=5;var TL=jc(Gc,9,1),EL=jc(mS,5,1),b0=function(o){for(var e=o[0],t=1;t<o.length;++t)o[t]>e&&(e=o[t]);return e},dr=function(o,e,t){var n=e/8|0;return(o[n]|o[n+1]<<8)>>(7&e)&t},S0=function(o,e){var t=e/8|0;return(o[t]|o[t+1]<<8|o[t+2]<<16)>>(7&e)},AL=function(o){return(o/8|0)+(7&o&&1)},RL=function(o,e,t){(e==null||e<0)&&(e=0),(t==null||t>o.length)&&(t=o.length);var n=new(o instanceof ja?ja:o instanceof y0?y0:Vi)(t-e);return n.set(o.subarray(e,t)),n},LL=function(o,e,t){var n=o.length;if(!n||t&&!t.l&&n<5)return e||new Vi(0);var i=!e||t,r=!t||t.i;t||(t={}),e||(e=new Vi(3*n));var s=function(j){var U=e.length;if(j>U){var ie=new Vi(Math.max(2*U,j));ie.set(e),e=ie}},c=t.f||0,u=t.p||0,d=t.b||0,p=t.l,f=t.d,g=t.m,v=t.n,b=8*n;do{if(!p){t.f=c=dr(o,u,1);var y=dr(o,u+1,3);if(u+=3,!y){var S=o[(F=AL(u)+4)-4]|o[F-3]<<8,M=F+S;if(M>n){if(r)throw"unexpected EOF";break}i&&s(d+S),e.set(o.subarray(F,M),d),t.b=d+=S,t.p=u=8*M;continue}if(y==1)p=TL,f=EL,g=9,v=5;else{if(y!=2)throw"invalid block type";var w=dr(o,u,31)+257,T=dr(o,u+10,15)+4,R=w+dr(o,u+5,31)+1;u+=14;for(var L=new Vi(R),P=new Vi(19),I=0;I<T;++I)P[_L[I]]=dr(o,u+3*I,7);u+=3*T;var V=b0(P),z=(1<<V)-1,G=jc(P,V,1);for(I=0;I<R;){var F,$=G[dr(o,u,z)];if(u+=15&$,(F=$>>>4)<16)L[I++]=F;else{var le=0,ae=0;for(F==16?(ae=3+dr(o,u,3),u+=2,le=L[I-1]):F==17?(ae=3+dr(o,u,7),u+=3):F==18&&(ae=11+dr(o,u,127),u+=7);ae--;)L[I++]=le}}var ye=L.subarray(0,w),pe=L.subarray(w);g=b0(ye),v=b0(pe),p=jc(ye,g,1),f=jc(pe,v,1)}if(u>b){if(r)throw"unexpected EOF";break}}i&&s(d+131072);for(var Me=(1<<g)-1,Ee=(1<<v)-1,Re=u;;Re=u){var he=(le=p[S0(o,u)&Me])>>>4;if((u+=15&le)>b){if(r)throw"unexpected EOF";break}if(!le)throw"invalid length/literal";if(he<256)e[d++]=he;else{if(he==256){Re=u,p=null;break}var ne=he-254;if(he>264){var me=cS[I=he-257];ne=dr(o,u,(1<<me)-1)+pS[I],u+=me}var Ae=f[S0(o,u)&Ee],Se=Ae>>>4;if(!Ae)throw"invalid distance";if(u+=15&Ae,pe=ML[Se],Se>3&&(me=uS[Se],pe+=S0(o,u)&(1<<me)-1,u+=me),u>b){if(r)throw"unexpected EOF";break}i&&s(d+131072);for(var Ne=d+ne;d<Ne;d+=4)e[d]=e[d-pe],e[d+1]=e[d+1-pe],e[d+2]=e[d+2-pe],e[d+3]=e[d+3-pe];d=Ne}}t.l=p,t.p=Re,t.b=d,p&&(c=1,t.m=g,t.d=f,t.n=v)}while(!c);return d==e.length?e:RL(e,0,d)},PL=new Vi(0),CL=function(o){if((15&o[0])!=8||o[0]>>>4>7||(o[0]<<8|o[1])%31)throw"invalid zlib data";if(32&o[1])throw"invalid zlib data: preset dictionaries not supported"};function DL(o,e){return LL((CL(o),o.subarray(2,-4)),e)}var OL=typeof TextDecoder<"u"&&new TextDecoder;try{OL.decode(PL,{stream:!0})}catch{}function gS(o,e,t){const n=t.length-o-1;if(e>=t[n])return n-1;if(e<=t[o])return o;let i=o,r=n,s=Math.floor((i+r)/2);for(;e<t[s]||e>=t[s+1];)e<t[s]?r=s:i=s,s=Math.floor((i+r)/2);return s}function IL(o,e,t,n){const i=[],r=[],s=[];i[0]=1;for(let c=1;c<=t;++c){r[c]=e-n[o+1-c],s[c]=n[o+c]-e;let u=0;for(let d=0;d<c;++d){const p=s[d+1],f=r[c-d],g=i[d]/(p+f);i[d]=u+p*g,u=f*g}i[c]=u}return i}function NL(o,e){let t=1;for(let i=2;i<=o;++i)t*=i;let n=1;for(let i=2;i<=e;++i)n*=i;for(let i=2;i<=o-e;++i)n*=i;return t/n}function kL(o,e,t,n,i){const r=function(s,c,u,d,p){const f=p<s?p:s,g=[],v=gS(s,d,c),b=function(S,M,w,T,R){const L=[];for(let F=0;F<=w;++F)L[F]=0;const P=[];for(let F=0;F<=T;++F)P[F]=L.slice(0);const I=[];for(let F=0;F<=w;++F)I[F]=L.slice(0);I[0][0]=1;const V=L.slice(0),z=L.slice(0);for(let F=1;F<=w;++F){V[F]=M-R[S+1-F],z[F]=R[S+F]-M;let $=0;for(let le=0;le<F;++le){const ae=z[le+1],ye=V[F-le];I[F][le]=ae+ye;const pe=I[le][F-1]/I[F][le];I[le][F]=$+ae*pe,$=ye*pe}I[F][F]=$}for(let F=0;F<=w;++F)P[0][F]=I[F][w];for(let F=0;F<=w;++F){let $=0,le=1;const ae=[];for(let ye=0;ye<=w;++ye)ae[ye]=L.slice(0);ae[0][0]=1;for(let ye=1;ye<=T;++ye){let pe=0;const Me=F-ye,Ee=w-ye;F>=ye&&(ae[le][0]=ae[$][0]/I[Ee+1][Me],pe=ae[le][0]*I[Me][Ee]);const Re=F-1<=Ee?ye-1:w-F;for(let ne=Me>=-1?1:-Me;ne<=Re;++ne)ae[le][ne]=(ae[$][ne]-ae[$][ne-1])/I[Ee+1][Me+ne],pe+=ae[le][ne]*I[Me+ne][Ee];F<=Ee&&(ae[le][ye]=-ae[$][ye-1]/I[Ee+1][F],pe+=ae[le][ye]*I[F][Ee]),P[ye][F]=pe;const he=$;$=le,le=he}}let G=w;for(let F=1;F<=T;++F){for(let $=0;$<=w;++$)P[F][$]*=G;G*=w-F}return P}(v,d,s,f,c),y=[];for(let S=0;S<u.length;++S){const M=u[S].clone(),w=M.w;M.x*=w,M.y*=w,M.z*=w,y[S]=M}for(let S=0;S<=f;++S){const M=y[v-s].clone().multiplyScalar(b[S][0]);for(let w=1;w<=s;++w)M.add(y[v-s+w].clone().multiplyScalar(b[S][w]));g[S]=M}for(let S=f+1;S<=p+1;++S)g[S]=new Qe(0,0,0);return g}(o,e,t,n,i);return function(s){const c=s.length,u=[],d=[];for(let f=0;f<c;++f){const g=s[f];u[f]=new C(g.x,g.y,g.z),d[f]=g.w}const p=[];for(let f=0;f<c;++f){const g=u[f].clone();for(let v=1;v<=f;++v)g.sub(p[f-v].clone().multiplyScalar(NL(f,v)*d[v]));p[f]=g.divideScalar(d[0])}return p}(r)}class FL extends ji{constructor(e,t,n,i,r){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=i||0,this.endKnot=r||this.knots.length-1;for(let s=0;s<n.length;++s){const c=n[s];this.controlPoints[s]=new Qe(c.x,c.y,c.z,c.w)}}getPoint(e,t=new C){const n=t,i=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=function(s,c,u,d){const p=gS(s,d,c),f=IL(p,d,s,c),g=new Qe(0,0,0,0);for(let v=0;v<=s;++v){const b=u[p-s+v],y=f[v],S=b.w*y;g.x+=b.x*S,g.y+=b.y*S,g.z+=b.z*S,g.w+=b.w*y}return g}(this.degree,this.knots,this.controlPoints,i);return r.w!==1&&r.divideScalar(r.w),n.set(r.x,r.y,r.z)}getTangent(e,t=new C){const n=t,i=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),r=kL(this.degree,this.knots,this.controlPoints,i,1);return n.copy(r[1]).normalize(),n}}let mt,cn,fi;class UL extends Wn{constructor(e){super(e)}load(e,t,n,i,r){const s=this,c=s.path===""?js.extractUrlBase(e):s.path,u=new ai(this.manager);u.setPath(s.path),u.setResponseType("arraybuffer"),u.setRequestHeader(s.requestHeader),u.setWithCredentials(s.withCredentials),u.load(e,function(d){try{t(s.parse(d,c))}catch(p){i?i(p):console.error(p),s.manager.itemError(e)}},n,i,r==null?void 0:r.mainFile)}parse(e,t){if(function(i){const r="Kaydara FBX Binary  \0";return i.byteLength>=r.length&&r===_S(i,0,r.length)}(e))mt=new GL().parse(e);else{const i=_S(e);if(!function(r){const s=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let c=0;function u(d){const p=r[d-1];return r=r.slice(c+d),c++,p}for(let d=0;d<s.length;++d)if(u(1)===s[d])return!1;return!0}(i))throw new Error("THREE.FBXLoader: Unknown format.");if(xS(i)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+xS(i));mt=new jL().parse(i)}const n=new ud(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new zL(n,this.manager).parse(mt)}}class zL{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){cn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),i=this.parseDeformers(),r=new BL().parse(i);return this.parseScene(i,r,n),fi}parseConnections(){const e=new Map;return"Connections"in mt&&mt.Connections.connections.forEach(function(t){const n=t[0],i=t[1],r=t[2];e.has(n)||e.set(n,{parents:[],children:[]});const s={ID:i,relationship:r};e.get(n).parents.push(s),e.has(i)||e.set(i,{parents:[],children:[]});const c={ID:n,relationship:r};e.get(i).children.push(c)}),e}parseImages(){const e={},t={};if("Video"in mt.Objects){const n=mt.Objects.Video;for(const i in n){const r=n[i];if(e[parseInt(i)]=r.RelativeFilename||r.Filename,"Content"in r){const s=r.Content instanceof ArrayBuffer&&r.Content.byteLength>0,c=typeof r.Content=="string"&&r.Content!=="";if(s||c){const u=this.parseImage(n[i]);t[r.RelativeFilename||r.Filename]=u}}}}for(const n in e){const i=e[n];t[i]!==void 0?e[n]=t[i]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();let r;switch(i){case"bmp":r="image/bmp";break;case"jpg":case"jpeg":r="image/jpeg";break;case"png":r="image/png";break;case"tif":r="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),r="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if(typeof t=="string")return"data:"+r+";base64,"+t;{const s=new Uint8Array(t);return window.URL.createObjectURL(new Blob([s],{type:r}))}}parseTextures(e){const t=new Map;if("Texture"in mt.Objects){const n=mt.Objects.Texture;for(const i in n){const r=this.parseTexture(n[i],e);t.set(parseInt(i),r)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const i=e.WrapModeU,r=e.WrapModeV,s=i!==void 0?i.value:0,c=r!==void 0?r.value:0;if(n.wrapS=s===0?hi:vn,n.wrapT=c===0?hi:vn,"Scaling"in e){const u=e.Scaling.value;n.repeat.x=u[0],n.repeat.y=u[1]}if("Translation"in e){const u=e.Translation.value;n.offset.x=u[0],n.offset.y=u[1]}return n}loadTexture(e,t){let n;const i=this.textureLoader.path,r=cn.get(e.id).children;let s;r!==void 0&&r.length>0&&t[r[0].ID]!==void 0&&(n=t[r[0].ID],n.indexOf("blob:")!==0&&n.indexOf("data:")!==0||this.textureLoader.setPath(void 0));const c=e.FileName.slice(-3).toLowerCase();if(c==="tga"){const u=this.manager.getHandler(".tga");u===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),s=new Ut):(u.setPath(this.textureLoader.path),s=u.load(n))}else c==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),s=new Ut):s=this.textureLoader.load(n);return this.textureLoader.setPath(i),s}parseMaterials(e){const t=new Map;if("Material"in mt.Objects){const n=mt.Objects.Material;for(const i in n){const r=this.parseMaterial(n[i],e);r!==null&&t.set(parseInt(i),r)}}return t}parseMaterial(e,t){const n=e.id,i=e.attrName;let r=e.ShadingModel;if(typeof r=="object"&&(r=r.value),!cn.has(n))return null;const s=this.parseParameters(e,t,n);let c;switch(r.toLowerCase()){case"phong":c=new Fc;break;case"lambert":c=new Km;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',r),c=new Fc}return c.setValues(s),c.name=i,c}parseParameters(e,t,n){const i={};e.BumpFactor&&(i.bumpScale=e.BumpFactor.value),e.Diffuse?i.color=new Pe().fromArray(e.Diffuse.value):!e.DiffuseColor||e.DiffuseColor.type!=="Color"&&e.DiffuseColor.type!=="ColorRGB"||(i.color=new Pe().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(i.displacementScale=e.DisplacementFactor.value),e.Emissive?i.emissive=new Pe().fromArray(e.Emissive.value):!e.EmissiveColor||e.EmissiveColor.type!=="Color"&&e.EmissiveColor.type!=="ColorRGB"||(i.emissive=new Pe().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(i.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(i.opacity=parseFloat(e.Opacity.value)),i.opacity<1&&(i.transparent=!0),e.ReflectionFactor&&(i.reflectivity=e.ReflectionFactor.value),e.Shininess&&(i.shininess=e.Shininess.value),e.Specular?i.specular=new Pe().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(i.specular=new Pe().fromArray(e.SpecularColor.value));const r=this;return cn.get(n).children.forEach(function(s){const c=s.relationship;switch(c){case"Bump":i.bumpMap=r.getTexture(t,s.ID);break;case"Maya|TEX_ao_map":i.aoMap=r.getTexture(t,s.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=r.getTexture(t,s.ID),i.map!==void 0&&(i.map.encoding=ht);break;case"DisplacementColor":i.displacementMap=r.getTexture(t,s.ID);break;case"EmissiveColor":i.emissiveMap=r.getTexture(t,s.ID),i.emissiveMap!==void 0&&(i.emissiveMap.encoding=ht);break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=r.getTexture(t,s.ID);break;case"ReflectionColor":i.envMap=r.getTexture(t,s.ID),i.envMap!==void 0&&(i.envMap.mapping=Ta,i.envMap.encoding=ht);break;case"SpecularColor":i.specularMap=r.getTexture(t,s.ID),i.specularMap!==void 0&&(i.specularMap.encoding=ht);break;case"TransparentColor":case"TransparencyFactor":i.alphaMap=r.getTexture(t,s.ID),i.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",c)}}),i}getTexture(e,t){return"LayeredTexture"in mt.Objects&&t in mt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=cn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in mt.Objects){const n=mt.Objects.Deformer;for(const i in n){const r=n[i],s=cn.get(parseInt(i));if(r.attrType==="Skin"){const c=this.parseSkeleton(s,n);c.ID=i,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=s.parents[0].ID,e[i]=c}else if(r.attrType==="BlendShape"){const c={id:i};c.rawTargets=this.parseMorphTargets(s,n),c.id=i,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[i]=c}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(i){const r=t[i.ID];if(r.attrType!=="Cluster")return;const s={ID:i.ID,indices:[],weights:[],transformLink:new De().fromArray(r.TransformLink.a)};"Indexes"in r&&(s.indices=r.Indexes.a,s.weights=r.Weights.a),n.push(s)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let i=0;i<e.children.length;i++){const r=e.children[i],s=t[r.ID],c={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if(s.attrType!=="BlendShapeChannel")return;c.geoID=cn.get(parseInt(r.ID)).children.filter(function(u){return u.relationship===void 0})[0].ID,n.push(c)}return n}parseScene(e,t,n){fi=new Vn;const i=this.parseModels(e.skeletons,t,n),r=mt.Objects.Model,s=this;i.forEach(function(u){const d=r[u.ID];s.setLookAtProperties(u,d),cn.get(u.ID).parents.forEach(function(p){const f=i.get(p.ID);f!==void 0&&f.add(u)}),u.parent===null&&fi.add(u)}),this.bindSkeleton(e.skeletons,t,i),this.createAmbientLight(),fi.traverse(function(u){if(u.userData.transformData){u.parent&&(u.userData.transformData.parentMatrix=u.parent.matrix,u.userData.transformData.parentMatrixWorld=u.parent.matrixWorld);const d=bS(u.userData.transformData);u.applyMatrix4(d),u.updateWorldMatrix()}});const c=new HL().parse();fi.children.length===1&&fi.children[0].isGroup&&(fi.children[0].animations=c,fi=fi.children[0]),fi.animations=c}parseModels(e,t,n){const i=new Map,r=mt.Objects.Model;for(const s in r){const c=parseInt(s),u=r[s],d=cn.get(c);let p=this.buildSkeleton(d,e,c,u.attrName);if(!p){switch(u.attrType){case"Camera":p=this.createCamera(d);break;case"Light":p=this.createLight(d);break;case"Mesh":p=this.createMesh(d,t,n);break;case"NurbsCurve":p=this.createCurve(d,t);break;case"LimbNode":case"Root":p=new el;break;default:p=new Vn}p.name=u.attrName?dt.sanitizeNodeName(u.attrName):"",p.ID=c}this.getTransformData(p,u),i.set(c,p)}return i}buildSkeleton(e,t,n,i){let r=null;return e.parents.forEach(function(s){for(const c in t){const u=t[c];u.rawBones.forEach(function(d,p){if(d.ID===s.ID){const f=r;r=new el,r.matrixWorld.copy(d.transformLink),r.name=i?dt.sanitizeNodeName(i):"",r.ID=n,u.bones[p]=r,f!==null&&r.add(f)}})}}),r}createCamera(e){let t,n;if(e.children.forEach(function(i){const r=mt.Objects.NodeAttribute[i.ID];r!==void 0&&(n=r)}),n===void 0)t=new ot;else{let i=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(i=1);let r=1;n.NearPlane!==void 0&&(r=n.NearPlane.value/1e3);let s=1e3;n.FarPlane!==void 0&&(s=n.FarPlane.value/1e3);let c=window.innerWidth,u=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(c=n.AspectWidth.value,u=n.AspectHeight.value);const d=c/u;let p=45;n.FieldOfView!==void 0&&(p=n.FieldOfView.value);const f=n.FocalLength?n.FocalLength.value:null;switch(i){case 0:t=new Qt(p,d,r,s),f!==null&&t.setFocalLength(f);break;case 1:t=new Oa(-c/2,c/2,u/2,-u/2,r,s);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+i+"."),t=new ot}}return t}createLight(e){let t,n;if(e.children.forEach(function(i){const r=mt.Objects.NodeAttribute[i.ID];r!==void 0&&(n=r)}),n===void 0)t=new ot;else{let i;i=n.LightType===void 0?0:n.LightType.value;let r=16777215;n.Color!==void 0&&(r=new Pe().fromArray(n.Color.value));let s=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(s=0);let c=0;n.FarAttenuationEnd!==void 0&&(c=n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?0:n.FarAttenuationEnd.value);const u=1;switch(i){case 0:t=new Bc(r,s,c,u);break;case 1:t=new dd(r,s);break;case 2:let d=Math.PI/3;n.InnerAngle!==void 0&&(d=hn.degToRad(n.InnerAngle.value));let p=0;n.OuterAngle!==void 0&&(p=hn.degToRad(n.OuterAngle.value),p=Math.max(p,1)),t=new hd(r,s,c,d,p,u);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Bc(r,s)}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let i,r=null,s=null;const c=[];return e.children.forEach(function(u){t.has(u.ID)&&(r=t.get(u.ID)),n.has(u.ID)&&c.push(n.get(u.ID))}),c.length>1?s=c:c.length>0?s=c[0]:(s=new Fc({color:13421772}),c.push(s)),"color"in r.attributes&&c.forEach(function(u){u.vertexColors=!0}),r.FBX_Deformer?(i=new qh(r,s),i.normalizeSkinWeights()):i=new Je(r,s),i}createCurve(e,t){const n=e.children.reduce(function(r,s){return t.has(s.ID)&&(r=t.get(s.ID)),r},null),i=new In({color:3342591,linewidth:1});return new Lr(n,i)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?SS(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&cn.get(e.ID).children.forEach(function(n){if(n.relationship==="LookAtProperty"){const i=mt.Objects.Model[n.ID];if("Lcl_Translation"in i){const r=i.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(r),fi.add(e.target)):e.lookAt(new C().fromArray(r))}}})}bindSkeleton(e,t,n){const i=this.parsePoseNodes();for(const r in e){const s=e[r];cn.get(parseInt(s.ID)).parents.forEach(function(c){if(t.has(c.ID)){const u=c.ID;cn.get(u).parents.forEach(function(d){n.has(d.ID)&&n.get(d.ID).bind(new tl(s.bones),i[d.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in mt.Objects){const t=mt.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const i=t[n].PoseNode;Array.isArray(i)?i.forEach(function(r){e[r.Node]=new De().fromArray(r.Matrix.a)}):e[i.Node]=new De().fromArray(i.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in mt&&"AmbientColor"in mt.GlobalSettings){const e=mt.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],i=e[2];if(t!==0||n!==0||i!==0){const r=new Pe(t,n,i);fi.add(new o0(r,1))}}}}class BL{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in mt.Objects){const n=mt.Objects.Geometry;for(const i in n){const r=cn.get(parseInt(i)),s=this.parseGeometry(r,n[i],e);t.set(parseInt(i),s)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const i=n.skeletons,r=[],s=e.parents.map(function(f){return mt.Objects.Model[f.ID]});if(s.length===0)return;const c=e.children.reduce(function(f,g){return i[g.ID]!==void 0&&(f=i[g.ID]),f},null);e.children.forEach(function(f){n.morphTargets[f.ID]!==void 0&&r.push(n.morphTargets[f.ID])});const u=s[0],d={};"RotationOrder"in u&&(d.eulerOrder=SS(u.RotationOrder.value)),"InheritType"in u&&(d.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(d.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(d.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(d.scale=u.GeometricScaling.value);const p=bS(d);return this.genGeometry(t,c,r,p)}genGeometry(e,t,n,i){const r=new Ke;e.attrName&&(r.name=e.attrName);const s=this.parseGeoNode(e,t),c=this.genBuffers(s),u=new Ge(c.vertex,3);if(u.applyMatrix4(i),r.setAttribute("position",u),c.colors.length>0&&r.setAttribute("color",new Ge(c.colors,3)),t&&(r.setAttribute("skinIndex",new Eh(c.weightsIndices,4)),r.setAttribute("skinWeight",new Ge(c.vertexWeights,4)),r.FBX_Deformer=t),c.normal.length>0){const d=new dn().getNormalMatrix(i),p=new Ge(c.normal,3);p.applyNormalMatrix(d),r.setAttribute("normal",p)}if(c.uvs.forEach(function(d,p){let f="uv"+(p+1).toString();p===0&&(f="uv"),r.setAttribute(f,new Ge(c.uvs[p],2))}),s.material&&s.material.mappingType!=="AllSame"){let d=c.materialIndex[0],p=0;if(c.materialIndex.forEach(function(f,g){f!==d&&(r.addGroup(p,g-p,d),d=f,p=g)}),r.groups.length>0){const f=r.groups[r.groups.length-1],g=f.start+f.count;g!==c.materialIndex.length&&r.addGroup(g,c.materialIndex.length-g,d)}r.groups.length===0&&r.addGroup(0,c.materialIndex.length,c.materialIndex[0])}return this.addMorphTargets(r,e,n,i),r}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let i=0;for(;e.LayerElementUV[i];)e.LayerElementUV[i].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[i])),i++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(i,r){i.indices.forEach(function(s,c){n.weightTable[s]===void 0&&(n.weightTable[s]=[]),n.weightTable[s].push({id:r,weight:i.weights[c]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,i=0,r=!1,s=[],c=[],u=[],d=[],p=[],f=[];const g=this;return e.vertexIndices.forEach(function(v,b){let y,S=!1;v<0&&(v^=-1,S=!0);let M=[],w=[];if(s.push(3*v,3*v+1,3*v+2),e.color){const T=Ad(b,n,v,e.color);u.push(T[0],T[1],T[2])}if(e.skeleton){if(e.weightTable[v]!==void 0&&e.weightTable[v].forEach(function(T){w.push(T.weight),M.push(T.id)}),w.length>4){r||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),r=!0);const T=[0,0,0,0],R=[0,0,0,0];w.forEach(function(L,P){let I=L,V=M[P];R.forEach(function(z,G,F){if(I>z){F[G]=I,I=z;const $=T[G];T[G]=V,V=$}})}),M=T,w=R}for(;w.length<4;)w.push(0),M.push(0);for(let T=0;T<4;++T)p.push(w[T]),f.push(M[T])}if(e.normal){const T=Ad(b,n,v,e.normal);c.push(T[0],T[1],T[2])}e.material&&e.material.mappingType!=="AllSame"&&(y=Ad(b,n,v,e.material)[0],y<0&&(g.negativeMaterialIndices=!0,y=0)),e.uv&&e.uv.forEach(function(T,R){const L=Ad(b,n,v,T);d[R]===void 0&&(d[R]=[]),d[R].push(L[0]),d[R].push(L[1])}),i++,S&&(i>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),g.genFace(t,e,s,y,c,u,d,p,f,i),n++,i=0,s=[],c=[],u=[],d=[],p=[],f=[])}),t}genFace(e,t,n,i,r,s,c,u,d,p){for(let f=2;f<p;f++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(f-1)]]),e.vertex.push(t.vertexPositions[n[3*(f-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(f-1)+2]]),e.vertex.push(t.vertexPositions[n[3*f]]),e.vertex.push(t.vertexPositions[n[3*f+1]]),e.vertex.push(t.vertexPositions[n[3*f+2]]),t.skeleton&&(e.vertexWeights.push(u[0]),e.vertexWeights.push(u[1]),e.vertexWeights.push(u[2]),e.vertexWeights.push(u[3]),e.vertexWeights.push(u[4*(f-1)]),e.vertexWeights.push(u[4*(f-1)+1]),e.vertexWeights.push(u[4*(f-1)+2]),e.vertexWeights.push(u[4*(f-1)+3]),e.vertexWeights.push(u[4*f]),e.vertexWeights.push(u[4*f+1]),e.vertexWeights.push(u[4*f+2]),e.vertexWeights.push(u[4*f+3]),e.weightsIndices.push(d[0]),e.weightsIndices.push(d[1]),e.weightsIndices.push(d[2]),e.weightsIndices.push(d[3]),e.weightsIndices.push(d[4*(f-1)]),e.weightsIndices.push(d[4*(f-1)+1]),e.weightsIndices.push(d[4*(f-1)+2]),e.weightsIndices.push(d[4*(f-1)+3]),e.weightsIndices.push(d[4*f]),e.weightsIndices.push(d[4*f+1]),e.weightsIndices.push(d[4*f+2]),e.weightsIndices.push(d[4*f+3])),t.color&&(e.colors.push(s[0]),e.colors.push(s[1]),e.colors.push(s[2]),e.colors.push(s[3*(f-1)]),e.colors.push(s[3*(f-1)+1]),e.colors.push(s[3*(f-1)+2]),e.colors.push(s[3*f]),e.colors.push(s[3*f+1]),e.colors.push(s[3*f+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(i),e.materialIndex.push(i),e.materialIndex.push(i)),t.normal&&(e.normal.push(r[0]),e.normal.push(r[1]),e.normal.push(r[2]),e.normal.push(r[3*(f-1)]),e.normal.push(r[3*(f-1)+1]),e.normal.push(r[3*(f-1)+2]),e.normal.push(r[3*f]),e.normal.push(r[3*f+1]),e.normal.push(r[3*f+2])),t.uv&&t.uv.forEach(function(g,v){e.uvs[v]===void 0&&(e.uvs[v]=[]),e.uvs[v].push(c[v][0]),e.uvs[v].push(c[v][1]),e.uvs[v].push(c[v][2*(f-1)]),e.uvs[v].push(c[v][2*(f-1)+1]),e.uvs[v].push(c[v][2*f]),e.uvs[v].push(c[v][2*f+1])})}addMorphTargets(e,t,n,i){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const r=this;n.forEach(function(s){s.rawTargets.forEach(function(c){const u=mt.Objects.Geometry[c.geoID];u!==void 0&&r.genMorphGeometry(e,t,u,i,c.name)})})}genMorphGeometry(e,t,n,i,r){const s=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],c=n.Vertices!==void 0?n.Vertices.a:[],u=n.Indexes!==void 0?n.Indexes.a:[],d=3*e.attributes.position.count,p=new Float32Array(d);for(let b=0;b<u.length;b++){const y=3*u[b];p[y]=c[3*b],p[y+1]=c[3*b+1],p[y+2]=c[3*b+2]}const f={vertexIndices:s,vertexPositions:p},g=this.genBuffers(f),v=new Ge(g.vertex,3);v.name=r||n.attrName,v.applyMatrix4(i),e.morphAttributes.position.push(v)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.Normals.a;let r=[];return n==="IndexToDirect"&&("NormalIndex"in e?r=e.NormalIndex.a:"NormalsIndex"in e&&(r=e.NormalsIndex.a)),{dataSize:3,buffer:i,indices:r,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.UV.a;let r=[];return n==="IndexToDirect"&&(r=e.UVIndex.a),{dataSize:2,buffer:i,indices:r,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,i=e.Colors.a;let r=[];return n==="IndexToDirect"&&(r=e.ColorIndex.a),{dataSize:4,buffer:i,indices:r,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const i=e.Materials.a,r=[];for(let s=0;s<i.length;++s)r.push(s);return{dataSize:1,buffer:i,indices:r,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Ke;const n=t-1,i=e.KnotVector.a,r=[],s=e.Points.a;for(let p=0,f=s.length;p<f;p+=4)r.push(new Qe().fromArray(s,p));let c,u;if(e.Form==="Closed")r.push(r[0]);else if(e.Form==="Periodic"){c=n,u=i.length-1-c;for(let p=0;p<n;++p)r.push(r[p])}const d=new FL(n,i,r,c,u).getPoints(12*r.length);return new Ke().setFromPoints(d)}}class HL{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const i=t[n],r=this.addClip(i);e.push(r)}return e}parseClips(){if(mt.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=mt.Objects.AnimationCurveNode,t=new Map;for(const n in e){const i=e[n];if(i.attrName.match(/S|R|T|DeformPercent/)!==null){const r={id:i.id,attr:i.attrName,curves:{}};t.set(r.id,r)}}return t}parseAnimationCurves(e){const t=mt.Objects.AnimationCurve;for(const n in t){const i={id:t[n].id,times:t[n].KeyTime.a.map(VL),values:t[n].KeyValueFloat.a},r=cn.get(i.id);if(r!==void 0){const s=r.parents[0].ID,c=r.parents[0].relationship;c.match(/X/)?e.get(s).curves.x=i:c.match(/Y/)?e.get(s).curves.y=i:c.match(/Z/)?e.get(s).curves.z=i:c.match(/d|DeformPercent/)&&e.has(s)&&(e.get(s).curves.morph=i)}}}parseAnimationLayers(e){const t=mt.Objects.AnimationLayer,n=new Map;for(const i in t){const r=[],s=cn.get(parseInt(i));s!==void 0&&(s.children.forEach(function(c,u){if(e.has(c.ID)){const d=e.get(c.ID);if(d.curves.x!==void 0||d.curves.y!==void 0||d.curves.z!==void 0){if(r[u]===void 0){const p=cn.get(c.ID).parents.filter(function(f){return f.relationship!==void 0})[0].ID;if(p!==void 0){const f=mt.Objects.Model[p.toString()];if(f===void 0)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",c);const g={modelName:f.attrName?dt.sanitizeNodeName(f.attrName):"",ID:f.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};fi.traverse(function(v){v.ID===f.id&&(g.transform=v.matrix,v.userData.transformData&&(g.eulerOrder=v.userData.transformData.eulerOrder))}),g.transform||(g.transform=new De),"PreRotation"in f&&(g.preRotation=f.PreRotation.value),"PostRotation"in f&&(g.postRotation=f.PostRotation.value),r[u]=g}}r[u]&&(r[u][d.attr]=d)}else if(d.curves.morph!==void 0){if(r[u]===void 0){const p=cn.get(c.ID).parents.filter(function(S){return S.relationship!==void 0})[0].ID,f=cn.get(p).parents[0].ID,g=cn.get(f).parents[0].ID,v=cn.get(g).parents[0].ID,b=mt.Objects.Model[v],y={modelName:b.attrName?dt.sanitizeNodeName(b.attrName):"",morphName:mt.Objects.Deformer[p].attrName};r[u]=y}r[u][d.attr]=d}}}),n.set(parseInt(i),r))}return n}parseAnimStacks(e){const t=mt.Objects.AnimationStack,n={};for(const i in t){const r=cn.get(parseInt(i)).children;r.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const s=e.get(r[0].ID);n[i]={name:t[i].attrName,layer:s}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(i){t=t.concat(n.generateTracks(i))}),new Hs(e.name,-1,t)}generateTracks(e){const t=[];let n=new C,i=new Ft,r=new C;if(e.transform&&e.transform.decompose(n,i,r),n=n.toArray(),i=new jn().setFromQuaternion(i,e.eulerOrder).toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const s=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");s!==void 0&&t.push(s)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const s=this.generateRotationTrack(e.modelName,e.R.curves,i,e.preRotation,e.postRotation,e.eulerOrder);s!==void 0&&t.push(s)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const s=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");s!==void 0&&t.push(s)}if(e.DeformPercent!==void 0){const s=this.generateMorphTrack(e);s!==void 0&&t.push(s)}return t}generateVectorTrack(e,t,n,i){const r=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(r,t,n);return new Bs(e+"."+i,r,s)}generateRotationTrack(e,t,n,i,r,s){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(hn.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(hn.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(hn.degToRad));const c=this.getTimesForAllAxes(t),u=this.getKeyframeTrackValues(c,t,n);i!==void 0&&((i=i.map(hn.degToRad)).push(s),i=new jn().fromArray(i),i=new Ft().setFromEuler(i)),r!==void 0&&((r=r.map(hn.degToRad)).push(s),r=new jn().fromArray(r),r=new Ft().setFromEuler(r).invert());const d=new Ft,p=new jn,f=[];for(let g=0;g<u.length;g+=3)p.set(u[g],u[g+1],u[g+2],s),d.setFromEuler(p),i!==void 0&&d.premultiply(i),r!==void 0&&d.multiply(r),d.toArray(f,g/3*4);return new aa(e+".quaternion",c,f)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(r){return r/100}),i=fi.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Us(e.modelName+".morphTargetInfluences["+i+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,i){return n-i}),t.length>1){let n=1,i=t[0];for(let r=1;r<t.length;r++){const s=t[r];s!==i&&(t[n]=s,i=s,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const i=n,r=[];let s=-1,c=-1,u=-1;return e.forEach(function(d){if(t.x&&(s=t.x.times.indexOf(d)),t.y&&(c=t.y.times.indexOf(d)),t.z&&(u=t.z.times.indexOf(d)),s!==-1){const p=t.x.values[s];r.push(p),i[0]=p}else r.push(i[0]);if(c!==-1){const p=t.y.values[c];r.push(p),i[1]=p}else r.push(i[1]);if(u!==-1){const p=t.z.values[u];r.push(p),i[2]=p}else r.push(i[2])}),r}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],i=e.values[t]-n,r=Math.abs(i);if(r>=180){const s=r/180,c=i/s;let u=n+c;const d=e.times[t-1],p=(e.times[t]-d)/s;let f=d+p;const g=[],v=[];for(;f<e.times[t];)g.push(f),f+=p,v.push(u),u+=c;e.times=wS(e.times,t,g),e.values=wS(e.values,t,v)}}}}class jL{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new yS,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(i,r){const s=i.match(/^[\s\t]*;/),c=i.match(/^[\s\t]*$/);if(s||c)return;const u=i.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),d=i.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),p=i.match("^\\t{"+(t.currentIndent-1)+"}}");u?t.parseNodeBegin(i,u):d?t.parseNodeProperty(i,d,n[++r]):p?t.popStack():i.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(i)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),i=t[2].split(",").map(function(u){return u.trim().replace(/^"/,"").replace(/"$/,"")}),r={name:n},s=this.parseNodeAttr(i),c=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,r):n in c?(n==="PoseNode"?c.PoseNode.push(r):c[n].id!==void 0&&(c[n]={},c[n][c[n].id]=c[n]),s.id!==""&&(c[n][s.id]=r)):typeof s.id=="number"?(c[n]={},c[n][s.id]=r):n!=="Properties70"&&(c[n]=n==="PoseNode"?[r]:r),typeof s.id=="number"&&(r.id=s.id),s.name!==""&&(r.attrName=s.name),s.type!==""&&(r.attrType=s.type),this.pushStack(r)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",i="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),i=e[2]),{id:t,name:n,type:i}}parseNodeProperty(e,t,n){let i=t[1].replace(/^"/,"").replace(/"$/,"").trim(),r=t[2].replace(/^"/,"").replace(/"$/,"").trim();i==="Content"&&r===","&&(r=n.replace(/"/g,"").replace(/,$/,"").trim());const s=this.getCurrentNode();if(s.name!=="Properties70"){if(i==="C"){const c=r.split(",").slice(1),u=parseInt(c[0]),d=parseInt(c[1]);let p=r.split(",").slice(3);p=p.map(function(f){return f.trim().replace(/^"/,"")}),i="connections",r=[u,d],function(f,g){for(let v=0,b=f.length,y=g.length;v<y;v++,b++)f[b]=g[v]}(r,p),s[i]===void 0&&(s[i]=[])}i==="Node"&&(s.id=r),i in s&&Array.isArray(s[i])?s[i].push(r):i!=="a"?s[i]=r:s.a=r,this.setCurrentProp(s,i),i==="a"&&r.slice(-1)!==","&&(s.a=w0(r))}else this.parseNodeSpecialProperty(e,i,r)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=w0(t.a))}parseNodeSpecialProperty(e,t,n){const i=n.split('",').map(function(p){return p.trim().replace(/^\"/,"").replace(/\s/,"_")}),r=i[0],s=i[1],c=i[2],u=i[3];let d=i[4];switch(s){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":d=parseFloat(d);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":d=w0(d)}this.getPrevNode()[r]={type:s,type2:c,flag:u,value:d},this.setCurrentProp(this.getPrevNode(),r)}}class GL{parse(e){const t=new vS(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const i=new yS;for(;!this.endOfContent(t);){const r=this.parseNode(t,n);r!==null&&i.add(r.name,r)}return i}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},i=t>=7500?e.getUint64():e.getUint32(),r=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const s=e.getUint8(),c=e.getString(s);if(i===0)return null;const u=[];for(let g=0;g<r;g++)u.push(this.parseProperty(e));const d=u.length>0?u[0]:"",p=u.length>1?u[1]:"",f=u.length>2?u[2]:"";for(n.singleProperty=r===1&&e.getOffset()===i;i>e.getOffset();){const g=this.parseNode(e,t);g!==null&&this.parseSubNode(c,n,g)}return n.propertyList=u,typeof d=="number"&&(n.id=d),p!==""&&(n.attrName=p),f!==""&&(n.attrType=f),c!==""&&(n.name=c),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const i=n.propertyList[0];Array.isArray(i)?(t[n.name]=n,n.a=i):t[n.name]=i}else if(e==="Connections"&&n.name==="C"){const i=[];n.propertyList.forEach(function(r,s){s!==0&&i.push(r)}),t.connections===void 0&&(t.connections=[]),t.connections.push(i)}else if(n.name==="Properties70")Object.keys(n).forEach(function(i){t[i]=n[i]});else if(e==="Properties70"&&n.name==="P"){let i=n.propertyList[0],r=n.propertyList[1];const s=n.propertyList[2],c=n.propertyList[3];let u;i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),u=r==="Color"||r==="ColorRGB"||r==="Vector"||r==="Vector3D"||r.indexOf("Lcl_")===0?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[i]={type:r,type2:s,flag:c,value:u}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const i=e.getUint32(),r=e.getUint32(),s=e.getUint32();if(r===0)switch(t){case"b":case"c":return e.getBooleanArray(i);case"d":return e.getFloat64Array(i);case"f":return e.getFloat32Array(i);case"i":return e.getInt32Array(i);case"l":return e.getInt64Array(i)}const c=DL(new Uint8Array(e.getArrayBuffer(s))),u=new vS(c.buffer);switch(t){case"b":case"c":return u.getBooleanArray(i);case"d":return u.getFloat64Array(i);case"f":return u.getFloat32Array(i);case"i":return u.getInt32Array(i);case"l":return u.getInt64Array(i)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class vS{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t===void 0||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const i=n.indexOf(0);return i>=0&&(n=new Uint8Array(this.dv.buffer,t,i)),this._textDecoder.decode(n)}}class yS{add(e,t){this[e]=t}}function xS(o){const e=o.match(/FBXVersion: (\d+)/);if(e)return parseInt(e[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function VL(o){return o/46186158e3}const WL=[];function Ad(o,e,t,n){let i;switch(n.mappingType){case"ByPolygonVertex":i=o;break;case"ByPolygon":i=e;break;case"ByVertice":i=t;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(i=n.indices[i]);const r=i*n.dataSize,s=r+n.dataSize;return function(c,u,d,p){for(let f=d,g=0;f<p;f++,g++)c[g]=u[f];return c}(WL,n.buffer,r,s)}const _0=new jn,vl=new C;function bS(o){const e=new De,t=new De,n=new De,i=new De,r=new De,s=new De,c=new De,u=new De,d=new De,p=new De,f=new De,g=new De,v=o.inheritType?o.inheritType:0;if(o.translation&&e.setPosition(vl.fromArray(o.translation)),o.preRotation){const G=o.preRotation.map(hn.degToRad);G.push(o.eulerOrder||jn.DEFAULT_ORDER),t.makeRotationFromEuler(_0.fromArray(G))}if(o.rotation){const G=o.rotation.map(hn.degToRad);G.push(o.eulerOrder||jn.DEFAULT_ORDER),n.makeRotationFromEuler(_0.fromArray(G))}if(o.postRotation){const G=o.postRotation.map(hn.degToRad);G.push(o.eulerOrder||jn.DEFAULT_ORDER),i.makeRotationFromEuler(_0.fromArray(G)),i.invert()}o.scale&&r.scale(vl.fromArray(o.scale)),o.scalingOffset&&c.setPosition(vl.fromArray(o.scalingOffset)),o.scalingPivot&&s.setPosition(vl.fromArray(o.scalingPivot)),o.rotationOffset&&u.setPosition(vl.fromArray(o.rotationOffset)),o.rotationPivot&&d.setPosition(vl.fromArray(o.rotationPivot)),o.parentMatrixWorld&&(f.copy(o.parentMatrix),p.copy(o.parentMatrixWorld));const b=t.clone().multiply(n).multiply(i),y=new De;y.extractRotation(p);const S=new De;S.copyPosition(p);const M=S.clone().invert().multiply(p),w=y.clone().invert().multiply(M),T=r,R=new De;if(v===0)R.copy(y).multiply(b).multiply(w).multiply(T);else if(v===1)R.copy(y).multiply(w).multiply(b).multiply(T);else{const G=new De().scale(new C().setFromMatrixScale(f)).clone().invert(),F=w.clone().multiply(G);R.copy(y).multiply(b).multiply(F).multiply(T)}const L=d.clone().invert(),P=s.clone().invert();let I=e.clone().multiply(u).multiply(d).multiply(t).multiply(n).multiply(i).multiply(L).multiply(c).multiply(s).multiply(r).multiply(P);const V=new De().copyPosition(I),z=p.clone().multiply(V);return g.copyPosition(z),I=g.clone().multiply(R),I.premultiply(p.invert()),I}function SS(o){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return(o=o||0)===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[o]}function w0(o){return o.split(",").map(function(e){return parseFloat(e)})}function _S(o,e,t){return e===void 0&&(e=0),t===void 0&&(t=o.byteLength),new TextDecoder().decode(new Uint8Array(o,e,t))}function wS(o,e,t){return o.slice(0,e).concat(t).concat(o.slice(e))}const M0=new WeakMap;class XL extends Wn{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const r=new ai(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,s=>{this.parse(s,t,i)},n,i)}parse(e,t,n){this.decodeDracoFile(e,t,null,null,Ei).catch(n)}decodeDracoFile(e,t,n,i,r=Co){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:r};return this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(M0.has(e)){const u=M0.get(e);if(u.key===n)return u.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const r=this.workerNextTaskID++,s=e.byteLength,c=this._getWorker(r,s).then(u=>(i=u,new Promise((d,p)=>{i._callbacks[r]={resolve:d,reject:p},i.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(u=>this._createGeometry(u.geometry));return c.catch(()=>!0).then(()=>{i&&r&&this._releaseTask(i,r)}),M0.set(e,{key:n,promise:c}),c}_createGeometry(e){const t=new Ke;e.index&&t.setIndex(new $e(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],r=i.name,s=i.array,c=i.itemSize,u=new $e(s,c);r==="color"&&this._assignVertexColorSpace(u,i.vertexColorSpace),t.setAttribute(r,u)}return t}_assignVertexColorSpace(e,t){if(t!==Ei)return;const n=new Pe;for(let i=0,r=e.count;i<r;i++)n.fromBufferAttribute(e,i).convertSRGBToLinear(),e.setXYZ(i,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new ai(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((i,r)=>{n.load(e,i,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const i=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=qL.toString(),s=["/* draco decoder */",i,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(r){const s=r.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,r){return i._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){this.workerPool.map(e=>e._taskLoad)}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function qL(){let o,e;function t(n,i,r,s,c,u){const d=u.num_components(),p=r.num_points()*d,f=p*c.BYTES_PER_ELEMENT,g=function(y,S){switch(S){case Float32Array:return y.DT_FLOAT32;case Int8Array:return y.DT_INT8;case Int16Array:return y.DT_INT16;case Int32Array:return y.DT_INT32;case Uint8Array:return y.DT_UINT8;case Uint16Array:return y.DT_UINT16;case Uint32Array:return y.DT_UINT32}}(n,c),v=n._malloc(f);i.GetAttributeDataArrayForAllPoints(r,u,g,f,v);const b=new c(n.HEAPF32.buffer,v,p).slice();return n._free(v),{name:s,array:b,itemSize:d}}onmessage=function(n){const i=n.data;switch(i.type){case"init":o=i.decoderConfig,e=new Promise(function(c){o.onModuleLoaded=function(u){c({draco:u})},DracoDecoderModule(o)});break;case"decode":const r=i.buffer,s=i.taskConfig;e.then(c=>{const u=c.draco,d=new u.Decoder;try{const p=function(g,v,b,y){const S=y.attributeIDs,M=y.attributeTypes;let w,T;const R=v.GetEncodedGeometryType(b);if(R===g.TRIANGULAR_MESH)w=new g.Mesh,T=v.DecodeArrayToMesh(b,b.byteLength,w);else{if(R!==g.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");w=new g.PointCloud,T=v.DecodeArrayToPointCloud(b,b.byteLength,w)}if(!T.ok()||w.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+T.error_msg());const L={index:null,attributes:[]};for(const P in S){const I=self[M[P]];let V,z;if(y.useUniqueIDs)z=S[P],V=v.GetAttributeByUniqueId(w,z);else{if(z=v.GetAttributeId(w,g[S[P]]),z===-1)continue;V=v.GetAttribute(w,z)}const G=t(g,v,w,P,I,V);P==="color"&&(G.vertexColorSpace=y.vertexColorSpace),L.attributes.push(G)}return R===g.TRIANGULAR_MESH&&(L.index=function(P,I,V){const z=V.num_faces(),G=3*z,F=4*G,$=P._malloc(F);I.GetTrianglesUInt32Array(V,F,$);const le=new Uint32Array(P.HEAPF32.buffer,$,G).slice();return P._free($),{array:le,itemSize:1}}(g,v,w)),g.destroy(w),L}(u,d,new Int8Array(r),s),f=p.attributes.map(g=>g.array.buffer);p.index&&f.push(p.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:p},f)}catch(p){console.error(p),self.postMessage({type:"error",id:i.id,error:p.message})}finally{u.destroy(d)}})}}}class YL extends Wn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new $L(t)}),this.register(function(t){return new sP(t)}),this.register(function(t){return new oP(t)}),this.register(function(t){return new lP(t)}),this.register(function(t){return new tP(t)}),this.register(function(t){return new nP(t)}),this.register(function(t){return new iP(t)}),this.register(function(t){return new rP(t)}),this.register(function(t){return new JL(t)}),this.register(function(t){return new aP(t)}),this.register(function(t){return new eP(t)}),this.register(function(t){return new ZL(t)}),this.register(function(t){return new cP(t)}),this.register(function(t){return new uP(t)})}load(e,t,n,i,r){const s=this;let c;c=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:js.extractUrlBase(e),this.manager.itemStart(e);const u=function(p){i?i(p):console.error(p),s.manager.itemError(e),s.manager.itemEnd(e)},d=new ai(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(p){try{s.parse(p,c,function(f){t(f),s.manager.itemEnd(e)},u,r==null?void 0:r.additionalFiles)}catch(f){u(f)}},n,u,r==null?void 0:r.mainFile)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i,r){let s;const c={},u={},d=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===MS){try{c[bt.KHR_BINARY_GLTF]=new pP(e)}catch(f){return void(i&&i(f))}s=JSON.parse(c[bt.KHR_BINARY_GLTF].content)}else s=JSON.parse(d.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const p=new EP(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const g=this.pluginCallbacks[f](p);u[g.name]=g,c[g.name]=!0}if(s.extensionsUsed)for(let f=0;f<s.extensionsUsed.length;++f){const g=s.extensionsUsed[f],v=s.extensionsRequired||[];switch(g){case bt.KHR_MATERIALS_UNLIT:c[g]=new KL;break;case bt.KHR_DRACO_MESH_COMPRESSION:c[g]=new fP(s,this.dracoLoader);break;case bt.KHR_TEXTURE_TRANSFORM:c[g]=new mP;break;case bt.KHR_MESH_QUANTIZATION:c[g]=new gP;break;default:v.indexOf(g)>=0&&u[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}s.additionalFiles=r,p.setExtensions(c),p.setPlugins(u),p.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,r){n.parse(e,t,i,r)})}}function QL(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const bt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ZL{constructor(e){this.parser=e,this.name=bt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const r=t.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let c;const u=new Pe(16777215);s.color!==void 0&&u.fromArray(s.color);const d=s.range!==void 0?s.range:0;switch(s.type){case"directional":c=new dd(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Bc(u),c.distance=d;break;case"spot":c=new hd(u),c.distance=d,s.spot=s.spot||{},s.spot.innerConeAngle=s.spot.innerConeAngle!==void 0?s.spot.innerConeAngle:0,s.spot.outerConeAngle=s.spot.outerConeAngle!==void 0?s.spot.outerConeAngle:Math.PI/4,c.angle=s.spot.outerConeAngle,c.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return c.position.set(0,0,0),c.decay=2,Ga(c,s),s.intensity!==void 0&&(c.intensity=s.intensity),c.name=t.createUniqueName(s.name||"light_"+e),i=Promise.resolve(c),t.cache.add(n,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,i=n.json.nodes[e],r=(i.extensions&&i.extensions[this.name]||{}).light;return r===void 0?null:this._loadLight(r).then(function(s){return n._getNodeRef(t.cache,r,s)})}}class KL{constructor(){this.name=bt.KHR_MATERIALS_UNLIT}getMaterialType(){return pi}extendParams(e,t,n){const i=[];e.color=new Pe(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const s=r.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}r.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",r.baseColorTexture,ht))}return Promise.all(i)}}class JL{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name].emissiveStrength;return i!==void 0&&(t.emissiveIntensity=i),Promise.resolve()}}class $L{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){const c=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ce(c,c)}return Promise.all(r)}}class eP{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return s.iridescenceFactor!==void 0&&(t.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(t.iridescenceIOR=s.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(r)}}class tP{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Pe(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=i.extensions[this.name];return s.sheenColorFactor!==void 0&&t.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",s.sheenColorTexture,ht)),s.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(r)}}class nP{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(r)}}class iP{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const c=s.attenuationColor||[1,1,1];return t.attenuationColor=new Pe(c[0],c[1],c[2]),Promise.all(r)}}class rP{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}}class aP{constructor(e){this.parser=e,this.name=bt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?ra:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",s.specularTexture));const c=s.specularColorFactor||[1,1,1];return t.specularColor=new Pe(c[0],c[1],c[2]),s.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",s.specularColorTexture,ht)),Promise.all(r)}}class sP{constructor(e){this.parser=e,this.name=bt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,s)}}class oP{constructor(e){this.parser=e,this.name=bt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],c=i.images[s.source];let u=n.textureLoader;if(c.uri){const d=n.options.manager.getHandler(c.uri);d!==null&&(u=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,s.source,u);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class lP{constructor(e){this.parser=e,this.name=bt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],c=i.images[s.source];let u=n.textureLoader;if(c.uri){const d=n.options.manager.getHandler(c.uri);d!==null&&(u=d)}return this.detectSupport().then(function(d){if(d)return n.loadTextureImage(e,s.source,u);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class cP{constructor(e){this.name=bt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],r=this.parser.getDependency("buffer",i.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const u=i.byteOffset||0,d=i.byteLength||0,p=i.count,f=i.byteStride,g=new Uint8Array(c,u,d);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(p,f,g,i.mode,i.filter).then(function(v){return v.buffer}):s.ready.then(function(){const v=new ArrayBuffer(p*f);return s.decodeGltfBuffer(new Uint8Array(v),p,f,g,i.mode,i.filter),v})})}return null}}class uP{constructor(e){this.name=bt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const i=t.meshes[n.mesh];for(const u of i.primitives)if(u.mode!==Wi.TRIANGLES&&u.mode!==Wi.TRIANGLE_STRIP&&u.mode!==Wi.TRIANGLE_FAN&&u.mode!==void 0)return null;const r=n.extensions[this.name].attributes,s=[],c={};for(const u in r)s.push(this.parser.getDependency("accessor",r[u]).then(d=>(c[u]=d,c[u])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(u=>{const d=u.pop(),p=d.isGroup?d.children:[d],f=u[0].count,g=[];for(const v of p){const b=new De,y=new C,S=new Ft,M=new C(1,1,1),w=new Qh(v.geometry,v.material,f);for(let T=0;T<f;T++)c.TRANSLATION&&y.fromBufferAttribute(c.TRANSLATION,T),c.ROTATION&&S.fromBufferAttribute(c.ROTATION,T),c.SCALE&&M.fromBufferAttribute(c.SCALE,T),w.setMatrixAt(T,b.compose(y,S,M));for(const T in c)T!=="TRANSLATION"&&T!=="ROTATION"&&T!=="SCALE"&&v.geometry.setAttribute(T,c[T]);ot.prototype.copy.call(w,v),w.frustumCulled=!1,this.parser.assignFinalMaterial(w),g.push(w)}return d.isGroup?(d.clear(),d.add(...g),d):g[0]}))}}const MS="glTF",hP=1313821514,dP=5130562;class pP{constructor(e){this.name=bt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==MS)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<i;){const c=r.getUint32(s,!0);s+=4;const u=r.getUint32(s,!0);if(s+=4,u===hP){const d=new Uint8Array(e,12+s,c);this.content=n.decode(d)}else if(u===dP){const d=12+s;this.body=e.slice(d,d+c)}s+=c}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class fP{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=bt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,c={},u={},d={};for(const p in s){const f=E0[p]||p.toLowerCase();c[f]=s[p]}for(const p in e.attributes){const f=E0[p]||p.toLowerCase();if(s[p]!==void 0){const g=n.accessors[e.attributes[p]],v=yl[g.componentType];d[f]=v.name,u[f]=g.normalized===!0}}return t.getDependency("bufferView",r).then(function(p){return new Promise(function(f){i.decodeDracoFile(p,function(g){for(const v in g.attributes){const b=g.attributes[v],y=u[v];y!==void 0&&(b.normalized=y)}f(g)},c,d)})})}}class mP{constructor(){this.name=bt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class gP{constructor(){this.name=bt.KHR_MESH_QUANTIZATION}}class TS extends ml{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let s=0;s!==i;s++)t[s]=n[r+s];return t}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,c=this.valueSize,u=2*c,d=3*c,p=i-t,f=(n-t)/p,g=f*f,v=g*f,b=e*d,y=b-d,S=-2*v+3*g,M=v-g,w=1-S,T=M-g+f;for(let R=0;R!==c;R++){const L=s[y+R+c],P=s[y+R+u]*p,I=s[b+R+c],V=s[b+R]*p;r[R]=w*L+T*P+S*I+M*V}return r}}const vP=new Ft;class yP extends TS{interpolate_(e,t,n,i){const r=super.interpolate_(e,t,n,i);return vP.fromArray(r).normalize().toArray(r),r}}const Wi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},yl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ES={9728:At,9729:rt,9984:lc,9985:rh,9986:Lo,9987:ir},AS={33071:vn,33648:Ro,10497:hi},T0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},E0={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},xl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},xP={CUBICSPLINE:void 0,LINEAR:ws,STEP:Po},bP="OPAQUE",SP="MASK",_P="BLEND";function Vc(o,e,t){for(const n in t.extensions)o[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Ga(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function wP(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)o.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function MP(o){const e=o.extensions&&o.extensions[bt.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+RS(e.attributes):o.indices+":"+RS(o.attributes)+":"+o.mode,t}function RS(o){let e="";const t=Object.keys(o).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+o[t[n]]+";";return e}function A0(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const TP=new De;class EP{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new QL,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,r=-1;typeof navigator<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,r=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||i&&r<98?this.textureLoader=new ud(this.options.manager):this.textureLoader=new gb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ai(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(s){const c={scene:s[0][i.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:i.asset,parser:n,userData:{}};Vc(r,c,i),Ga(c,i),Promise.all(n._invokeAll(function(u){return u.afterRoot&&u.afterRoot(c)})).then(function(){e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i].joints;for(let c=0,u=s.length;c<u;c++)e[s[c]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const s=e[i];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(n[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),r=(s,c)=>{const u=this.associations.get(s);u!=null&&this.associations.set(c,u);for(const[d,p]of s.children.entries())r(p,c.children[d])};return r(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const r=e(t[i]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":i=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(r,s){return n.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[bt.KHR_BINARY_GLTF].body);let i=this.json.additionalFiles,r=i?i.find(c=>c.name===t.uri):null;const s=this.options;return new Promise(function(c,u){n.load(js.resolveURL(t.uri,s.path),c,void 0,function(){u(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))},r)})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const s=T0[i.type],c=yl[i.componentType],u=i.normalized===!0,d=new c(i.count*s);return Promise.resolve(new $e(d,s,u))}const r=[];return i.bufferView!==void 0?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),i.sparse!==void 0&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then(function(s){const c=s[0],u=T0[i.type],d=yl[i.componentType],p=d.BYTES_PER_ELEMENT,f=p*u,g=i.byteOffset||0,v=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,b=i.normalized===!0;let y,S;if(v&&v!==f){const M=Math.floor(g/v),w="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+M+":"+i.count;let T=t.cache.get(w);T||(y=new d(c,M*v,i.count*v/p),T=new Qo(y,v/p),t.cache.add(w,T)),S=new ri(T,u,g%v/p,b)}else y=c===null?new d(i.count*u):new d(c,g,i.count*u),S=new $e(y,u,b);if(i.sparse!==void 0){const M=T0.SCALAR,w=yl[i.sparse.indices.componentType],T=i.sparse.indices.byteOffset||0,R=i.sparse.values.byteOffset||0,L=new w(s[1],T,i.sparse.count*M),P=new d(s[2],R,i.sparse.count*u);c!==null&&(S=new $e(S.array.slice(),S.itemSize,S.normalized));for(let I=0,V=L.length;I<V;I++){const z=L[I];if(S.setX(z,P[I*u]),u>=2&&S.setY(z,P[I*u+1]),u>=3&&S.setZ(z,P[I*u+2]),u>=4&&S.setW(z,P[I*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return S})}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e].source,r=t.images[i];let s=this.textureLoader;if(r.uri){const c=n.manager.getHandler(r.uri);c!==null&&(s=c)}return this.loadTextureImage(e,i,s)}loadTextureImage(e,t,n){const i=this,r=this.json,s=r.textures[e],c=r.images[t],u=(c.uri||c.bufferView)+":"+s.sampler;if(this.textureCache[u])return this.textureCache[u];const d=this.loadImageSource(t,n).then(function(p){p.flipY=!1,p.name=s.name||c.name||"";const f=(r.samplers||{})[s.sampler]||{};return p.magFilter=ES[f.magFilter]||rt,p.minFilter=ES[f.minFilter]||ir,p.wrapS=AS[f.wrapS]||hi,p.wrapT=AS[f.wrapT]||hi,i.associations.set(p,{textures:e}),p}).catch(function(){return null});return this.textureCache[u]=d,d}loadImageSource(e,t){const n=this,i=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const s=i.images[e],c=self.URL||self.webkitURL;let u=s.uri||"",d=!1;if(s.bufferView!==void 0)u=n.getDependency("bufferView",s.bufferView).then(function(f){d=!0;const g=new Blob([f],{type:s.mimeType});return u=c.createObjectURL(g),u});else{if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");if(i.additionalFiles){let f=u.split("\\").pop().split("/").pop(),g=i.additionalFiles.find(v=>f===v.name);g&&(u=ab(g))}}const p=Promise.resolve(u).then(function(f){return new Promise(function(g,v){let b=g;t.isImageBitmapLoader===!0&&(b=function(y){const S=new Ut(y);S.needsUpdate=!0,g(S)}),t.load(js.resolveURL(f,r.path),b,void 0,v)})}).then(function(f){var g;return d===!0&&c.revokeObjectURL(u),f.userData.mimeType=s.mimeType||((g=s.uri).search(/\.jpe?g($|\?)/i)>0||g.search(/^data\:image\/jpeg/)===0?"image/jpeg":g.search(/\.webp($|\?)/i)>0||g.search(/^data\:image\/webp/)===0?"image/webp":"image/png"),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",u),f});return this.sourceCache[e]=p,p}assignTexture(e,t,n,i){const r=this;return this.getDependency("texture",n.index).then(function(s){if(!s)return null;if(n.texCoord===void 0||n.texCoord==0||t==="aoMap"&&n.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[bt.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[bt.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const u=r.associations.get(s);s=r.extensions[bt.KHR_TEXTURE_TRANSFORM].extendTexture(s,c),r.associations.set(s,u)}}return i!==void 0&&(s.encoding=i),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let u=this.cache.get(c);u||(u=new Kh,on.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(c,u)),n=u}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let u=this.cache.get(c);u||(u=new In,on.prototype.copy.call(u,n),u.color.copy(n.color),this.cache.add(c,u)),n=u}if(i||r||s){let c="ClonedMaterial:"+n.uuid+":";i&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),s&&(c+="flat-shading:");let u=this.cache.get(c);u||(u=n.clone(),r&&(u.vertexColors=!0),s&&(u.flatShading=!0),i&&(u.normalScale&&(u.normalScale.y*=-1),u.clearcoatNormalScale&&(u.clearcoatNormalScale.y*=-1)),this.cache.add(c,u),this.associations.set(u,this.associations.get(n))),n=u}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return zt}loadMaterial(e){const t=this,n=this.json,i=this.extensions,r=n.materials[e];let s;const c={},u=[];if((r.extensions||{})[bt.KHR_MATERIALS_UNLIT]){const p=i[bt.KHR_MATERIALS_UNLIT];s=p.getMaterialType(),u.push(p.extendParams(c,r,t))}else{const p=r.pbrMetallicRoughness||{};if(c.color=new Pe(1,1,1),c.opacity=1,Array.isArray(p.baseColorFactor)){const f=p.baseColorFactor;c.color.fromArray(f),c.opacity=f[3]}p.baseColorTexture!==void 0&&u.push(t.assignTexture(c,"map",p.baseColorTexture,ht)),c.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,c.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(c,"metalnessMap",p.metallicRoughnessTexture)),u.push(t.assignTexture(c,"roughnessMap",p.metallicRoughnessTexture))),s=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=_e);const d=r.alphaMode||bP;if(d===_P?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,d===SP&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&s!==pi&&(u.push(t.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new ce(1,1),r.normalTexture.scale!==void 0)){const p=r.normalTexture.scale;c.normalScale.set(p,p)}return r.occlusionTexture!==void 0&&s!==pi&&(u.push(t.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&s!==pi&&(c.emissive=new Pe().fromArray(r.emissiveFactor)),r.emissiveTexture!==void 0&&s!==pi&&u.push(t.assignTexture(c,"emissiveMap",r.emissiveTexture,ht)),Promise.all(u).then(function(){const p=new s(c);return r.name&&(p.name=r.name),Ga(p,r),t.associations.set(p,{materials:e}),r.extensions&&Vc(i,p,r),p})}createUniqueName(e){const t=dt.sanitizeNodeName(e||"");let n=t;for(let i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function r(c){return n[bt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(u){return LS(u,c,t)})}const s=[];for(let c=0,u=e.length;c<u;c++){const d=e[c],p=MP(d),f=i[p];if(f)s.push(f.promise);else{let g;g=d.extensions&&d.extensions[bt.KHR_DRACO_MESH_COMPRESSION]?r(d):LS(new Ke,d,t),i[p]={primitive:d,promise:g},s.push(g)}}return Promise.all(s)}loadMesh(e){const t=this,n=this.json,i=this.extensions,r=n.meshes[e],s=r.primitives,c=[];for(let d=0,p=s.length;d<p;d++){const f=s[d].material===void 0?((u=this.cache).DefaultMaterial===void 0&&(u.DefaultMaterial=new zt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:oe})),u.DefaultMaterial):this.getDependency("material",s[d].material);c.push(f)}var u;return c.push(t.loadGeometries(s)),Promise.all(c).then(function(d){const p=d.slice(0,d.length-1),f=d[d.length-1],g=[];for(let b=0,y=f.length;b<y;b++){const S=f[b],M=s[b];let w;const T=p[b];if(M.mode===Wi.TRIANGLES||M.mode===Wi.TRIANGLE_STRIP||M.mode===Wi.TRIANGLE_FAN||M.mode===void 0)w=r.isSkinnedMesh===!0?new qh(S,T):new Je(S,T),w.isSkinnedMesh===!0&&w.normalizeSkinWeights(),M.mode===Wi.TRIANGLE_STRIP?w.geometry=g0(w.geometry,Qf):M.mode===Wi.TRIANGLE_FAN&&(w.geometry=g0(w.geometry,dh));else if(M.mode===Wi.LINES)w=new ur(S,T);else if(M.mode===Wi.LINE_STRIP)w=new Lr(S,T);else if(M.mode===Wi.LINE_LOOP)w=new Im(S,T);else{if(M.mode!==Wi.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);w=new km(S,T)}Object.keys(w.geometry.morphAttributes).length>0&&wP(w,r),w.name=t.createUniqueName(r.name||"mesh_"+e),Ga(w,r),M.extensions&&Vc(i,w,M),t.assignFinalMaterial(w),g.push(w)}for(let b=0,y=g.length;b<y;b++)t.associations.set(g[b],{meshes:e,primitives:b});if(g.length===1)return g[0];const v=new Vn;t.associations.set(v,{meshes:e});for(let b=0,y=g.length;b<y;b++)v.add(g[b]);return v})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return n.type==="perspective"?t=new Qt(hn.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new Oa(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Ga(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,r=t.joints.length;i<r;i++)n.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(i){const r=i.pop(),s=i,c=[],u=[];for(let d=0,p=s.length;d<p;d++){const f=s[d];if(f){c.push(f);const g=new De;r!==null&&g.fromArray(r.array,16*d),u.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new tl(c,u)})}loadAnimation(e){const t=this.json.animations[e],n=[],i=[],r=[],s=[],c=[];for(let u=0,d=t.channels.length;u<d;u++){const p=t.channels[u],f=t.samplers[p.sampler],g=p.target,v=g.node,b=t.parameters!==void 0?t.parameters[f.input]:f.input,y=t.parameters!==void 0?t.parameters[f.output]:f.output;n.push(this.getDependency("node",v)),i.push(this.getDependency("accessor",b)),r.push(this.getDependency("accessor",y)),s.push(f),c.push(g)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(r),Promise.all(s),Promise.all(c)]).then(function(u){const d=u[0],p=u[1],f=u[2],g=u[3],v=u[4],b=[];for(let S=0,M=d.length;S<M;S++){const w=d[S],T=p[S],R=f[S],L=g[S],P=v[S];if(w===void 0)continue;let I;switch(w.updateMatrix(),xl[P.path]){case xl.weights:I=Us;break;case xl.rotation:I=aa;break;default:I=Bs}const V=w.name?w.name:w.uuid,z=L.interpolation!==void 0?xP[L.interpolation]:ws,G=[];xl[P.path]===xl.weights?w.traverse(function($){$.morphTargetInfluences&&G.push($.name?$.name:$.uuid)}):G.push(V);let F=R.array;if(R.normalized){const $=A0(F.constructor),le=new Float32Array(F.length);for(let ae=0,ye=F.length;ae<ye;ae++)le[ae]=F[ae]*$;F=le}for(let $=0,le=G.length;$<le;$++){const ae=new I(G[$]+"."+xl[P.path],T.array,F,z);L.interpolation==="CUBICSPLINE"&&(ae.createInterpolant=function(ye){return new(this instanceof aa?yP:TS)(this.times,this.values,this.getValueSize()/3,ye)},ae.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),b.push(ae)}}const y=t.name?t.name:"animation_"+e;return new Hs(y,void 0,b)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(r){const s=n._getNodeRef(n.meshCache,i.mesh,r);return i.weights!==void 0&&s.traverse(function(c){if(c.isMesh)for(let u=0,d=i.weights.length;u<d;u++)c.morphTargetInfluences[u]=i.weights[u]}),s})}loadNode(e){const t=this,n=this.json.nodes[e],i=t._loadNodeShallow(e),r=[],s=n.children||[];for(let u=0,d=s.length;u<d;u++)r.push(t.getDependency("node",s[u]));const c=n.skin===void 0?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([i,Promise.all(r),c]).then(function(u){const d=u[0],p=u[1],f=u[2];f!==null&&d.traverse(function(g){g.isSkinnedMesh&&g.bind(f,TP)});for(let g=0,v=p.length;g<v;g++)d.add(p[g]);return d})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],s=r.name?i.createUniqueName(r.name):"",c=[],u=i._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return u&&c.push(u),r.camera!==void 0&&c.push(i.getDependency("camera",r.camera).then(function(d){return i._getNodeRef(i.cameraCache,r.camera,d)})),i._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){c.push(d)}),this.nodeCache[e]=Promise.all(c).then(function(d){let p;if(p=r.isBone===!0?new el:d.length>1?new Vn:d.length===1?d[0]:new ot,p!==d[0])for(let f=0,g=d.length;f<g;f++)p.add(d[f]);if(r.name&&(p.userData.name=r.name,p.name=s),Ga(p,r),r.extensions&&Vc(n,p,r),r.matrix!==void 0){const f=new De;f.fromArray(r.matrix),p.applyMatrix4(f)}else r.translation!==void 0&&p.position.fromArray(r.translation),r.rotation!==void 0&&p.quaternion.fromArray(r.rotation),r.scale!==void 0&&p.scale.fromArray(r.scale);return i.associations.has(p)||i.associations.set(p,{}),i.associations.get(p).nodes=e,p}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,r=new Vn;n.name&&(r.name=i.createUniqueName(n.name)),Ga(r,n),n.extensions&&Vc(t,r,n);const s=n.nodes||[],c=[];for(let u=0,d=s.length;u<d;u++)c.push(i.getDependency("node",s[u]));return Promise.all(c).then(function(u){for(let d=0,p=u.length;d<p;d++)r.add(u[d]);return i.associations=(d=>{const p=new Map;for(const[f,g]of i.associations)(f instanceof on||f instanceof Ut)&&p.set(f,g);return d.traverse(f=>{const g=i.associations.get(f);g!=null&&p.set(f,g)}),p})(r),r})}}function LS(o,e,t){const n=e.attributes,i=[];function r(s,c){return t.getDependency("accessor",s).then(function(u){o.setAttribute(c,u)})}for(const s in n){const c=E0[s]||s.toLowerCase();c in o.attributes||i.push(r(n[s],c))}if(e.indices!==void 0&&!o.index){const s=t.getDependency("accessor",e.indices).then(function(c){o.setIndex(c)});i.push(s)}return Ga(o,e),function(s,c,u){const d=c.attributes,p=new Ar;if(d.POSITION===void 0)return;{const v=u.json.accessors[d.POSITION],b=v.min,y=v.max;if(b===void 0||y===void 0)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(p.set(new C(b[0],b[1],b[2]),new C(y[0],y[1],y[2])),v.normalized){const S=A0(yl[v.componentType]);p.min.multiplyScalar(S),p.max.multiplyScalar(S)}}const f=c.targets;if(f!==void 0){const v=new C,b=new C;for(let y=0,S=f.length;y<S;y++){const M=f[y];if(M.POSITION!==void 0){const w=u.json.accessors[M.POSITION],T=w.min,R=w.max;if(T!==void 0&&R!==void 0){if(b.setX(Math.max(Math.abs(T[0]),Math.abs(R[0]))),b.setY(Math.max(Math.abs(T[1]),Math.abs(R[1]))),b.setZ(Math.max(Math.abs(T[2]),Math.abs(R[2]))),w.normalized){const L=A0(yl[w.componentType]);b.multiplyScalar(L)}v.max(b)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}p.expandByVector(v)}s.boundingBox=p;const g=new Qr;p.getCenter(g.center),g.radius=p.min.distanceTo(p.max)/2,s.boundingSphere=g}(o,e,t),Promise.all(i).then(function(){return e.targets!==void 0?function(s,c,u){let d=!1,p=!1,f=!1;for(let y=0,S=c.length;y<S;y++){const M=c[y];if(M.POSITION!==void 0&&(d=!0),M.NORMAL!==void 0&&(p=!0),M.COLOR_0!==void 0&&(f=!0),d&&p&&f)break}if(!d&&!p&&!f)return Promise.resolve(s);const g=[],v=[],b=[];for(let y=0,S=c.length;y<S;y++){const M=c[y];if(d){const w=M.POSITION!==void 0?u.getDependency("accessor",M.POSITION):s.attributes.position;g.push(w)}if(p){const w=M.NORMAL!==void 0?u.getDependency("accessor",M.NORMAL):s.attributes.normal;v.push(w)}if(f){const w=M.COLOR_0!==void 0?u.getDependency("accessor",M.COLOR_0):s.attributes.color;b.push(w)}}return Promise.all([Promise.all(g),Promise.all(v),Promise.all(b)]).then(function(y){const S=y[0],M=y[1],w=y[2];return d&&(s.morphAttributes.position=S),p&&(s.morphAttributes.normal=M),f&&(s.morphAttributes.color=w),s.morphTargetsRelative=!0,s})}(o,e.targets,t):o})}var bl,AP=function(){var o=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var t,n=WebAssembly.validate(o)?"b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;t9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;h8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgohAaoclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;uzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:EPliuo97eue978Jjjjjbca9Rhidndnadcl9hmbdnaec98GglTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaiaeciGgvcdtgdVcbczad9R;8kbaiabalcdtfglad;8qbbdnavTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkalaiad;8qbbskdnaec98GgxTmbcbhvabhdinadczfglalpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgvax6mbkkaxae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabaxcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbhdabheinaeaepbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbaeczfheadclfgdav6mbkkdnaval9pmbaialciGgdcdtgeVcbc;abae9R;8kbaiabavcdtfgvae;8qbbdnadTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiae;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb":"b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:P8Yqdbk;3sezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfgocl4cifcd4hxdndndndnaoc9WGgmTmbcbhPcehsawcjdfhzalhHinaraH9Rax6midnaraHaxfgl9RcK6mbczhoinawcj;cbfaogifgoc9WfhOdndndndndnaHaic9WfgAco4fRbbaAci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOalRblalRbbgAco4gCaCciSgCE86bbaocGfalclfaCfgORbbaAcl4ciGgCaCciSgCE86bbaocVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbaoc7faOaCfgORbbaAciGgAaAciSgAE86bbaoctfaOaAfgARbbalRbegOco4gCaCciSgCE86bbaoc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc93faAaCfgARbbaOciGgOaOciSgOE86bbaoc94faAaOfgARbbalRbdgOco4gCaCciSgCE86bbaoc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc97faAaCfgARbbaOciGgOaOciSgOE86bbaoc98faAaOfgORbbalRbiglco4gAaAciSgAE86bbaoc99faOaAfgORbbalcl4ciGgAaAciSgAE86bbaoc9:faOaAfgORbbalcd4ciGgAaAciSgAE86bbaocufaOaAfgoRbbalciGglalciSglE86bbaoalfhlxdkaOalRbwalRbbgAcl4gCaCcsSgCE86bbaocGfalcwfaCfgORbbaAcsGgAaAcsSgAE86bbaocVfaOaAfgORbbalRbegAcl4gCaCcsSgCE86bbaoc7faOaCfgORbbaAcsGgAaAcsSgAE86bbaoctfaOaAfgORbbalRbdgAcl4gCaCcsSgCE86bbaoc91faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc4faOaAfgORbbalRbigAcl4gCaCcsSgCE86bbaoc93faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc94faOaAfgORbbalRblgAcl4gCaCcsSgCE86bbaoc95faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc96faOaAfgORbbalRbvgAcl4gCaCcsSgCE86bbaoc97faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc98faOaAfgORbbalRbogAcl4gCaCcsSgCE86bbaoc99faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc9:faOaAfgORbbalRbrglcl4gAaAcsSgAE86bbaocufaOaAfgoRbbalcsGglalcsSglE86bbaoalfhlxekaOal8Pbb83bbaOcwfalcwf8Pbb83bbalczfhlkdnaiam9pmbaiczfhoaral9RcL0mekkaiam6mialTmidnakTmbawaPfRbbhOcbhoazhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkkazcefhzaPcefgPad6hsalhHaPad9hmexvkkcbhlasceGmdxikalaxad2fhCdnakTmbcbhHcehsawcjdfhminaral9Rax6mialTmdalaxfhlawaHfRbbhOcbhoamhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkamcefhmaHcefgHad6hsaHad9hmbkaChlxikcbhocehsinaral9Rax6mdalTmealaxfhlaocefgoad6hsadao9hmbkaChlxdkcbhlasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqalmbkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;yzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2geTmbinababydbgdcwtcw91:Yadce91cjjj;8ifcjjj98G::NUdbabclfhbaecufgembkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaiczfhiaeczfheadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",i=WebAssembly.instantiate(r(n),{}).then(function(b){(t=b.instance).exports.__wasm_call_ctors()});function r(b){for(var y=new Uint8Array(b.length),S=0;S<b.length;++S){var M=b.charCodeAt(S);y[S]=M>96?M-97:M>64?M-39:M+4}var w=0;for(S=0;S<b.length;++S)y[w++]=y[S]<60?e[y[S]]:64*(y[S]-60)+y[++S];return y.buffer.slice(0,w)}function s(b,y,S,M,w,T){var R=t.exports.sbrk,L=S+3&-4,P=R(L*M),I=R(w.length),V=new Uint8Array(t.exports.memory.buffer);V.set(w,I);var z=b(P,S,M,I,w.length);if(z==0&&T&&T(P,L,M),y.set(V.subarray(P,P+S*M)),R(P-R(0)),z!=0)throw new Error("Malformed buffer data: "+z)}var c={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},u={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},d=[],p=0;function f(b){var y={object:new Worker(b),pending:0,requests:{}};return y.object.onmessage=function(S){var M=S.data;y.pending-=M.count,y.requests[M.id][M.action](M.value),delete y.requests[M.id]},y}function g(b){for(var y="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(r(n))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+s.toString()+v.toString(),S=new Blob([y],{type:"text/javascript"}),M=URL.createObjectURL(S),w=0;w<b;++w)d[w]=f(M);URL.revokeObjectURL(M)}function v(b){i.then(function(){var y=b.data;try{var S=new Uint8Array(y.count*y.size);s(t.exports[y.mode],S,y.count,y.size,y.source,t.exports[y.filter]),self.postMessage({id:y.id,count:y.count,action:"resolve",value:S},[S.buffer])}catch(M){self.postMessage({id:y.id,count:y.count,action:"reject",value:M})}})}return{ready:i,supported:!0,useWorkers:function(b){g(b)},decodeVertexBuffer:function(b,y,S,M,w){s(t.exports.meshopt_decodeVertexBuffer,b,y,S,M,t.exports[c[w]])},decodeIndexBuffer:function(b,y,S,M){s(t.exports.meshopt_decodeIndexBuffer,b,y,S,M)},decodeIndexSequence:function(b,y,S,M){s(t.exports.meshopt_decodeIndexSequence,b,y,S,M)},decodeGltfBuffer:function(b,y,S,M,w,T){s(t.exports[u[w]],b,y,S,M,t.exports[c[T]])},decodeGltfBufferAsync:function(b,y,S,M,w){return d.length>0?function(T,R,L,P,I){for(var V=d[0],z=1;z<d.length;++z)d[z].pending<V.pending&&(V=d[z]);return new Promise(function(G,F){var $=new Uint8Array(L),le=p++;V.pending+=T,V.requests[le]={resolve:G,reject:F},V.object.postMessage({id:le,count:T,size:R,source:$,mode:P,filter:I},[$.buffer])})}(b,y,S,u[M],c[w]):i.then(function(){var T=new Uint8Array(b*y);return s(t.exports[u[M]],T,b,y,S,t.exports[c[w]]),T})}}}();class RP extends sb{constructor(e){super(e),this.type=di}parse(e){const t=function(u,d){switch(u){case 1:console.error("THREE.RGBELoader Read Error: "+(d||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(d||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(d||""));break;default:console.error("THREE.RGBELoader: Error: "+(d||""))}return-1},n=function(u,d,p){d=d||1024;let f=u.pos,g=-1,v=0,b="",y=String.fromCharCode.apply(null,new Uint16Array(u.subarray(f,f+128)));for(;0>(g=y.indexOf(`
`))&&v<d&&f<u.byteLength;)b+=y,v+=y.length,f+=128,y+=String.fromCharCode.apply(null,new Uint16Array(u.subarray(f,f+128)));return-1<g&&(p!==!1&&(u.pos+=v+g+1),b+y.slice(0,g))},i=function(u,d,p,f){const g=u[d+3],v=Math.pow(2,g-128)/255;p[f+0]=u[d+0]*v,p[f+1]=u[d+1]*v,p[f+2]=u[d+2]*v,p[f+3]=1},r=function(u,d,p,f){const g=u[d+3],v=Math.pow(2,g-128)/255;p[f+0]=Hc.toHalfFloat(Math.min(u[d+0]*v,65504)),p[f+1]=Hc.toHalfFloat(Math.min(u[d+1]*v,65504)),p[f+2]=Hc.toHalfFloat(Math.min(u[d+2]*v,65504)),p[f+3]=Hc.toHalfFloat(1)},s=new Uint8Array(e);s.pos=0;const c=function(u){const d=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,p=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,f=/^\s*FORMAT=(\S+)\s*$/,g=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,v={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let b,y;if(u.pos>=u.byteLength||!(b=n(u)))return t(1,"no header found");if(!(y=b.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(v.valid|=1,v.programtype=y[1],v.string+=b+`
`;b=n(u),b!==!1;)if(v.string+=b+`
`,b.charAt(0)!=="#"){if((y=b.match(d))&&(v.gamma=parseFloat(y[1])),(y=b.match(p))&&(v.exposure=parseFloat(y[1])),(y=b.match(f))&&(v.valid|=2,v.format=y[1]),(y=b.match(g))&&(v.valid|=4,v.height=parseInt(y[1],10),v.width=parseInt(y[2],10)),2&v.valid&&4&v.valid)break}else v.comments+=b+`
`;return 2&v.valid?4&v.valid?v:t(3,"missing image size specifier"):t(3,"missing format specifier")}(s);if(c!==-1){const u=c.width,d=c.height,p=function(f,g,v){const b=g;if(b<8||b>32767||f[0]!==2||f[1]!==2||128&f[2])return new Uint8Array(f);if(b!==(f[2]<<8|f[3]))return t(3,"wrong scanline width");const y=new Uint8Array(4*g*v);if(!y.length)return t(4,"unable to allocate buffer space");let S=0,M=0;const w=4*b,T=new Uint8Array(4),R=new Uint8Array(w);let L=v;for(;L>0&&M<f.byteLength;){if(M+4>f.byteLength)return t(1);if(T[0]=f[M++],T[1]=f[M++],T[2]=f[M++],T[3]=f[M++],T[0]!=2||T[1]!=2||(T[2]<<8|T[3])!=b)return t(3,"bad rgbe scanline format");let P,I=0;for(;I<w&&M<f.byteLength;){P=f[M++];const z=P>128;if(z&&(P-=128),P===0||I+P>w)return t(3,"bad scanline data");if(z){const G=f[M++];for(let F=0;F<P;F++)R[I++]=G}else R.set(f.subarray(M,M+P),I),I+=P,M+=P}const V=b;for(let z=0;z<V;z++){let G=0;y[S]=R[z+G],G+=b,y[S+1]=R[z+G],G+=b,y[S+2]=R[z+G],G+=b,y[S+3]=R[z+G],S+=4}L--}return y}(s.subarray(s.pos),u,d);if(p!==-1){let f,g,v;switch(this.type){case Ti:v=p.length/4;const b=new Float32Array(4*v);for(let S=0;S<v;S++)i(p,4*S,b,4*S);f=b,g=Ti;break;case di:v=p.length/4;const y=new Uint16Array(4*v);for(let S=0;S<v;S++)r(p,4*S,y,4*S);f=y,g=di;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:u,height:d,data:f,header:c.string,gamma:c.gamma,exposure:c.exposure,type:g}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,i,r){return super.load(e,function(s,c){switch(s.type){case Ti:case di:s.encoding=rr,s.minFilter=rt,s.magFilter=rt,s.generateMipmaps=!1,s.flipY=!0}t&&t(s,c)},n,i,r)}}class Xn{static Clear(){this.caches.clear()}static RegistLoader(e){let t=new e;for(let n of t.extensions)this.loaders.set(n,t)}static Load(e){return new Promise((t,n)=>{let{url:i,file:r,ext:s}=function(d){let p="",f=null,g="";return typeof File<"u"&&d instanceof File?(p=d.name,g=Ed(p),f=d):typeof d=="object"?(p=d.mainFile.name,g=Ed(p),f=d):(p+=d,g=Ed(p)),{url:p,file:f,ext:g}}(e.url),c=function(d,p){let f=[d];for(let g in p)f.push(g+"="+p[g]);return f.join(",")}(i,e.settings),u=this.caches.get(c);if(u)t(u);else{const d=p=>{this.caches.set(c,p),t(p)};this.loaders.has(s)?this.loaders.get(s).load({...e,url:i,file:r,onLoad:d,onError:n}):n("missing loader for"+s)}})}}N(Xn,"loaders",new Map),N(Xn,"caches",new Map),Xn.RegistLoader(class extends Ha{constructor(){super(...arguments);N(this,"extensions",["atlas"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:r,settings:s}){(async()=>{let c=await function({url:d,file:p,onProgress:f}){return new Promise((g,v)=>new sS().load({url:d,file:p,onLoad:g,onError:v,onProgress:f}))}({url:e,file:t}).catch(r),u=await function({url:d,file:p,onProgress:f,settings:g}){return new Promise((v,b)=>new oS().load({url:d,file:p,onLoad:v,onError:b,onProgress:f,settings:g}))}({url:`${iS(e)}/${c.meta.image}`,file:t,onProgress:i,settings:s}).catch(r);n(new aS(c,u))})()}}),Xn.RegistLoader(class extends Ha{constructor(){super(...arguments);N(this,"extensions",["fbx"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:r}){new UL().load(e,n,i,r,t)}}),Xn.RegistLoader(class extends Ha{constructor(){super(...arguments);N(this,"extensions",["gltf","glb"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:r}){let s=new XL;s.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.5/");let c=new YL;c.setMeshoptDecoder(AP),c.setDRACOLoader(s),c.load(e,u=>n(Object.assign(u.scene,{animations:u.animations})),i,r,t)}}),Xn.RegistLoader(class extends Ha{constructor(){super(...arguments);N(this,"extensions",["hdr"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:r,settings:s}){new RP().load(e,c=>n(Object.assign(c,s)),i,r,t)}}),Xn.RegistLoader(sS),Xn.RegistLoader(oS),Xn.RegistLoader(class extends Ha{constructor(){super(...arguments);N(this,"extensions",["mp3","wav","ogg"])}load({url:e,file:t,onLoad:n,onProgress:i,onError:r}){new vb().load(e,n,i,r,t)}}),function(o){o[o.Destroyed=1]="Destroyed",o[o.OnLoadCalled=2]="OnLoadCalled",o[o.OnEnableCalled=4]="OnEnableCalled",o[o.StartCalled=8]="StartCalled",o[o.Deactivating=16]="Deactivating"}(bl||(bl={}));let LP=100;class Or extends k{constructor(t){super();N(this,"uuid",""+LP++);N(this,"name","");N(this,"_objFlags",0);this.name=t||this.name}__setFlag(t){this._objFlags|=t}__clearFlag(t){this._objFlags&=~t}__getFlag(t){return!!(this._objFlags&t)}get isValid(){return!(this._objFlags&bl.Destroyed)}destroy(){return!this.__getFlag(bl.Destroyed)&&(this.destroyImmediate(),!0)}destroyImmediate(){this._onPreDestroy&&this._onPreDestroy(),this.__setFlag(bl.Destroyed)}}N(Or,"Flags",bl);class wt extends Or{constructor(){super(...arguments);N(this,"viewer");N(this,"node");N(this,"isComponent",!0);N(this,"_enabled",!0)}get enabled(){return this._enabled}set enabled(t){var n;this._enabled!==t&&(this._enabled=t,(n=this.viewer)==null||n.componentScheduler.enableComponent(this,t))}_onPreDestroy(){var t,n;this.unscheduleAll(),(t=this.viewer)==null||t.removeComponent(this.node,this),this._enabled&&((n=this.viewer)==null||n.componentScheduler.enableComponent(this,!1)),this.onDestroy&&this.__getFlag(Or.Flags.OnLoadCalled)&&this.onDestroy()}schedule(t,n,i=-1){var r;(r=this.viewer)==null||r.scheduler.schedule(this,t,n,i)}unshedule(t){var n;(n=this.viewer)==null||n.scheduler.unshedule(this,t)}unscheduleAll(){var t;(t=this.viewer)==null||t.scheduler.unscheduleAll(this)}}class qn extends wt{constructor(){super(...arguments);N(this,"isPlugin",!0)}}class Rd extends qn{update(e){this.viewer.render(e)}}class R0{constructor(e){N(this,"_targets",[]);N(this,"_callback");this._callback=e}add(e){this._targets.push(e)}remove(e){let t=this._targets.indexOf(e);t!==-1&&this._targets.splice(t,1)}invoke(e){let t=this._callback;for(let n of this._targets)t(n,e)}}class PP extends R0{invoke(e){if(this._targets.length>0){let t=this._callback;for(let n of this._targets)t(n,e);this._targets.length=0}}}class CP{constructor(){N(this,"startInvoker",new PP(e=>e.start()));N(this,"updateInvoker",new R0((e,t)=>e.update(t)));N(this,"lastUpdateInvoker",new R0((e,t)=>e.lastUpdate(t)))}start(){this.startInvoker.invoke(0)}update(e){this.updateInvoker.invoke(e)}lastUpdate(e){this.lastUpdateInvoker.invoke(e)}enableComponent(e,t){t?e.__getFlag(Or.Flags.OnEnableCalled)===!1&&(e.__setFlag(Or.Flags.OnEnableCalled),e.onEnable&&e.onEnable(),e.start&&this.startInvoker.add(e),e.update&&this.updateInvoker.add(e),e.lastUpdate&&this.lastUpdateInvoker.add(e)):e.__getFlag(Or.Flags.OnEnableCalled)&&(e.__clearFlag(Or.Flags.OnEnableCalled),e.onDisable&&e.onDisable(),e.start&&this.startInvoker.remove(e),e.update&&this.updateInvoker.remove(e),e.lastUpdate&&this.lastUpdateInvoker.remove(e))}}class DP extends Or{constructor(){super(...arguments);N(this,"_scheduler",new ge);N(this,"_componentScheduler",new CP)}get scheduler(){return this._scheduler}get componentScheduler(){return this._componentScheduler}update(t){this._scheduler.update(t),this._componentScheduler.start(),this._componentScheduler.update(t),this._componentScheduler.lastUpdate(t)}destroyNode(t){t.removeFromParent(),this.destroyComponents(t)}activeNode(t,n){t.visible=n,this.activeComponents(t)}destroyComponents(t){let n=this._getComponents(t);for(let i of n)i.destroy();t._components=[];for(let i of t.children)this.destroyComponents(i)}activeComponents(t){let n=t.visible;for(let i of this._getComponents(t))this._activeComponent(i,n);for(let i of t.children)this.activeComponents(i)}addComponent(t,n,i){let r=t instanceof wt?t.node:t,s=typeof n=="function",c=this._findComponent(r,s?n:n.constructor);if(c===void 0){c=s?new n:n,c.node=r,c.viewer=this;let u=c._dependencies;if(u)for(let d of u)this.getComponent(r,d)==null&&this.addComponent(r,d);c.__getFlag(Or.Flags.OnLoadCalled)===!1&&(c.__setFlag(Or.Flags.OnLoadCalled),c.onLoad&&c.onLoad(i||{})),this._getComponents(r).push(c),this._activeComponent(c,!0),this.emit("component-changed",{action:"add",target:c})}return c}removeComponent(t,n){let i=this._getComponents(t),r=i.indexOf(n);return r!=-1&&(i.splice(r,1),this.emit("omponent-changed",{action:"remove",target:n})),this}getComponent(t,n){return this._findComponent(t,n)}getComponentsInChidren(t,n,i=[]){let r=this._getComponents(t);for(let s=r.length;s--;)r[s]instanceof n&&i.push(r[s]);for(let s of t.children)this.getComponentsInChidren(s,n,i);return i}_getComponents(t){let n=t._components;return n==null&&(n=t._components=[]),n}_findComponent(t,n){let i=this._getComponents(t);for(let r=i.length;r--;){let s=i[r];if(s instanceof n)return s}}_activeComponent(t,n){this._componentScheduler.enableComponent(t,n)}}var mi=Xt(622),OP=Xt(631);const{Tween:IP,getAll:NP,remove:kP,update:FP}=Xt(622),{TweenChain:UP}=Xt(631);class PS{static Tween(e){return new IP(e)}static Timeline(e){return new UP(e)}static KillTweensOf(e){let t=NP();for(let n of t)n._object===e&&kP(n)}static TweenUpdate(e){FP(e)}}class CS extends qn{update(e){PS.TweenUpdate()}}const Zt=class Zt{constructor(e){N(this,"viewer");N(this,"_listeners",[]);N(this,"_mouseWheel",0);N(this,"_touches",[]);N(this,"_touchCount",0);N(this,"_pointerButton",-1);N(this,"_pointerPosition",new ce);N(this,"_pointer",new ce);N(this,"_keys",{});this.viewer=e}get pointerButton(){return this._pointerButton}get pointer(){return this._pointer}get pointerPosition(){return this._pointerPosition}get mouseWheel(){return this._mouseWheel}get touchCount(){return this._touchCount}get touches(){return this._touches}get keys(){return this._keys}addEventListeners(){const e=this.viewer.renderer.domElement;e.style.touchAction="none",this._addEventListener(window,"resize",()=>this._onResize()),this._addEventListener(e,"contextmenu",t=>t.preventDefault()),this._addEventListener(e,"pointerdown",t=>this._onPointerDown(t),{passive:!1}),this._addEventListener(e,"pointerup",t=>this._onPointerUp(t),{passive:!1}),this._addEventListener(e,"pointermove",t=>{this._onPointerMove(t)},{passive:!0}),this._addEventListener(e,"mousewheel",t=>this._onMouseWheel(t),{passive:!1}),this._addEventListener(e,"touchstart",t=>this._onTouchStart(t),{passive:!0}),this._addEventListener(e,"touchend",t=>this._onTouchEnd(t),{passive:!0}),this._addEventListener(e,"touchmove",t=>this._onTouchMove(t),{passive:!0}),this._addEventListener(e,"keydown",t=>this._onKeyDown(t),{passive:!0}),this._addEventListener(e,"keypress",t=>this._onKeyPress(t),{passive:!0}),this._addEventListener(e,"keyup",t=>this._onKeyUp(t),{passive:!0}),this._onResize()}_onResize(){this.viewer.resize(window.innerWidth,window.innerHeight),this.viewer.emit(Zt.RESIZE,window.innerWidth,window.innerHeight)}_onPointerDown(e){e.preventDefault(),this._pointerButton=e.button,this.viewer.emit(Zt.POINTER_DOWN,e)}_onPointerUp(e){e.preventDefault(),this._pointerButton=-1,this.viewer.emit(Zt.POINTER_UP,e)}_onPointerMove(e){this._pointer.x=e.pageX/window.innerWidth*2-1,this._pointer.y=1-e.pageY/window.innerHeight*2,this._pointerPosition.set(e.pageX,e.pageY),this.viewer.emit(Zt.POINTER_MOVE,e)}_onMouseWheel(e){e.preventDefault(),this._mouseWheel=e.deltaY,this.viewer.emit(Zt.MOUSE_WHEEL,e)}_onTouchStart(e){this.viewer.emit(Zt.TOUCH_START,e)}_onTouchEnd(e){this.viewer.emit(Zt.TOUCH_END,e)}_onTouchMove(e){let t=e.touches,n=this._touches;for(let i=t.length;i--;){n[i]==null&&(n[i]={id:-1,position:new ce});const r=t[i];n[i].id=r.identifier,n[i].position.set(r.pageX,r.pageY)}this._touchCount=t.length,this.viewer.emit(Zt.TOUCH_MOVE,e)}_onKeyDown(e){this._keys[e.key]=!0,this.viewer.emit(Zt.KEYDOWN,e)}_onKeyPress(e){this._keys[e.key]=!0,this.viewer.emit(Zt.KEYPRESS,e)}_onKeyUp(e){this._keys[e.key]=!1,this.viewer.emit(Zt.KEYUP,e)}_addEventListener(e,t,n,i){e.addEventListener?e.addEventListener(t,n):e.on&&e.on(t,n,e),this._listeners.push({target:e,type:t,callback:n})}removeAllListeners(){for(let{target:e,type:t,callback:n}of this._listeners)e.removeEventListener?e.removeEventListener(t,n):e.off&&e.off(t,n,e);this._listeners=[]}};N(Zt,"MOUSE_WHEEL","mousewheel"),N(Zt,"TOUCH_START","touchstart"),N(Zt,"TOUCH_END","touchend"),N(Zt,"TOUCH_MOVE","touchmove"),N(Zt,"POINTER_DOWN","pointerdown"),N(Zt,"POINTER_UP","pointerup"),N(Zt,"POINTER_MOVE","pointermove"),N(Zt,"KEYDOWN","keydown"),N(Zt,"KEYPRESS","keypress"),N(Zt,"KEYUP","keyup"),N(Zt,"RESIZE","resize");let Rn=Zt;ct.matrix=`
mat4 getInstanceMatrix(vec3 p, vec4 q, vec3 s) {
    mat4 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    float sx = s.x;
    float sy = s.y;
    float sz = s.z;
    m[0][0] = (1. - (yy + zz)) * sx;
    m[0][1] = (xy + wz) * sx;
    m[0][2] = (xz - wy) * sx;
    m[0][3] = 0.;
    m[1][0] = (xy - wz) * sy;
    m[1][1] = (1. - (xx + zz)) * sy;
    m[1][2] = (yz + wx) * sy;
    m[1][3] = 0.;
    m[2][0] = (xz + wy) * sz;
    m[2][1] = (yz - wx) * sz;
    m[2][2] = (1. - (xx + yy)) * sz;
    m[2][3] = 0.;
    m[3][0] = p.x;
    m[3][1] = p.y;
    m[3][2] = p.z;
    m[3][3] = 1.;
    return m;
}
mat3 getInstanceRotationMatrix(vec4 q) {
    mat3 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    m[0][0] = (1. - (yy + zz));
    m[0][1] = (xy + wz);
    m[0][2] = (xz - wy);
    m[1][0] = (xy - wz);
    m[1][1] = (1. - (xx + zz));
    m[1][2] = (yz + wx);
    m[2][0] = (xz + wy);
    m[2][1] = (yz - wx);
    m[2][2] = (1. - (xx + yy));
    return m;
}
`;let zP=new C,BP=new C,HP=new ce;class jP extends DP{constructor({canvas:t,shadows:n=!1,linear:i=!0,outputEncoding:r=ht,toneMapping:s=_f,toneMappingExposure:c=1,camera:u={fov:45,near:1,far:1e3},user:d={},...p}){super();N(this,"_time",0);N(this,"_running",!1);N(this,"_renderer");N(this,"_scene");N(this,"_camera");N(this,"_viewport",{width:1,height:1,factor:1});N(this,"_states",[]);N(this,"_input",new Rn(this));N(this,"_user",null);N(this,"_environment",null);N(this,"_background",null);this._user=d,this._scene=new Ds,this._camera=_t(new Qt(u.fov,u.aspect||window.innerWidth/window.innerHeight,u.near,u.far),u),this._renderer=new Bh({canvas:t,...p}),this._renderer.setPixelRatio(this.dpr),this._renderer.outputEncoding=r,this._renderer.toneMapping=s,this._renderer.toneMappingExposure=c,this._renderer.shadowMap.enabled=!!n,this._renderer.shadowMap.type=typeof n=="boolean"?D:n,this._renderer.info.autoReset=!1,this._input.addEventListeners(),this._addDefaultPlugins(),this._printInfo(i),t||document.body.appendChild(this._renderer.domElement),this.start()}get environment(){return this._environment}get background(){return this._background}get input(){return this._input}get time(){return this._time}get renderer(){return this._renderer}get scene(){return this._scene}get camera(){return this._camera}get dpr(){return Math.min(2,window.devicePixelRatio)}get viewport(){return this._viewport}get size(){return this._renderer.getSize(HP)}get user(){return this._user}_printInfo(t){En.enabled=t;const n=this._renderer.getContext();["Welcome to xviewer.js","Three Version: "+ve,"WebGL Version: "+n.getParameter(n.VERSION),"ColorSpace: "+En.workingColorSpace].join(`
`)}_onPreDestroy(){Xn.Clear(),this._user={},this._input.removeAllListeners(),this._renderer.dispose(),this.destroyComponents(this._scene),this.stop()}async load({replace:t,castShadow:n,receiveShadow:i,parent:r=this._scene,...s}){let c=await Xn.Load(s);return t&&(r.clear(),this.emit("node-changed",{action:"clear",target:r})),(n||i)&&c.traverse(u=>{u instanceof Je&&(u.castShadow=!!n,u.receiveShadow=!!i)}),r.add(c),this.emit("node-changed",{action:"add",target:c}),c}async setEnvironment(t){let n=t?t.url:null;this._environment!==n&&(this._environment=n,this.emit("env-changed",n),this._scene.environment=n?await Xn.Load({...t,settings:Object.assign({mapping:Ta},t.settings)}):null),t&&t.noBackground||this.setBackground(t)}async setBackground(t){let n=t?t.color||t.url:null;this._background!==n&&(this._background=n,this.emit("bg-changed",n),this._scene.background=n?t.color||await Xn.Load({...t,settings:Object.assign({mapping:Ta},t.settings)}):null)}pushScene(t=new Ds){return this._states.push({scene:this._scene,camera:this._camera}),this._scene=t||this._scene,this}popScene(){let t=this._states.pop();return t&&(this._scene=t.scene,this._camera=t.camera),this}addNode(t,n={},i=this._scene){let r,s;if(typeof t=="function"){let c=n&&n.args,u=c?new t(...c):new t;u.isCamera&&n.makeDefault&&(u.manual=u.aspect!==this.camera.aspect,this._camera=u),u.isObject3D?r=i.addObject(_t(u,n)):(r=i.addObject(u.create&&u.create(n)||new ot),s=this.addComponent(r,u,n))}else r=i.addObject(_t(t,n));return this.emit("node-changed",{action:"add",target:r}),s||r}addPlugin(t,n){return this.addComponent(this._scene,t,n)}removePlugin(t){return this.removeComponent(this._scene,t)}getPlugin(t){return this.getComponent(this._scene,t)}_addDefaultPlugins(){this.addPlugin(Rd),this.addPlugin(CS)}resize(t,n){let i=this._camera;if(i.isOrthographicCamera)this._viewport={width:t/i.zoom,height:n/i.zoom,factor:1};else if(i.isPerspectiveCamera){i.manual||(i.aspect=t/n,i.updateProjectionMatrix());let r=i.getWorldPosition(BP).distanceTo(zP),s=2*Math.tan(hn.degToRad(.5*i.fov))*r,c=s*t/n;this._viewport={width:c,height:s,factor:t/c}}this._renderer.setSize(t,n)}start(){if(this._running==0){this._running=!0;let t=n=>{let i=this._time!==0?n-this._time:0;return this._time=n,i};this._renderer.setAnimationLoop(n=>this.update(t(.001*n)))}return this}render(t){this._renderer.info.reset(),this._renderer.render(this._scene,this._camera)}stop(){return this._time=0,this._running=!1,this._renderer.setAnimationLoop(null),this}}function Ot(o={}){return function(e,t){e.hasOwnProperty("__properties")==0&&(e.__properties=Object.assign({},e.__proto__.__properties)),e.__properties[t]=o}}function Ir(...o){return function(e){let t=e.prototype;t._dependencies==null&&(t._dependencies=[]),t._dependencies.push(...o)}}let{PI:Zs,cos:DS,sin:Wc,pow:Va,sqrt:Ld}=Math;function OS(o){return 1-L0(1-o)}function L0(o){return o<1/2.75?7.5625*o*o:o<2/2.75?7.5625*(o-=1.5/2.75)*o+.75:o<2.5/2.75?7.5625*(o-=2.25/2.75)*o+.9375:7.5625*(o-=2.625/2.75)*o+.984375}var P0;(function(o){o[o.Linear=0]="Linear",o[o.QuadraticIn=1]="QuadraticIn",o[o.QuadraticOut=2]="QuadraticOut",o[o.QuadraticInOut=3]="QuadraticInOut",o[o.CubicIn=4]="CubicIn",o[o.CubicOut=5]="CubicOut",o[o.CubicInOut=6]="CubicInOut",o[o.QuarticIn=7]="QuarticIn",o[o.QuarticOut=8]="QuarticOut",o[o.QuarticInOut=9]="QuarticInOut",o[o.QuinticIn=10]="QuinticIn",o[o.QuinticOut=11]="QuinticOut",o[o.QuinticInOut=12]="QuinticInOut",o[o.SinusoidalIn=13]="SinusoidalIn",o[o.SinusoidalOut=14]="SinusoidalOut",o[o.SinusoidalInOut=15]="SinusoidalInOut",o[o.ExponentialIn=16]="ExponentialIn",o[o.ExponentialOut=17]="ExponentialOut",o[o.ExponentialInOut=18]="ExponentialInOut",o[o.CircularIn=19]="CircularIn",o[o.CircularOut=20]="CircularOut",o[o.CircularInOut=21]="CircularInOut",o[o.ElasticIn=22]="ElasticIn",o[o.ElasticOut=23]="ElasticOut",o[o.ElasticInOut=24]="ElasticInOut",o[o.BackIn=25]="BackIn",o[o.BackOut=26]="BackOut",o[o.BackInOut=27]="BackInOut",o[o.BounceIn=28]="BounceIn",o[o.BounceOut=29]="BounceOut",o[o.BounceInOut=30]="BounceInOut"})(P0||(P0={}));const GP=[function(o){return o},function(o){return o*o},function(o){return o*(2-o)},function(o){return(o*=2)<1?.5*o*o:-.5*(--o*(o-2)-1)},function(o){return o*o*o},function(o){return--o*o*o+1},function(o){return(o*=2)<1?.5*o*o*o:.5*((o-=2)*o*o+2)},function(o){return o*o*o*o},function(o){return 1- --o*o*o*o},function(o){return(o*=2)<1?.5*o*o*o*o:-.5*((o-=2)*o*o*o-2)},function(o){return o*o*o*o*o},function(o){return--o*o*o*o*o+1},function(o){return(o*=2)<1?.5*o*o*o*o*o:.5*((o-=2)*o*o*o*o+2)},function(o){return 1-DS(o*Zs/2)},function(o){return Wc(o*Zs/2)},function(o){return .5*(1-DS(Zs*o))},function(o){return o===0?0:Va(1024,o-1)},function(o){return o===1?1:1-Va(2,-10*o)},function(o){return o===0?0:o===1?1:(o*=2)<1?.5*Va(1024,o-1):.5*(2-Va(2,-10*(o-1)))},function(o){return 1-Ld(1-o*o)},function(o){return Ld(1- --o*o)},function(o){return(o*=2)<1?-.5*(Ld(1-o*o)-1):.5*(Ld(1-(o-=2)*o)+1)},function(o){return o===0?0:o===1?1:-Va(2,10*(o-1))*Wc(5*(o-1.1)*Zs)},function(o){return o===0?0:o===1?1:Va(2,-10*o)*Wc(5*(o-.1)*Zs)+1},function(o){return o===0?0:o===1?1:(o*=2)<1?-.5*Va(2,10*(o-1))*Wc(5*(o-1.1)*Zs):.5*Va(2,-10*(o-1))*Wc(5*(o-1.1)*Zs)+1},function(o){var e=1.70158;return o*o*((e+1)*o-e)},function(o){var e=1.70158;return--o*o*((e+1)*o+e)+1},function(o){var e=2.5949095;return(o*=2)<1?o*o*((e+1)*o-e)*.5:.5*((o-=2)*o*((e+1)*o+e)+2)},OS,L0,function(o){return o<.5?.5*OS(2*o):.5*L0(2*o-1)+.5}];class VP{constructor(){N(this,"style",P0.QuadraticInOut);N(this,"time",4)}}const{clamp:WP,lerp:C0}=hn;class D0 extends wt{constructor(){super(...arguments);N(this,"_vcam",null);N(this,"_vcamSolo",null);N(this,"_vcams",[]);N(this,"_lerpTime",0);N(this,"brainBlend",new VP)}get vcam(){return this._vcam}get vcams(){return this._vcams}update(t){let n=this.getActiveCamera();if(n!=null){for(let i of this._vcams)i.enabled=i===n;if(this._lerpTime<this.brainBlend.time){this._lerpTime+=t;let i=WP(this._lerpTime/this.brainBlend.time,0,1),r=GP[this.brainBlend.style];r&&(i=r(i)),this._lerpToMainCamera(n,i)}else this._lerpToMainCamera(n,1)}}activeCamera(t,n=4){this._vcamSolo!==t&&(this._vcamSolo=t,this._lerpTime=0,this.brainBlend.time=n)}addCamera(t){this._vcams.indexOf(t)===-1&&this._vcams.push(t)}removeCamera(t){let n=this._vcams.indexOf(t);n!==-1&&this._vcams.splice(n,1)}getActiveCamera(){return this._vcamSolo||this._vcams.filter(t=>t.enabled).sort((t,n)=>n.priority-t.priority)[0]}_lerpToMainCamera(t,n){let i=this.viewer.camera,r=t,s=r.lens,c=i.fov,u=i.near,d=i.far;i.position.lerp(r.finalPosition,n),i.quaternion.slerp(r.finalRotation,n),i.fov=C0(c,s.fov,n),i.near=C0(u,s.near,n),i.far=C0(d,s.far,n),c==s.fov&&u==s.near&&d==s.far||i.updateProjectionMatrix()}}const{clamp:Ks}=hn,{min:XP,max:Xc,acos:qP,abs:gi}=Math,qc=1e-6,YP=Math.log(.01);function IS(o,e,t,n){let i=-YP/t;return o+(e-o)*(1-Math.exp(-i*n))}function Sl(o,e,t,n){let i=1-XP(n,t)/t,r=i*i;return o+(e-o)*(1-r*r)}function QP(o,e,t,n,i){return o.copy(e).slerp(t,IS(0,1,n,i))}function ZP(o,e,t,n,i){return o.copy(e).slerp(t,Sl(0,1,n,i))}function O0(o,e,t,n,i,r){o._velocity===void 0&&(o._velocity=0);let s=2/(n=Math.max(1e-4,n)),c=s*r,u=1/(1+c+.48*c*c+.235*c*c*c),d=e-t,p=t,f=i*n;d=Ks(d,-f,f),t=e-d;let g=(o._velocity+s*d)*r;o._velocity=(o._velocity-s*g)*u;let v=t+(d+g)*u;return p-e>0==v>p&&(v=p,o._velocity=(v-p)/r),v}function KP(o,e,t,n,i=o){return i.copy(o).slerp(e,O0(i,0,1,t,1/0,n))}function JP(o,e,t,n,i=o){return i.copy(o).lerp(e,O0(i,0,1,t,1/0,n))}let NS=new C;function $P(o,e,t,n,i=o){if(n<=0)return i.copy(e);let r=NS.copy(e).sub(o);return r.lengthSq()<qc?i.copy(e):i.copy(o).add(r.multiplyScalar(Ks(t*n,0,1)))}function eC(o,e,t,n,i=o){let r=NS.copy(e).sub(o),s=r.length(),c=n*t;if(s>c){if(c>0){let u=r.multiplyScalar(1/s);return i.copy(o).add(u)}return i.copy(o)}return i.copy(e)}function kS(o,e,t=qc){return gi(o.x-e.x)<=t*Xc(1,gi(o.x),gi(e.x))&&gi(o.y-e.y)<=t*Xc(1,gi(o.y),gi(e.y))&&gi(o.z-e.z)<=t*Xc(1,gi(o.z),gi(e.z))&&gi(o.w-e.w)<=t*Xc(1,gi(o.w),gi(e.w))}function tC(o,e,t,n){return n<=0||kS(o,e)?e:o.slerp(e,Ks(n*t,0,1))}function nC(o,e,t,n,i=o){if(n<=0||kS(o,e))return i.copy(e);let r=Ks(n*t,0,1),s=Xc(function(c,u){let d=c.x*u.x+c.y*u.y+c.z*u.z+c.w*u.w;return qP(2*d*d-1)}(o,e),qc);return i.copy(o).slerp(e,Ks(r/s,0,1))}function iC(o,e,t,n){if(n<=0)return e;let i=e-o;return gi(i)<qc?e:o+i*Ks(n*t,0,1)}function rC(o,e,t,n){let i=e-o;if(gi(i)<qc)return e;let r=n*t;return o+Ks(i,-r,r)}var Nr;(function(o){o[o.FREE=0]="FREE",o[o.TRANSLATE=1]="TRANSLATE",o[o.LOCK=2]="LOCK"})(Nr||(Nr={}));class FS{constructor(){N(this,"mode",Nr.FREE);N(this,"forbidX",!1);N(this,"forbidY",!1);N(this,"forbidZ",!1);N(this,"forbidPanX",!1);N(this,"forbidPanY",!1);N(this,"rotateSpeed",2);N(this,"rotateSmoothing",.5);N(this,"panSpeed",2);N(this,"panSmoothing",.5);N(this,"phiMin",.001);N(this,"phiMax",Math.PI-.001);N(this,"thetaMin",-1/0);N(this,"thetaMax",1/0);N(this,"distanceMin",.001);N(this,"distanceMax",1/0);N(this,"rotateTouchID",0)}}class US{constructor(){N(this,"trackedObjectOffset",new C)}}class zS{constructor(){N(this,"fov",45);N(this,"near",.1);N(this,"far",1e3)}}class BS extends wt{constructor(){super(...arguments);N(this,"_finalPosition",new C);N(this,"_finalRotation",new Ft);N(this,"priority",10);N(this,"lookAt",null);N(this,"follow",null);N(this,"lens",new zS);N(this,"aim",new US);N(this,"correctPosition",new C);N(this,"correctRotation",new Ft);N(this,"lookaheadPosition",new C);N(this,"brain")}get finalPosition(){return this._finalPosition.copy(this.node.position).add(this.correctPosition)}get finalRotation(){return this._finalRotation.copy(this.node.quaternion).multiply(this.correctRotation)}onLoad({lookAt:t,fov:n,near:i,far:r,...s}){this.node.isCamera=!0,this.lookAt=t,_t(this.lens,{fov:n,near:i,far:r}),_t(this.node,s),this.brain=this.viewer.getComponent(this.viewer.camera,D0),this.brain.addCamera(this)}onDestroy(){this.brain.removeCamera(this)}update(t){this.lookAt&&this.node.lookAt(this.lookAt.position)}}const{clamp:Yc,degToRad:aC}=hn,{abs:la,tan:sC}=Math;let pr=new ce,Pd=new ce,oC=new ce,lC=new ce,Cd=new ce,kr=new C,Xi=new C,HS=new C,jS=new C,GS=new C,Js=new Ft,I0=new Ft,vi=new Rb,cC=new jn;class VS extends BS{constructor(){super(...arguments);N(this,"_button",-1);N(this,"_touchID",-1);N(this,"_distanceDelta",0);N(this,"_preLoc0",new ce);N(this,"_preLoc1",new ce);N(this,"_rotateDelta",new ce);N(this,"_panDelta",new ce);N(this,"freelook",new FS)}onLoad({forbidX:t=!1,forbidY:n=!1,forbidZ:i=!1,forbidPanX:r=!1,forbidPanY:s=!1,mode:c=Nr.FREE,...u}){super.onLoad(u),_t(this.freelook,{forbidX:t,forbidY:n,forbidZ:i,forbidPanX:r,forbidPanY:s,mode:c})}onEnable(){this.viewer.on(Rn.POINTER_DOWN,this._onPointerDown,this),this.viewer.on(Rn.POINTER_UP,this._onPointerUp,this),this.viewer.on(Rn.POINTER_MOVE,this._onPointerMove,this),this.viewer.on(Rn.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.on(Rn.TOUCH_START,this._onTouchStart,this),this.viewer.on(Rn.TOUCH_MOVE,this._onTouchMove,this),this.reset()}onDisable(){this.viewer.off(Rn.POINTER_DOWN,this._onPointerDown,this),this.viewer.off(Rn.POINTER_UP,this._onPointerUp,this),this.viewer.off(Rn.POINTER_MOVE,this._onPointerMove,this),this.viewer.off(Rn.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.off(Rn.TOUCH_START,this._onTouchStart,this),this.viewer.off(Rn.TOUCH_MOVE,this._onTouchMove,this)}reset(){this._button=-1,this._touchID=-1,this._rotateDelta.set(0,0),this._panDelta.set(0,0),this._distanceDelta=0}_onPointerDown(t){this._button=t.button,this._preLoc0.set(t.pageX,t.pageY)}_onPointerUp(t){this._button=-1}_onPointerMove(t){switch(pr.set(t.pageX,t.pageY),this._button){case 0:this._rotateDelta.add(this._calculateRotateDelta(Cd,this._preLoc0,pr));break;case 1:this._panDelta.add(this._calculatePanDelta(Cd,this._preLoc0,pr))}this._preLoc0.copy(pr)}_onMouseWheel(t){if(this.lookAt){let n=kr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset).distanceTo(this.node.position),i=n+this._distanceDelta;t.deltaY>0?i*=this._calculateDistanceScale(1/.85):t.deltaY<0&&(i*=this._calculateDistanceScale(.85)),this._distanceDelta=i-n}}_onTouchStart(t){if(this._button>-1)return;let n=t.touches,i=this.freelook.rotateTouchID;n.length>i+1?(this._preLoc0.set(n[i].pageX,n[i].pageY),this._preLoc1.set(n[i+1].pageX,n[i+1].pageY)):n.length>i&&(this._touchID=n[i].identifier,this._preLoc0.set(n[i].pageX,n[i].pageY))}_onTouchMove(t){if(this._button>-1)return;let n=t.touches,i=this.freelook.rotateTouchID;if(n.length>i+1){if(pr.set(n[i].pageX,n[i].pageY),Pd.set(n[i+1].pageX,n[i+1].pageY),this.lookAt){let r=kr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset).distanceTo(this.node.position),s=(r+this._distanceDelta)*this._calculateDistanceScale(this._preLoc0.distanceTo(this._preLoc1)/pr.distanceTo(Pd));this._distanceDelta=s-r}this._panDelta.add(this._calculatePanDelta(Cd,lC.copy(this._preLoc0).add(this._preLoc1).multiplyScalar(.5),oC.copy(pr).add(Pd).multiplyScalar(.5))),this._preLoc0.copy(pr),this._preLoc1.copy(Pd)}else n.length>i&&this._touchID===n[i].identifier&&(pr.set(n[i].pageX,n[i].pageY),this._rotateDelta.add(this._calculateRotateDelta(Cd,this._preLoc0,pr)),this._preLoc0.copy(pr))}_calculateDistanceScale(t){return this.freelook.forbidZ&&(t=1),t}_calculateRotateDelta(t,n,i){let r=this.freelook,s=this.viewer.renderer.domElement;return t.copy(i).sub(n).multiplyScalar(2*r.rotateSpeed*Math.PI/s.height),t.y=-t.y,r.forbidX&&(t.x=0),r.forbidY&&(t.y=0),t}_calculatePanDelta(t,n,i){let r=this.freelook,s=this.viewer.renderer.domElement;return t.copy(i).sub(n).multiplyScalar(r.panSpeed/s.height),r.forbidPanX&&(t.x=0),r.forbidPanY&&(t.y=0),t}update(t){let n=this.freelook;if(this.lookAt){switch(kr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset),n.mode){case Nr.FREE:if(la(this._rotateDelta.x)+la(this._rotateDelta.y)+la(this._distanceDelta)>.001){Js.setFromUnitVectors(this.node.up,ot.DEFAULT_UP),Xi.copy(this.node.position).sub(kr),Xi.applyQuaternion(Js),vi.setFromVector3(Xi);let i=Sl(1,0,this.freelook.rotateSmoothing,t);this._rotateDelta.x=vi.theta-Yc(vi.theta-this._rotateDelta.x,n.thetaMin,n.thetaMax),vi.theta=vi.theta-this._rotateDelta.x*(1-i),this._rotateDelta.y=Yc(vi.phi+this._rotateDelta.y,n.phiMin,n.phiMax)-vi.phi,vi.phi=Yc(vi.phi+this._rotateDelta.y*(1-i),.001,Math.PI-.001),this._distanceDelta=Yc(vi.radius+this._distanceDelta,n.distanceMin,n.distanceMax)-vi.radius,vi.radius=vi.radius+this._distanceDelta*(1-i),this._rotateDelta.multiplyScalar(i),this._distanceDelta*=i,Xi.setFromSpherical(vi),Xi.applyQuaternion(Js.invert()),this.node.position.copy(Xi.add(kr))}break;case Nr.TRANSLATE:if(la(this._distanceDelta)>.001){Xi.copy(this.node.position).sub(this.lookAt.position);let i=Sl(1,0,this.freelook.rotateSmoothing,t),r=Xi.length();this._distanceDelta=Yc(r+this._distanceDelta,n.distanceMin,n.distanceMax)-r;let s=r+this._distanceDelta*(1-i);this._distanceDelta*=i;let c=Xi.normalize().multiplyScalar(s).add(this.lookAt.position);HS.copy(c).sub(this.node.position),this.aim.trackedObjectOffset.add(HS),this.node.position.copy(c),kr.copy(this.lookAt.position).add(this.aim.trackedObjectOffset)}break;case Nr.LOCK:if(la(this._rotateDelta.x)+la(this._rotateDelta.y)+la(this._distanceDelta)>.001){let i=Sl(1,0,this.freelook.rotateSmoothing,t);Js.setFromEuler(cC.set(-this._rotateDelta.y*(1-i),this._rotateDelta.x*(1-i),0)),Js.multiply(this.node.quaternion),I0.copy(this.node.quaternion).invert(),I0.multiply(Js),this.node.quaternion.multiply(I0.multiply(Js)),this._rotateDelta.multiplyScalar(i)}}switch(n.mode){case Nr.FREE:case Nr.TRANSLATE:if(la(this._panDelta.x)+la(this._panDelta.y)>.001){Xi.copy(this.node.position).sub(kr),jS.setFromMatrixColumn(this.node.matrix,0),GS.setFromMatrixColumn(this.node.matrix,1);let i=2*Xi.length()*sC(aC(.5*this.lens.fov)),r=Sl(1,0,this.freelook.panSmoothing,t),s=this.aim.trackedObjectOffset;s.sub(jS.multiplyScalar(this._panDelta.x*i*(1-r))),s.add(GS.multiplyScalar(this._panDelta.y*i*(1-r))),this._panDelta.multiplyScalar(r),kr.copy(this.lookAt.position).add(s),this.node.position.copy(Xi.add(kr))}this.node.lookAt(kr)}}}}const WS="SYSTEM_UPDATE",XS="SYSTEM_UPDATE_AFTER",uC="EULER";function hC(o,e,t){o.sleep||(o.mass!==1&&o.acceleration.multiplyScalar(1/o.mass),o.velocity.add(o.acceleration.multiplyScalar(e)),o.position.add(o.velocity.multiplyScalar(e)),o.acceleration.set(0,0,0))}function dC(o,e,t,n=uC){hC(o,e)}class Dd{constructor(e,t){N(this,"a");N(this,"b");N(this,"arr");Array.isArray(e)?this.arr=e:(this.a=e??0,this.b=t??this.a)}getValue(e=!1){return this.arr?this.arr[this.arr.length*Math.random()>>0]:function(t,n,i){if(t===n)return i?t>>0:t;{let r=t+Math.random()*(n-t);return i?r>>0:r}}(this.a,this.b,e)}}class qS{constructor(e=1,t=0,n=1){N(this,"_countSpan",null);N(this,"_intervalSpan",null);N(this,"_elapse",0);N(this,"_inteval",0);N(this,"_lastTime",0);N(this,"_repeat",1);N(this,"_repeatCount",1);this._countSpan=Array.isArray(e)?new Dd(e[0],e[1]):new Dd(e),this._intervalSpan=Array.isArray(t)?new Dd(t[0],t[1]):new Dd(t),this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat=n}reset(){this._elapse=0,this._lastTime=0,this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat}getVaue(e){return(this._repeatCount>0||this._repeat<0)&&(this._elapse+=e,this._elapse-this._lastTime>=this._inteval)?(this._lastTime+=this._inteval,this._inteval=this._intervalSpan.getValue(),this._repeatCount--,this._countSpan.getValue(!0)):0}}const{PI:N0}=Math,_l={easeLinear:function(o){return o},easeInQuad:function(o){return Math.pow(o,2)},easeOutQuad:function(o){return-(Math.pow(o-1,2)-1)},easeInOutQuad:function(o){return(o/=.5)<1?.5*Math.pow(o,2):-.5*((o-=2)*o-2)},easeInCubic:function(o){return Math.pow(o,3)},easeOutCubic:function(o){return Math.pow(o-1,3)+1},easeInOutCubic:function(o){return(o/=.5)<1?.5*Math.pow(o,3):.5*(Math.pow(o-2,3)+2)},easeInQuart:function(o){return Math.pow(o,4)},easeOutQuart:function(o){return-(Math.pow(o-1,4)-1)},easeInOutQuart:function(o){return(o/=.5)<1?.5*Math.pow(o,4):-.5*((o-=2)*Math.pow(o,3)-2)},easeInSine:function(o){return 1-Math.cos(o*(N0/2))},easeOutSine:function(o){return Math.sin(o*(N0/2))},easeInOutSine:function(o){return-.5*(Math.cos(N0*o)-1)},easeInExpo:function(o){return o===0?0:Math.pow(2,10*(o-1))},easeOutExpo:function(o){return o===1?1:1-Math.pow(2,-10*o)},easeInOutExpo:function(o){return o===0?0:o===1?1:(o/=.5)<1?.5*Math.pow(2,10*(o-1)):.5*(2-Math.pow(2,-10*--o))},easeInCirc:function(o){return-(Math.sqrt(1-o*o)-1)},easeOutCirc:function(o){return Math.sqrt(1-Math.pow(o-1,2))},easeInOutCirc:function(o){return(o/=.5)<1?-.5*(Math.sqrt(1-o*o)-1):.5*(Math.sqrt(1-(o-=2)*o)+1)},easeInBack:function(o){var e=1.70158;return o*o*((e+1)*o-e)},easeOutBack:function(o){var e=1.70158;return(o-=1)*o*((e+1)*o+e)+1},easeInOutBack:function(o){var e=1.70158;return(o/=.5)<1?o*o*((1+(e*=1.525))*o-e)*.5:.5*((o-=2)*o*((1+(e*=1.525))*o+e)+2)}};function YS(o){return o.constructor.type==="Span"?o.getValue():o}function Od(o,e,t){for(var n in e)o.hasOwnProperty(n)&&(t?t.indexOf(n)<0&&(o[n]=YS(e[n])):o[n]=YS(e[n]));return o}function pC(o,e){for(let t in e)if(o.hasOwnProperty(t)){let n=o[t];n&&n.copy?n.copy(e[t]):o[t]=e[t]}return o}const{clamp:f7,clamp01:fC}=hn;class k0{constructor(e){N(this,"index",0);N(this,"age",0);N(this,"life",1/0);N(this,"energy",1);N(this,"progress",0);N(this,"dead",!1);N(this,"sleep",!1);N(this,"delay",0);N(this,"acceleration",new C);N(this,"scale",new C(1,1,1));N(this,"position",new C);N(this,"velocity",new C);N(this,"rotation",new jn);N(this,"behaviours",[]);N(this,"parent",null);N(this,"color",new Pe);N(this,"alpha",1);N(this,"mass",1);N(this,"easing",_l.easeLinear);N(this,"transform",{});N(this,"rand",new C);Od(this,e)}reset(){return this.age=0,this.life=1/0,this.energy=1,this.progress=0,this.dead=!1,this.sleep=!1,this.delay=0,this.acceleration.set(0,0,0),this.scale.set(1,1,1),this.position.set(0,0,0),this.velocity.set(0,0,0),this.rotation.set(0,0,0),this.parent=null,this.color.setRGB(1,1,1),this.alpha=1,this.mass=1,this.easing=_l.easeLinear,this.rand.set(0,0,0),this.removeAllBehaviours(),this}destroy(){return this.dead=!0,this.parent=null,this}update(e){if(this.sleep||this.dead)return!1;if(this.delay>0)return this.delay-=e,!1;if(this.age+=e,this.age>this.life){if(!(this.energy>0))return this.destroy(),!1;this.energy=0,this.progress=1}else this.progress=this.easing(fC(this.age/this.life)),this.energy=1-this.progress;for(let t=this.behaviours.length;t--;)this.behaviours[t].applyBehaviour(this,e,this.progress);return!0}addBehaviour(...e){for(let t of e)this.behaviours.push(t),t.initialize(this)}removeBehaviour(e){let t=this.behaviours.indexOf(e);t>-1&&this.behaviours.splice(t,1)}removeAllBehaviours(){this.behaviours.length=0}}const mC=new rS(null,new Qe,new Qe);class QS{constructor(e={}){N(this,"spriteFrame",mC);N(this,"count",1);N(this,"interval",0);N(this,"repeat",1);N(this,"billboard",!0);N(this,"behaviours",[]);Od(this,e)}}const{clamp:gC}=hn,ZS={count:1};class vC extends k0{constructor(t){super();N(this,"rate",new qS(1,.1));N(this,"playing",!1);N(this,"particles",[]);N(this,"damping",.006);N(this,"controller",new QS);Od(this,t),this.initialize(this.controller)}initialize({count:t,interval:n,repeat:i,behaviours:r}){this.rate=new qS(t,n,i),this.behaviours=r}update(t){return!this.sleep&&!this.dead&&(this.age+=t,this.age>this.life&&this.particles.length==0&&this.destroy(),this.playing&&this.generate(t),this.particles.length>0&&this.integrate(t),!0)}integrate(t){var r,s,c;this.damping;let n,i=gC(60*t,.5,1.5);for(let u=this.particles.length;u--;)n=this.particles[u],n.update(t)&&((r=this.parent)==null||r.emit("PARTICLE_UPDATE",n),this.controller.onParticleUpdate&&this.controller.onParticleUpdate(n),dC(n,i)),n.dead&&(this.particles.splice(u,1),(s=this.parent)==null||s.pool.expire(n),(c=this.parent)==null||c.emit("PARTICLE_DEAD",n))}createParticle(t){var i;let n=this.parent.pool.get(k0);n.reset(),n.addBehaviour(...this.behaviours),n.parent=this,n.index=this.particles.length,this.particles.push(n),(i=this.parent)==null||i.emit("PARTICLE_CREATED",n),this.controller.onParticleCreate&&this.controller.onParticleCreate(n,t)}generate(t){for(let n=ZS.count=this.rate.getVaue(t);n--;)this.createParticle(ZS)}emit(t){for(let n=t.count=Math.max(1,t.count);n--;)this.createParticle(t)}play(){this.playing=!0,this.rate.reset()}stop(){this.playing=!1}}class yC{constructor(){N(this,"list",[])}get(e){return this.list.length>0?this.list.pop():new e}expire(e){this.list.push(e)}}var KS=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class F0 extends wt{constructor(){super(...arguments);N(this,"playing",!1);N(this,"pool",new yC);N(this,"emitters",[]);N(this,"renderers",[])}onLoad({name:t,...n}){this.name=t||"ParticleSystem-"+this.uuid,_t(this.node,n)}addEmitter(t){return t.parent=this,this.emitters.push(t),this.emit("EMITTER_ADDED",t),this}removeEmitter(t){return t.parent!==this||(t.parent=null,this.emitters.splice(this.emitters.indexOf(t),1),this.emit("EMITTER_REMOVED",t)),this}addRenderer(t){return this.renderers.push(t.init(this)),this}removeRenderer(t){return this.renderers.splice(this.renderers.indexOf(t.reset()),1),this}play(){for(let t=this.emitters.length;t--;)this.emitters[t].play();return this.playing=!0,this}stop(){return this.playing=!1,this}update(t){if(!this.playing)return;let n;for(let i=this.emitters.length;i--;)n=this.emitters[i],n.update(t),n.particles.length&&this.emit(WS,this);this.emit(XS,this)}getCount(){let t=0;for(let n=this.emitters.length;n--;)t+=this.emitters[n].particles.length;return t}onDestroy(){for(let t=this.emitters.length;t--;)this.emitters[t].destroy();for(let t=this.renderers.length;t--;)this.renderers[t].destroy();this.emitters.length=0,this.renderers.length=0}}KS([Ot()],F0.prototype,"play",null),KS([Ot()],F0.prototype,"stop",null);class Qc{constructor(e=!0){N(this,"enabled");this.enabled=e}applyBehaviour(e,t,n){this.enabled&&this.mutate(e,t,n)}initialize(e){}mutate(e,t,n){}}class xC extends Qc{constructor(t=1,n,i=_l.easeLinear,r){super(r);N(this,"alphaA");N(this,"alphaB");N(this,"easing");this.alphaA=t,this.alphaB=n,this.easing=i}initialize(t){t.transform.alphaA=this.alphaA,t.transform.alphaB=this.alphaB}mutate(t,n,i){t.alpha=t.transform.alphaB!==void 0?hn.lerp(t.transform.alphaA,t.transform.alphaB,this.easing(i)):t.transform.alphaA}}class bC extends Qc{constructor(t=new Pe,n,i=_l.easeLinear,r){super(r);N(this,"colorA");N(this,"colorB");N(this,"easing");this.colorA=t,this.colorB=n,this.easing=i}initialize(t){var n;t.transform.colorA=this.colorA.clone(),t.transform.colorB=(n=this.colorB)==null?void 0:n.clone()}mutate(t,n,i){t.color.copy(t.transform.colorA),t.transform.colorB&&t.color.lerp(t.transform.colorB,this.easing(i))}}class JS extends Qc{constructor(t=new C,n){super(n);N(this,"force");this.force=t,this.force.multiplyScalar(100)}initialize(t){t.transform.force=this.force.clone()}mutate(t,n,i){t.acceleration.add(t.transform.force)}}class SC extends JS{constructor(t=10,n){super(new C(0,-t,0),n);N(this,"gravity");this.gravity=t}}class _C extends Qc{constructor(t=new C,n,i=_l.easeLinear,r){super(r);N(this,"scaleA");N(this,"scaleB");N(this,"easing");this.scaleA=t,this.scaleB=n,this.easing=i}initialize(t){var n;t.transform.scaleA=this.scaleA.clone(),t.transform.scaleB=(n=this.scaleB)==null?void 0:n.clone()}mutate(t,n,i){t.scale.copy(t.transform.scaleA),t.transform.scaleB&&t.scale.lerp(t.transform.scaleB,this.easing(i))}}class $S extends Je{constructor(){super(...arguments);N(this,"system")}init(t){return this.system=t,this.system.node.add(this),this.system.on(WS,this.onSystemUpdate,this),this.system.on(XS,this.onSystemUpdateAfter,this),this}reset(){return this.system&&(this.system.targetOff(this),this.system.node.remove(this),this.system=void 0),this}destroy(){}onSystemUpdate(t){}onSystemUpdateAfter(t){}}const e_={blending:gn,depthTest:!0,depthWrite:!1,transparent:!0,maxParticles:200},U0=new na;let wl=new Ft;class wC extends $S{constructor(t=e_){super();N(this,"stride",21);N(this,"buffer");N(this,"interleavedBuffer");N(this,"geometry",new md);N(this,"renderMode",0);const{blending:n,useAlphaSDF:i,depthTest:r,depthWrite:s,transparent:c,maxParticles:u,map:d,...p}={...e_,...t},f=new xt({uniforms:{map:{value:d}},defines:{USE_ALPHA_SDF:!!i,IS_ADDITIVE_BLENDING:n===gn},vertexShader:`
precision highp float;
attribute vec4 texCoords;
attribute vec4 meshCoords;
attribute vec3 spritePos;
attribute vec4 spriteQuat;
attribute vec4 spriteColor;
attribute vec2 decorators;

varying vec2 vUv;
varying vec4 vColor;

#include <matrix>

mat2 makeRotateMatrix(in float rad) {
    float c = cos(rad);
    float s = sin(rad);
    return mat2(c,-s,s,c);
}

void main() {
    vColor = spriteColor;
    vUv = uv * texCoords.zw + texCoords.xy;
    vUv.y = 1. - vUv.y;

    mat4 instanceMatrix = getInstanceMatrix(spritePos, spriteQuat, vec3(1.));
    mat4 mvMatrix = modelViewMatrix * instanceMatrix;

    vec4 transformed = vec4(position,1.);
    transformed.xy = transformed.xy * meshCoords.zw + meshCoords.xy;

    vec4 mvPosition = mvMatrix * transformed;
    vec4 bbPosition = mvMatrix * vec4(0.,0.,0.,1.);
    vec2 scale = vec2(length(mvMatrix[0].xyz), length(mvMatrix[1].xyz));
    bbPosition.xy += makeRotateMatrix(spriteQuat.x) * transformed.xy * scale;
    mvPosition = mix(mvPosition, bbPosition, decorators.x);
    
    gl_Position = projectionMatrix * mvPosition;
}
`,fragmentShader:`
precision highp float;
uniform sampler2D map;
varying vec2 vUv;
varying vec4 vColor;

float luma(vec3 color) { return dot(color, vec3(0.299, 0.587, 0.114)); }

void main() {
    vec4 color = texture2D(map, vUv);
    float shape = color.r;

#ifdef USE_ALPHA_SDF
#ifdef IS_ADDITIVE_BLENDING
    float l = vColor.a * luma(vColor.rgb);
    shape = max(smoothstep(0.48, 0.52, shape), shape * l);
#else
    shape = smoothstep(0.48, 0.52, shape);
#endif
#endif

    float alpha = color.a * vColor.a;
    vec3 col = vColor.rgb * vColor.a * shape;
    gl_FragColor = vec4(col, alpha * shape);
}
`,blending:n,depthTest:r,depthWrite:s,transparent:c});let g=new Float32Array(u*this.stride),v=new Eb(g,this.stride),b=new md;b.index=U0.index,b.attributes.position=U0.attributes.position,b.attributes.uv=U0.attributes.uv,b.setAttribute("texCoords",new ri(v,4,0,!1)),b.setAttribute("meshCoords",new ri(v,4,4,!1)),b.setAttribute("spritePos",new ri(v,3,8,!1)),b.setAttribute("decorators",new ri(v,2,11,!1)),b.setAttribute("spriteQuat",new ri(v,4,13,!1)),b.setAttribute("spriteColor",new ri(v,4,17,!1)),this.buffer=g,this.interleavedBuffer=v,this.interleavedBuffer.setUsage(by),this.geometry=b,this.material=f,this.frustumCulled=!1,_t(this,p)}onSystemUpdateAfter(t){let n=0,i=t.emitters;for(let r=i.length;r--;){let s=i[r].particles;for(let c=s.length;c--;)this.commitInstanceBuffer(s[c],n++*this.stride)}this.interleavedBuffer.needsUpdate=!0,this.geometry.instanceCount=n,this.visible=n>0}commitInstanceBuffer(t,n=0){let{position:i,rotation:r,scale:s,color:c}=t,{billboard:u,spriteFrame:d}=t.parent.controller,{texCoords:p,meshCoords:f}=d;u?wl.x=r.x:wl.setFromEuler(r);let g=this.buffer;g[n++]=p.x,g[n++]=p.y,g[n++]=p.z,g[n++]=p.w,g[n++]=f.x*s.x,g[n++]=f.y*s.y,g[n++]=f.z*s.x,g[n++]=f.w*s.y,g[n++]=i.x,g[n++]=i.y,g[n++]=i.z,g[n++]=u?1:0,g[n++]=0,g[n++]=wl.x,g[n++]=wl.y,g[n++]=wl.z,g[n++]=wl.w,g[n++]=c.r,g[n++]=c.g,g[n++]=c.b,g[n++]=t.alpha}}class MC extends wt{create({width:e=1,height:t=1,depth:n=1,widthSegments:i=1,heightSegments:r=1,depthSegments:s=1,material:c=new zt,...u}){return _t(new Je(new ea(e,t,n,i,r,s),c),u)}}class TC extends wt{create({radius:e=1,length:t=1,capSegments:n=4,radialSegments:i=8,material:r=new zt,...s}){return _t(new Je(new nl(e,t,n,i),r),s)}}class EC extends wt{create({radius:e,segments:t,thetaStart:n,thetaLength:i,material:r=new zt,...s}){return _t(new Je(new il(e,t,n,i),r),s)}}class AC extends wt{create({radius:e=1,height:t=1,radialSegments:n=32,heightSegments:i=1,openEnded:r=!1,thetaStart:s=0,thetaLength:c=2*Math.PI,material:u=new zt,...d}){return _t(new Je(new rl(e,t,n,i,r,s,c),u),d)}}class RC extends wt{create({radiusTop:e=1,radiusBottom:t=1,height:n=1,radialSegments:i=32,heightSegments:r=1,openEnded:s=!1,thetaStart:c=0,thetaLength:u=2*Math.PI,material:d=new zt,...p}){return _t(new Je(new ka(e,t,n,i,r,s,c,u),d),p)}}class LC extends wt{create({radius:e=1,detail:t=0,material:n=new zt,...i}){return _t(new Je(new al(e,t),n),i)}}class PC extends wt{create({geometry:e=null,thresholdAngle:t=1,material:n=new zt,...i}){return _t(new Je(new Xm(e,t),n),i)}}class CC extends wt{create({shapes:e=new ia([new ce(.5,.5),new ce(-.5,.5),new ce(-.5,-.5),new ce(.5,-.5)]),options:t={},material:n=new zt,...i}){return _t(new Je(new ol(e,t),n),i)}}class DC extends wt{create({radius:e=1,detail:t=0,material:n=new zt,...i}){return _t(new Je(new ll(e,t),n),i)}}class OC extends wt{create({points:e=[new ce(0,-.5),new ce(.5,0),new ce(0,.5)],segments:t=12,phiStart:n=0,phiLength:i=2*Math.PI,material:r=new zt,...s}){return _t(new Je(new Os(e,t,n,i),r),s)}}class IC extends wt{create({radius:e=1,detail:t=0,material:n=new zt,...i}){return _t(new Je(new Ns(e,t),n),i)}}class NC extends wt{create({width:e=1,height:t=1,widthSegments:n=1,heightSegments:i=1,material:r=new zt,...s}){return _t(new Je(new na(e,t,n,i),r),s)}}class kC extends wt{create({vertices:e=[],indices:t=[],radius:n=1,detail:i=0,material:r=new zt,...s}){return _t(new Je(new Pr(e,t,n,i),r),s)}}class FC extends wt{create({innerRadius:e=.5,outerRadius:t=1,thetaSegments:n=32,phiSegments:i=1,thetaStart:r=0,thetaLength:s=2*Math.PI,material:c=new zt,...u}){return _t(new Je(new cl(e,t,n,i,r,s),c),u)}}class UC extends wt{create({shapes:e=new ia([new ce(0,.5),new ce(-.5,-.5),new ce(.5,-.5)]),curveSegments:t=12,material:n=new zt,...i}){return _t(new Je(new ul(e,t),n),i)}}class zC extends wt{create({radius:e,widthSegments:t,heightSegments:n,material:i=new zt,...r}){return _t(new Je(new Fa(e,t,n),i),r)}}class BC extends wt{create({radius:e=1,detail:t=0,material:n=new zt,...i}){return _t(new Je(new hl(e,t),n),i)}}class HC extends wt{create({radius:e=1,tube:t=.4,radialSegments:n=12,tubularSegments:i=48,arc:r=2*Math.PI,material:s=new zt,...c}){return _t(new Je(new dl(e,t,n,i,r),s),c)}}class jC extends wt{create({radius:e=1,tube:t=.4,tubularSegments:n=64,radialSegments:i=8,p:r=2,q:s=3,material:c=new zt,...u}){return _t(new Je(new pl(e,t,n,i,r,s),c),u)}}class GC extends wt{create({path:e=new id(new C(-1,-1,0),new C(-1,1,0),new C(1,1,0)),tubularSegments:t=64,radius:n=1,radialSegments:i=8,closed:r=!1,material:s=new zt,...c}){return _t(new Je(new fl(e,t,n,i,r),s),c)}}class VC extends wt{create({geometry:e=null,material:t=new zt,...n}){return _t(new Je(new Qm(e),t),n)}}class t_ extends xt{constructor(t=new ce){super({uniforms:{inputBuffer:new He(null),depthBuffer:new He(null),resolution:new He(new ce),texelSize:new He(new ce),halfTexelSize:new He(new ce),kernel:new He(0),scale:new He(1),cameraNear:new He(0),cameraFar:new He(1),minDepthThreshold:new He(0),maxDepthThreshold:new He(1),depthScale:new He(0),depthToBlurRatioBias:new He(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <encodings_fragment>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:ke,depthWrite:!1,depthTest:!1});N(this,"kernel");this.toneMapped=!1,this.setTexelSize(t.x,t.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(t,n){this.uniforms.texelSize.value.set(t,n),this.uniforms.halfTexelSize.value.set(t,n).multiplyScalar(.5)}setResolution(t){this.uniforms.resolution.value.copy(t)}}class n_{constructor({gl:e,resolution:t,width:n=500,height:i=500,minDepthThreshold:r=0,maxDepthThreshold:s=1,depthScale:c=0,depthToBlurRatioBias:u=.25}){N(this,"renderTargetA");N(this,"renderTargetB");N(this,"convolutionMaterial");N(this,"scene");N(this,"camera");N(this,"screen");N(this,"renderToScreen",!1);this.renderTargetA=new Rt(t,t,{minFilter:rt,magFilter:rt,stencilBuffer:!1,depthBuffer:!1,type:di}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new t_,this.convolutionMaterial.setTexelSize(1/n,1/i),this.convolutionMaterial.setResolution(new ce(n,i)),this.scene=new Ds,this.camera=new Vo,this.convolutionMaterial.uniforms.minDepthThreshold.value=r,this.convolutionMaterial.uniforms.maxDepthThreshold.value=s,this.convolutionMaterial.uniforms.depthScale.value=c,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=u,this.convolutionMaterial.defines.USE_DEPTH=c>0;const d=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),p=new Float32Array([0,0,2,0,0,2]),f=new Ke;f.setAttribute("position",new $e(d,3)),f.setAttribute("uv",new $e(p,2)),this.screen=new Je(f,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,n){const i=this.scene,r=this.camera,s=this.renderTargetA,c=this.renderTargetB;let u=this.convolutionMaterial,d=u.uniforms;d.depthBuffer.value=t.depthTexture;const p=u.kernel;let f,g,v,b=t;for(g=0,v=p.length-1;g<v;++g)f=1&g?c:s,d.kernel.value=p[g],d.inputBuffer.value=b.texture,e.setRenderTarget(f),e.render(i,r),b=f;d.kernel.value=p[g],d.inputBuffer.value=b.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(i,r)}}class i_ extends zt{constructor(t={}){super(t);N(this,"_tDepth",{value:null});N(this,"_distortionMap",{value:null});N(this,"_tDiffuse",{value:null});N(this,"_tDiffuseBlur",{value:null});N(this,"_textureMatrix",{value:null});N(this,"_hasBlur",{value:!1});N(this,"_mirror",{value:0});N(this,"_mixBlur",{value:0});N(this,"_blurStrength",{value:.5});N(this,"_minDepthThreshold",{value:.9});N(this,"_maxDepthThreshold",{value:1});N(this,"_depthScale",{value:0});N(this,"_depthToBlurRatioBias",{value:.25});N(this,"_distortion",{value:1});N(this,"_mixContrast",{value:1});this.setValues(t)}onBeforeCompile(t){var n;(n=t.defines)!=null&&n.USE_UV||(t.defines.USE_UV=""),t.uniforms.hasBlur=this._hasBlur,t.uniforms.tDiffuse=this._tDiffuse,t.uniforms.tDepth=this._tDepth,t.uniforms.distortionMap=this._distortionMap,t.uniforms.tDiffuseBlur=this._tDiffuseBlur,t.uniforms.textureMatrix=this._textureMatrix,t.uniforms.mirror=this._mirror,t.uniforms.mixBlur=this._mixBlur,t.uniforms.mixStrength=this._blurStrength,t.uniforms.minDepthThreshold=this._minDepthThreshold,t.uniforms.maxDepthThreshold=this._maxDepthThreshold,t.uniforms.depthScale=this._depthScale,t.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,t.uniforms.distortion=this._distortion,t.uniforms.mixContrast=this._mixContrast,t.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${t.vertexShader}`,t.vertexShader=t.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),t.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
		uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${t.fragmentShader}`,t.fragmentShader=t.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(t){this._tDiffuse.value=t}get tDepth(){return this._tDepth.value}set tDepth(t){this._tDepth.value=t}get distortionMap(){return this._distortionMap.value}set distortionMap(t){this._distortionMap.value=t}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(t){this._tDiffuseBlur.value=t}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(t){this._textureMatrix.value=t}get hasBlur(){return this._hasBlur.value}set hasBlur(t){this._hasBlur.value=t}get mirror(){return this._mirror.value}set mirror(t){this._mirror.value=t}get mixBlur(){return this._mixBlur.value}set mixBlur(t){this._mixBlur.value=t}get mixStrength(){return this._blurStrength.value}set mixStrength(t){this._blurStrength.value=t}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(t){this._minDepthThreshold.value=t}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(t){this._maxDepthThreshold.value=t}get depthScale(){return this._depthScale.value}set depthScale(t){this._depthScale.value=t}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(t){this._depthToBlurRatioBias.value=t}get distortion(){return this._distortion.value}set distortion(t){this._distortion.value=t}get mixContrast(){return this._mixContrast.value}set mixContrast(t){this._mixContrast.value=t}}const Zc=new Qe,ca=new Qe,Ml=new ta,$s=new C,z0=new C,Kc=new C,Jc=new De,Wa=new C,Id=new C,Nd=new C;class WC extends wt{constructor(){super(...arguments);N(this,"_fbo1");N(this,"_fbo2");N(this,"_blurPass");N(this,"_hasBlur",!1);N(this,"_virtualCamera",new Qt);N(this,"_reflectorOffset",0);N(this,"_textureMatrix",new De);N(this,"_reflectorMaterial")}create({width:t=1,height:n=1,...i}){return _t(new Je(new na(t,n)),{rotation:nS(-Math.PI/2,0,0),...i})}onLoad({mixBlur:t=0,mixStrength:n=1,resolution:i=256,blur:r=[0,0],minDepthThreshold:s=.9,maxDepthThreshold:c=1,depthScale:u=0,depthToBlurRatioBias:d=.25,mirror:p=0,distortion:f=1,mixContrast:g=1,distortionMap:v,reflectorOffset:b=0,...y}){const S=this.viewer.renderer,M={minFilter:rt,magFilter:rt,type:di};this._fbo1=new Rt(i,i,M),this._fbo1.depthBuffer=!0,this._fbo1.depthTexture=new Ec(i,i),this._fbo1.depthTexture.format=Xr,this._fbo1.depthTexture.type=ah,this._fbo2=new Rt(i,i,M),this._blurPass=new n_({gl:S,resolution:i,width:r[0],height:r[1],minDepthThreshold:s,maxDepthThreshold:c,depthScale:u,depthToBlurRatioBias:d});let w=this._hasBlur=r[0]+r[1]>0;this._reflectorOffset=b,this._reflectorMaterial=Object.assign(new i_,{mirror:p,mixBlur:t,textureMatrix:this._textureMatrix,tDiffuse:this._fbo1.texture,tDepth:this._fbo1.depthTexture,tDiffuseBlur:this._fbo2.texture,hasBlur:w,mixStrength:n,minDepthThreshold:s,maxDepthThreshold:c,depthScale:u,depthToBlurRatioBias:d,distortion:f,distortionMap:v,mixContrast:g,defines:{USE_BLUR:w?"":void 0,USE_DEPTH:u>0?"":void 0,USE_DISTORTION:v?"":void 0},...y},!0),this.node.material=this._reflectorMaterial}onDestroy(){this._fbo1.dispose(),this._fbo2.dispose(),this._reflectorMaterial.dispose()}beforeRender(){const t=this.viewer.camera,n=this._virtualCamera,i=this._textureMatrix;if($s.setFromMatrixPosition(this.node.matrixWorld),z0.setFromMatrixPosition(t.matrixWorld),Jc.extractRotation(this.node.matrixWorld),Wa.set(0,0,1),Wa.applyMatrix4(Jc),$s.addScaledVector(Wa,this._reflectorOffset),Kc.subVectors($s,z0),Kc.dot(Wa)>0)return;Kc.reflect(Wa).negate(),Kc.add($s),Jc.extractRotation(t.matrixWorld),Nd.set(0,0,-1),Nd.applyMatrix4(Jc),Nd.add(z0),Id.subVectors($s,Nd),Id.reflect(Wa).negate(),Id.add($s),n.position.copy(Kc),n.up.set(0,1,0),n.up.applyMatrix4(Jc),n.up.reflect(Wa),n.lookAt(Id),n.far=t.far,n.updateMatrixWorld(),n.projectionMatrix.copy(t.projectionMatrix),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(n.projectionMatrix),i.multiply(n.matrixWorldInverse),i.multiply(this.node.matrixWorld),Ml.setFromNormalAndCoplanarPoint(Wa,$s),Ml.applyMatrix4(n.matrixWorldInverse),ca.set(Ml.normal.x,Ml.normal.y,Ml.normal.z,Ml.constant);const r=n.projectionMatrix;Zc.x=(Math.sign(ca.x)+r.elements[8])/r.elements[0],Zc.y=(Math.sign(ca.y)+r.elements[9])/r.elements[5],Zc.z=-1,Zc.w=(1+r.elements[10])/r.elements[14],ca.multiplyScalar(2/ca.dot(Zc)),r.elements[2]=ca.x,r.elements[6]=ca.y,r.elements[10]=ca.z+1,r.elements[14]=ca.w}update(t){this.node.visible=!1;const n=this.viewer.renderer,i=this.viewer.scene,r=n.xr.enabled,s=n.shadowMap.autoUpdate;this.beforeRender(),n.xr.enabled=!1,n.shadowMap.autoUpdate=!1,n.setRenderTarget(this._fbo1),n.state.buffers.depth.setMask(!0),n.autoClear||n.clear(),n.render(i,this._virtualCamera),this._hasBlur&&this._blurPass.render(n,this._fbo1,this._fbo2),n.xr.enabled=r,n.shadowMap.autoUpdate=s,this.node.visible=!0,n.setRenderTarget(null)}}class XC extends wt{constructor(){super(...arguments);N(this,"_fbo");N(this,"_scene");N(this,"_camera")}get texture(){return this._fbo.texture}onLoad({width:t=128,height:n=128,...i}){const{scene:r,camera:s,size:c,renderer:u}=this.viewer;this._scene=r,this._camera=s,this._fbo=new Rt(t||c.width,n||c.height),this._fbo.texture.readPixels=(d,p,f,g,v)=>u.readRenderTargetPixels(this._fbo,d,p,f,g,v),_t(this.texture,i)}update(t){const n=this.viewer.renderer;n.setRenderTarget(this._fbo),n.render(this._scene,this._camera),n.setRenderTarget(null)}}class B0 extends wt{create(){return new Je(new Fa(500,60,40),new pi({side:xe}))}}class qC extends B0{onLoad(e){Xn.Load(Object.assign({magFilter:rt,minFilter:rt},e)).then(t=>{this.node.material.map=t,this.node.material.needsUpdate=!0})}}class YC extends B0{}class r_ extends wt{create(){return new c0(new vd)}onLoad({listener:e}){this.viewer.addNode(this.node.listener,{},e||this.viewer.camera)}play({url:e,loop:t=!1,volume:n=1,force:i=!1}){Xn.Load({url:e}).then(r=>{i&&this.node.stop(),this.node.setBuffer(r),this.node.setLoop(t),this.node.setVolume(n),this.node.isPlaying||this.node.play()})}stop(){this.node.stop()}}class QC extends wt{create(){return new vd}onLoad(e){this.node}}class ZC extends r_{create(){return new Mb(new vd)}play({refDistance:e=20,maxDistance:t=1e4,...n}){super.play(n),this.node.setRefDistance(e),this.node.setMaxDistance(t)}}function H0(o){return o>1e3?Math.floor(.001*o)+"k":o>1e6?Math.floor(1e-6*o)+"m":o}var eo=function(o,e,t){var n=1/0,i=0,r=Math.round,s=r(window.devicePixelRatio||1),c=80*s,u=48*s,d=3*s,p=2*s,f=3*s,g=15*s,v=74*s,b=30*s,y=document.createElement("canvas");y.width=c,y.height=u,y.style.cssText="width:80px;height:48px";var S=y.getContext("2d");return S.font="bold "+9*s+"px Helvetica,Arial,sans-serif",S.textBaseline="top",S.fillStyle=t,S.fillRect(0,0,c,u),S.fillStyle=e,S.fillText(o,d,p),S.fillRect(f,g,v,b),S.fillStyle=t,S.globalAlpha=.9,S.fillRect(f,g,v,b),{dom:y,update:function(M,w){n=Math.min(n,M),i=Math.max(i,M),S.fillStyle=t,S.globalAlpha=1,S.fillRect(0,0,c,g),S.fillStyle=e,S.fillText(H0(r(M))+" "+o+" ("+H0(r(n))+"-"+H0(r(i))+")",d,p),S.drawImage(y,f+s,g,v-s,b,f,g,v-s,b),S.fillRect(f+v-s,g,s,b),S.fillStyle=t,S.globalAlpha=.9,S.fillRect(f+v-s,g,s,r((1-M/w)*b))}}},KC=function(){var o=0,e=document.createElement("div");function t(p){return e.appendChild(p.dom),p}function n(p){for(var f=0;f<e.children.length;f++)e.children[f].style.display=f===p?"block":"none";o=p}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(p){p.preventDefault(),n(++o%e.children.length)},!1);var i=(performance||Date).now(),r=i,s=0,c=t(new eo("FPS","#0ff","#002")),u=t(new eo("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=t(new eo("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){s++;var p=(performance||Date).now();if(u.update(p-i,200),p>=r+1e3&&(c.update(1e3*s/(p-r),100),r=p,s=0,d)){var f=performance.memory;d.update(f.usedJSHeapSize/1048576,f.jsHeapSizeLimit/1048576)}return p},update:function(){i=this.end()},domElement:e,setMode:n}};class JC extends qn{constructor(){super(...arguments);N(this,"_stats",new KC);N(this,"_dcPanel",new eo("DC","#ff8","#221"));N(this,"_triPanel",new eo("TRI","#ff8","#221"));N(this,"_texPanel",new eo("TEX","#ff8","#221"));N(this,"_prgPanel",new eo("PRG","#ff8","#221"))}onLoad(t){this._stats.addPanel(this._dcPanel),this._stats.addPanel(this._texPanel),this._stats.addPanel(this._triPanel),this._stats.addPanel(this._prgPanel),this._stats.showPanel(0),document.body.appendChild(this._stats.dom)}update(t){let n=this.viewer.renderer.info;this._dcPanel.update(n.render.calls,300),this._triPanel.update(n.render.triangles,5e5),this._texPanel.update(n.memory.textures,200),this._prgPanel.update(n.programs.length,50),this._stats.update()}}class $C extends qn{constructor(){super(...arguments);N(this,"name","VirtualCameraPlugin");N(this,"_brain",null);N(this,"_freelookCamera",null)}onEnable(){this._brain&&(this._brain.enabled=!0),this._freelookCamera&&(this._freelookCamera.enabled=!0)}onDisable(){this._brain&&(this._brain.enabled=!1),this._freelookCamera&&(this._freelookCamera.enabled=!1)}onLoad(t){const n=this.viewer.camera,i=Object.assign({fov:n.fov,near:n.near,far:n.far,lookAt:new ot,position:tS(0,0,4)},t);this._brain=this.viewer.addComponent(n,D0),this._freelookCamera=this.viewer.addNode(VS,i)}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.18.2
 * @author George Michael Brower
 * @license MIT
 */class Pi{constructor(e,t,n,i,r="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(i),this.$name=document.createElement("div"),this.$name.classList.add("name"),Pi.nextNameID=Pi.nextNameID||0,this.$name.id="lil-gui-name-"+ ++Pi.nextNameID,this.$widget=document.createElement(r),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",s=>s.stopPropagation()),this.domElement.addEventListener("keyup",s=>s.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class a_ extends Pi{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function j0(o){let e,t;return(e=o.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=o.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=o.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const eD={isPrimitive:!0,match:o=>typeof o=="string",fromHexString:j0,toHexString:j0},$c={isPrimitive:!0,match:o=>typeof o=="number",fromHexString:o=>parseInt(o.substring(1),16),toHexString:o=>"#"+o.toString(16).padStart(6,0)},tD={isPrimitive:!1,match:o=>Array.isArray(o),fromHexString(o,e,t=1){const n=$c.fromHexString(o);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(255&n)/255*t},toHexString:([o,e,t],n=1)=>$c.toHexString(o*(n=255/n)<<16^e*n<<8^t*n<<0)},nD={isPrimitive:!1,match:o=>Object(o)===o,fromHexString(o,e,t=1){const n=$c.fromHexString(o);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(255&n)/255*t},toHexString:({r:o,g:e,b:t},n=1)=>$c.toHexString(o*(n=255/n)<<16^e*n<<8^t*n<<0)},iD=[eD,$c,tD,nD];class s_ extends Pi{constructor(e,t,n,i){var r;super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(r=this.initialValue,iD.find(s=>s.match(r))),this._rgbScale=i,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=j0(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class kd extends Pi{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",i=>{i.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class o_ extends Pi{constructor(e,t,n,i,r,s){super(e,t,n,"number"),this._initInput(),this.min(i),this.max(r);const c=s!==void 0;this.step(c?s:this._getImplicitStep(),c),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=p=>{const f=parseFloat(this.$input.value);isNaN(f)||(this._snapClampSetValue(f+p),this.$input.value=this.getValue())};let t,n,i,r,s,c=!1;const u=p=>{if(c){const f=p.clientX-t,g=p.clientY-n;Math.abs(g)>5?(p.preventDefault(),this.$input.blur(),c=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(f)>5&&d()}if(!c){const f=p.clientY-i;s-=f*this._step*this._arrowKeyMultiplier(p),r+s>this._max?s=this._max-r:r+s<this._min&&(s=this._min-r),this._snapClampSetValue(r+s)}i=p.clientY},d=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",d)};this.$input.addEventListener("input",()=>{let p=parseFloat(this.$input.value);isNaN(p)||(this._stepExplicit&&(p=this._snap(p)),this.setValue(this._clamp(p)))}),this.$input.addEventListener("keydown",p=>{p.key==="Enter"&&this.$input.blur(),p.code==="ArrowUp"&&(p.preventDefault(),e(this._step*this._arrowKeyMultiplier(p))),p.code==="ArrowDown"&&(p.preventDefault(),e(this._step*this._arrowKeyMultiplier(p)*-1))}),this.$input.addEventListener("wheel",p=>{this._inputFocused&&(p.preventDefault(),e(this._step*this._normalizeMouseWheel(p)))},{passive:!1}),this.$input.addEventListener("mousedown",p=>{t=p.clientX,n=i=p.clientY,c=!0,r=this.getValue(),s=0,window.addEventListener("mousemove",u),window.addEventListener("mouseup",d)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=g=>{const v=this.$slider.getBoundingClientRect();let b=((y,S,M,w,T)=>(y-S)/(M-S)*(T-w)+w)(g,v.left,v.right,this._min,this._max);this._snapClampSetValue(b)},t=g=>{e(g.clientX)},n=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)};let i,r,s=!1;const c=g=>{g.preventDefault(),this._setDraggingStyle(!0),e(g.touches[0].clientX),s=!1},u=g=>{if(s){const v=g.touches[0].clientX-i,b=g.touches[0].clientY-r;Math.abs(v)>Math.abs(b)?c(g):(window.removeEventListener("touchmove",u),window.removeEventListener("touchend",d))}else g.preventDefault(),e(g.touches[0].clientX)},d=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",u),window.removeEventListener("touchend",d)},p=this._callOnFinishChange.bind(this);let f;this.$slider.addEventListener("mousedown",g=>{this._setDraggingStyle(!0),e(g.clientX),window.addEventListener("mousemove",t),window.addEventListener("mouseup",n)}),this.$slider.addEventListener("touchstart",g=>{g.touches.length>1||(this._hasScrollBar?(i=g.touches[0].clientX,r=g.touches[0].clientY,s=!0):c(g),window.addEventListener("touchmove",u,{passive:!1}),window.addEventListener("touchend",d))},{passive:!1}),this.$slider.addEventListener("wheel",g=>{if(Math.abs(g.deltaX)<Math.abs(g.deltaY)&&this._hasScrollBar)return;g.preventDefault();const v=this._normalizeMouseWheel(g)*this._step;this._snapClampSetValue(this.getValue()+v),this.$input.value=this.getValue(),clearTimeout(f),f=setTimeout(p,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class l_ extends Pi{constructor(e,t,n,i){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(i)?i:Object.values(i),this._names=Array.isArray(i)?i:Object.keys(i),this._names.forEach(r=>{const s=document.createElement("option");s.innerHTML=r,this.$select.appendChild(s)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=t===-1?e:this._names[t],this}}class c_ extends Pi{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",i=>{i.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let to=null,u_=new WeakMap;class h_ extends Pi{constructor(e,t,n){super(e,t,n,"image"),this.$img=document.createElement("img"),this.$widget.appendChild(this.$img),this.updateDisplay()}updateDisplay(){return async function(e){if(e instanceof HTMLImageElement)return e.src;{let t=u_.get(e);if(t)return t;const n=Math.min(e.width,256),i=Math.min(e.height,256);if(to==null&&(to=document.createElement("canvas").getContext("2d")),to.canvas.width=n,to.canvas.height=i,e.data){let r=to.createImageData(e.width,e.height);r.data.set(e.data),e=await createImageBitmap(r)}return e instanceof ImageBitmap?(to.drawImage(e,0,0,e.width,e.height,0,0,n,i),u_.set(e,t=to.canvas.toDataURL()),t):""}}(this.getValue()).then(e=>this.$img.src=e),this}}class Fd{constructor(e){this.dom=e}add(){for(let e=0;e<arguments.length;e++){const t=arguments[e];t instanceof Fd?this.dom.appendChild(t.dom):console.error("UIElement:",t,"is not an instance of UIElement.")}return this}remove(){for(let e=0;e<arguments.length;e++){const t=arguments[e];t instanceof Fd?this.dom.removeChild(t.dom):console.error("UIElement:",t,"is not an instance of UIElement.")}return this}clear(){for(;this.dom.children.length;)this.dom.removeChild(this.dom.lastChild)}setId(e){return this.dom.id=e,this}getId(){return this.dom.id}setClass(e){return this.dom.className=e,this}addClass(e){return this.dom.classList.add(e),this}removeClass(e){return this.dom.classList.remove(e),this}setStyle(e,t){for(let n=0;n<t.length;n++)this.dom.style[e]=t[n];return this}setDisabled(e){return this.dom.disabled=e,this}setTextContent(e){return this.dom.textContent=e,this}getIndexOfChild(e){return Array.prototype.indexOf.call(this.dom.children,e.dom)}}function d_(o){let e=o.toString(),t=e.indexOf(".");return t>0?e.length-t-1:0}class rD extends Fd{constructor(e){super(document.createElement("input")),this.dom.style.cursor="ns-resize",this.dom.value="0.00",this.value=0,this.min=-1/0,this.max=1/0,this.step=.01,this.precision=d_(this.step),this.unit="",this.setValue(e);const t=this,n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!0);let i=0,r=0;const s={x:0,y:0},c={x:0,y:0};function u(v){const b=t.value;s.x=v.clientX,s.y=v.clientY,i+=s.x-c.x-(s.y-c.y);let y=r+10*i/(v.shiftKey?5:50)*t.step;y=Math.min(t.max,Math.max(t.min,y)),b!==y&&(t.setValue(y),t.dom.dispatchEvent(n)),c.x=v.clientX,c.y=v.clientY}function d(){document.removeEventListener("mousemove",u,!1),document.removeEventListener("mouseup",d,!1),Math.abs(i)<2&&(t.dom.focus(),t.dom.select())}function p(v){const b=t.value;s.x=v.touches[0].pageX,s.y=v.touches[0].pageY,i+=s.x-c.x-(s.y-c.y);let y=r+i/(v.shiftKey?5:50)*t.step;y=Math.min(t.max,Math.max(t.min,y)),b!==y&&(t.setValue(y),t.dom.dispatchEvent(n)),c.x=v.touches[0].pageX,c.y=v.touches[0].pageY}function f(v){v.touches.length===0&&(document.removeEventListener("touchmove",p,!1),document.removeEventListener("touchend",f,!1))}function g(){t.dom.style.cursor="ns-resize"}g(),this.dom.addEventListener("keydown",function(v){switch(v.stopPropagation(),v.keyCode){case 13:t.dom.blur();break;case 38:v.preventDefault(),t.setValue(t.getValue()+t.step),t.dom.dispatchEvent(n);break;case 40:v.preventDefault(),t.setValue(t.getValue()-t.step),t.dom.dispatchEvent(n)}},!1),this.dom.addEventListener("mousedown",function(v){v.preventDefault(),i=0,r=t.value,c.x=v.clientX,c.y=v.clientY,document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",d,!1)},!1),this.dom.addEventListener("touchstart",function(v){v.touches.length===1&&(i=0,r=t.value,c.x=v.touches[0].pageX,c.y=v.touches[0].pageY,document.addEventListener("touchmove",p,!1),document.addEventListener("touchend",f,!1))},!1),this.dom.addEventListener("change",function(){t.setValue(t.dom.value)},!1),this.dom.addEventListener("focus",function(){t.dom.style.backgroundColor="",t.dom.style.cursor=""},!1),this.dom.addEventListener("blur",g,!1)}getValue(){return this.value}setValue(e){return e!==void 0&&((e=parseFloat(e))<this.min&&(e=this.min),e>this.max&&(e=this.max),this.value=e,this.dom.value=e.toFixed(this.precision),this.unit!==""&&(this.dom.value+=" "+this.unit),this._onChangeCallback&&this._onChangeCallback(e)),this}onChange(e){return this._onChangeCallback=e,this}setStep(e){return this.step=e,this.precision=d_(e),this}setRange(e,t){return this.min=e,this.max=t,this}setUnit(e){return this.unit=e,this}}class aD extends Pi{constructor(e,t,n,i,r,s){super(e,t,n,"vector"),this.vector=this.initialValue.clone&&this.initialValue.clone()||Object.assign({},this.initialValue);let c=[];this.initialValue.x!==void 0&&c.push("x"),this.initialValue.y!==void 0&&c.push("y"),this.initialValue.z!==void 0&&c.push("z"),this.initialValue.w!==void 0&&c.push("w");for(let u=0;u<c.length;u++)this.setInput(c[u],u<c.length-1,i,r,s)}setInput(e,t,n,i,r){let s=new rD(this.vector[e]);if(s.dom.setAttribute("type","number"),s.dom.setAttribute("aria-labelledby",this.$name.id),s.setRange(n,i),s.setStep(r),s.setValue(this.vector[e]),s.onChange(c=>{this.vector[e]=c,this.setValue(this.vector)}),this.$widget.appendChild(s.dom),t){let c=document.createElement("div");c.classList.add("fill"),this.$widget.appendChild(c)}}}let p_=!1;class Ud{constructor({parent:e,autoPlace:t=e===void 0,container:n,width:i,title:r="Controls",id:s=r,closeFolders:c=!1,injectStyles:u=!0,touchStyles:d=!0}={}){if(this.id=s,this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",p=>{p.code!=="Enter"&&p.code!=="Space"||(p.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(r),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),d&&this.domElement.classList.add("allow-touch-styles"),!p_&&u&&(function(p){const f=document.createElement("style");f.innerHTML=p;const g=document.querySelector("head link[rel=stylesheet], head style");g?document.head.insertBefore(f,g):document.head.appendChild(f)}(`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid rgba(255, 255, 255, 0.6);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "↕";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}
.lil-gui .controller.image img {
  max-width: 100%;
}
.lil-gui .controller.vector input {
  color: var(--number-color);
}
.lil-gui .controller.vector .fill {
  height: 100%;
  margin-left: var(--spacing);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "▾";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "▸";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "✓";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`),p_=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),i&&this.domElement.style.setProperty("--width",i+"px"),this._closeFolders=c}add(e,t,n,i,r){if(Object(n)===n)return new l_(this,e,t,n);const s=e[t];switch(typeof s){case"number":return new o_(this,e,t,n,i,r);case"boolean":return new a_(this,e,t);case"string":return new c_(this,e,t);case"function":return new kd(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,s)}addColor(e,t,n=1){return new s_(this,e,t,n)}addImage(e,t){return new h_(this,e,t)}addVector(e,t,n=-1/0,i=1/0,r=.01){return new aD(this,e,t,n,i,r)}addFolder(e,t=e){const n=new Ud({parent:this,title:e,id:t});return this.root._closeFolders&&n.close(),n}removeFolder(e){let t=this.getFolder(e);return t&&t.destroy(),this}getFolder(e){return this.folders.find(t=>t.id===e)}load(e,t=!0){return e.controllers&&this.controllers.forEach(n=>{n instanceof kd||n._name in e.controllers&&n.load(e.controllers[n._name])}),t&&e.folders&&this.folders.forEach(n=>{n._title in e.folders&&n.load(e.folders[n._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof kd)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}}),e&&this.folders.forEach(n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const n=r=>{r.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const i=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=i+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(t=>t.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const no=`varying vec2 vUv;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`;class sD extends xt{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new He(null),luminanceBuffer1:new He(null),minLuminance:new He(.01),deltaTime:new He(0),tau:new He(1)},extensions:{shaderTextureLOD:!0},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <packing>\r
\r
#define packFloatToRGBA(v) packDepthToRGBA(v)\r
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\r
\r
uniform lowp sampler2D luminanceBuffer0;\r
uniform lowp sampler2D luminanceBuffer1;\r
\r
uniform float minLuminance;\r
uniform float deltaTime;\r
uniform float tau;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	// This 1x1 buffer contains the previous luminance.\r
	float l0 = unpackRGBAToFloat(texture2D(luminanceBuffer0, vUv));\r
\r
	// Get the current average scene luminance.\r
	#if __VERSION__ < 300\r
\r
		float l1 = texture2DLodEXT(luminanceBuffer1, vUv, MIP_LEVEL_1X1).r;\r
\r
	#else\r
\r
		float l1 = textureLod(luminanceBuffer1, vUv, MIP_LEVEL_1X1).r;\r
\r
	#endif\r
\r
	l0 = max(minLuminance, l0);\r
	l1 = max(minLuminance, l1);\r
\r
	// Adapt the luminance using Pattanaik's technique.\r
	float adaptedLum = l0 + (l1 - l0) * (1.0 - exp(-deltaTime * tau));\r
\r
	gl_FragColor = (adaptedLum == 1.0) ? vec4(1.0) : packFloatToRGBA(adaptedLum);\r
\r
}\r
`,vertexShader:no})}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}}class zd extends xt{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{inputBuffer:new He(null),cocBuffer:new He(null),texelSize:new He(new ce),kernel64:new He(null),kernel16:new He(null),scale:new He(1)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#if PASS == 1\r
\r
	uniform vec4 kernel64[32];\r
\r
#else\r
\r
	uniform vec4 kernel16[8];\r
\r
#endif\r
\r
uniform lowp sampler2D cocBuffer;\r
uniform vec2 texelSize;\r
uniform float scale;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	#ifdef FOREGROUND\r
\r
		vec2 CoCNearFar = texture2D(cocBuffer, vUv).rg;\r
		float CoC = CoCNearFar.r * scale;\r
\r
	#else\r
\r
		float CoC = texture2D(cocBuffer, vUv).g * scale;\r
\r
	#endif\r
\r
	if(CoC == 0.0) {\r
\r
		// Skip blurring.\r
		gl_FragColor = texture2D(inputBuffer, vUv);\r
\r
	} else {\r
\r
		#ifdef FOREGROUND\r
\r
			// Use far CoC to avoid weak blurring around foreground objects.\r
			vec2 step = texelSize * max(CoC, CoCNearFar.g * scale);\r
\r
		#else\r
\r
			vec2 step = texelSize * CoC;\r
\r
		#endif\r
\r
		#if PASS == 1\r
\r
			vec4 acc = vec4(0.0);\r
\r
			// Each vector contains two sampling points (64 in total).\r
			for(int i = 0; i < 32; ++i) {\r
\r
				vec4 kernel = kernel64[i];\r
\r
				vec2 uv = step * kernel.xy + vUv;\r
				acc += texture2D(inputBuffer, uv);\r
\r
				uv = step * kernel.zw + vUv;\r
				acc += texture2D(inputBuffer, uv);\r
\r
			}\r
\r
			gl_FragColor = acc / 64.0;\r
\r
		#else\r
\r
			vec4 maxValue = texture2D(inputBuffer, vUv);\r
\r
			// Each vector contains two sampling points (16 in total).\r
			for(int i = 0; i < 8; ++i) {\r
\r
				vec4 kernel = kernel16[i];\r
\r
				vec2 uv = step * kernel.xy + vUv;\r
				maxValue = max(texture2D(inputBuffer, uv), maxValue);\r
\r
				uv = step * kernel.zw + vUv;\r
				maxValue = max(texture2D(inputBuffer, uv), maxValue);\r
\r
\r
			}\r
\r
			gl_FragColor = maxValue;\r
\r
		#endif\r
\r
	}\r
\r
}\r
`,vertexShader:no}),t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.scale}setScale(e){this.scale=e}generateKernel(){const e=new Float64Array(128),t=new Float64Array(32);let n=0,i=0;for(let r=0,s=Math.sqrt(80);r<80;++r){const c=2.39996323*r,u=Math.sqrt(r)/s,d=u*Math.cos(c),p=u*Math.sin(c);r%5==0?(t[i++]=d,t[i++]=p):(e[n++]=d,e[n++]=p)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}const Vt="srgb",Bd="srgb-linear",f_=Number(ve.replace(/\D+/g,""))>=152,oD=new Map([[rr,Bd],[ht,Vt]]),lD=new Map([[Bd,rr],[Vt,ht]]);function Xa(o){return o===null?null:f_?o.outputColorSpace:oD.get(o.outputEncoding)}function Ci(o,e){o!==null&&(f_?o.colorSpace=e:o.encoding=lD.get(e))}function m_(o,e,t){return o*(e-t)-e}function G0(o,e,t){return Math.min(Math.max((o+e)/(e-t),0),1)}class cD extends xt{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new He(null),focusDistance:new He(0),focusRange:new He(0),cameraNear:new He(.3),cameraFar:new He(1e3)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <packing>\r
\r
#ifdef GL_FRAGMENT_PRECISION_HIGH\r
\r
	uniform highp sampler2D depthBuffer;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer;\r
\r
#endif\r
\r
uniform float focusDistance;\r
uniform float focusRange;\r
uniform float cameraNear;\r
uniform float cameraFar;\r
\r
varying vec2 vUv;\r
\r
float readDepth(const in vec2 uv) {\r
\r
	#if DEPTH_PACKING == 3201\r
\r
		return unpackRGBAToDepth(texture2D(depthBuffer, uv));\r
\r
	#else\r
\r
		return texture2D(depthBuffer, uv).r;\r
\r
	#endif\r
\r
}\r
\r
void main() {\r
\r
	float depth = readDepth(vUv);\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		float viewZ = perspectiveDepthToViewZ(depth, cameraNear, cameraFar);\r
		float linearDepth = viewZToOrthographicDepth(viewZ, cameraNear, cameraFar);\r
\r
	#else\r
\r
		float linearDepth = depth;\r
\r
	#endif\r
\r
	float signedDistance = linearDepth - focusDistance;\r
	float magnitude = smoothstep(0.0, focusRange, abs(signedDistance));\r
\r
	gl_FragColor.rg = magnitude * vec2(\r
		step(signedDistance, 0.0),\r
		step(0.0, signedDistance)\r
	);\r
\r
}\r
`,vertexShader:no}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=ar){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-m_(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=G0(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-m_(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=G0(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Qt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}const V0=0,uD=1,hD=2,dD=3,pD=4,fD=5,mD=6,gD=7,vD=8,g_=9,yD=10,xD=11,bD=12,SD=13,_D=14,wD=15,MD=16,TD=17,ED=18,AD=19,RD=20,LD=21,PD=22,v_=23,CD=24,DD=25,OD=26,ID=27,y_=28,ND=29,W0=30,kD=31,FD=32,UD=0,zD=1,X0=1,x_=2,b_=0,eu=1,q0=2,Lt={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Y0=2,BD=3,HD=0,S_=1,jD=2,fr={REINHARD:0,REINHARD2:1,REINHARD2_ADAPTIVE:2,OPTIMIZED_CINEON:3,ACES_FILMIC:4},GD=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])];class VD extends xt{constructor(e=new Qe){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new He(null),texelSize:new He(new Qe),scale:new He(1),kernel:new He(0)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
\r
void main() {\r
\r
	vec4 sum = texture2D(inputBuffer, vUv0); // Top left\r
	sum += texture2D(inputBuffer, vUv1); // Top right\r
	sum += texture2D(inputBuffer, vUv2); // Bottom right\r
	sum += texture2D(inputBuffer, vUv3); // Bottom left\r
	gl_FragColor = sum * 0.25; // Compute the average\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec4 texelSize; // XY = texel size, ZW = half texel size\r
uniform float kernel;\r
uniform float scale;\r
\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
\r
void main() {\r
\r
	vec2 uv = position.xy * 0.5 + 0.5;\r
	vec2 dUv = (texelSize.xy * vec2(kernel) + texelSize.zw) * scale;\r
\r
	vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\r
	vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\r
	vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\r
	vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`}),this.setTexelSize(e.x,e.y),this.kernelSize=Y0}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get kernelSequence(){return GD[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t,.5*e,.5*t)}setSize(e,t){const n=1/e,i=1/t;this.uniforms.texelSize.value.set(n,i,.5*n,.5*i)}}class __ extends xt{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new He(null),opacity:new He(1)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <dithering_pars_fragment>\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
uniform float opacity;\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec4 texel = texture2D(inputBuffer, vUv);\r
	gl_FragColor = opacity * texel;\r
\r
	#include <encodings_fragment>\r
	#include <dithering_fragment>\r
\r
}\r
`,vertexShader:no})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}}class WD extends xt{constructor(){super({name:"DepthMaskMaterial",defines:{DEPTH_EPSILON:"0.0001",DEPTH_PACKING_0:"0",DEPTH_PACKING_1:"0",DEPTH_TEST_STRATEGY:X0},uniforms:{inputBuffer:new He(null),depthBuffer0:new He(null),depthBuffer1:new He(null),cameraNearFar:new He(new ce(1,1))},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
#include <packing>\r
\r
#ifdef GL_FRAGMENT_PRECISION_HIGH\r
\r
	uniform highp sampler2D depthBuffer0;\r
	uniform highp sampler2D depthBuffer1;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer0;\r
	uniform mediump sampler2D depthBuffer1;\r
\r
#endif\r
\r
uniform sampler2D inputBuffer;\r
uniform vec2 cameraNearFar;\r
\r
float getViewZ(const in float depth) {\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		return perspectiveDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\r
\r
	#else\r
\r
		return orthographicDepthToViewZ(depth, cameraNearFar.x, cameraNearFar.y);\r
\r
	#endif\r
\r
}\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec2 depth;\r
\r
	#if DEPTH_PACKING_0 == 3201\r
\r
		depth.x = unpackRGBAToDepth(texture2D(depthBuffer0, vUv));\r
\r
	#else\r
\r
		depth.x = texture2D(depthBuffer0, vUv).r;\r
\r
	#endif\r
\r
	#if DEPTH_PACKING_1 == 3201\r
\r
		depth.y = unpackRGBAToDepth(texture2D(depthBuffer1, vUv));\r
\r
	#else\r
\r
		depth.y = texture2D(depthBuffer1, vUv).r;\r
\r
	#endif\r
\r
	bool isMaxDepth = (depth.x == 1.0);\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		// Linearize.\r
		depth.x = viewZToOrthographicDepth(getViewZ(depth.x), cameraNearFar.x, cameraNearFar.y);\r
		depth.y = viewZToOrthographicDepth(getViewZ(depth.y), cameraNearFar.x, cameraNearFar.y);\r
\r
	#endif\r
\r
	#if DEPTH_TEST_STRATEGY == 0\r
\r
		// Decide based on depth test.\r
		bool keep = depthTest(depth.x, depth.y);\r
\r
	#elif DEPTH_TEST_STRATEGY == 1\r
\r
		// Always keep max depth.\r
		bool keep = isMaxDepth || depthTest(depth.x, depth.y);\r
\r
	#else\r
\r
		// Always discard max depth.\r
		bool keep = !isMaxDepth && depthTest(depth.x, depth.y);\r
\r
	#endif\r
\r
	if(keep) {\r
\r
		gl_FragColor = texture2D(inputBuffer, vUv);\r
\r
	} else {\r
\r
		discard;\r
\r
	}\r
\r
}\r
`,vertexShader:no}),this.depthMode=th}set depthBuffer0(e){this.uniforms.depthBuffer0.value=e}set depthPacking0(e){this.defines.DEPTH_PACKING_0=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer0(e,t=ar){this.depthBuffer0=e,this.depthPacking0=t}set depthBuffer1(e){this.uniforms.depthBuffer1.value=e}set depthPacking1(e){this.defines.DEPTH_PACKING_1=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer1(e,t=ar){this.depthBuffer1=e,this.depthPacking1=t}get maxDepthStrategy(){return Number(this.defines.DEPTH_TEST_STRATEGY)}set maxDepthStrategy(e){this.defines.DEPTH_TEST_STRATEGY=e.toFixed(0),this.needsUpdate=!0}get keepFar(){return this.maxDepthStrategy}set keepFar(e){this.maxDepthStrategy=e?X0:x_}getMaxDepthStrategy(){return this.maxDepthStrategy}setMaxDepthStrategy(e){this.maxDepthStrategy=e}get epsilon(){return Number(this.defines.DEPTH_EPSILON)}set epsilon(e){this.defines.DEPTH_EPSILON=e.toFixed(16),this.needsUpdate=!0}getEpsilon(){return this.epsilon}setEpsilon(e){this.epsilon=e}get depthMode(){return Number(this.defines.DEPTH_MODE)}set depthMode(e){let t;switch(e){case xf:t="false";break;case bf:t="true";break;case ac:t="abs(d1 - d0) <= DEPTH_EPSILON";break;case nh:t="abs(d1 - d0) > DEPTH_EPSILON";break;case th:t="d0 > d1";break;case rc:t="d0 >= d1";break;case Sf:t="d0 <= d1";break;default:t="d0 < d1"}this.defines.DEPTH_MODE=e.toFixed(0),this.defines["depthTest(d0, d1)"]=t,this.needsUpdate=!0}getDepthMode(){return this.depthMode}setDepthMode(e){this.depthMode=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNearFar.value.set(e.near,e.far),e instanceof Qt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}class XD extends xt{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new He(null),texelSize:new He(new ce)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
// (1 / 4) * 0.5 = 0.125\r
#define WEIGHT_INNER 0.125\r
// (1 / 9) * 0.5 = 0.0555555\r
#define WEIGHT_OUTER 0.0555555\r
\r
varying vec2 vUv;\r
varying vec2 vUv00;\r
varying vec2 vUv01;\r
varying vec2 vUv02;\r
varying vec2 vUv03;\r
varying vec2 vUv04;\r
varying vec2 vUv05;\r
varying vec2 vUv06;\r
varying vec2 vUv07;\r
varying vec2 vUv08;\r
varying vec2 vUv09;\r
varying vec2 vUv10;\r
varying vec2 vUv11;\r
\r
float clampToBorder(const in vec2 uv) {\r
\r
	return float(uv.s >= 0.0 && uv.s <= 1.0 && uv.t >= 0.0 && uv.t <= 1.0);\r
\r
}\r
\r
void main() {\r
\r
	vec4 c = vec4(0.0);\r
\r
	vec4 w = WEIGHT_INNER * vec4(\r
		clampToBorder(vUv00),\r
		clampToBorder(vUv01),\r
		clampToBorder(vUv02),\r
		clampToBorder(vUv03)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv00);\r
	c += w.y * texture2D(inputBuffer, vUv01);\r
	c += w.z * texture2D(inputBuffer, vUv02);\r
	c += w.w * texture2D(inputBuffer, vUv03);\r
\r
	w = WEIGHT_OUTER * vec4(\r
		clampToBorder(vUv04),\r
		clampToBorder(vUv05),\r
		clampToBorder(vUv06),\r
		clampToBorder(vUv07)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv04);\r
	c += w.y * texture2D(inputBuffer, vUv05);\r
	c += w.z * texture2D(inputBuffer, vUv06);\r
	c += w.w * texture2D(inputBuffer, vUv07);\r
\r
	w = WEIGHT_OUTER * vec4(\r
		clampToBorder(vUv08),\r
		clampToBorder(vUv09),\r
		clampToBorder(vUv10),\r
		clampToBorder(vUv11)\r
	);\r
\r
	c += w.x * texture2D(inputBuffer, vUv08);\r
	c += w.y * texture2D(inputBuffer, vUv09);\r
	c += w.z * texture2D(inputBuffer, vUv10);\r
	c += w.w * texture2D(inputBuffer, vUv11);\r
\r
	c += WEIGHT_OUTER * texture2D(inputBuffer, vUv);\r
	gl_FragColor = c;\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec2 texelSize;\r
\r
varying vec2 vUv;\r
varying vec2 vUv00;\r
varying vec2 vUv01;\r
varying vec2 vUv02;\r
varying vec2 vUv03;\r
varying vec2 vUv04;\r
varying vec2 vUv05;\r
varying vec2 vUv06;\r
varying vec2 vUv07;\r
varying vec2 vUv08;\r
varying vec2 vUv09;\r
varying vec2 vUv10;\r
varying vec2 vUv11;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	vUv00 = vUv + texelSize * vec2(-1.0, 1.0);\r
	vUv01 = vUv + texelSize * vec2(1.0, 1.0);\r
	vUv02 = vUv + texelSize * vec2(-1.0, -1.0);\r
	vUv03 = vUv + texelSize * vec2(1.0, -1.0);\r
\r
	vUv04 = vUv + texelSize * vec2(-2.0, 2.0);\r
	vUv05 = vUv + texelSize * vec2(0.0, 2.0);\r
	vUv06 = vUv + texelSize * vec2(2.0, 2.0);\r
	vUv07 = vUv + texelSize * vec2(-2.0, 0.0);\r
	vUv08 = vUv + texelSize * vec2(2.0, 0.0);\r
	vUv09 = vUv + texelSize * vec2(-2.0, -2.0);\r
	vUv10 = vUv + texelSize * vec2(0.0, -2.0);\r
	vUv11 = vUv + texelSize * vec2(2.0, -2.0);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}class qD extends xt{constructor(e,t,n,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:ve.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new He(null),depthBuffer:new He(null),resolution:new He(new ce),texelSize:new He(new ce),cameraNear:new He(.3),cameraFar:new He(1e3),aspect:new He(1),time:new He(0)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.copyCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=ar){this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){return this.fragmentShader=`#include <common>\r
#include <packing>\r
#include <dithering_pars_fragment>\r
\r
#define packFloatToRGBA(v) packDepthToRGBA(v)\r
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#if DEPTH_PACKING == 3201\r
\r
	uniform lowp sampler2D depthBuffer;\r
\r
#elif defined(GL_FRAGMENT_PRECISION_HIGH)\r
\r
	uniform highp sampler2D depthBuffer;\r
\r
#else\r
\r
	uniform mediump sampler2D depthBuffer;\r
\r
#endif\r
\r
uniform vec2 resolution;\r
uniform vec2 texelSize;\r
\r
uniform float cameraNear;\r
uniform float cameraFar;\r
uniform float aspect;\r
uniform float time;\r
\r
varying vec2 vUv;\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#if THREE_REVISION >= 137\r
\r
	vec4 sRGBToLinear(const in vec4 value) {\r
\r
		return vec4(mix(\r
			pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)),\r
			value.rgb * 0.0773993808,\r
			vec3(lessThanEqual(value.rgb, vec3(0.04045)))\r
		), value.a);\r
\r
	}\r
\r
#endif\r
\r
float readDepth(const in vec2 uv) {\r
\r
	#if DEPTH_PACKING == 3201\r
\r
		return unpackRGBAToDepth(texture2D(depthBuffer, uv));\r
\r
	#else\r
\r
		return texture2D(depthBuffer, uv).r;\r
\r
	#endif\r
\r
}\r
\r
float getViewZ(const in float depth) {\r
\r
	#ifdef PERSPECTIVE_CAMERA\r
\r
		return perspectiveDepthToViewZ(depth, cameraNear, cameraFar);\r
\r
	#else\r
\r
		return orthographicDepthToViewZ(depth, cameraNear, cameraFar);\r
\r
	#endif\r
\r
}\r
\r
/**\r
 * Based on work by Sam Hocevar, Emil Persson and Ian Taylor.\r
 * https://www.chilliant.com/rgb2hsv.html\r
 */\r
\r
vec3 RGBToHCV(const in vec3 RGB) {\r
\r
	vec4 P = mix(vec4(RGB.bg, -1.0, 2.0 / 3.0), vec4(RGB.gb, 0.0, -1.0 / 3.0), step(RGB.b, RGB.g));\r
	vec4 Q = mix(vec4(P.xyw, RGB.r), vec4(RGB.r, P.yzx), step(P.x, RGB.r));\r
	float C = Q.x - min(Q.w, Q.y);\r
	float H = abs((Q.w - Q.y) / (6.0 * C + EPSILON) + Q.z);\r
	return vec3(H, C, Q.x);\r
\r
}\r
\r
vec3 RGBToHSL(const in vec3 RGB) {\r
\r
	vec3 HCV = RGBToHCV(RGB);\r
	float L = HCV.z - HCV.y * 0.5;\r
	float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + EPSILON);\r
	return vec3(HCV.x, S, L);\r
\r
}\r
\r
vec3 HueToRGB(const in float H) {\r
\r
	float R = abs(H * 6.0 - 3.0) - 1.0;\r
	float G = 2.0 - abs(H * 6.0 - 2.0);\r
	float B = 2.0 - abs(H * 6.0 - 4.0);\r
	return clamp(vec3(R, G, B), 0.0, 1.0);\r
\r
}\r
\r
vec3 HSLToRGB(const in vec3 HSL) {\r
\r
	vec3 RGB = HueToRGB(HSL.x);\r
	float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\r
	return (RGB - 0.5) * C + HSL.z;\r
\r
}\r
\r
FRAGMENT_HEAD\r
\r
void main() {\r
\r
	FRAGMENT_MAIN_UV\r
\r
	vec4 color0 = texture2D(inputBuffer, UV);\r
	vec4 color1 = vec4(0.0);\r
\r
	FRAGMENT_MAIN_IMAGE\r
\r
	gl_FragColor = color0;\r
\r
	#ifdef ENCODE_OUTPUT\r
\r
		#include <encodings_fragment>\r
\r
	#endif\r
\r
	#include <dithering_fragment>\r
\r
}\r
`.replace(Lt.FRAGMENT_HEAD,e.get(Lt.FRAGMENT_HEAD)||"").replace(Lt.FRAGMENT_MAIN_UV,e.get(Lt.FRAGMENT_MAIN_UV)||"").replace(Lt.FRAGMENT_MAIN_IMAGE,e.get(Lt.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=`uniform vec2 resolution;\r
uniform vec2 texelSize;\r
\r
uniform float cameraNear;\r
uniform float cameraFar;\r
uniform float aspect;\r
uniform float time;\r
\r
varying vec2 vUv;\r
\r
VERTEX_HEAD\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	VERTEX_MAIN_SUPPORT\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`.replace(Lt.VERTEX_HEAD,e.get(Lt.VERTEX_HEAD)||"").replace(Lt.VERTEX_MAIN_SUPPORT,e.get(Lt.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Qt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return Lt}}class YD extends xt{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:ve.replace(/\D+/g,"")},uniforms:{inputBuffer:new He(null),threshold:new He(0),smoothing:new He(1),range:new He(null)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#include <common>\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#ifdef RANGE\r
\r
	uniform vec2 range;\r
\r
#elif defined(THRESHOLD)\r
\r
	uniform float threshold;\r
	uniform float smoothing;\r
\r
#endif\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	vec4 texel = texture2D(inputBuffer, vUv);\r
	float l = luminance(texel.rgb);\r
\r
	#ifdef RANGE\r
\r
		// Apply a luminance range mask.\r
		float low = step(range.x, l);\r
		float high = step(l, range.y);\r
\r
		l *= low * high;\r
\r
	#elif defined(THRESHOLD)\r
\r
		l = smoothstep(threshold, threshold + smoothing, l);\r
\r
	#endif\r
\r
	#ifdef COLOR\r
\r
		gl_FragColor = vec4(texel.rgb * l, l);\r
\r
	#else\r
\r
		gl_FragColor = vec4(l);\r
\r
	#endif\r
\r
}\r
`,vertexShader:no}),this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}}class QD extends xt{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new He(e),inputBuffer:new He(null),strength:new He(1)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
\r
#endif\r
\r
#ifdef MASK_PRECISION_HIGH\r
\r
	uniform mediump sampler2D maskTexture;\r
\r
#else\r
\r
	uniform lowp sampler2D maskTexture;\r
\r
#endif\r
\r
#if MASK_FUNCTION != 0\r
\r
	uniform float strength;\r
\r
#endif\r
\r
varying vec2 vUv;\r
\r
void main() {\r
\r
	#if COLOR_CHANNEL == 0\r
\r
		float mask = texture2D(maskTexture, vUv).r;\r
\r
	#elif COLOR_CHANNEL == 1\r
\r
		float mask = texture2D(maskTexture, vUv).g;\r
\r
	#elif COLOR_CHANNEL == 2\r
\r
		float mask = texture2D(maskTexture, vUv).b;\r
\r
	#else\r
\r
		float mask = texture2D(maskTexture, vUv).a;\r
\r
	#endif\r
\r
	#if MASK_FUNCTION == 0\r
\r
		#ifdef INVERTED\r
\r
			// (mask > 0.0) ? 0.0 : 1.0;\r
			mask = step(mask, 0.0);\r
\r
		#else\r
\r
			// (mask > 0.0) ? 1.0 : 0.0;\r
			mask = 1.0 - step(mask, 0.0);\r
\r
		#endif\r
\r
	#else\r
\r
		mask = clamp(mask * strength, 0.0, 1.0);\r
\r
		#ifdef INVERTED\r
\r
			mask = 1.0 - mask;\r
\r
		#endif\r
\r
	#endif\r
\r
	#if MASK_FUNCTION == 2\r
\r
		// MULTIPLY_RGB_SET_ALPHA\r
		gl_FragColor = vec4(mask * texture2D(inputBuffer, vUv).rgb, mask);\r
\r
	#else\r
\r
		// DISCARD / MULTIPLY\r
		gl_FragColor = mask * texture2D(inputBuffer, vUv);\r
\r
	#endif\r
\r
}\r
`,vertexShader:no}),this.colorChannel=UD,this.maskFunction=HD}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==yn&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}}class ZD extends xt{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new He(null),supportBuffer:new He(null),texelSize:new He(new ce),radius:new He(.85)},blending:ke,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D inputBuffer;\r
	uniform mediump sampler2D supportBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D inputBuffer;\r
	uniform lowp sampler2D supportBuffer;\r
\r
#endif\r
\r
uniform float radius;\r
\r
varying vec2 vUv;\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
varying vec2 vUv4;\r
varying vec2 vUv5;\r
varying vec2 vUv6;\r
varying vec2 vUv7;\r
\r
void main() {\r
\r
	vec4 c = vec4(0.0);\r
\r
	c += texture2D(inputBuffer, vUv0) * 0.0625;\r
	c += texture2D(inputBuffer, vUv1) * 0.125;\r
	c += texture2D(inputBuffer, vUv2) * 0.0625;\r
	c += texture2D(inputBuffer, vUv3) * 0.125;\r
	c += texture2D(inputBuffer, vUv) * 0.25;\r
	c += texture2D(inputBuffer, vUv4) * 0.125;\r
	c += texture2D(inputBuffer, vUv5) * 0.0625;\r
	c += texture2D(inputBuffer, vUv6) * 0.125;\r
	c += texture2D(inputBuffer, vUv7) * 0.0625;\r
\r
	vec4 baseColor = texture2D(supportBuffer, vUv);\r
	gl_FragColor = mix(baseColor, c, radius);\r
\r
	#include <encodings_fragment>\r
\r
}\r
`,vertexShader:`uniform vec2 texelSize;\r
\r
varying vec2 vUv;\r
varying vec2 vUv0;\r
varying vec2 vUv1;\r
varying vec2 vUv2;\r
varying vec2 vUv3;\r
varying vec2 vUv4;\r
varying vec2 vUv5;\r
varying vec2 vUv6;\r
varying vec2 vUv7;\r
\r
void main() {\r
\r
	vUv = position.xy * 0.5 + 0.5;\r
\r
	vUv0 = vUv + texelSize * vec2(-1.0, 1.0);\r
	vUv1 = vUv + texelSize * vec2(0.0, 1.0);\r
	vUv2 = vUv + texelSize * vec2(1.0, 1.0);\r
	vUv3 = vUv + texelSize * vec2(-1.0, 0.0);\r
\r
	vUv4 = vUv + texelSize * vec2(1.0, 0.0);\r
	vUv5 = vUv + texelSize * vec2(-1.0, -1.0);\r
	vUv6 = vUv + texelSize * vec2(0.0, -1.0);\r
	vUv7 = vUv + texelSize * vec2(1.0, -1.0);\r
\r
	gl_Position = vec4(position.xy, 1.0, 1.0);\r
\r
}\r
`})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}set supportBuffer(e){this.uniforms.supportBuffer.value=e}get radius(){return this.uniforms.radius.value}set radius(e){this.uniforms.radius.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}}const KD=new Vo;let qa=null;class Ln{constructor(e="Pass",t=new Ds,n=KD){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Je(function(){if(qa===null){const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),i=new Float32Array([0,0,2,0,0,2]);qa=new Ke,qa.setAttribute!==void 0?(qa.setAttribute("position",new $e(n,3)),qa.setAttribute("uv",new $e(i,2))):(qa.addAttribute("position",new $e(n,3)),qa.addAttribute("uv",new $e(i,2)))}return qa}(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Ds),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=ar){}render(e,t,n,i,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Rt||t instanceof on||t instanceof Ut||t instanceof Ln)&&this[e].dispose()}}}class w_ extends Ln{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new __,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Rt(1,1,{minFilter:rt,magFilter:rt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==yn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":Xa(e)===Vt&&Ci(this.renderTarget.texture,Vt))}}class JD extends Ln{constructor(e,{minLuminance:t=.01,adaptationRate:n=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new sD,this.needsSwap=!1,this.renderTargetPrevious=new Rt(1,1,{minFilter:At,magFilter:At,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const i=this.fullscreenMaterial;i.luminanceBuffer0=this.renderTargetPrevious.texture,i.luminanceBuffer1=e,i.minLuminance=t,i.adaptationRate=n,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new w_(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,n,i,r){this.fullscreenMaterial.deltaTime=i,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}}class $D extends Ln{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,i,r){const s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}}const M_=new Pe;class Q0 extends Ln{constructor(e=!0,t=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,i,r){const s=this.overrideClearColor,c=this.overrideClearAlpha,u=e.getClearAlpha(),d=s!==null,p=c>=0;d?(e.getClearColor(M_),e.setClearColor(s,p?c:u)):p&&e.setClearAlpha(c),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),d?e.setClearColor(M_,u):p&&e.setClearAlpha(u)}}const Tl=-1;class Yn extends zi{constructor(e,t=-1,n=-1,i=1){super(),this.resizable=e,this.baseSize=new ce(1,1),this.preferredSize=new ce(t,n),this.target=this.preferredSize,this.s=i,this.effectiveSize=new ce,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,n=this.effectiveSize,i=this.scale;t.width!==Tl?n.width=t.width:t.height!==Tl?n.width=Math.round(t.height*(e.width/Math.max(e.height,1))):n.width=Math.round(e.width*i),t.height!==Tl?n.height=t.height:t.width!==Tl?n.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n.height=Math.round(e.height*i)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar(Tl),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){this.baseSize.width===e&&this.baseSize.height===t||(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){this.preferredSize.width===e&&this.preferredSize.height===t||(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Tl}}let Z0=!1;class T_{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let n;if(t.material.flatShading)switch(t.material.side){case _e:n=this.materialsFlatShadedDoubleSide;break;case xe:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded}else switch(t.material.side){case _e:n=this.materialsDoubleSide;break;case xe:n=this.materialsBackSide;break;default:n=this.materials}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=n[2]:t.isInstancedMesh?t.material=n[1]:t.material=n[0],++this.meshCount}}}cloneMaterial(e){if(!(e instanceof xt))return e.clone();const t=e.uniforms,n=new Map;for(const r in t){const s=t[r].value;s.isRenderTargetTexture&&(t[r].value=null,n.set(r,s))}const i=e.clone();for(const r of n)t[r[0]].value=r[1],i.uniforms[r[0]].value=r[1];return i}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){const t=this.materials=[this.cloneMaterial(e),this.cloneMaterial(e),this.cloneMaterial(e)];for(const n of t)n.uniforms=Object.assign({},e.uniforms),n.side=oe;t[2].skinning=!0,this.materialsBackSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.side=xe,i}),this.materialsDoubleSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.side=_e,i}),this.materialsFlatShaded=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=xe,i}),this.materialsFlatShadedDoubleSide=t.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=_e,i})}}render(e,t,n){const i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Z0){const r=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(const s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{const r=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=r}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Z0}static set workaroundEnabled(e){Z0=e}}class E_ extends Ln{constructor(e,t,n=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Q0,this.overrideMaterialManager=n===null?null:new T_(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new T_(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,i,r){const s=this.scene,c=this.camera,u=this.selection,d=c.layers.mask,p=s.background,f=e.shadowMap.autoUpdate,g=this.renderToScreen?null:t;u!==null&&c.layers.set(u.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(g),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,c):e.render(s,c),c.layers.mask=d,s.background=p,e.shadowMap.autoUpdate=f}}class e5 extends Ln{constructor(e,t,{renderTarget:n,resolutionScale:i=1,width:r=Yn.AUTO_SIZE,height:s=Yn.AUTO_SIZE,resolutionX:c=r,resolutionY:u=s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new E_(e,t,new zh({depthPacking:ph}));const d=this.renderPass;d.skipShadowMapUpdate=!0,d.ignoreBackground=!0;const p=d.getClearPass();p.overrideClearColor=new Pe(16777215),p.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Rt(1,1,{minFilter:At,magFilter:At}),this.renderTarget.texture.name="DepthPass.Target");const f=this.resolution=new Yn(this,c,u,i);f.addEventListener("change",g=>this.setSize(f.baseWidth,f.baseHeight))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}}function A_(o,e,t){for(const n of e){const i="$1"+o+n.charAt(0).toUpperCase()+n.slice(1),r=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const s of t.entries())s[1]!==null&&t.set(s[0],s[1].replace(r,i))}}function t5(o,e,t){let n=e.getFragmentShader(),i=e.getVertexShader();const r=n!==void 0&&/mainImage/.test(n),s=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(s&&t.attributes&q0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!s)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const c=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,u=t.shaderParts;let d=u.get(Lt.FRAGMENT_HEAD)||"",p=u.get(Lt.FRAGMENT_MAIN_UV)||"",f=u.get(Lt.FRAGMENT_MAIN_IMAGE)||"",g=u.get(Lt.VERTEX_HEAD)||"",v=u.get(Lt.VERTEX_MAIN_SUPPORT)||"";const b=new Set,y=new Set;if(s&&(p+=`	${o}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const w=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);v+=`	${o}MainSupport(`,v+=w?`vUv);
`:`);
`;for(const T of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const R of T[1].split(/\s*,\s*/))t.varyings.add(R),b.add(R),y.add(R);for(const T of i.matchAll(c))y.add(T[1])}for(const w of n.matchAll(c))y.add(w[1]);for(const w of e.defines.keys())y.add(w.replace(/\([\w\s,]*\)/g,""));for(const w of e.uniforms.keys())y.add(w);y.delete("while"),y.delete("for"),y.delete("if"),e.uniforms.forEach((w,T)=>t.uniforms.set(o+T.charAt(0).toUpperCase()+T.slice(1),w)),e.defines.forEach((w,T)=>t.defines.set(o+T.charAt(0).toUpperCase()+T.slice(1),w));const S=new Map([["fragment",n],["vertex",i]]);A_(o,y,t.defines),A_(o,y,S),n=S.get("fragment"),i=S.get("vertex");const M=e.blendMode;if(t.blendModes.set(M.blendFunction,M),r){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(f+=e.inputColorSpace===Vt?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==""?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const w=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${o}MainImage(color0, UV, `,t.attributes&eu&&w.test(n)&&(f+="depth, ",t.readDepth=!0),f+=`color1);
	`;const T=o+"BlendOpacity";t.uniforms.set(T,M.opacity),f+=`color0 = blend${M.blendFunction}(color0, color1, ${T});

	`,d+=`uniform float ${T};

`}if(d+=n+`
`,i!==null&&(g+=i+`
`),u.set(Lt.FRAGMENT_HEAD,d),u.set(Lt.FRAGMENT_MAIN_UV,p),u.set(Lt.FRAGMENT_MAIN_IMAGE,f),u.set(Lt.VERTEX_HEAD,g),u.set(Lt.VERTEX_MAIN_SUPPORT,v),e.extensions!==null)for(const w of e.extensions)t.extensions.add(w)}}class n5 extends Ln{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new qD(null,null,null,e),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(t),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort((t,n)=>n.attributes-t.attributes);for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new o5;let t=0;for(const c of this.effects)if(c.blendMode.blendFunction===g_)e.attributes|=c.getAttributes()&eu;else{if(e.attributes&c.getAttributes()&q0)throw new Error(`Convolution effects cannot be merged (${c.name})`);t5("e"+t++,c,e)}let n=e.shaderParts.get(Lt.FRAGMENT_HEAD),i=e.shaderParts.get(Lt.FRAGMENT_MAIN_IMAGE),r=e.shaderParts.get(Lt.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const c of e.blendModes.values())n+=c.getShaderCode().replace(s,`blend${c.blendFunction}`)+`
`;e.attributes&eu?(e.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,e.colorSpace===Vt&&(i+=`color0 = sRGBToLinear(color0);
	`),e.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(Lt.FRAGMENT_HEAD,n),e.shaderParts.set(Lt.FRAGMENT_MAIN_IMAGE,i),e.shaderParts.set(Lt.FRAGMENT_MAIN_UV,r);for(const[c,u]of e.shaderParts)u!==null&&e.shaderParts.set(c,u.trim().replace(/^#/,`
#`));this.skipRendering=t===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=ar){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,i,r){for(const s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i*this.timeScale,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(const i of this.effects)i.initialize(e,t,n);this.updateMaterial(),n!==void 0&&n!==yn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){e.type==="change"&&this.recompile()}}class R_ extends Ln{constructor({kernelSize:e=Y0,resolutionScale:t=.5,width:n=Yn.AUTO_SIZE,height:i=Yn.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}={}){super("KawaseBlurPass"),this.renderTargetA=new Rt(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const c=this.resolution=new Yn(this,r,s,t);c.addEventListener("change",u=>this.setSize(c.baseWidth,c.baseHeight)),this._blurMaterial=new VD,this._blurMaterial.kernelSize=e,this.copyMaterial=new __}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(e){this._blurMaterial=e}get dithering(){return this.copyMaterial.dithering}set dithering(e){this.copyMaterial.dithering=e}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(e){this.blurMaterial.kernelSize=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){const s=this.scene,c=this.camera,u=this.renderTargetA,d=this.renderTargetB,p=this.blurMaterial,f=p.kernelSequence;let g=t;this.fullscreenMaterial=p;for(let v=0,b=f.length;v<b;++v){const y=1&v?d:u;p.kernel=f[v],p.inputBuffer=g.texture,e.setRenderTarget(y),e.render(s,c),g=y}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=g.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(s,c)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(e,t)}initialize(e,t,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==yn?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):Xa(e)===Vt&&(Ci(this.renderTargetA.texture,Vt),Ci(this.renderTargetB.texture,Vt)))}static get AUTO_SIZE(){return Yn.AUTO_SIZE}}class L_ extends Ln{constructor({renderTarget:e,luminanceRange:t,colorOutput:n,resolutionScale:i=1,width:r=Yn.AUTO_SIZE,height:s=Yn.AUTO_SIZE,resolutionX:c=r,resolutionY:u=s}={}){super("LuminancePass"),this.fullscreenMaterial=new YD(n,t),this.needsSwap=!1,this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new Rt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const d=this.resolution=new Yn(this,c,u,i);d.addEventListener("change",p=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){n!==void 0&&n!==yn&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}class i5 extends Ln{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Q0(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,i,r){const s=e.getContext(),c=e.state.buffers,u=this.scene,d=this.camera,p=this.clearPass,f=this.inverted?0:1,g=1-f;c.color.setMask(!1),c.depth.setMask(!1),c.color.setLocked(!0),c.depth.setLocked(!0),c.stencil.setTest(!0),c.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),c.stencil.setFunc(s.ALWAYS,f,4294967295),c.stencil.setClear(g),c.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(e,null):(p.render(e,t),p.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(u,d)):(e.setRenderTarget(t),e.render(u,d),e.setRenderTarget(n),e.render(u,d)),c.color.setLocked(!1),c.depth.setLocked(!1),c.stencil.setLocked(!1),c.stencil.setFunc(s.EQUAL,1,4294967295),c.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),c.stencil.setLocked(!0)}}class r5 extends Ln{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Rt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new XD,this.upsamplingMaterial=new ZD,this.resolution=new ce}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(e){if(this.levels!==e){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<e;++n){const i=t.clone();i.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(i)}this.upsamplingMipmaps.push(t);for(let n=1,i=e-1;n<i;++n){const r=t.clone();r.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(r)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(e){this.upsamplingMaterial.radius=e}render(e,t,n,i,r){const{scene:s,camera:c}=this,{downsamplingMaterial:u,upsamplingMaterial:d}=this,{downsamplingMipmaps:p,upsamplingMipmaps:f}=this;let g=t;this.fullscreenMaterial=u;for(let v=0,b=p.length;v<b;++v){const y=p[v];u.setSize(g.width,g.height),u.inputBuffer=g.texture,e.setRenderTarget(y),e.render(s,c),g=y}this.fullscreenMaterial=d;for(let v=f.length-1;v>=0;--v){const b=f[v];d.setSize(g.width,g.height),d.inputBuffer=g.texture,d.supportBuffer=p[v].texture,e.setRenderTarget(b),e.render(s,c),g=b}}setSize(e,t){const n=this.resolution;n.set(e,t);let i=n.width,r=n.height;for(let s=0,c=this.downsamplingMipmaps.length;s<c;++s)i=Math.round(.5*i),r=Math.round(.5*r),this.downsamplingMipmaps[s].setSize(i,r),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(i,r)}initialize(e,t,n){if(n!==void 0){const i=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const r of i)r.texture.type=n;if(n!==yn)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(Xa(e)===Vt)for(const r of i)Ci(r.texture,Vt)}}dispose(){super.dispose();for(const e of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))e.dispose()}}class Ya extends Ln{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.input=t}setInput(e){this.input=e}render(e,t,n,i,r){const s=this.fullscreenMaterial.uniforms;t!==null&&s!==void 0&&s[this.input]!==void 0&&(s[this.input].value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){n!==void 0&&n!==yn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}const K0=.001;class a5{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*K0}get fixedDelta(){return this._fixedDelta*K0}set fixedDelta(e){this._fixedDelta=1e3*e}get elapsed(){return this._elapsed*K0}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(e!==void 0?e:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(e){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}}class s5{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new w_,this.depthTexture=null,this.passes=[],this.timer=new a5,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new ce),n=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===yn&&Xa(e)===Vt&&(Ci(this.inputBuffer.texture,Vt),Ci(this.outputBuffer.texture,Vt),this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const r of this.passes)r.initialize(e,n,i)}}replaceRenderer(e,t=!0){const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(n.domElement),i.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new Ec;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Ea,e.type=Wr):e.type=Vr,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,i){const r=this.renderer,s=r===null?new ce:r.getDrawingBufferSize(new ce),c={minFilter:rt,magFilter:rt,stencilBuffer:t,depthBuffer:e,type:n},u=new Rt(s.width,s.height,c);return i>0&&(u.ignoreDepthForMultisampleCopy=!1,u.samples=i),n===yn&&Xa(r)===Vt&&Ci(u.texture,Vt),u.texture.name="EffectComposer.Buffer",u.texture.generateMipmaps=!1,u}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new ce),s=i.getContext().getContextAttributes().alpha,c=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(r.width,r.height),e.initialize(i,s,c),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const u=this.createDepthTexture();for(e of n)e.setDepthTexture(u)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const i=(r,s)=>r||s.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let i,r,s,c=this.inputBuffer,u=this.outputBuffer,d=!1;e===void 0&&(this.timer.update(),e=this.timer.delta);let p=null;for(let f=this.passes.length;f--;)if(this.passes[f].enabled){p=this.passes[f];break}for(const f of this.passes)f.enabled&&(this.autoRenderToScreen&&(f.renderToScreen=f===p),f.render(t,c,u,e,d),f.needsSwap&&(d&&(n.renderToScreen=f.renderToScreen,i=t.getContext(),r=t.state.buffers.stencil,r.setFunc(i.NOTEQUAL,1,4294967295),n.render(t,c,u,e,d),r.setFunc(i.EQUAL,1,4294967295)),s=c,c=u,u=s),f instanceof i5?d=!0:f instanceof $D&&(d=!1))}setSize(e,t,n){const i=this.renderer,r=i.getSize(new ce);e!==void 0&&t!==void 0||(e=r.width,t=r.height),r.width===e&&r.height===t||i.setSize(e,t,n);const s=i.getDrawingBufferSize(new ce);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const c of this.passes)c.setSize(s.width,s.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}}class o5{constructor(){this.shaderParts=new Map([[Lt.FRAGMENT_HEAD,null],[Lt.FRAGMENT_MAIN_UV,null],[Lt.FRAGMENT_MAIN_IMAGE,null],[Lt.VERTEX_HEAD,null],[Lt.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=b_,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Bd}}class l5 extends Set{constructor(e,t=10){super(),this.l=t,this.exclusive=!1,e!==void 0&&this.set(e)}get layer(){return this.l}set layer(e){const t=this.l;for(const n of this)n.layers.disable(t),n.layers.enable(e);this.l=e}getLayer(){return this.layer}setLayer(e){this.layer=e}isExclusive(){return this.exclusive}setExclusive(e){this.exclusive=e}clear(){const e=this.layer;for(const t of this)t.layers.disable(e);return super.clear()}set(e){this.clear();for(const t of e)this.add(t);return this}indexOf(e){return this.has(e)?0:-1}add(e){return this.exclusive?e.layers.set(this.layer):e.layers.enable(this.layer),super.add(e)}delete(e){return this.has(e)&&e.layers.disable(this.layer),super.delete(e)}toggle(e){let t;return this.has(e)?(this.delete(e),t=!1):(this.add(e),t=!0),t}setVisible(e){for(const t of this)e?t.layers.enable(0):t.layers.disable(0);return this}}const c5=new Map([[V0,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x + y, opacity);\r
\r
}\r
`],[uD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y, min(y.a, opacity));\r
\r
}\r
`],[hD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, (x + y) * 0.5, opacity);\r
\r
}\r
`],[dD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(yHSL.rg, xHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[pD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(step(0.0, y) * (1.0 - min(vec4(1.0), (1.0 - x) / y)), vec4(1.0), step(1.0, x));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[fD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = step(0.0, x) * mix(min(vec4(1.0), x / max(1.0 - y, 1e-9)), vec4(1.0), step(1.0, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[mD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, min(x, y), opacity);\r
\r
}\r
`],[gD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, abs(x - y), opacity);\r
\r
}\r
`],[vD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x / max(y, 1e-12), opacity);\r
\r
}\r
`],[g_,null],[yD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, (x + y - 2.0 * x * y), opacity);\r
\r
}\r
`],[xD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 a = min(x, 1.0), b = min(y, 1.0);\r
	vec4 z = mix(2.0 * a * b, 1.0 - 2.0 * (1.0 - a) * (1.0 - b), step(0.5, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[bD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, step(1.0, x + y), opacity);\r
\r
}\r
`],[SD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(yHSL.r, xHSL.gb));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[_D,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, 1.0 - y, opacity);\r
\r
}\r
`],[wD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y * (1.0 - x), opacity);\r
\r
}\r
`],[MD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, max(x, y), opacity);\r
\r
}\r
`],[TD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, clamp(y + x - 1.0, 0.0, 1.0), opacity);\r
\r
}\r
`],[ED,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, min(x + y, 1.0), opacity);\r
\r
}\r
`],[AD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, clamp(2.0 * y + x - 1.0, 0.0, 1.0), opacity);\r
\r
}\r
`],[RD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(xHSL.rg, yHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[LD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x * y, opacity);\r
\r
}\r
`],[PD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, 1.0 - abs(1.0 - x - y), opacity);\r
\r
}\r
`],[v_,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, y, opacity);\r
\r
}\r
`],[CD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(2.0 * y * x, 1.0 - 2.0 * (1.0 - y) * (1.0 - x), step(0.5, x));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[DD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 y2 = 2.0 * y;\r
\r
	vec4 z = mix(\r
		mix(y2, x, step(0.5 * x, y)),\r
		max(vec4(0.0), y2 - 1.0), \r
		step(x, (y2 - 1.0))\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`],[OD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(min(x * x / max(1.0 - y, 1e-12), 1.0), y, step(1.0, y));\r
	return mix(x, z, opacity);\r
\r
}\r
`],[ID,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec3 xHSL = RGBToHSL(x.rgb);\r
	vec3 yHSL = RGBToHSL(y.rgb);\r
	vec3 z = HSLToRGB(vec3(xHSL.r, yHSL.g, xHSL.b));\r
	return vec4(mix(x.rgb, z, opacity), y.a);\r
\r
}\r
`],[y_,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, x + y - min(x * y, 1.0), opacity);\r
\r
}\r
`],[ND,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 y2 = 2.0 * y;\r
	vec4 w = step(0.5, y);\r
\r
	vec4 z = mix(\r
		x - (1.0 - y2) * x * (1.0 - x), \r
		mix(\r
			x + (y2 - 1.0) * (sqrt(x) - x),\r
			x + (y2 - 1.0) * x * ((16.0 * x - 12.0) * x + 3.0),\r
			w * (1.0 - step(0.25, x))\r
		),\r
		w\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`],[W0,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return y;\r
\r
}\r
`],[kD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	return mix(x, max(x + y - 1.0, 0.0), opacity);\r
\r
}\r
`],[FD,`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\r
\r
	vec4 z = mix(\r
		max(1.0 - min((1.0 - x) / (2.0 * y), 1.0), 0.0),\r
		min(x / (2.0 * (1.0 - y)), 1.0),\r
		step(0.5, y)\r
	);\r
\r
	return mix(x, z, opacity);\r
\r
}\r
`]]);class u5 extends zi{constructor(e,t=1){super(),this._blendFunction=e,this.opacity=new He(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return c5.get(this.blendFunction)}}class El extends zi{constructor(e,t,{attributes:n=b_,blendFunction:i=v_,defines:r=new Map,uniforms:s=new Map,extensions:c=null,vertexShader:u=null}={}){super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=u,this.defines=r,this.uniforms=s,this.extensions=c,this.blendMode=new u5(i),this.blendMode.addEventListener("change",d=>this.setChanged()),this._inputColorSpace=Bd,this._outputColorSpace=""}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=ar){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Rt||t instanceof on||t instanceof Ut||t instanceof Ln)&&this[e].dispose()}}}class P_ extends El{constructor({blendFunction:e=y_,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,mipmapBlur:i=!1,intensity:r=1,radius:s=.85,levels:c=8,kernelSize:u=BD,resolutionScale:d=.5,width:p=Yn.AUTO_SIZE,height:f=Yn.AUTO_SIZE,resolutionX:g=p,resolutionY:v=f}={}){super("BloomEffect",`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D map;\r
\r
#else\r
\r
	uniform lowp sampler2D map;\r
\r
#endif\r
\r
uniform float intensity;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	outputColor = texture2D(map, uv) * intensity;\r
\r
}\r
`,{blendFunction:e,uniforms:new Map([["map",new He(null)],["intensity",new He(r)]])}),this.renderTarget=new Rt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new R_({kernelSize:u}),this.luminancePass=new L_({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new r5,this.mipmapBlurPass.enabled=i,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=c,this.uniforms.get("map").value=i?this.mipmapBlurPass.texture:this.renderTarget.texture;const b=this.resolution=new Yn(this,g,v,d);b.addEventListener("change",y=>this.setSize(b.baseWidth,b.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){const i=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(e,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,r.renderTarget):this.blurPass.render(e,r.renderTarget,i)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,t):this.blurPass.render(e,t,i)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(e,t),this.mipmapBlurPass.setSize(e,t)}initialize(e,t,n){this.blurPass.initialize(e,t,n),this.luminancePass.initialize(e,t,n),this.mipmapBlurPass.initialize(e,t,n),n!==void 0&&(this.renderTarget.texture.type=n,Xa(e)===Vt&&Ci(this.renderTarget.texture,Vt))}}class h5 extends El{constructor({offset:e=new ce(.001,5e-4),radialModulation:t=!1,modulationOffset:n=.15}={}){super("ChromaticAberrationEffect",`#ifdef RADIAL_MODULATION\r
\r
	uniform float modulationOffset;\r
\r
#endif\r
\r
varying float vActive;\r
varying vec2 vUvR;\r
varying vec2 vUvB;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	vec2 ra = inputColor.ra;\r
	vec2 ba = inputColor.ba;\r
\r
	#ifdef RADIAL_MODULATION\r
\r
		const vec2 center = vec2(0.5);\r
		float d = distance(uv, center) * 2.0;\r
		d = max(d - modulationOffset, 0.0);\r
\r
		if(vActive > 0.0 && d > 0.0) {\r
\r
			ra = texture2D(inputBuffer, mix(uv, vUvR, d)).ra;\r
			ba = texture2D(inputBuffer, mix(uv, vUvB, d)).ba;\r
\r
		}\r
\r
	#else\r
\r
		if(vActive > 0.0) {\r
\r
			ra = texture2D(inputBuffer, vUvR).ra;\r
			ba = texture2D(inputBuffer, vUvB).ba;\r
\r
		}\r
\r
	#endif\r
\r
	outputColor = vec4(ra.x, inputColor.g, ba.x, max(max(ra.y, ba.y), inputColor.a));\r
\r
}\r
`,{vertexShader:`uniform vec2 offset;\r
\r
varying float vActive;\r
varying vec2 vUvR;\r
varying vec2 vUvB;\r
\r
void mainSupport(const in vec2 uv) {\r
\r
	vec2 shift = offset * vec2(1.0, aspect);\r
	vActive = (shift.x != 0.0 || shift.y != 0.0) ? 1.0 : 0.0;\r
	vUvR = uv + shift;\r
	vUvB = uv - shift;\r
\r
}\r
`,attributes:q0,uniforms:new Map([["offset",new He(e)],["modulationOffset",new He(n)]])}),this.radialModulation=t}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(e){e?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(e){this.uniforms.get("modulationOffset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}}class d5 extends El{constructor(e,{blendFunction:t,worldFocusDistance:n,worldFocusRange:i,focusDistance:r=0,focalLength:s=.1,focusRange:c=s,bokehScale:u=1,resolutionScale:d=1,width:p=Yn.AUTO_SIZE,height:f=Yn.AUTO_SIZE,resolutionX:g=p,resolutionY:v=f}={}){super("DepthOfFieldEffect",`#ifdef FRAMEBUFFER_PRECISION_HIGH\r
\r
	uniform mediump sampler2D nearColorBuffer;\r
	uniform mediump sampler2D farColorBuffer;\r
\r
#else\r
\r
	uniform lowp sampler2D nearColorBuffer;\r
	uniform lowp sampler2D farColorBuffer;\r
\r
#endif\r
\r
uniform lowp sampler2D nearCoCBuffer;\r
uniform float scale;\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, const in float depth, out vec4 outputColor) {\r
\r
	vec4 colorNear = texture2D(nearColorBuffer, uv);\r
	vec4 colorFar = texture2D(farColorBuffer, uv);\r
\r
	float cocNear = texture2D(nearCoCBuffer, uv).r;\r
	cocNear = min(cocNear * scale, 1.0);\r
\r
	// The far color buffer has been premultiplied with the CoC buffer.\r
	vec4 result = inputColor * (1.0 - colorFar.a) + colorFar;\r
	result = mix(result, colorNear, cocNear);\r
\r
	outputColor = result;\r
\r
}\r
`,{blendFunction:t,attributes:eu,uniforms:new Map([["nearColorBuffer",new He(null)],["farColorBuffer",new He(null)],["nearCoCBuffer",new He(null)],["scale",new He(1)]])}),this.camera=e,this.renderTarget=new Rt(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Ya(new cD(e));const b=this.cocMaterial;b.focusDistance=r,b.focusRange=c,n!==void 0&&(b.worldFocusDistance=n),i!==void 0&&(b.worldFocusRange=i),this.blurPass=new R_({resolutionScale:d,resolutionX:g,resolutionY:v,kernelSize:Y0}),this.maskPass=new Ya(new QD(this.renderTargetCoC.texture));const y=this.maskPass.fullscreenMaterial;y.maskFunction=S_,y.colorChannel=zD,this.bokehNearBasePass=new Ya(new zd(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Ya(new zd(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Ya(new zd(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Ya(new zd(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const S=this.resolution=new Yn(this,g,v,d);S.addEventListener("change",M=>this.setSize(S.baseWidth,S.baseHeight)),this.bokehScale=u}set mainCamera(e){this.camera=e,this.cocMaterial.copyCameraSettings(e)}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){this.bokehNearBasePass.fullscreenMaterial.scale=e,this.bokehNearFillPass.fullscreenMaterial.scale=e,this.bokehFarBasePass.fullscreenMaterial.scale=e,this.bokehFarFillPass.fullscreenMaterial.scale=e,this.maskPass.fullscreenMaterial.strength=e,this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){const t=this.camera;return G0(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e,t=ar){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,n){const i=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,c=this.renderTargetMasked;if(this.target!==null){const u=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=u}this.cocPass.render(e,null,r),this.blurPass.render(e,r,s),this.maskPass.render(e,t,c),this.bokehFarBasePass.render(e,c,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const i=n.width,r=n.height;this.cocPass.setSize(e,t),this.blurPass.setSize(e,t),this.maskPass.setSize(e,t),this.renderTargetCoC.setSize(e,t),this.renderTargetMasked.setSize(e,t),this.renderTarget.setSize(i,r),this.renderTargetNear.setSize(i,r),this.renderTargetFar.setSize(i,r),this.renderTargetCoCBlurred.setSize(i,r),this.bokehNearBasePass.fullscreenMaterial.setSize(e,t),this.bokehNearFillPass.fullscreenMaterial.setSize(e,t),this.bokehFarBasePass.fullscreenMaterial.setSize(e,t),this.bokehFarFillPass.fullscreenMaterial.setSize(e,t)}initialize(e,t,n){this.cocPass.initialize(e,t,n),this.maskPass.initialize(e,t,n),this.bokehNearBasePass.initialize(e,t,n),this.bokehNearFillPass.initialize(e,t,n),this.bokehFarBasePass.initialize(e,t,n),this.bokehFarFillPass.initialize(e,t,n),this.blurPass.initialize(e,t,yn),this.maskPass.fullscreenMaterial.maskFunction=t?S_:jD,n!==void 0&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,Xa(e)===Vt&&(Ci(this.renderTarget.texture,Vt),Ci(this.renderTargetNear.texture,Vt),Ci(this.renderTargetFar.texture,Vt),Ci(this.renderTargetMasked.texture,Vt)))}}class p5 extends El{constructor({blendFunction:e=W0}={}){super("FXAAEffect",`/**\r
 * FXAA 3.11 by Timothy Lottes\r
 *\r
 * Copyright (c) 2011, NVIDIA CORPORATION. All rights reserved.\r
 *\r
 * TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THIS SOFTWARE IS PROVIDED "AS IS" AND NVIDIA AND ITS SUPPLIERS\r
 * DISCLAIM ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF\r
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL NVIDIA OR ITS SUPPLIERS BE LIABLE FOR ANY\r
 * SPECIAL, INCIDENTAL, INDIRECT, OR CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS\r
 * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY OTHER PECUNIARY LOSS) ARISING OUT OF\r
 * THE USE OF OR INABILITY TO USE THIS SOFTWARE, EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\r
 */\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))\r
#define ONE_OVER_TWELVE 0.08333333333333333\r
\r
varying vec2 vUvDown;\r
varying vec2 vUvUp;\r
varying vec2 vUvLeft;\r
varying vec2 vUvRight;\r
\r
varying vec2 vUvDownLeft;\r
varying vec2 vUvUpRight;\r
varying vec2 vUvUpLeft;\r
varying vec2 vUvDownRight;\r
\r
vec4 fxaa(const in vec4 inputColor, const in vec2 uv) {\r
\r
	// Luma at the current fragment.\r
	float lumaCenter = luminance(inputColor.rgb);\r
\r
	// Luma at the four direct neighbours of the current fragment.\r
	float lumaDown = luminance(texture2D(inputBuffer, vUvDown).rgb);\r
	float lumaUp = luminance(texture2D(inputBuffer, vUvUp).rgb);\r
	float lumaLeft = luminance(texture2D(inputBuffer, vUvLeft).rgb);\r
	float lumaRight = luminance(texture2D(inputBuffer, vUvRight).rgb);\r
\r
	// Find the maximum and minimum luma around the current fragment.\r
	float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));\r
	float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));\r
\r
	// Compute the delta.\r
	float lumaRange = lumaMax - lumaMin;\r
\r
	// Skip AA if the luma variation is lower than a threshold (low contrast or dark area).\r
	if(lumaRange < max(EDGE_THRESHOLD_MIN, lumaMax * EDGE_THRESHOLD_MAX)) {\r
\r
		return inputColor;\r
\r
	}\r
\r
	// Query the 4 remaining corners lumas.\r
	float lumaDownLeft = luminance(texture2D(inputBuffer, vUvDownLeft).rgb);\r
	float lumaUpRight = luminance(texture2D(inputBuffer, vUvUpRight).rgb);\r
	float lumaUpLeft = luminance(texture2D(inputBuffer, vUvUpLeft).rgb);\r
	float lumaDownRight = luminance(texture2D(inputBuffer, vUvDownRight).rgb);\r
\r
	// Combine the four edges lumas (using intermediary variables for future computations with the same values).\r
	float lumaDownUp = lumaDown + lumaUp;\r
	float lumaLeftRight = lumaLeft + lumaRight;\r
\r
	// Same for corners.\r
	float lumaLeftCorners = lumaDownLeft + lumaUpLeft;\r
	float lumaDownCorners = lumaDownLeft + lumaDownRight;\r
	float lumaRightCorners = lumaDownRight + lumaUpRight;\r
	float lumaUpCorners = lumaUpRight + lumaUpLeft;\r
\r
	// Compute an estimation of the gradient along the horizontal and vertical axis.\r
	float edgeHorizontal = (\r
		abs(-2.0 * lumaLeft + lumaLeftCorners) +\r
		abs(-2.0 * lumaCenter + lumaDownUp ) * 2.0 +\r
		abs(-2.0 * lumaRight + lumaRightCorners)\r
	);\r
\r
	float edgeVertical = (\r
		abs(-2.0 * lumaUp + lumaUpCorners) +\r
		abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 +\r
		abs(-2.0 * lumaDown + lumaDownCorners)\r
	);\r
\r
	// Check if the local edge is horizontal or vertical.\r
	bool isHorizontal = (edgeHorizontal >= edgeVertical);\r
\r
	// Choose the step size (one pixel) accordingly.\r
	float stepLength = isHorizontal ? texelSize.y : texelSize.x;\r
\r
	// Select the two neighboring texels' lumas in the opposite direction to the local edge.\r
	float luma1 = isHorizontal ? lumaDown : lumaLeft;\r
	float luma2 = isHorizontal ? lumaUp : lumaRight;\r
\r
	// Compute gradients in this direction.\r
	float gradient1 = abs(luma1 - lumaCenter);\r
	float gradient2 = abs(luma2 - lumaCenter);\r
\r
	// Check which direction is the steepest.\r
	bool is1Steepest = gradient1 >= gradient2;\r
\r
	// Gradient in the corresponding direction, normalized.\r
	float gradientScaled = 0.25 * max(gradient1, gradient2);\r
\r
	// Average luma in the correct direction.\r
	float lumaLocalAverage = 0.0;\r
\r
	if(is1Steepest) {\r
\r
		// Switch the direction.\r
		stepLength = -stepLength;\r
		lumaLocalAverage = 0.5 * (luma1 + lumaCenter);\r
\r
	} else {\r
\r
		lumaLocalAverage = 0.5 * (luma2 + lumaCenter);\r
\r
	}\r
\r
	// Shift UV in the correct direction by half a pixel.\r
	vec2 currentUv = uv;\r
\r
	if(isHorizontal) {\r
\r
		currentUv.y += stepLength * 0.5;\r
\r
	} else {\r
\r
		currentUv.x += stepLength * 0.5;\r
\r
	}\r
\r
	// Compute offset (for each iteration step) in the right direction.\r
	vec2 offset = isHorizontal ? vec2(texelSize.x, 0.0) : vec2(0.0, texelSize.y);\r
\r
	// Compute UVs to explore on each side of the edge, orthogonally. The QUALITY allows us to step faster.\r
	vec2 uv1 = currentUv - offset * QUALITY(0);\r
	vec2 uv2 = currentUv + offset * QUALITY(0);\r
\r
	// Read lumas at both extremities of the exploration segment, and compute the delta w.r.t. the local average luma.\r
	float lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\r
	float lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\r
	lumaEnd1 -= lumaLocalAverage;\r
	lumaEnd2 -= lumaLocalAverage;\r
\r
	// If the deltas at the current extremities are larger than the local gradient, the side of the edge has been reached.\r
	bool reached1 = abs(lumaEnd1) >= gradientScaled;\r
	bool reached2 = abs(lumaEnd2) >= gradientScaled;\r
	bool reachedBoth = reached1 && reached2;\r
\r
	// If the side has not been reached, continue to explore in this direction.\r
	if(!reached1) {\r
\r
		uv1 -= offset * QUALITY(1);\r
\r
	}\r
\r
	if(!reached2) {\r
\r
		uv2 += offset * QUALITY(1);\r
\r
	}\r
\r
	// If both sides have not been reached, continue to explore.\r
	if(!reachedBoth) {\r
\r
		for(int i = 2; i < SAMPLES; ++i) {\r
\r
			// If needed, read luma in 1st direction, compute delta.\r
			if(!reached1) {\r
\r
				lumaEnd1 = luminance(texture2D(inputBuffer, uv1).rgb);\r
				lumaEnd1 = lumaEnd1 - lumaLocalAverage;\r
\r
			}\r
\r
			// If needed, read luma in opposite direction, compute delta.\r
			if(!reached2) {\r
\r
				lumaEnd2 = luminance(texture2D(inputBuffer, uv2).rgb);\r
				lumaEnd2 = lumaEnd2 - lumaLocalAverage;\r
\r
			}\r
\r
			// If the deltas are larger than the local gradient, the side of the edge has been reached.\r
			reached1 = abs(lumaEnd1) >= gradientScaled;\r
			reached2 = abs(lumaEnd2) >= gradientScaled;\r
			reachedBoth = reached1 && reached2;\r
			\r
			// If the side has not been reached, continue to explore in this direction, with dynamic quality.\r
			if(!reached1) {\r
\r
				uv1 -= offset * QUALITY(i);\r
\r
			}\r
\r
			if(!reached2) {\r
\r
				uv2 += offset * QUALITY(i);\r
\r
			}\r
\r
			// If both sides have been reached, stop the exploration.\r
			if(reachedBoth) {\r
\r
				break;\r
\r
			}\r
\r
		}\r
\r
	}\r
\r
	// Compute the distances to each side edge of the edge (!).\r
	float distance1 = isHorizontal ? (uv.x - uv1.x) : (uv.y - uv1.y);\r
	float distance2 = isHorizontal ? (uv2.x - uv.x) : (uv2.y - uv.y);\r
\r
	// Check in which direction the side of the edge is closer.\r
	bool isDirection1 = distance1 < distance2;\r
	float distanceFinal = min(distance1, distance2);\r
\r
	// Thickness of the edge.\r
	float edgeThickness = (distance1 + distance2);\r
\r
	// Check if the luma at the center is smaller than the local average.\r
	bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;\r
\r
	// If the luma is smaller than at its neighbour, the delta luma at each end should be positive (same variation).\r
	bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;\r
	bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;\r
\r
	// Only keep the result in the direction of the closer side of the edge.\r
	bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;\r
\r
	// UV offset: read in the direction of the closest side of the edge.\r
	float pixelOffset = -distanceFinal / edgeThickness + 0.5;\r
\r
	// If the luma variation is incorrect, do not offset.\r
	float finalOffset = correctVariation ? pixelOffset : 0.0;\r
\r
	// Sub-Pixel Shifting\r
	// Full weighted average of the luma over the 3x3 neighborhood.\r
	float lumaAverage = ONE_OVER_TWELVE * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);\r
	// Ratio of the delta between the global average and the center luma, over the luma range in the 3x3 neighborhood.\r
	float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);\r
	float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;\r
	// Compute a sub-pixel offset based on this delta.\r
	float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * SUBPIXEL_QUALITY;\r
\r
	// Pick the biggest of the two offsets.\r
	finalOffset = max(finalOffset, subPixelOffsetFinal);\r
\r
	// Compute the final UV coordinates.\r
	vec2 finalUv = uv;\r
\r
	if(isHorizontal) {\r
\r
		finalUv.y += finalOffset * stepLength;\r
\r
	} else {\r
\r
		finalUv.x += finalOffset * stepLength;\r
\r
	}\r
\r
	return texture2D(inputBuffer, finalUv);\r
\r
}\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	outputColor = fxaa(inputColor, uv);\r
\r
}\r
`,{vertexShader:`varying vec2 vUvDown;\r
varying vec2 vUvUp;\r
varying vec2 vUvLeft;\r
varying vec2 vUvRight;\r
\r
varying vec2 vUvDownLeft;\r
varying vec2 vUvUpRight;\r
varying vec2 vUvUpLeft;\r
varying vec2 vUvDownRight;\r
\r
void mainSupport(const in vec2 uv) {\r
\r
	vUvDown = uv + vec2(0.0, -1.0) * texelSize;\r
	vUvUp = uv + vec2(0.0, 1.0) * texelSize;\r
	vUvRight = uv + vec2(1.0, 0.0) * texelSize;\r
	vUvLeft = uv + vec2(-1.0, 0.0) * texelSize;\r
\r
	vUvDownLeft = uv + vec2(-1.0, -1.0) * texelSize;\r
	vUvUpRight = uv + vec2(1.0, 1.0) * texelSize;\r
	vUvUpLeft = uv + vec2(-1.0, 1.0) * texelSize;\r
	vUvDownRight = uv + vec2(1.0, -1.0) * texelSize;\r
\r
}\r
`,blendFunction:e,defines:new Map([["EDGE_THRESHOLD_MIN","0.0312"],["EDGE_THRESHOLD_MAX","0.125"],["SUBPIXEL_QUALITY","0.75"],["SAMPLES","12"]])})}get minEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MIN"))}set minEdgeThreshold(e){this.defines.set("EDGE_THRESHOLD_MIN",e.toFixed(12)),this.setChanged()}get maxEdgeThreshold(){return Number(this.defines.get("EDGE_THRESHOLD_MAX"))}set maxEdgeThreshold(e){this.defines.set("EDGE_THRESHOLD_MAX",e.toFixed(12)),this.setChanged()}get subpixelQuality(){return Number(this.defines.get("SUBPIXEL_QUALITY"))}set subpixelQuality(e){this.defines.set("SUBPIXEL_QUALITY",e.toFixed(12)),this.setChanged()}get samples(){return Number(this.defines.get("SAMPLES"))}set samples(e){this.defines.set("SAMPLES",e.toFixed(0)),this.setChanged()}}new C,new De,new Pe,new C,new C;class f5 extends P_{constructor(e,t,n){super(n),this.setAttributes(this.getAttributes()|eu),this.camera=t,this.depthPass=new e5(e,t),this.clearPass=new Q0(!0,!1,!1),this.clearPass.overrideClearColor=new Pe(0),this.depthMaskPass=new Ya(new WD);const i=this.depthMaskMaterial;i.copyCameraSettings(t),i.depthBuffer1=this.depthPass.texture,i.depthPacking1=ph,i.depthMode=ac,this.renderTargetMasked=new Rt(1,1,{depthBuffer:!1}),this.renderTargetMasked.texture.name="Bloom.Masked",this.selection=new l5,this.selection.layer=11,this._inverted=!1,this._ignoreBackground=!1}set mainScene(e){this.depthPass.mainScene=e}set mainCamera(e){this.camera=e,this.depthPass.mainCamera=e,this.depthMaskMaterial.copyCameraSettings(e)}getSelection(){return this.selection}get depthMaskMaterial(){return this.depthMaskPass.fullscreenMaterial}get inverted(){return this._inverted}set inverted(e){this._inverted=e,this.depthMaskMaterial.depthMode=e?nh:ac}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get ignoreBackground(){return this._ignoreBackground}set ignoreBackground(e){this._ignoreBackground=e,this.depthMaskMaterial.maxDepthStrategy=e?x_:X0}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}setDepthTexture(e,t=ar){this.depthMaskMaterial.depthBuffer0=e,this.depthMaskMaterial.depthPacking0=t}update(e,t,n){const i=this.camera,r=this.selection,s=this.inverted;let c=t;if(this.ignoreBackground||!s||r.size>0){const u=i.layers.mask;i.layers.set(r.layer),this.depthPass.render(e),i.layers.mask=u,c=this.renderTargetMasked,this.clearPass.render(e,c),this.depthMaskPass.render(e,t,c)}super.update(e,c,n)}setSize(e,t){super.setSize(e,t),this.renderTargetMasked.setSize(e,t),this.depthPass.setSize(e,t)}initialize(e,t,n){super.initialize(e,t,n),this.clearPass.initialize(e,t,n),this.depthPass.initialize(e,t,n),this.depthMaskPass.initialize(e,t,n),n!==void 0&&(this.renderTargetMasked.texture.type=n,Xa(e)===Vt&&Ci(this.renderTargetMasked.texture,Vt))}}class m5 extends El{constructor({blendFunction:e=W0,adaptive:t=!0,mode:n=t?fr.REINHARD2_ADAPTIVE:fr.REINHARD2,resolution:i=256,maxLuminance:r=16,whitePoint:s=r,middleGrey:c=.6,minLuminance:u=.01,averageLuminance:d=1,adaptationRate:p=1}={}){super("ToneMappingEffect",`#include <tonemapping_pars_fragment>\r
\r
#if THREE_REVISION < 143\r
\r
	#define luminance(v) linearToRelativeLuminance(v)\r
\r
#endif\r
\r
uniform lowp sampler2D luminanceBuffer;\r
uniform float whitePoint;\r
uniform float middleGrey;\r
\r
#if TONE_MAPPING_MODE != 2\r
\r
	uniform float averageLuminance;\r
\r
#endif\r
\r
vec3 Reinhard2ToneMapping(vec3 color) {\r
\r
	color *= toneMappingExposure;\r
\r
	// Calculate the luminance of the current pixel.\r
	float l = luminance(color);\r
\r
	#if TONE_MAPPING_MODE == 2\r
\r
		// Get the average luminance from the adaptive 1x1 buffer.\r
		float lumAvg = unpackRGBAToFloat(texture2D(luminanceBuffer, vec2(0.5)));\r
\r
	#else\r
\r
		float lumAvg = averageLuminance;\r
\r
	#endif\r
\r
	float lumScaled = (l * middleGrey) / max(lumAvg, 1e-6);\r
	float lumCompressed = lumScaled * (1.0 + lumScaled / (whitePoint * whitePoint));\r
	lumCompressed /= (1.0 + lumScaled);\r
\r
	return clamp(lumCompressed * color, 0.0, 1.0);\r
\r
}\r
\r
void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {\r
\r
	#if TONE_MAPPING_MODE == 1 || TONE_MAPPING_MODE == 2\r
\r
		outputColor = vec4(Reinhard2ToneMapping(inputColor.rgb), inputColor.a);\r
\r
	#else\r
\r
		outputColor = vec4(toneMapping(inputColor.rgb), inputColor.a);\r
\r
	#endif\r
\r
}\r
`,{blendFunction:e,uniforms:new Map([["luminanceBuffer",new He(null)],["maxLuminance",new He(r)],["whitePoint",new He(s)],["middleGrey",new He(c)],["averageLuminance",new He(d)]])}),this.renderTargetLuminance=new Rt(1,1,{minFilter:ir,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new L_({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new JD(this.luminancePass.texture,{minLuminance:u,adaptationRate:p}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=i,this.mode=n}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode!==e){switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case fr.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case fr.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)","OptimizedCineonToneMapping(texel)");break;case fr.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel")}this.adaptiveLuminancePass.enabled=e===fr.REINHARD2_ADAPTIVE,this.setChanged()}}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),n=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(n,n),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===fr.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?fr.REINHARD2_ADAPTIVE:fr.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,n){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,n))}initialize(e,t,n){this.adaptiveLuminancePass.initialize(e,t,n)}}class io extends qn{constructor(){super(...arguments);N(this,"_composer");N(this,"_effects",[]);N(this,"_effectPass",null);N(this,"_effectsNeedUpdate",!1)}onLoad({depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r=di}){this._composer=new s5(this.viewer.renderer,{depthBuffer:t,stencilBuffer:n,multisampling:i,frameBufferType:r}),this._composer.addPass(new E_(this.viewer.scene,this.viewer.camera))}onDestroy(){this._composer.dispose()}onEnable(){let t=this.viewer.getPlugin(Rd);t&&(t.enabled=!1),this.viewer.on(Rn.RESIZE,this.onResize,this)}onDisable(){let t=this.viewer.getPlugin(Rd);t&&(t.enabled=!0),this.viewer.off(Rn.RESIZE,this.onResize,this)}onResize(t,n){this._composer.setSize(t,n)}addPass(t){this._composer.addPass(t)}removePass(t){this._composer.removePass(t)}addEffect(t){this._effects.push(t),this._effectsNeedUpdate=!0}removeEffect(t){let n=this._effects.indexOf(t);n>-1&&(this._effects.splice(n,1),this._effectsNeedUpdate=!0)}updateEffects(){this._effectsNeedUpdate&&(this._effectsNeedUpdate=!1,this._effectPass&&(this.removePass(this._effectPass),this._effectPass=null),this._effects.length&&(this._effectPass=new n5(this.viewer.camera,...this._effects),this.addPass(this._effectPass)))}update(t){this.updateEffects(),this.viewer.renderer.info.reset(),this._composer.render(t)}}var g5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let ro=class extends qn{constructor(){super(...arguments);N(this,"pass")}onEnable(){this.pass.enabled=!0}onDisable(){this.pass.enabled=!1}onLoad(e){var t;this.initialize&&this.initialize(e),(t=this.viewer.getPlugin(io))==null||t.addPass(this.pass)}onDestroy(){var e;(e=this.viewer.getPlugin(io))==null||e.removePass(this.pass)}};ro=g5([Ir(io)],ro);const v5=new Oa(-1,1,1,-1,0,1),J0=new Ke;J0.setAttribute("position",new Ge([-1,3,0,-1,-1,0,3,-1,0],3)),J0.setAttribute("uv",new Ge([0,2,0,0,2,0],2));class y5{constructor(e){this._mesh=new Je(J0,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,v5)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const $0={uniforms:{tDiffuse:{value:null},tDepth:{value:null},tNormal:{value:null},tNoise:{value:null},uClippingParams:{value:new Qe},uSamples:{value:[]},uAoParams:{value:new Qe},uScreenSize:{value:new Qe},uSsaoProjectionInfo:{value:new Qe},uFrameModTaaSS:{value:0},cameraNear:{value:.1},cameraFar:{value:100},cameraProjectionMatrix:{value:new De},cameraInverseProjectionMatrix:{value:new De}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }`,fragmentShader:`
    precision highp float;

    #include <packing>

    uniform sampler2D tDiffuse;
    uniform sampler2D tDepth;
    uniform sampler2D tNormal;
    uniform sampler2D tNoise;
    uniform vec4      uSamples[32]; 
    uniform vec4      uAoParams;
    uniform vec4      uScreenSize;
    uniform vec4      uSsaoProjectionInfo;
    uniform float     uFrameModTaaSS;
    varying vec2      vUv;

    //x = far - near
    //y = near
    //z = tanFov * aspect
    //w = tanFov
    uniform vec4      uClippingParams;

    #define uRadius     uAoParams.x
    #define uSampleCnt  uAoParams.y
    #define uGiBoost    uAoParams.z
    #define uBias       uAoParams.w

    uniform float cameraNear;
    uniform float cameraFar;
    uniform mat4 cameraProjectionMatrix;
    uniform mat4 cameraInverseProjectionMatrix;

    vec3 ndcToView(vec2 ndc, float depth) {
        float z = depth * uClippingParams.x + uClippingParams.y;
        return vec3(ndc * uClippingParams.zw, -1.0) * z;
    }
    
    vec2 viewToNdc(vec3 view) {
        return -view.xy / (uClippingParams.zw * view.z);
    }

    vec3 textureNormal(sampler2D map, vec2 uv) {
	    return unpackRGBToNormal(texture(map, uv).xyz);
    }

    float textureDepth(sampler2D map, vec2 uv) {
        return (-perspectiveDepthToViewZ(texture(map, uv).r, cameraNear, cameraFar ) - cameraNear) / (cameraFar - cameraNear);
    }

    float zValueFromScreenSpacePosition(const in float depth) {
        return (depth * uClippingParams.x + uClippingParams.y);
    }

    vec3 reconstructCSPosition(const in vec2 ssP, const in float z) {
        return vec3((ssP.xy * uSsaoProjectionInfo.xy + uSsaoProjectionInfo.zw) * z, z);
    }

    vec3 getPosition(const in vec2 uv) {
        return reconstructCSPosition(uv * uScreenSize.xy, zValueFromScreenSpacePosition(textureDepth(tDepth, uv)));
    }

    vec3 getOffsetedPixelPos(const in vec2 uv, const in vec2 unitOffset, const in float screenSpaceRadius) {
        vec2 uvOff = uv + floor(screenSpaceRadius * unitOffset) / uScreenSize.xy;
        float d = zValueFromScreenSpacePosition(textureDepth(tDepth, uvOff));
        return reconstructCSPosition(uvOff * uScreenSize.xy, d);
    }

    float interleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {
        vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);
        return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));
    }

    float hash(vec2 p) {
        return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453123);
    }

    vec2 hash2(vec2 p) { // replace this by something better
        p = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));
        return fract(sin(p) * 43758.5453123);
    }

    vec3 hash3(vec2 p){
        // p += uFrameModTaaSS * vec2(0.05);
        vec3 q = vec3(dot(p,vec2(127.1,311.7)), 
                    dot(p,vec2(269.5,183.3)), 
                    dot(p,vec2(419.2,371.9)) );
        return fract(sin(q)*43758.5453);
    }


    vec3 ssao() {
        vec2 uv = vUv;

        float uSsaoRadius = uRadius;
        float uSsaoIntensity = uGiBoost;
        float uSsaoProjectionScale = -1559.1949;
        float uSsaoBias = 0.008;

        vec3 cameraSpacePosition = getPosition(uv);
        float ssRadius = -uSsaoProjectionScale * uSsaoRadius / cameraSpacePosition.z;

        float d = textureDepth(tDepth, vUv);
        if(d >= 0.999) {
             return vec3(1.);
        }
        if (ssRadius < 1.) {
            return vec3(1.);
        }

        vec3 normal = normalize(cross(dFdy(cameraSpacePosition), dFdx(cameraSpacePosition)));
        // vec3 normal = -textureNormal(tNormal, uv);
        // return normal * 0.5 + 0.5;

        float nFalloff = mix(1.0, max(0.0, 1.5 * normal.z), 0.35);
        // return vec3(nFalloff);

        float randomAngle = 6.28 * interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);
        float invRadius2 = 1.0 / (uSsaoRadius * uSsaoRadius);
        float contrib = 0.0;
        float vv;
        float vn;
        float screenSpaceRadius;
        float angle;
        vec3 occludingPoint;
        vec2 offsetUnitVec;

        float offset = 0.;
        float nbSamples = 32.;
        for (float i = 0.; i < nbSamples; i++) {
            screenSpaceRadius = (offset + i + 0.5) * (1.0 / nbSamples);
            angle = screenSpaceRadius * (3.0 * 6.28) + randomAngle;
            screenSpaceRadius = max(0.75, screenSpaceRadius * ssRadius);
            offsetUnitVec = vec2(cos(angle), sin(angle));
            occludingPoint = getOffsetedPixelPos(uv, offsetUnitVec, screenSpaceRadius);
            occludingPoint -= cameraSpacePosition;
            vv = dot(occludingPoint, occludingPoint);
            vn = dot(occludingPoint, normal);
            contrib += max(1. - vv * invRadius2, 0.0) * max((vn - uSsaoBias) * inversesqrt(vv), 0.0);
        }
        float aoValue = max(0.0, 1.0 - sqrt(contrib * nFalloff / nbSamples));
        aoValue = pow(aoValue, 10.0 * uSsaoIntensity);
        return vec3(mix(1.0, aoValue, clamp(ssRadius - 1.0, 0.0, 1.0)));
    }

    // vec3 ssao2() {
    //     const float ATTF = 1e-5; 
    //     float d = textureDepth(tDepth, vUv);
    //     if( d >= 0.999) {
    //         discard;
    //     }
    //     float occ = 0.;
    //     float occCnt = 0.;
    //     vec3 p = ndcToView(vUv * 2. - 1., d);
    //     // vec3 n = textureNormal(tNormal, vUv);
    //     vec3 n = normalize(cross(dFdx(p), dFdy(p)));

    //     vec3  rvec = normalize(texture(tNoise, gl_FragCoord.xy/64.0).rgb*2.-1.);
    //     for(int i = 0; i<32 && d < 1.; i++) {
    //         vec3 dir = reflect(uSamples[i].xyz, rvec); // a la Crysis
    //         dir -= 2.*dir*step(dot(n,dir), 0.);  // a la Starcraft
    //         vec3 sp = p + (dir*uRadius) * (d*1e2); // scale radius with depth
    //         vec2 spNdc = viewToNdc(sp); // get sample ndc coords
            
    //         bvec4 outOfScreen = bvec4(false); // check if sample projects to screen
    //         outOfScreen.xy = lessThan(spNdc, vec2(-1));
    //         outOfScreen.zw = greaterThan(spNdc, vec2(1));
    //         if(any(outOfScreen)) continue;

    //         float spd = textureDepth(tDepth, (spNdc*0.5+0.5));
    //         vec3  occEye = -sp/sp.z*(spd*uClippingParams.x+uClippingParams.y); // compute correct pos
    //         vec3  occVec = occEye - p; // vector
    //         float att2 = 1.0+ATTF*length(occVec); // quadratic attenuation
    //         occ += max(0.0,dot(normalize(occVec),n)-0.25) / (att2*att2);
    //         ++occCnt;
    //     }
    //     return occCnt > 0.0 ? vec3(1.0-occ*uGiBoost/occCnt) : vec3(1.);
    // }

    vec3 ssao2() {
        const float ATTF = 1e-5; 
        float d = textureDepth(tDepth, vUv);
        if( d >= 0.999) {
            discard;
        }
        float occ = 0.;
        float occCnt = 0.;
        vec3 p = ndcToView(vUv * 2. - 1., d);
        vec3 n = textureNormal(tNormal, vUv);
        // vec3 n = normalize(cross(dFdx(p), dFdy(p)));

        float invRadius2 = 1.0 / (uRadius * uRadius);
        vec2 sUv = gl_FragCoord.xy/64.;
        vec3 rvec = normalize(hash3(sUv)*2.-1.);
        float nbSamples = 8.; //采样率太低会出现水波纹
        // for(int i = 0; i < 32 && d < 1.; i++) {
        for(float i = 0.; i<nbSamples && d < 1.; i++) {
            vec2 st = sUv * i;
            vec3 s = (hash3(st)*2.-1.) * mix(1e-5,.5,hash(st)); //随机缩放步长,固定步长更容易收敛,随机步长AO更准确
            vec3 dir = reflect(s, rvec); // a la Crysis
            // vec3 dir = reflect(uSamples[i].xyz, rvec); // a la Crysis
            dir -= 2.*dir*step(dot(n,dir), 0.);  // a la Starcraft
            vec3 sp = p + (dir*uRadius) * (d*5.); // scale radius with depth
            vec2 spNdc = viewToNdc(sp); // get sample ndc coords
            
            bvec4 outOfScreen = bvec4(false); // check if sample projects to screen
            outOfScreen.xy = lessThan(spNdc, vec2(-1));
            outOfScreen.zw = greaterThan(spNdc, vec2(1));
            if(any(outOfScreen)) continue;

            float spd = textureDepth(tDepth, (spNdc*0.5+0.5));
            vec3  occEye = -sp/sp.z*(spd*uClippingParams.x+uClippingParams.y); // compute correct pos
            vec3  occVec = occEye - p; // vector
            float att2 = 1.0+ATTF*length(occVec); // quadratic attenuation
            occ += max(0.0,dot(normalize(occVec),n)-0.25) / (att2*att2) * max(0., 1.-dot(occVec,occVec) * invRadius2);
            ++occCnt;
        }
        return occCnt > 0.0 ? vec3(1.0-occ*uGiBoost*10./occCnt) : vec3(1.);
    }

    void main() {        
        gl_FragColor.rgb = ssao2();
        // gl_FragColor.rgb = vec3(interleavedGradientNoise(vUv, 0.));
        // gl_FragColor.rgb = vec3(hash(gl_FragCoord.xy/64.));
        // gl_FragColor.rgb = texture(tNoise, gl_FragCoord.xy/64.0).rgb;
        gl_FragColor.a = 1.;
    }
    `},{randFloat:Hd,randInt:eg,degToRad:x5,lerp:m7}=hn;let C_=new Qe,b5=new Qe;class S5 extends Ln{constructor(t,n){super();N(this,"_scene");N(this,"_camera");N(this,"_ssaoMaterial");N(this,"_fsQuad");N(this,"_depthTexture");N(this,"_normalRenderTarget");N(this,"_normalMaterial");N(this,"_aoParams",new Qe(24,32,1,0));this._scene=t,this._camera=n,this._ssaoMaterial=new xt({uniforms:Sm.clone($0.uniforms),vertexShader:$0.vertexShader,fragmentShader:$0.fragmentShader});let i=window.innerWidth,r=window.innerHeight;this._depthTexture=new Ec(i,r,Wr),this._normalRenderTarget=new Rt(i,r,{depthTexture:this._depthTexture}),this._normalMaterial=new Zm({blending:ke}),this._fsQuad=new y5(null),this._createSamples(),this._createNoiseTexure()}get radius(){return this._aoParams.x}set radius(t){this._aoParams.x=t}get giBoost(){return this._aoParams.z}set giBoost(t){this._aoParams.z=t}_createSamples(){let t=[];for(let n=0;n<32;n++){let i=new C().set(Hd(-1,1),Hd(-1,1),Hd(-1,1)).normalize();t[n]=new Qe(i.x,i.y,i.z,1).multiplyScalar(Hd(1e-5,1))}this._ssaoMaterial.uniforms.uSamples.value=t}_createNoiseTexure(){let t=new Uint8Array(16384);for(let i=0;i<16384;i+=4)t[i+0]=eg(0,255),t[i+1]=eg(0,255),t[i+2]=eg(0,255);let n=new Ia(t,64,64,ti,yn);n.wrapS=hi,n.wrapT=hi,n.minFilter=rt,n.magFilter=rt,n.needsUpdate=!0,this._ssaoMaterial.uniforms.tNoise.value=n}setSize(t,n){this._normalRenderTarget.setSize(t,n),this._ssaoMaterial.uniforms.uScreenSize.value=b5.set(t,n,1/t,1/n);let i=this._camera.projectionMatrix.elements,r=new Qe(-2/(t*i[0]),-2/(n*i[5]),(1-i[2])/i[0],(1+i[6])/i[5]);this._ssaoMaterial.uniforms.uSsaoProjectionInfo.value=r}render(t,n,i,r,s){this._renderOverride(t,this._normalMaterial,this._normalRenderTarget),this._blit(t,i,this.renderToScreen?null:n,this._ssaoMaterial)}_renderOverride(t,n,i){t.setRenderTarget(i),this._scene.overrideMaterial=n,t.render(this._scene,this._camera),this._scene.overrideMaterial=null}_blit(t,n,i,r){t.setRenderTarget(i),r.uniforms.tDiffuse.value=n.texture,r.uniforms.tDepth.value=this._normalRenderTarget.depthTexture,r.uniforms.tNormal.value=this._normalRenderTarget.texture,r.uniforms.uAoParams.value=this._aoParams,r.uniforms.uFrameModTaaSS.value++;let s=this._camera;this._ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(s.projectionMatrixInverse),this._ssaoMaterial.uniforms.cameraProjectionMatrix.value=s.projectionMatrix,this._ssaoMaterial.uniforms.cameraNear.value=s.near,this._ssaoMaterial.uniforms.cameraFar.value=s.far;let c=Math.tan(.5*x5(s.fov));C_.set(s.far-s.near,s.near,c*s.aspect,c),this._ssaoMaterial.uniforms.uClippingParams.value=C_,this._fsQuad.material=r,this._fsQuad.render(t)}dispose(){this._ssaoMaterial.dispose(),this._fsQuad.dispose()}}var D_=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class tg extends ro{initialize(e){this.pass=new S5(this.viewer.scene,this.viewer.camera)}get radius(){return this.pass.radius}set radius(e){this.pass.radius=e}get giBoost(){return this.pass.giBoost}set giBoost(e){this.pass.giBoost=e}}D_([Ot({min:.001,max:10,step:.001})],tg.prototype,"radius",null),D_([Ot({min:.1,max:2,step:.01})],tg.prototype,"giBoost",null);const tu=new Ke;tu.setAttribute("position",new $e(new Float32Array([-1,-1,3,-1,-1,3]),2)),tu.setAttribute("uv",new $e(new Float32Array([0,0,2,0,0,2]),2)),tu.boundingSphere=new Qr,tu.computeBoundingSphere=function(){};const _5=new Oa;class nu{constructor(e){this._mesh=new Je(tu,e),this._mesh.frustumCulled=!1}render(e){e.render(this._mesh,_5)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}const w5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new De},viewMat:{value:new De},projViewMat:{value:new De},projectionMatrixInv:{value:new De},viewMatrixInv:{value:new De},cameraPos:{value:new C},resolution:{value:new ce},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 1);
}`,fragmentShader:`
    #define SAMPLES 16
    #define FSAMPLES 16.0
uniform sampler2D sceneDiffuse;
uniform highp sampler2D sceneNormal;
uniform highp sampler2D sceneDepth;
uniform mat4 projectionMatrixInv;
uniform mat4 viewMatrixInv;
uniform mat4 projMat;
uniform mat4 viewMat;
uniform mat4 projViewMat;
uniform vec3 cameraPos;
uniform vec2 resolution;
uniform float time;
uniform vec3[SAMPLES] samples;
uniform float[SAMPLES] samplesR;
uniform float radius;
uniform float distanceFalloff;
uniform float near;
uniform float far;
uniform bool logDepth;
uniform bool ortho;
uniform bool screenSpaceRadius;
uniform sampler2D bluenoise;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }

    vec3 getWorldPosLog(vec3 posS) {
      vec2 uv = posS.xy;
      float z = posS.z;
      float nearZ =near;
      float farZ = far;
      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
      vec4 wpos = projectionMatrixInv * clipVec;
      return wpos.xyz / wpos.w;
    }
    vec3 getWorldPos(float depth, vec2 coord) {
      #ifdef LOGDEPTH
        return getWorldPosLog(vec3(coord, depth));
      #endif
      float z = depth * 2.0 - 1.0;
      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
      // Perspective division
     vec4 worldSpacePosition = viewSpacePosition;
     worldSpacePosition.xyz /= worldSpacePosition.w;
      return worldSpacePosition.xyz;
  }

  vec3 computeNormal(vec3 worldPos, vec2 vUv) {
    ivec2 p = ivec2(vUv * resolution);
    float c0 = texelFetch(sceneDepth, p, 0).x;
    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;

    float dl = abs((2.0 * l1 - l2) - c0);
    float dr = abs((2.0 * r1 - r2) - c0);
    float db = abs((2.0 * b1 - b2) - c0);
    float dt = abs((2.0 * t1 - t2) - c0);

    vec3 ce = getWorldPos(c0, vUv).xyz;

    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;

    return normalize(cross(dpdx, dpdy));
}

void main() {
      vec4 diffuse = texture2D(sceneDiffuse, vUv);
      float depth = texture2D(sceneDepth, vUv).x;
      if (depth == 1.0) {
        gl_FragColor = vec4(vec3(1.0), 1.0);
        return;
      }
      vec3 worldPos = getWorldPos(depth, vUv);
    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);
      #ifdef HALFRES
        vec3 normal = texture2D(sceneNormal, vUv).rgb;
      #else
        vec3 normal = computeNormal(worldPos, vUv);
      #endif
      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);
      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);
      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));
      vec3 bitangent = cross(normal, tangent);
      mat3 tbn = mat3(tangent, bitangent, normal);
      float occluded = 0.0;
      float totalWeight = 0.0;
     /* float radiusScreen = distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(48.0, 0.0) / resolution)
      );/*vUv.x < 0.5 ? radius : min(distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(100.0, 0.0) / resolution)
      ), radius);
      float distanceFalloffScreen = radiusScreen * 0.2;*/
      float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;
      for(float i = 0.0; i < FSAMPLES; i++) {
        vec3 sampleDirection = 
        tbn * 
        samples[int(i)];
        ;
        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];
        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;
        vec4 offset = projMat * vec4(samplePos, 1.0);
        offset.xyz /= offset.w;
        offset.xyz = offset.xyz * 0.5 + 0.5;
        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;
        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) 
         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/
        #ifdef LOGDEPTH
        float distSample = linearize_depth_log(sampleDepth, near, far);
        #else
        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);
        #endif
        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);
        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));
        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);
        float weight = dot(sampleDirection, normal);
          occluded += rangeCheck * weight * 
            (distSample + bias
               < distWorld ? 1.0 : 0.0) * (
          (dot(
            diff,
            diff
             
            ) < 1.0 || (sampleDepth == depth) || (
              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0
            ) ? 0.0 : 1.0)
          );
          totalWeight += weight;
      }
      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);
      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);
}`},M5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new De},viewMat:{value:new De},projectionMatrixInv:{value:new De},viewMatrixInv:{value:new De},cameraPos:{value:new C},resolution:{value:new ce},color:{value:new C(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1},fog:{value:!1},fogExp:{value:!1},fogDensity:{value:0},fogNear:{value:1/0},fogFar:{value:1/0},colorMultiply:{value:!0}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform highp sampler2D downsampledDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform vec2 resolution;
    uniform vec3 color;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform float intensity;
    uniform float renderMode;
    uniform float near;
    uniform float far;
    uniform bool gammaCorrection;
    uniform bool logDepth;
    uniform bool ortho;
    uniform bool screenSpaceRadius;
    uniform bool fog;
    uniform bool fogExp;
    uniform bool colorMultiply;
    uniform float fogDensity;
    uniform float fogNear;
    uniform float fogFar;
    uniform float radius;
    uniform float distanceFalloff;
    uniform vec3 cameraPos;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
       // if (logDepth) {
        #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
        #endif
      //  }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }

    #include <common>
    #include <dithering_pars_fragment>
    void main() {
        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);
        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);
        float depth = texture2D(
            sceneDepth,
            vUv
        ).x;
        #ifdef HALFRES 
        vec4 texel;
        if (depth == 1.0) {
            texel = vec4(0.0, 0.0, 0.0, 1.0);
        } else {
        vec3 worldPos = getWorldPos(depth, vUv);
        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);
       // vec4 texel = texture2D(tDiffuse, vUv);
       // Find closest depth;
       float totalWeight = 0.0;
       float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
        for(float x = -1.0; x <= 1.0; x++) {
            for(float y = -1.0; y <= 1.0; y++) {
                vec2 offset = vec2(x, y);
                ivec2 p = ivec2(
                    (vUv * resolution * 0.5) + offset
                );
                vec2 pUv = vec2(p) / (resolution * 0.5);
                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;
                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);
                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;
                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);
                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);
                float weight = rangeCheck;
                totalWeight += weight;
                texel += sampleInfo * weight;
            }
        }
        if (totalWeight == 0.0) {
            texel = texture2D(tDiffuse, vUv);
        } else {
            texel /= totalWeight;
        }
    }
        #else
        vec4 texel = texture2D(tDiffuse, vUv);
        #endif

     
        float finalAo = pow(texel.a, intensity);
        float fogFactor;
        float fogDepth = distance(
            cameraPos,
            getWorldPos(depth, vUv)
        );
        if (fog) {
            if (fogExp) {
                fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
            } else {
                fogFactor = smoothstep( fogNear, fogFar, fogDepth );
            }
        }
        finalAo = mix(finalAo, 1.0, fogFactor);
        vec3 aoApplied = color * mix(vec3(1.0), sceneTexel.rgb, float(colorMultiply));
        if (renderMode == 0.0) {
            gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 1.0) {
            gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 2.0) {
            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
        } else if (renderMode == 3.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        } else if (renderMode == 4.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        }
        #include <dithering_fragment>
        if (gammaCorrection) {
            gl_FragColor = LinearTosRGB(gl_FragColor);
        }
    }
    `},T5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new De},viewMat:{value:new De},projectionMatrixInv:{value:new De},viewMatrixInv:{value:new De},cameraPos:{value:new C},resolution:{value:new ce},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1.0);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform vec2 resolution;
    uniform float r;
    uniform float radius;
     uniform float worldRadius;
    uniform float index;
     uniform float near;
     uniform float far;
     uniform float distanceFalloff;
     uniform bool logDepth;
     uniform bool screenSpaceRadius;
    varying vec2 vUv;

    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        highp float z_n = 2.0 * d - 1.0;
        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     return linearize_depth(linDepth, nearZ, farZ);
   }
   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
     return nearZ + (farZ - nearZ) * d;
   }
   vec3 getWorldPosLog(vec3 posS) {
     vec2 uv = posS.xy;
     float z = posS.z;
     float nearZ =near;
     float farZ = far;
     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
     vec4 wpos = projectionMatrixInv * clipVec;
     return wpos.xyz / wpos.w;
   }
    vec3 getWorldPos(float depth, vec2 coord) {
     #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
     #endif
        
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
    #include <common>
    #define NUM_SAMPLES 16
    uniform vec2 poissonDisk[NUM_SAMPLES];
    void main() {
        const float pi = 3.14159;
        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec2 uv = vUv;
        vec4 data = texture2D(tDiffuse, vUv);
        float occlusion = data.a;
        float baseOcc = data.a;
        vec3 normal = data.rgb * 2.0 - 1.0;
        float count = 1.0;
        float d = texture2D(sceneDepth, vUv).x;
        if (d == 1.0) {
          gl_FragColor = data;
          return;
        }
        vec3 worldPos = getWorldPos(d, vUv);
        float size = radius;
        float angle;
        if (index == 0.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;
        } else if (index == 1.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;
        } else if (index == 2.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;
        } else {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;
        }

        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
        float radiusToUse = screenSpaceRadius ? distance(
          worldPos,
          getWorldPos(d, vUv +
            vec2(worldRadius, 0.0) / resolution)
        ) : worldRadius;
        float distanceFalloffToUse =screenSpaceRadius ?
            radiusToUse * distanceFalloff
        : distanceFalloff;


        for(int i = 0; i < NUM_SAMPLES; i++) {
            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;
            vec4 dataSample = texture2D(tDiffuse, uv + offset);
            float occSample = dataSample.a;
            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;
            float dSample = texture2D(sceneDepth, uv + offset).x;
            vec3 worldPosSample = getWorldPos(dSample, uv + offset);
            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
            float rangeCheck = dSample == 1.0 ? 0.0 :exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));
            occlusion += occSample * rangeCheck;
            count += rangeCheck;
        }
        if (count > 0.0) {
          occlusion /= count;
        }
        #ifdef LOGDEPTH
          occlusion = clamp(occlusion, 0.0, 1.0);
          if (occlusion == 0.0) {
            occlusion = 1.0;
          }
        #endif
        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);
    }
    `},E5={uniforms:{sceneDepth:{value:null},resolution:{value:new ce},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new De},projectionMatrixInv:{value:new De},logDepth:{value:!1}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = vec4(position, 1);
    }`,fragmentShader:`
    uniform highp sampler2D sceneDepth;
    uniform vec2 resolution;
    uniform float near;
    uniform float far;
    uniform bool logDepth;
    uniform mat4 viewMatrixInv;
    uniform mat4 projectionMatrixInv;
    varying vec2 vUv;
    layout(location = 1) out vec4 gNormal;
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
        if (logDepth) {
          return getWorldPosLog(vec3(coord, depth));
        }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }
    void main() {
        vec2 uv = vUv - vec2(0.5) / resolution;
        vec2 pixelSize = vec2(1.0) / resolution;
        vec2[] uvSamples = vec2[4](
            uv,
            uv + vec2(pixelSize.x, 0.0),
            uv + vec2(0.0, pixelSize.y),
            uv + pixelSize
        );
        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;
        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;
        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;
        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;
        float minDepth = min(min(depth00, depth10), min(depth01, depth11));
        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));
        float targetDepth = minDepth;
        // Checkerboard pattern to avoid artifacts
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { 
            targetDepth = maxDepth;
        }
        int chosenIndex = 0;
        float[] samples = float[4](depth00, depth10, depth01, depth11);
        for(int i = 0; i < 4; ++i) {
            if (samples[i] == targetDepth) {
                chosenIndex = i;
                break;
            }
        }
        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]
        ), 0.0);
       /* float[] samples = float[4](depth00, depth10, depth01, depth11);
        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);
        float[] distances = float[4](depth00, depth10, depth01, depth11);
        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));

        int remaining[3];
        int rejected[3];
        int i, j, k;

        for(i = 0, j = 0, k = 0; i < 4; ++i) {
            if (distances[i] < maxDistance) {
                remaining[j++] = i;
            } else {
                rejected[k++] = i;
            }
        }
        for(;j < 3;++j) {
            remaining[j] = rejected[--k];
        }
        vec3 s = vec3(
            samples[remaining[0]],
            samples[remaining[1]],
            samples[remaining[2]]
        );
        c = (s.x + s.y + s.z) / 3.0;

        distances[0] = abs(c - s.x);
        distances[1] = abs(c - s.y);
        distances[2] = abs(c - s.z);

        float minDistance = min(min(distances[0], distances[1]), distances[2]);

        for(i = 0; i < 3; ++i) {
            if (distances[i] == minDistance) {
                break;
            }
        }*/
      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]
        ), 0.0);*/
    }`},A5=Uint8Array.from(atob("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"),o=>o.charCodeAt(0));function O_(o,e,t){if(e.getQueryParameter(o,e.QUERY_RESULT_AVAILABLE)){const n=e.getQueryParameter(o,e.QUERY_RESULT)/1e6;t.lastTime=n}else setTimeout(()=>{O_(o,e,t)},1)}class R5 extends Ln{constructor(e,t,n=512,i=512){super(),this.width=n,this.height=i,this.clear=!0,this.camera=t,this.scene=e,this.autosetGamma=!0,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Pe(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0,colorMultiply:!0},{set:(r,s,c)=>{const u=r[s];return r[s]=c,s==="aoSamples"&&u!==c&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),s==="denoiseSamples"&&u!==c&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),s==="halfRes"&&u!==c&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),s==="depthAwareUpsampling"&&u!==c&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),s==="gammaCorrection"&&(this.autosetGamma=!1),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.copyQuad=new nu(new xt({uniforms:{tDiffuse:{value:null}},depthWrite:!1,vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = vec4(position, 1);
            }
            `,fragmentShader:`
            uniform sampler2D tDiffuse;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(tDiffuse, vUv);
            }
            `})),this.writeTargetInternal=new Rt(this.width,this.height,{minFilter:rt,magFilter:rt,depthBuffer:!1}),this.readTargetInternal=new Rt(this.width,this.height,{minFilter:rt,magFilter:rt,depthBuffer:!1}),this.outputTargetInternal=new Rt(this.width,this.height,{minFilter:rt,magFilter:rt,depthBuffer:!1}),this.bluenoise=new Ia(A5,128,128),this.bluenoise.colorSpace=yy,this.bluenoise.wrapS=hi,this.bluenoise.wrapT=hi,this.bluenoise.minFilter=At,this.bluenoise.magFilter=At,this.bluenoise.needsUpdate=!0,this.lastTime=0,this.needsDepthTexture=!0,this.needsSwap=!0,this._r=new ce,this._c=new Pe}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new Ey(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=wf,this.depthDownsampleTarget.texture[0].type=Ti,this.depthDownsampleTarget.texture[0].minFilter=At,this.depthDownsampleTarget.texture[0].magFilter=At,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=ti,this.depthDownsampleTarget.texture[1].type=di,this.depthDownsampleTarget.texture[1].minFilter=At,this.depthDownsampleTarget.texture[1].magFilter=At,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new nu(new xt(E5))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(e=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const t={...w5};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new xt(t)):this.effectShaderQuad=new nu(new xt(t))}configureDenoisePass(e=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const t={...T5};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.denoiseSamples),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new xt(t)):this.poissonBlurQuad=new nu(new xt(t))}configureEffectCompositer(e=!1){const t={...M5};e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new xt(t)):this.effectCompositerQuad=new nu(new xt(t))}generateHemisphereSamples(e){const t=[];for(let n=0;n<e;n++){const i=2.399963*n,r=Math.sqrt(n+.5)/Math.sqrt(e),s=r*Math.cos(i),c=r*Math.sin(i),u=Math.sqrt(1-(s*s+c*c));t.push(new C(s,c,u))}return t}generateHemisphereSamplesR(e){let t=[];for(let n=0;n<e;n++)t.push((n+1)/e);return t}generateDenoiseSamples(e,t){const n=2*Math.PI*t/e,i=1/e,r=i,s=[];let c=i,u=0;for(let d=0;d<e;d++)s.push(new ce(Math.cos(u),Math.sin(u)).multiplyScalar(Math.pow(c,.75))),c+=r,u+=n;return s}setSize(e,t){this.width=e,this.height=t;const n=this.configuration.halfRes?.5:1;this.writeTargetInternal.setSize(e*n,t*n),this.readTargetInternal.setSize(e*n,t*n),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(e*n,t*n),this.outputTargetInternal.setSize(e,t)}setDepthTexture(e){this.depthTexture=e}render(e,t,n){const i=e.xr.enabled;let r,s,c;e.xr.enabled=!1,e.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=e.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer)),t.texture.type!==this.outputTargetInternal.texture.type&&(this.outputTargetInternal.texture.type=t.texture.type,this.outputTargetInternal.texture.needsUpdate=!0),this.debugMode&&(r=e.getContext(),s=r.getExtension("EXT_disjoint_timer_query_webgl2"),s===null&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),this.debugMode&&(c=r.createQuery(),r.beginQuery(s.TIME_ELAPSED_EXT,c)),this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let u=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(u*=.5),this.configuration.halfRes&&(e.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(e)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new C),this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=u,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(e);for(let d=0;d<this.configuration.denoiseIterations;d++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new C),this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=u,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=d,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(e);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=t.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=u,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.autosetGamma?this.renderToScreen:this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),this.effectCompositerQuad.material.uniforms.colorMultiply.value=this.configuration.colorMultiply,this.effectCompositerQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new C),this.effectCompositerQuad.material.uniforms.fog.value=!!this.scene.fog,this.scene.fog&&(this.scene.fog.isFog?(this.effectCompositerQuad.material.uniforms.fogExp.value=!1,this.effectCompositerQuad.material.uniforms.fogNear.value=this.scene.fog.near,this.effectCompositerQuad.material.uniforms.fogFar.value=this.scene.fog.far):this.scene.fog.isFogExp2?(this.effectCompositerQuad.material.uniforms.fogExp.value=!0,this.effectCompositerQuad.material.uniforms.fogDensity.value=this.scene.fog.density):console.error(`Unsupported fog type ${this.scene.fog.constructor.name} in SSAOPass.`)),e.setRenderTarget(this.outputTargetInternal),this.effectCompositerQuad.render(e),e.setRenderTarget(this.renderToScreen?null:n),this.copyQuad.material.uniforms.tDiffuse.value=this.outputTargetInternal.texture,this.copyQuad.render(e),this.debugMode&&(r.endQuery(s.TIME_ELAPSED_EXT),O_(c,r,this)),e.xr.enabled=i}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(e){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(e)}setQualityMode(e){e==="Performance"?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Low"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Medium"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):e==="High"?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):e==="Ultra"&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}var Al=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class ao extends ro{constructor(){super(...arguments);N(this,"name","N8AOPlugin");N(this,"_quality","Medium")}initialize(t){this.pass=new R5(this.viewer.scene,this.viewer.camera),Object.assign(this.pass.configuration,{depthAwareUpsampling:!0,aoRadius:5,aoSamples:16,denoiseSamples:4,denoiseRadius:12,distanceFalloff:1,intensity:1,renderMode:0,...t})}get intensity(){return this.pass.configuration.intensity}set intensity(t){this.pass.configuration.intensity=t}get aoRadius(){return this.pass.configuration.aoRadius}set aoRadius(t){this.pass.configuration.aoRadius=t}get quality(){return this._quality}set quality(t){this.pass.setQualityMode(t)}get renderMode(){return this.pass.configuration.renderMode}set renderMode(t){this.pass.configuration.renderMode=t}get depthAwareUpsampling(){return this.pass.configuration.depthAwareUpsampling}set depthAwareUpsampling(t){this.pass.configuration.depthAwareUpsampling=t}get halfRes(){return this.pass.configuration.halfRes}set halfRes(t){this.pass.configuration.halfRes=t}}Al([Ot({min:0,max:10,step:.01})],ao.prototype,"intensity",null),Al([Ot({min:1,max:10,step:.01})],ao.prototype,"aoRadius",null),Al([Ot({value:["Performance","Low","Medium","High","Ultra"]})],ao.prototype,"quality",null),Al([Ot({value:{Combined:0,AO:1,"No AO":2,Split:3,"Split AO":4}})],ao.prototype,"renderMode",null),Al([Ot()],ao.prototype,"depthAwareUpsampling",null),Al([Ot()],ao.prototype,"halfRes",null);var L5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let Fr=class extends qn{constructor(){super(...arguments);N(this,"effect")}onEnable(){var e;(e=this.viewer.getPlugin(io))==null||e.addEffect(this.effect)}onDisable(){var e;(e=this.viewer.getPlugin(io))==null||e.removeEffect(this.effect)}onLoad(e){this.initialize&&this.initialize(e)}};Fr=L5([Ir(io)],Fr);var I_=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class ng extends Fr{constructor(){super(...arguments);N(this,"name","BloomPlugin")}initialize(t){this.effect=new P_({blendFunction:V0,...t})}get intensity(){return this.effect.intensity}set intensity(t){this.effect.intensity=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}}I_([Ot({min:0,max:1,step:.01})],ng.prototype,"intensity",null),I_([Ot({min:0,max:10,step:.01})],ng.prototype,"luminanceThreshold",null);var P5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class N_ extends Fr{constructor(){super(...arguments);N(this,"name","ChromaticAberrationPlugin")}get offset(){return this.effect.offset}set offset(t){this.effect.offset.copy(t)}initialize(t){this.effect=new h5(t)}}P5([Ot()],N_.prototype,"offset",null);var ig=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class jd extends Fr{constructor(){super(...arguments);N(this,"name","DepthOfFieldPlugin")}initialize({target:t,...n}){this.effect=new d5(this.viewer.camera,n),this.effect.target=t}get target(){return this.effect.target}set target(t){this.effect.target=t}get focalLength(){return this.effect.circleOfConfusionMaterial.focalLength}set focalLength(t){this.effect.circleOfConfusionMaterial.focalLength=t}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}}ig([Ot()],jd.prototype,"target",null),ig([Ot()],jd.prototype,"focalLength",null),ig([Ot()],jd.prototype,"bokehScale",null);var C5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class k_ extends Fr{constructor(){super(...arguments);N(this,"name","ToneMappingPlugin")}get mode(){return this.effect.mode}set mode(t){this.effect.mode=t}initialize(t){this.effect=new m5(t)}}C5([Ot({value:fr})],k_.prototype,"mode",null);var rg=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class Gd extends Fr{constructor(){super(...arguments);N(this,"name","SelectiveBloomPlugin")}initialize({selection:t,selectionLayer:n=11,ignoreBackground:i=!1,...r}){this.effect=new f5(this.viewer.scene,this.viewer.camera,{blendFunction:V0,...r}),Array.isArray(t)&&this.effect.selection.set(t),this.effect.selection.layer=n,this.effect.ignoreBackground=i}get intensity(){return this.effect.intensity}set intensity(t){this.effect.intensity=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get selectionLayer(){return this.effect.selection.layer}set selectionLayer(t){this.effect.selection.layer=t}}rg([Ot({min:0,max:10,step:.01})],Gd.prototype,"intensity",null),rg([Ot({min:0,max:10,step:.01})],Gd.prototype,"luminanceThreshold",null),rg([Ot()],Gd.prototype,"selectionLayer",null);var Vd=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class iu extends Fr{constructor(){super(...arguments);N(this,"name","FXAAPlugin")}initialize(t){this.effect=new p5(t)}get minEdgeThreshold(){return this.effect.minEdgeThreshold}set minEdgeThreshold(t){this.effect.minEdgeThreshold=t}get maxEdgeThreshold(){return this.effect.maxEdgeThreshold}set maxEdgeThreshold(t){this.effect.maxEdgeThreshold=t}get subpixelQuality(){return this.effect.subpixelQuality}set subpixelQuality(t){this.effect.subpixelQuality=t}get samples(){return this.effect.samples}set samples(t){this.effect.samples=t}}Vd([Ot()],iu.prototype,"minEdgeThreshold",null),Vd([Ot()],iu.prototype,"maxEdgeThreshold",null),Vd([Ot()],iu.prototype,"subpixelQuality",null),Vd([Ot()],iu.prototype,"samples",null);const D5={uniforms:{tDiffuse:{value:null},resolution:{value:new ce(1/1024,1/512)}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
	precision highp float;

	uniform sampler2D tDiffuse;

	uniform vec2 resolution;

	varying vec2 vUv;

	// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)

	//----------------------------------------------------------------------------------
	// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag
	// SDK Version: v3.00
	// Email:       gameworks@nvidia.com
	// Site:        http://developer.nvidia.com/
	//
	// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
	//
	// Redistribution and use in source and binary forms, with or without
	// modification, are permitted provided that the following conditions
	// are met:
	//  * Redistributions of source code must retain the above copyright
	//    notice, this list of conditions and the following disclaimer.
	//  * Redistributions in binary form must reproduce the above copyright
	//    notice, this list of conditions and the following disclaimer in the
	//    documentation and/or other materials provided with the distribution.
	//  * Neither the name of NVIDIA CORPORATION nor the names of its
	//    contributors may be used to endorse or promote products derived
	//    from this software without specific prior written permission.
	//
	// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ''AS IS'' AND ANY
	// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
	// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
	// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
	// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	//
	//----------------------------------------------------------------------------------

	#ifndef FXAA_DISCARD
			//
			// Only valid for PC OpenGL currently.
			// Probably will not work when FXAA_GREEN_AS_LUMA = 1.
			//
			// 1 = Use discard on pixels which don't need AA.
			//     For APIs which enable concurrent TEX+ROP from same surface.
			// 0 = Return unchanged color on pixels which don't need AA.
			//
			#define FXAA_DISCARD 0
	#endif

	/*--------------------------------------------------------------------------*/
	#define FxaaTexTop(t, p) texture2D(t, p, -100.0)
	#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), -100.0)
	/*--------------------------------------------------------------------------*/

	#define NUM_SAMPLES 5

	// assumes colors have premultipliedAlpha, so that the calculated color contrast is scaled by alpha
	float contrast( vec4 a, vec4 b ) {
			vec4 diff = abs( a - b );
			return max( max( max( diff.r, diff.g ), diff.b ), diff.a );
	}

	/*============================================================================

									FXAA3 QUALITY - PC

	============================================================================*/

	/*--------------------------------------------------------------------------*/
	vec4 FxaaPixelShader(
			vec2 posM,
			sampler2D tex,
			vec2 fxaaQualityRcpFrame,
			float fxaaQualityEdgeThreshold,
			float fxaaQualityinvEdgeThreshold
	) {
			vec4 rgbaM = FxaaTexTop(tex, posM);
			vec4 rgbaS = FxaaTexOff(tex, posM, vec2( 0.0, 1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaE = FxaaTexOff(tex, posM, vec2( 1.0, 0.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaN = FxaaTexOff(tex, posM, vec2( 0.0,-1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaW = FxaaTexOff(tex, posM, vec2(-1.0, 0.0), fxaaQualityRcpFrame.xy);
			// . S .
			// W M E
			// . N .

			bool earlyExit = max( max( max(
					contrast( rgbaM, rgbaN ),
					contrast( rgbaM, rgbaS ) ),
					contrast( rgbaM, rgbaE ) ),
					contrast( rgbaM, rgbaW ) )
					< fxaaQualityEdgeThreshold;
			// . 0 .
			// 0 0 0
			// . 0 .

			#if (FXAA_DISCARD == 1)
					if(earlyExit) FxaaDiscard;
			#else
					if(earlyExit) return rgbaM;
			#endif

			float contrastN = contrast( rgbaM, rgbaN );
			float contrastS = contrast( rgbaM, rgbaS );
			float contrastE = contrast( rgbaM, rgbaE );
			float contrastW = contrast( rgbaM, rgbaW );

			float relativeVContrast = ( contrastN + contrastS ) - ( contrastE + contrastW );
			relativeVContrast *= fxaaQualityinvEdgeThreshold;

			bool horzSpan = relativeVContrast > 0.;
			// . 1 .
			// 0 0 0
			// . 1 .

			// 45 deg edge detection and corners of objects, aka V/H contrast is too similar
			if( abs( relativeVContrast ) < .3 ) {
					// locate the edge
					vec2 dirToEdge;
					dirToEdge.x = contrastE > contrastW ? 1. : -1.;
					dirToEdge.y = contrastS > contrastN ? 1. : -1.;
					// . 2 .      . 1 .
					// 1 0 2  ~=  0 0 1
					// . 1 .      . 0 .

					// tap 2 pixels and see which ones are "outside" the edge, to
					// determine if the edge is vertical or horizontal

					vec4 rgbaAlongH = FxaaTexOff(tex, posM, vec2( dirToEdge.x, -dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongH = contrast( rgbaM, rgbaAlongH );
					// . 1 .
					// 0 0 1
					// . 0 H

					vec4 rgbaAlongV = FxaaTexOff(tex, posM, vec2( -dirToEdge.x, dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongV = contrast( rgbaM, rgbaAlongV );
					// V 1 .
					// 0 0 1
					// . 0 .

					relativeVContrast = matchAlongV - matchAlongH;
					relativeVContrast *= fxaaQualityinvEdgeThreshold;

					if( abs( relativeVContrast ) < .3 ) { // 45 deg edge
							// 1 1 .
							// 0 0 1
							// . 0 1

							// do a simple blur
							return mix(
									rgbaM,
									(rgbaN + rgbaS + rgbaE + rgbaW) * .25,
									.4
							);
					}

					horzSpan = relativeVContrast > 0.;
			}

			if(!horzSpan) rgbaN = rgbaW;
			if(!horzSpan) rgbaS = rgbaE;
			// . 0 .      1
			// 1 0 1  ->  0
			// . 0 .      1

			bool pairN = contrast( rgbaM, rgbaN ) > contrast( rgbaM, rgbaS );
			if(!pairN) rgbaN = rgbaS;

			vec2 offNP;
			offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;
			offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;

			bool doneN = false;
			bool doneP = false;

			float nDist = 0.;
			float pDist = 0.;

			vec2 posN = posM;
			vec2 posP = posM;

			int iterationsUsed = 0;
			int iterationsUsedN = 0;
			int iterationsUsedP = 0;
			for( int i = 0; i < NUM_SAMPLES; i++ ) {
					iterationsUsed = i;

					float increment = float(i + 1);

					if(!doneN) {
							nDist += increment;
							posN = posM + offNP * nDist;
							vec4 rgbaEndN = FxaaTexTop(tex, posN.xy);
							doneN = contrast( rgbaEndN, rgbaM ) > contrast( rgbaEndN, rgbaN );
							iterationsUsedN = i;
					}

					if(!doneP) {
							pDist += increment;
							posP = posM - offNP * pDist;
							vec4 rgbaEndP = FxaaTexTop(tex, posP.xy);
							doneP = contrast( rgbaEndP, rgbaM ) > contrast( rgbaEndP, rgbaN );
							iterationsUsedP = i;
					}

					if(doneN || doneP) break;
			}


			if ( !doneP && !doneN ) return rgbaM; // failed to find end of edge

			float dist = min(
					doneN ? float( iterationsUsedN ) / float( NUM_SAMPLES - 1 ) : 1.,
					doneP ? float( iterationsUsedP ) / float( NUM_SAMPLES - 1 ) : 1.
			);

			// hacky way of reduces blurriness of mostly diagonal edges
			// but reduces AA quality
			dist = pow(dist, .5);

			dist = 1. - dist;

			return mix(
					rgbaM,
					rgbaN,
					dist * .5
			);
	}

	void main() {
			const float edgeDetectionQuality = .2;
			const float invEdgeDetectionQuality = 1. / edgeDetectionQuality;

			gl_FragColor = FxaaPixelShader(
					vUv,
					tDiffuse,
					resolution,
					edgeDetectionQuality, // [0,1] contrast needed, otherwise early discard
					invEdgeDetectionQuality
			);

	}
	`};class O5 extends ro{constructor(){super(...arguments);N(this,"name","NVFXAAPlugin");N(this,"_material",new xt(D5))}initialize(t){this.pass=new Ya(this._material,"tDiffuse")}update(t){const n=this.viewer.dpr,i=this.viewer.size;this._material.uniforms.resolution.value.set(1/(i.width*n),1/(i.height*n))}}class Ur extends qn{constructor(){super(...arguments);N(this,"_gui")}onLoad(){this._gui=new Ud({width:310,title:"Inspector"}).close()}onDestroy(){this._gui.destroy()}inspect(t="",...n){let i=this._gui;t&&(i=i.getFolder(t)||i.addFolder(t).close());for(let r of n){if(i.getFolder(r.uuid))return;let s=r.__properties;s&&Object.keys(s).length&&I5(i.addFolder(this.getObjectName(r),r.uuid).close(),r,s)}return this}uninspect(t="",...n){let i=this._gui;if(n.length>0){t&&(i=i.getFolder(t)||i);for(let r of n)i.removeFolder(r.uuid)}else t&&i.removeFolder(t)}getObjectName(t){return t.name||t.constructor.name||t.__cls}}function I5(o,e,t){let n=[];e.isComponent&&n.push({k:"enabled",order:0});for(let i in t)n.push((t[i].k=i,t[i]));n.sort((i,r)=>(i.order??1e3)-(r.order??1e3));for(let i=0;i<n.length;i++){let r=o,s=n[i],c=s.k;s.dir&&(r=o.getFolder(s.dir)||o.addFolder(s.dir).close());let u=e[c];if(u!=null)if(u.isColor)s.value={[c]:"#"+u.getHexString()},s.$=r.addColor(s.value,c).onChange(d=>u.set(d));else if(u.isTexture){s.value={};let d=u.image;d.data==null&&u.isRenderTargetTexture&&u.readPixels&&(s.value.capture=()=>{d.data=d.data||new Uint8Array(d.width*d.height*4),u.readPixels(0,0,d.width,d.height,d.data),s.$.updateDisplay()},r.add(s.value,"capture")),s.value[c]=d,s.$=r.addImage(s.value,c)}else u.isVector2||u.isVector3||u.isVector4||u.isEuler?(s.value={[c]:u},s.$=r.addVector(s.value,c,s.min,s.max,s.step).onChange(d=>u.copy(d))):typeof u=="object"||(s.$=r.add(e,c,s.value||s.min,s.max,s.step));else s.$=r.add(e,c,s.value||s.min,s.max,s.step)}}var N5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};function F_(o){return o instanceof ro||o instanceof Fr}let ag=class extends qn{constructor(){super(...arguments);N(this,"_inspector")}onLoad(e){this._inspector=this.viewer.getPlugin(Ur),this._inspector.inspect("Postprocessing",...this.viewer.scene._components.filter(F_)),this.viewer.on("component-changed",this._onComponentChanged,this)}onDestroy(){this.viewer.off("component-changed",this._onComponentChanged,this)}_onComponentChanged(e){F_(e.target)&&(e.action==="add"&&this._inspector.inspect("Postprocessing",e.target),e.action==="remove"&&this._inspector.uninspect("Postprocessing",e.target))}};function U_(o,e,t){o.__properties_copy==null&&(o.__properties_copy=o.__properties);let n=Object.assign({},o.__properties_copy),i=o.__properties_ignore||{};for(let r in o){if(o[r]==null){delete n[r];continue}n[r]==null&&i[r]==null&&t[r]==null&&(n[r]=Object.assign({},e[r]));let s=n[r]&&n[r].parent;s&&o[s]==null&&delete n[r]}return o.__properties=n,o}function z_(o){return Object.values(o).forEach((e,t)=>e.order=t),o}function B_(o){return o.reduce((e,t)=>(e[t]=!0,e),{})}ag=N5([Ir(Ur)],ag);var k5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let so=class extends qn{constructor(){super(...arguments);N(this,"inspector");N(this,"inspectorNodeHandlers",[])}onLoad(e){this.inspector=this.viewer.getPlugin(Ur),this.viewer.on("node-changed",this._onNodeChanged,this)}onDestroy(){this.viewer.off("node-changed",this._onNodeChanged,this)}start(){this.viewer.scene.traverse(e=>this.inspectorNodeHandlers.forEach(t=>t.onNodeAdd&&t.onNodeAdd(e)))}registHandler(e){this.inspectorNodeHandlers.push(e.init(this))}unregistHandler(e){this.inspectorNodeHandlers.remove(e)}_onNodeChanged(e){let t=e.action;t==="add"?e.target.traverse(n=>this.inspectorNodeHandlers.forEach(i=>i.onNodeAdd&&i.onNodeAdd(n))):(t==="remove"||t==="clear")&&e.target.traverse(n=>this.inspectorNodeHandlers.forEach(i=>i.onNodeRemove&&i.onNodeRemove(n)))}};so=k5([Ir(Ur)],so);class sg{constructor(){N(this,"inspectorNode")}init(e){return this.inspectorNode=e,this}}var F5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let og=class extends qn{constructor(){super(...arguments);N(this,"_inspectorNode");N(this,"_inspectorHandler")}onLoad(e){this._inspectorNode=this.viewer.getPlugin(so),this._inspectorHandler=new U5,this._inspectorNode.registHandler(this._inspectorHandler)}onDestroy(){this._inspectorNode.unregistHandler(this._inspectorHandler)}};og=F5([Ir(so)],og);class U5 extends sg{constructor(){super(...arguments);N(this,"_materials",{})}onNodeAdd(t){if(t.isMesh&&t.material){let n=t.material;this._materials[n.uuid]==null&&(this._materials[n.uuid]=0,U_(n,z5,B5),this.inspectorNode.inspector.inspect("Materials",n)),this._materials[n.uuid]++}}onNodeRemove(t){if(t.isMesh&&t.material){let n=t.material;--this._materials[n.uuid]<=0&&this.inspectorNode.inspector.uninspect("Materials",n)}}}const z5=z_({visible:{},transparent:{},side:{value:{FrontSide:0,BackSide:1,DoubleSide:2}},color:{dir:"diffuse"},opacity:{dir:"diffuse",min:0,max:1,step:.01},map:{dir:"diffuse"},roughnessMap:{dir:"roughness"},roughness:{dir:"roughness",min:0,max:1,step:.01},metalnessMap:{dir:"metalness"},metalness:{dir:"metalness",min:0,max:1,step:.01},aoMap:{dir:"ao"},aoMapIntensity:{dir:"ao",min:0,max:1,step:.01,parent:"aoMap"},emissive:{dir:"emissive"},emissiveMap:{dir:"emissive"},emissiveIntensity:{dir:"emissive",min:0,max:1,step:.01,parent:"emissiveMap"},normalMap:{dir:"normal"},normalScale:{dir:"normal",parent:"normalMap"},displacementScale:{dir:"displacement",min:0,max:1,step:.01,parent:"displacementMap"},displacementBias:{dir:"displacement",parent:"displacementMap"},envMapIntensity:{min:0,max:1,step:.01,parent:"envMap"},lightMapIntensity:{min:0,max:1,step:.01,parent:"lightMap"}}),B5=B_(["vertexShader","fragmentShader","__properties","__properties_copy","isMaterial","isMeshPhongMaterial","isMeshBasicMaterial","isMeshStandardMaterial","isShaderMaterial","uuid","name","type","blending","vertexColors","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clippingPlanes","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaToCoverage","premultipliedAlpha","forceSinglePass","userData","version","_alphaTest","defines","bumpScale","normalMapType","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","toneMapped","flatShading","fog","uniforms","uniformsGroups","extensions","defaultAttributeValues","linewidth","lights","clipping","uniformsNeedUpdate"]);var ru=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let lg=class extends qn{constructor(){super(...arguments);N(this,"_viewerWrap");N(this,"_inspector")}onLoad(e){this._viewerWrap=new au(this.viewer,e),this._inspector=this.viewer.getPlugin(Ur),this._inspector.inspect("",this._viewerWrap)}onDestroy(){this._viewerWrap.dispose()}};lg=ru([Ir(Ur)],lg);class au{constructor(e,t){N(this,"name","Viewer");N(this,"viewer");N(this,"envMap",new Map);this.viewer=e,this.viewer.on("env-changed",this._onEnvChanged,this),this._setProperties(t)}get outputEncoding(){return this.viewer.renderer.outputEncoding}set outputEncoding(e){this.viewer.renderer.outputEncoding=e}get toneMapping(){return this.viewer.renderer.toneMapping}set toneMapping(e){this.viewer.renderer.toneMapping=e}get toneMappingExposure(){return this.viewer.renderer.toneMappingExposure}set toneMappingExposure(e){this.viewer.renderer.toneMappingExposure=e}get shadows(){return this.viewer.renderer.shadowMap.enabled}set shadows(e){this.viewer.renderer.shadowMap.enabled=e}get environment(){return this._envName(this.viewer.environment)}set environment(e){this.viewer.setEnvironment({url:this.envMap.get(e)})}dispose(){this.viewer.off("env-changed",this._onEnvChanged,this)}_onEnvChanged(e){let t=this.__properties.environment.$;t&&t.updateDisplay()}_envName(e){return e instanceof File?e.name:e?v0(e):"none"}_setProperties({environments:e}){this.envMap.set("none",null),this.envMap.set(this.environment,this.viewer.environment),e==null||e.reduce((t,n)=>t.set(v0(n),n),this.envMap),e=Array.from(this.envMap.keys()),this.__properties.environment={value:e}}}ru([Ot({value:{LinearEncoding:3e3,sRGBEncoding:3001}})],au.prototype,"outputEncoding",null),ru([Ot({value:{NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,CineonToneMapping:3,ACESFilmicToneMapping:4}})],au.prototype,"toneMapping",null),ru([Ot({min:0,max:10,step:.01})],au.prototype,"toneMappingExposure",null),ru([Ot()],au.prototype,"shadows",null);var H5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let cg=class extends qn{onLoad(o){}};cg=H5([Ir(Ur)],cg);var j5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let ug=class extends qn{constructor(){super(...arguments);N(this,"_inspectorNode");N(this,"_inspectorHandler")}onLoad(e){this._inspectorNode=this.viewer.getPlugin(so),this._inspectorHandler=new G5,this._inspectorHandler.helperGroup=this.viewer.addNode(Vn),this._inspectorNode.registHandler(this._inspectorHandler)}onDestroy(){this._inspectorHandler.helperGroup.remove(),this._inspectorNode.unregistHandler(this._inspectorHandler)}update(e){this._inspectorHandler.helperGroup.children.forEach(t=>{t.visible=t.light.visible,t.update()})}};ug=j5([Ir(so)],ug);class G5 extends sg{constructor(){super(...arguments);N(this,"helperGroup")}onNodeAdd(t){t.isLight&&(t.isDirectionalLight&&this.helperGroup.add(new zb(t)),t.isPointLight&&this.helperGroup.add(new Ib(t)),t.isSpotLight&&this.helperGroup.add(new Db(t)),t.target&&function(n,i,r,s){Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:r,set:s})}(t,"targetPos",()=>t.target.position,n=>t.target.position.copy(n)),U_(t,V5,W5),this.inspectorNode.inspector.inspect("Lights",t))}onNodeRemove(t){if(t.isLight){let n=this.helperGroup.children.find(i=>i.light===t);n&&this.helperGroup.remove(n),this.inspectorNode.inspector.uninspect("Lights",t)}}}const V5=z_({visible:{},castShadow:{},intensity:{min:0,max:1,step:.01},color:{},position:{},targetPos:{}}),W5=B_(["isObject3D","isLight","isDirectionalLight","isPointLight","isSpotLight","isAmbientLight","isHemisphereLight","uuid","name","type","parent","children","matrix","matrixWorld","matrixAutoUpdate","scale","up","matrixWorldNeedsUpdate","matrixWorldAutoUpdate","layers","receiveShadow","frustumCulled","renderOrder","animations","userData","uniforms","target","shadow","rotation"]);var X5=function(o,e,t,n){var i,r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,n);else for(var c=o.length-1;c>=0;c--)(i=o[c])&&(s=(r<3?i(s):r>3?i(e,t,s):i(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let hg=class extends qn{constructor(){super(...arguments);N(this,"_inspector")}onLoad(e){this._inspector=this.viewer.getPlugin(Ur),this._inspector.inspect("Components",...this.viewer.getComponentsInChidren(this.viewer.scene,wt).filter(t=>!t.isPlugin)),this.viewer.on("component-changed",this._onComponentChanged,this)}onDestroy(){this.viewer.off("component-changed",this._onComponentChanged,this)}_onComponentChanged(e){e.target.isPlugin||(e.action==="add"&&this._inspector.inspect("Components",e.target),e.action==="remove"&&this._inspector.uninspect("Components",e.target))}};hg=X5([Ir(Ur)],hg)})();E.J12;E.$c;E.I_b;E.oGK;var N4=E.$p;E.$q;var k4=E.$r;E.i5S;E.nXV;E.bd1;E.LY2;E.bGH;E.NDo;E.gSk;E.WMw;E.OTo;E.Se2;E.cum;var F4=E.Mig;E.i_9;E.m7l;E.sYA;var U4=E.Xcj;E.mzJ;E.ZZA;E.T__;E.HkE;E.tGC;E.gOo;var Fn=E.meI;E.BbS;E.kqm;var uM=E.Wat;E.Hmr;E.SJI;E.rMl;E.mTL;E.y8_;E._Li;E.z81;E._MY;var z4=E.dFZ;E.IIx;E.N$j;E.XO3;E._YM;E.TUj;E.ZzF;E.GQ;E.nvb;E.DvJ;E.fQA;E.TlE;var B4=E.u9r;E.s4_;E.T95;E.CtF;E.V1s;E.Rki;E.ROQ;E.YN5;E.BVQ;E.YT8;E._DE;E.YGz;E.WXy;E.max;E.trn;E.zf8;E.uWy;E.SUY;var Sr=E.Ilk;E.xRS;E.R2R;E.epp;var _a=E.wA2;E.Z_g;E.EB7;E.DqL;E._3;E.b_z;E.Qrh;E.unp;E._am;E.fY$;E.vxC;E.BtG;E.cBK;E.g8_;E.AXT;E.yj7;E.dYG;E.tm_;E.S2y;E.B02;E.PeU;E.Hyl;E.Wqd;E.Xaj;E.dZ3;E.m_w;E.fHI;E.LBq;E.JUT;E.p3g;var H4=E.IEO;E.yxD;E.A5E;E.jfJ;E.T_J;E.tEQ;E.qkB;E.HWo;E.brP;E.$YQ;var Lu=E.iRp,j4=E.Ox3;E.cBI;E.cU9;E.ntt;E.DT1;E.Kgo;E.ehD;E.fSK;E.Vdb;E.l8J;E.dj0;E.QM0;E.TOt;var G4=E.Qmf,V4=E.JIf;E.Ny0;E.eD;E.jwo;E.dSO;E.Bf4;var DT=E.USm;E.pBf;var W4=E.vpe;E.$Vf;E.O7d;var X4=E.JE9;E.hH6;E.e62;var hM=E.a$l;E.OM3;var q4=E.VzW,Y4=E.ybr;E.yo9;E.Wzm;E.zUS;E.Wl3;E.iWj;E.CoK;E.ylh;E.v9Y;E.LSk;E.XSA;E.w$m;E.ksN;E.j4z;E.OAl;E.VLJ;E.ZAu;E.cLu;E.vmT;E.Qpg;E.So8;E.Wjw;E.cJO;E.QRU;E.uSM;E.S3k;E.fnl;E.PpQ;E.ZRs;E.oqc;E.UT1;E.KQe;E.s28;E.uEm;E.b08;E.yPR;E.ph9;E.llF;E.EIF;E.lb7;E.L5s;E.$TI;var I1=E.SPe;E.aVm;E.j87;E.RNb;E.Kz5;E.vpT;E.kB5;E._C8;E.Syv;E.NMF;E.pIN;E.eMJ;E.x5V;E.tUh;E.z8B;E.GZb;E.p7y;E.S9g;E.Zr5;E.vCF;E.yt0;E.uXU;E._kC;E.lk7;E.x12;E.Zzh;E.nls;E.g_z;E.U7;E.FT0;E.blk;E.ejS;var Q4=E.rnI;E.wem;E.lfu;E.FDw;E.lRj;var Z4=E.D1R;E.qyh;E.GUF;E.EoG;E.aNw;E.Zp0;E.lLk;var K4=E.jAl;E.uEv;E.YKA;E.cRx;E.Y8D;E.RsA;E.F5T;E.u7G;var Uv=E.M8C,dM=E.Vkp,N1=E.yGw;E.Sm8;var yo=E.Kj0;E.vBJ;E.lRF;E.Lun;E.YBo;E.kaV;E.RSm;E.xoR;E.EJi;E.Qme;E.Wid;E.IKL;E.r_;E.OoA;E.qhX;E.M5h;E.Ns1;E.Ue;E.RR3;E.TyD;E.vZf;E.HTd;E.aH4;E.YLQ;E.BVF;E.MyG;E.jFi;E.aCh;var J4=E.uL9;E.IFH;E.bdR;E.M6v;E.RvT;E.ymC;E.dUE;var $4=E.Tme;E.Gql;E.PA7;E.REq;E.pQR;E.ghN;E.Hy8;E.Wpd;E.LgZ;E.iWC;E.lkL;E.iKG;E._iA;E.ntZ;E.anP;E.HRQ;E.hpZ;E.w2v;E.WI2;E.y$t;E.cPb;E.JOQ;E.BKK;var OT=E._12;E.tJx;E.OdJ;var k1=E.SyM;E.cek;E.xG9;var eN=E.woe,tN=E.UY4;E.aq0;E.ujx;E.Uol;E.VYz;E.tSf;E.M20;E.iUV;E.tf;E.ZQ6;E.mXe;var F1=E._fP;E.iLg;E.zbs;E.ZTh;E.HdW;E.UZH;E.mSO;var nN=E.wk1;E.E2K;E.FUD;E.pKu;E.GG6;E.Gih;E.iiP;E.SvJ;E.ptH;E.jZA;E.y2t;E.gi4;E.Djp;E.BG$;E.NYV;E.xJs;E.bsb;E.ekQ;E.CaW;E.eaV;E.BFQ;E.v3W;E.ILR;E.fto;E.l0P;E.vCx;E._AM;E.wuA;E.av9;E.CtA;E.FIo;E.zHn;E.iMs;E.T_f;E.hEm;E.D9w;E.CdI;E.wo6;E.TIb;var IT=E.rpg;E.ce8;E.rOj;E.V4E;E.o8S;E.lGU;E.vuL;E.KI_;E.iLN;E.xsS;var iN=E.b26;E.w5d;E.WdD;E.Vj0;var Ju=E.jyz;E.Tn7;E.bnF;E.HW6;E.oa8;E.T_1;E.iDF;E.iAb;E.OdW;E._YX;E.TUv;E.Hw6;E.aLr;E.Aip;E.xo$;E.$V;E.lDi;E.gti;E.PMe;E.FvO;E.jyi;E.xeV;E.k74;E.RlZ;E.KhW;E.HgB;E.W2J;E.JWc;E.kP0;E.u37;E.Z6B;E.QZ1;E.Ir4;E.nE5;E.NwF;E.Wbm;E.N4l;E.QmN;var Qi=E.wes;E.IOt;E.L5g;E.H$k;E.xEZ;E.Yin;var $u=E.dpR,rN=E.hmx,aN=E.Lb$;E.Cne;E.XvJ;E.XZw;E.FE5;E.CJI;E.z$h;E.UlW;E.WwZ;E.Lcc;E.WXh;E.VNk;E.ub3;E.xfE;E.qlB;E.lCJ;E.WTc;E.rAo;var pM=E.xWb;E.gH0;E.rBU;E.rDY;E.ywz;E.wJv;E.JQ4;E.k0A;E.irR;E.LsT;E.Oih;E.p9U;E.MiG;E.JSe;E.dwk;E.FM8;var mn=E.Pa4;E.Ltg;E.yC1;E.Lpp;E.fO1;var sN=E.AEx;E._9o;E.k5T;E.b5g;E.Ywn;E.GVz;E.oAp;E.kFz;E.dd2;E.CP7;E.fQK;E.Uk6;E._sL;E.Pnf;E.c8b;E._lf;E.ad5;E.L_r;E.HOT;E.$R8;E.lDs;E.Oe_;E.S6$;var ys=E.CbL;E.knz;class fM{constructor(){N(this,"_taskCount",0);N(this,"_taskFinished",0);N(this,"_resolve",Promise.resolve());N(this,"_progress",0)}get progress(){return this._progress}task(l,{name:h="",weight:m=1}={}){return this._regist(m),this._resolve.then(()=>typeof l=="function"?l():l).then(()=>this._finish(m,h)).catch(x=>{this._finish(m,h),console.error(x)})}reset(){this._taskCount=0,this._taskFinished=0,this._progress=0}_finish(l,h){this._taskFinished+=l,this._progress=Uv.clamp01(Math.max(this._progress,this._taskFinished/this._taskCount))}_regist(l){this._taskCount=Math.max(1,this._taskCount+l)}}class oN extends W4{constructor(){super(...arguments);N(this,"taskManger",new fM);N(this,"restartCount",0)}reset(){this.clear(),this.taskManger.reset(),this.taskManger=new fM}get progress(){return this.taskManger.progress}restart(){window.location.href="https://www.bilibili.com/video/BV1E8411v7xy"}task(h,m={}){return this.taskManger.task(h,m)}}const gt=new oN;function lN(){const[a,l]=Mn.useState(!1),[h,m]=Mn.useState(!1),[x,_]=Mn.useState(!1),[A,k]=Mn.useState(!1);return Mn.useEffect(()=>{gt.on("doorCreate",()=>{_(!0)},!0,!0),gt.on("openDoor",()=>{k(!0),m(!1)},!0,!0),setTimeout(()=>{l(!0),m(!0)},500)},[]),Tt.jsxs("div",{className:"menu-container",children:[Tt.jsx("div",{className:"menu-12",style:{opacity:h?"0.9":"0"}}),Tt.jsxs("div",{className:"menu-login",style:{opacity:a?"1":"0"},children:[Tt.jsx("div",{className:"background"}),Tt.jsx("div",{className:"menu-description",children:Tt.jsxs("div",{className:"description",children:[Tt.jsx("p",{children:"免责声明："}),Tt.jsx("p",{children:"本网站是一个纯粹的技术示例，旨在展示和分享我们的技术能力。网站的设计和内容受到《原神》的启发，并尽可能地复制了《原神》的登录界面。我们对此表示敬意，并强调这个项目不是官方的《原神》产品，也没有与《原神》或其母公司miHoYo有任何关联。"}),Tt.jsx("p",{children:"我们没有，也无意从这个项目中获得任何经济利益。这个网站的所有内容仅供学习和研究目的，以便让更多的人了解和熟悉webgl开发技术。"}),Tt.jsx("p",{children:"如果miHoYo或任何有关方面认为这个项目侵犯了他们的权益，请联系我们，我们会立即采取行动。"})]})}),Tt.jsx("button",{className:"ClickMe",onClick:a?()=>{gt.emit("button-start-click"),gt.emit("start"),l(!1)}:()=>{}}),Tt.jsx("button",{className:"ClickMe",style:{bottom:"16%",backgroundImage:'url("/Genshin/jump.png")'},onClick:a?()=>{window.open("https://www.bilibili.com/video/BV1E8411v7xy")}:()=>{}})]}),x&&Tt.jsx("div",{className:"menu-doorCreate-content",style:{opacity:A?"0":"1"},children:Tt.jsx("div",{className:"menu-doorCreate",children:Tt.jsx("div",{className:"entry"})})})]})}let Jp=new iN,jg=null;function NT(){let a=performance.now();if(jg!==null){let l=a-jg;Jp.update(l*.001)}jg=a,requestAnimationFrame(NT)}NT();let kT=1;const cN={uuid:""+kT++};function uN(){Jp.unscheduleAll(cN)}function hN(a,l=[],h=0,m=-1){const[x]=Mn.useState(()=>({uuid:""+kT++})),_=Mn.useCallback(a,l);Mn.useEffect(()=>(Jp.schedule(x,_,h,m),()=>Jp.unshedule(x,_)),[_,h,m])}function dN(){const a=Mn.useRef(),[l,h]=Mn.useState(!0),[m,x]=Mn.useState(0);return Mn.useEffect(()=>{m>=1&&(h(!1),setTimeout(()=>gt.emit("preloaded"),1500))},[m]),hN(_=>{_=Uv.clamp(_,.005,.3);let A=Uv.damp(m,gt.progress,170,_);A!==0&&(A>.99&&(A=1),x(A))},[m]),Tt.jsx("div",{className:"progress-container",style:{opacity:l?"1":"0"},children:Tt.jsxs("div",{className:"progress-content",children:[Tt.jsx("img",{className:"Genshin",src:"Genshin/Genshin.png",alt:"图片",style:{opacity:l?"1":"0"}}),Tt.jsxs("div",{className:"LoadingBar",style:{opacity:l?"1":"0"},children:[Tt.jsx("div",{className:"progress-bar",children:Tt.jsx("div",{ref:a,className:"progress",style:{width:m*100+"%"}})}),Tt.jsx("div",{className:"ball",style:{left:"-2vmin"}}),Tt.jsx("div",{className:"ball",style:{left:"40.8vmin",top:"-2.4vmin"}}),Tt.jsx("div",{style:{paddingTop:"1vmin",fontSize:"1.4vmin"},children:"为了您更好的体验，请在电脑端打开"})]})]})})}class pN{constructor(){N(this,"resources",{})}}class FT{constructor(){N(this,"name","");N(this,"active",!1);N(this,"target");N(this,"SM")}}Promise.resolve();class fN{constructor(l){N(this,"_state","");N(this,"_states",[]);N(this,"_handlers",{});N(this,"_promise",Promise.resolve());this.target=l}reset(){this._state="",this._states=[],this._handlers={}}getState(){return this._state}setState(l){if(this._state===l)return!1;if(this._state){let h=this._handlers[this._state];if(h===void 0||h.canTransfer&&!h.canTransfer(l))return!1}return this._states.push(l),this._states.length==1&&this._transferState(),!0}_transferState(){let l=async()=>{let m=this._handlers[this._state];m&&(m.onLeave&&await this._promise.then(()=>m.onLeave()),m.active=!1)},h=async()=>{if(!this._states.length)return;let m=this._state=this._states.shift(),x=this._handlers[m];x&&(x.onEnter&&await this._promise.then(()=>x.onEnter()),x.active=!0),this._states.length>0&&this._transferState()};this._promise.then(l).then(h).catch(console.error)}registState(l){let h=new l,m=h.name||h.constructor.name;this._handlers[m]&&console.warn(`state: ${m} duplicate registered`),h.SM=this,h.target=this.target,this._handlers[m]=h}updateState(l){for(let h in this._handlers){let m=this._handlers[h];m.active&&m.onUpdate&&m.onUpdate(l)}}}var mN=Object.defineProperty,gN=Object.getOwnPropertyDescriptor,UT=(a,l,h,m)=>{for(var x=m>1?void 0:m?gN(l,h):l,_=a.length-1,A;_>=0;_--)(A=a[_])&&(x=(m?A(l,h,x):A(x))||x);return m&&x&&mN(l,h,x),x};class U1 extends _a{get color(){return this.node.color}set color(l){this.node.color.copy(l)}get intensity(){return this.node.intensity}set intensity(l){this.node.intensity=l}create(l){return N4(new F4,{color:new Sr(1011455),intensity:6,...l})}}UT([ys()],U1.prototype,"color",1);UT([ys({min:0,max:20,step:.001})],U1.prototype,"intensity",1);const Mi=new mn;let vN=new mn;class yN extends _a{constructor(){super(...arguments);N(this,"speed",new mn(0,0,-88));N(this,"shouldStop",!1);N(this,"_zOffset",0)}onLoad(h){Mi.set(0,0,0),this.on("showDoor",this.stop,this),this.on("openDoor",this.openDoor,this)}update(h){this.shouldStop||(Mi.add(vN.copy(this.speed).multiplyScalar(h)),this.viewer.camera.position.copy(Mi))}stop(h){this.shouldStop=!0,this._zOffset=h;let m=this.viewer.camera.position.clone();Qi.TweenManager.Tween(this.viewer.camera).to({position:new mn(m.x,m.y,h-165)},5).easing(Qi.Easing.Cubic.Out).start()}openDoor(){let h=this.viewer.camera.position.clone();Qi.TweenManager.KillTweensOf(this.viewer.camera),Qi.TweenManager.Tween(this.viewer.camera).to({position:new mn(h.x,h.y,this._zOffset-400)},.6).easing(Qi.Easing.Cubic.In).start()}}const xN=`
#ifdef USE_FOG
    #ifdef FOG_EXP2
        float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
    #else
        float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
    #endif
    vec3 linearFragCol = aces_fitted(gl_FragColor.rgb);
    gl_FragColor.rgb = mix( linearFragCol, fogColor, fogFactor );
    gl_FragColor.rgb = ACES_Inv(gl_FragColor.rgb);
#endif
`,ic=`
vec3 rrt_odt_fit(vec3 v)
{
    vec3 a = v*(         v + 0.0245786) - 0.000090537;
    vec3 b = v*(0.983729*v + 0.4329510) + 0.238081;
    return a/b;
}
vec3 inv_rrt_odt_fit(vec3 v)
{
    vec3 a = -(sqrt(10.)*sqrt((-187248350.*pow(v,vec3(2.)))+232585567.*v+241290.)+21650.*v-1230.);
    vec3 b = (98370.*v-100000.);
    return a/b;
}

mat3 mat3_from_rows(vec3 c0, vec3 c1, vec3 c2)
{
    mat3 m = mat3(c0, c1, c2);
    m = transpose(m);

    return m;
}

vec3 mul(mat3 m, vec3 v)
{
    return m * v;
}

mat3 mul(mat3 m1, mat3 m2)
{
    return m1 * m2;
}

vec3 aces_fitted(vec3 color)
{
    mat3 ACES_INPUT_MAT = mat3_from_rows(
        vec3( 0.59719, 0.35458, 0.04823),
        vec3( 0.07600, 0.90834, 0.01566),
        vec3( 0.02840, 0.13383, 0.83777));

    mat3 ACES_OUTPUT_MAT = mat3_from_rows(
        vec3( 1.60475,-0.53108,-0.07367),
        vec3(-0.10208, 1.10813,-0.00605),
        vec3(-0.00327,-0.07276, 1.07602));

    color = mul(ACES_INPUT_MAT, color);

    // Apply RRT and ODT
    color = rrt_odt_fit(color);

    color = mul(ACES_OUTPUT_MAT, color);

    return color;
}
vec3 ACES_Inv(vec3 color)
{
    mat3 ACES_INPUT_MAT = mat3_from_rows(
        vec3( 1.76474, -0.67577, -0.08896),
        vec3( -0.14702, 1.16025, -0.01322),
        vec3( -0.03633, -0.16243, 1.19877));

    mat3 ACES_OUTPUT_MAT = mat3_from_rows(
        vec3( 0.64304, 0.31119,0.04578),
        vec3(0.05926, 0.93144, 0.00929),
        vec3(0.00596,0.06393, 0.93012));

    color = mul(ACES_OUTPUT_MAT, color);
    
    // Apply RRT and ODT
    color = inv_rrt_odt_fit(color);

    color = mul(ACES_INPUT_MAT, color);

    return color;
}

vec3 PowVec3(vec3 v, float p)
{
    return vec3(pow(v.x, p), pow(v.y, p), pow(v.z, p));
}

const float gamma = 2.2;
vec3 ToSRGB(vec3 v) { return PowVec3(v, 1.0/gamma); }
`,bN=`
${ic}
void RE_Direct_ToonPhysical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, const in float metalnessFactor, inout ReflectedLight reflectedLight ) {
    float dotNL_noSaturate = dot( geometry.normal, directLight.direction );
    float dotNL = saturate( dotNL_noSaturate );
    float dotNL_toon = smoothstep(0.25,0.27,dotNL);//*pow(dotNL,0.5);//*0.8;//+0.14;
    vec3 irradiance = dotNL_toon * directLight.color;
    #ifdef USE_CLEARCOAT
        float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
        vec3 ccIrradiance = dotNLcc * directLight.color;
        clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
    #endif
    #ifdef USE_SHEEN
        sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
    #endif
    #ifdef USE_IRIDESCENCE
        reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
    #else
        //手动调整反射粗糙度
        float new_roughness = (1.0-step(0.01,metalnessFactor))*pow(material.roughness,0.4);
        new_roughness += step(0.01,metalnessFactor)*pow(material.roughness,1.4);
        reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, new_roughness );
    #endif
    // reflectedLight.directSpecular*=13.;
    reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
    //计算出假反射
    float dotNL_reflect_faker = 1.-smoothstep(0.,0.3,dotNL_noSaturate);

	float fresnelTerm = dot(geometry.viewDir, geometry.normal);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.) * dotNL_reflect_faker;
    reflectedLight.directDiffuse += fresnelCol*pow(fresnelTerm,4.5)*0.8;
}
`,mM=`
${ic}
void RE_Direct_ToonPhysical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, const in float metalnessFactor, inout ReflectedLight reflectedLight ) {
    float dotNL_noSaturate = dot( geometry.normal, directLight.direction );
    float dotNL = saturate( dotNL_noSaturate );
    float dotNL_toon = smoothstep(0.25,0.27,dotNL)*pow(dotNL,0.5)*1.4;//*0.8;//+0.14;
    dotNL_toon += smoothstep(0.75,0.8,dotNL)*pow(dotNL,1.);
    vec3 irradiance = dotNL_toon * directLight.color;
    #ifdef USE_CLEARCOAT
        float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
        vec3 ccIrradiance = dotNLcc * directLight.color;
        clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
    #endif
    #ifdef USE_SHEEN
        sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
    #endif
    #ifdef USE_IRIDESCENCE
        reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
    #else
        //手动调整反射粗糙度
        float new_roughness = (1.0-metalnessFactor)*pow(material.roughness,0.4);
        new_roughness += metalnessFactor*pow(material.roughness,1.2);
        reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, new_roughness );
    #endif
    reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
    //计算出假反射
    float dotNL_reflect_faker = 1.-smoothstep(0.,0.3,dotNL_noSaturate);

	float fresnelTerm = dot(geometry.viewDir, geometry.normal);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.) * dotNL_reflect_faker;
    reflectedLight.directDiffuse += fresnelCol*pow(fresnelTerm,5.)*0.8;
}
`,Gg=`

GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
    geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
    float dotNVi = saturate( dot( normal, geometry.viewDir ) );
    if ( material.iridescenceThickness == 0.0 ) {
        material.iridescence = 0.0;
    } else {
        material.iridescence = saturate( material.iridescence );
    }
    if ( material.iridescence > 0.0 ) {
        material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
        material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
    }
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
    PointLight pointLight;
    #if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
    PointLightShadow pointLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
        pointLight = pointLights[ i ];
        getPointLightInfo( pointLight, geometry, directLight );
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
        pointLightShadow = pointLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
        #endif
        RE_Direct( directLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
    SpotLight spotLight;
    vec4 spotColor;
    vec3 spotLightCoord;
    bool inSpotLightMap;
    #if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
    SpotLightShadow spotLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
        spotLight = spotLights[ i ];
        getSpotLightInfo( spotLight, geometry, directLight );
        #if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
        #define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
        #elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
        #define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
        #else
        #define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
        #endif
        #if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
            spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
            inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
            spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
            directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
        #endif
        #undef SPOT_LIGHT_MAP_INDEX
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
        spotLightShadow = spotLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
        #endif
        RE_Direct( directLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
    DirectionalLight directionalLight;
    #if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
    DirectionalLightShadow directionalLightShadow;
    #endif
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
        directionalLight = directionalLights[ i ];
        getDirectionalLightInfo( directionalLight, geometry, directLight );
        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
        directionalLightShadow = directionalLightShadows[ i ];
        directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
        #endif
        RE_Direct_ToonPhysical( directLight, geometry, material,metalnessFactor, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
    RectAreaLight rectAreaLight;
    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
        rectAreaLight = rectAreaLights[ i ];
        RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
    }
    #pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
    vec3 iblIrradiance = vec3( 0.0 );
    vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
    irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
    #if ( NUM_HEMI_LIGHTS > 0 )
        #pragma unroll_loop_start
        for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
            irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
        }
        #pragma unroll_loop_end
    #endif
#endif
#if defined( RE_IndirectSpecular )
    vec3 radiance = vec3( 0.0 );
    vec3 clearcoatRadiance = vec3( 0.0 );
#endif
`,eh=`
float random(vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}`,SN=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;
uniform float time;

${eh}
${ic}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    vec3 mask = col.rgb;

    vec3 col_r = mix(vec3(23., 145., 250.)/255.,vec3(0.93),vec3(pow(mask.r,0.4)));
    
    col = vec4(col_r,col.a);
    col.rgb = ACES_Inv(col.rgb);

    gl_FragColor = vec4(col);
}`,_N=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;

${eh}
${ic}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    col.a = col.r;
    col = vec4(vec3(0.9)*2.,col.a*0.4);
    gl_FragColor = vec4(col);
}`,wN=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D cloudTexture;

uniform vec3 color_1;
uniform float color_intensity_1;
uniform vec3 color_2;
uniform float color_intensity_2;

${eh}
${ic}

void main() {
    vec4 col = texture(cloudTexture,vUv);
    vec3 mask = col.rgb;

    vec3 col_r = mix(color_1*color_intensity_1,color_2*color_intensity_2,vec3(pow(mask.r,0.6)));

    col = vec4(col_r,col.a);
    col.rgb = ACES_Inv(col.rgb);
    gl_FragColor = vec4(col);
}`,MN=`
/* 噪波 */
const float F3 =  0.3333333;
const float G3 =  0.1666667;
vec3 random3(vec3 c) {
	float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
	vec3 r;
	r.z = fract(512.0*j);
	j *= .125;
	r.x = fract(512.0*j);
	j *= .125;
	r.y = fract(512.0*j);
	return r-0.5;
}
float noise3d(vec3 p) {
	 vec3 s = floor(p + dot(p, vec3(F3)));
	 vec3 x = p - s + dot(s, vec3(G3));

	 vec3 e = step(vec3(0.0), x - x.yzx);
	 vec3 i1 = e*(1.0 - e.zxy);
	 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
	
	 vec3 x1 = x - i1 + G3;
	 vec3 x2 = x - i2 + 2.0*G3;
	 vec3 x3 = x - 1.0 + 3.0*G3;
	 
	 vec4 w, d;
	 
	 w.x = dot(x, x);
	 w.y = dot(x1, x1);
	 w.z = dot(x2, x2);
	 w.w = dot(x3, x3);
	 
	 w = max(0.6 - w, 0.0);
	 
	 d.x = dot(random3(s), x);
	 d.y = dot(random3(s + i1), x1);
	 d.z = dot(random3(s + i2), x2);
	 d.w = dot(random3(s + 1.0), x3);
	 
	 w *= w;
	 w *= w;
	 d *= w;
	 
	 return dot(d, vec4(52.0));
}
`,TN=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform float time;
${MN}

void main() {
    
	vec2 uv = vUv*vec2(0.0024,0.0016);
	
	float f = 0.0;

    f = clamp(noise3d(vPositionW*vec3(0.012,0.012,0.)+vec3(time*0.25))+0.2,0.,1.);
    f+= clamp(noise3d(vPositionW*vec3(0.004,0.004,0.)-vec3(time*0.15))+0.1,0.,1.);

    f=clamp(f,0.,1.);
    //做一个y轴的过渡
    f*=(1.-smoothstep(-5.,45.,vPositionW.y));
    f*= (smoothstep(-200.,-35.,vPositionW.y));
    //做一个x轴的过渡
    f*=(smoothstep(0.,40.,vPositionW.x)+(1.-smoothstep(-40.,-0.,vPositionW.x)));
    
    gl_FragColor = vec4(vec3(1.)*3.,f*0.3);
}`,EN=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;

uniform sampler2D lightTexture;
uniform float time;

${eh}

void main() {
    float mask = 1.5*texture(lightTexture,vUv+vec2(time*0.015,0.)).r;
    mask+=  texture(lightTexture,vUv*vec2(0.4,1.)+vec2(time*-0.0075,0.)).r;

    vec4 col = vec4(vec3(1.8),mask);
    //与相机距离越近，透明度降低
    float distanceToCamera = distance(cameraPosition.xyz,vPositionW);
    col.a*=smoothstep(200.,1000.,distanceToCamera);
    col.a*=smoothstep(0.0,0.5,vUv.y);
    col.a*=smoothstep(0.0,0.1,vUv.x)*smoothstep(1.0,0.9,vUv.x);
    gl_FragColor = vec4(col);
}`,AN=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

${eh}

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );

    vUv = uv;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
      vec3 instPosition = vec3(instanceMatrix * vec4(vec3(0.),1.));
    #endif

    #ifdef USE_INSTANCING
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif

    //uv为随机值
    vec2 wh = vec2(2.,4.);
    float rn = ceil(random(instPosition.xy)*wh.x*wh.y);
    vec2 cell = vec2(1.,1.)/wh;vUv = uv/wh;
    vUv+=vec2(cell.x*mod(rn,wh.x),cell.y*(ceil(rn/wh.x)-1.));
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = projectionMatrix*modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = vec4((viewerUV.xyz / viewerUV.w).xy* 0.5 + 0.5,0.,1.);
}`,gf=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
    vUv = uv;
    //UV是反的
    vUv.y = 1.0 - vUv.y;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
    #endif

    #ifdef USE_INSTANCING
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif
    
    gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = projectionMatrix*modelViewMatrix * vec4(vPosition, 1.0);
    viewerUV = vec4((viewerUV.xyz / viewerUV.w).xy* 0.5 + 0.5,0.,1.);
}`;var RN=Object.defineProperty,LN=Object.getOwnPropertyDescriptor,vf=(a,l,h,m)=>{for(var x=m>1?void 0:m?LN(l,h):l,_=a.length-1,A;_>=0;_--)(A=a[_])&&(x=(m?A(l,h,x):A(x))||x);return m&&x&&RN(l,h,x),x};const PN=new $u,CN=PN.load("Genshin/Login/Textures/Tex_0062.png"),ha=new Ju({uniforms:{cloudTexture:{value:CN},color_1:{value:new Sr("#00a2f0")},color_intensity_1:{value:1},color_2:{value:new Sr("#f0f0f5")},color_intensity_2:{value:1}},fragmentShader:wN,vertexShader:AN,transparent:!0,depthWrite:!1}),DN=new $u,ON=DN.load("Genshin/Login/Textures/Tex_0063.png"),IN=new Ju({uniforms:{cloudTexture:{value:ON}},fragmentShader:SN,vertexShader:gf,transparent:!0,depthWrite:!1}),NN=new $u,kN=NN.load("Genshin/Login/Textures/Tex_0067b.png"),FN=new Ju({uniforms:{cloudTexture:{value:kN}},fragmentShader:_N,vertexShader:gf,transparent:!0,depthWrite:!1}),gM=new Ju({uniforms:{time:{value:123}},fragmentShader:TN,vertexShader:gf,transparent:!0,depthWrite:!1}),UN=new $u,z1=UN.load("Genshin/Login/Textures/Tex_0071.png");z1.wrapS=IT;z1.wrapT=IT;const vM=new Ju({uniforms:{lightTexture:{value:z1},time:{value:123}},fragmentShader:EN,vertexShader:gf,transparent:!0,depthWrite:!1});class zN{getToonMaterial_Column(l){return l.metalness=.3,l.onBeforeCompile=function(h){let m=h.fragmentShader;m=m.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            vec3 fresnelCol = vec3(0x11,0x2e,0xae)/255.*5.;
            ${bN}
            `),m=m.replace("#include <lights_fragment_begin>",`
            ${Gg}
            `),m=m.replace("#include <fog_fragment>",`
            ${xN}
            `),h.fragmentShader=m},l}getToonMaterial_Road(l,h){return l.color.multiply(new Sr("#fffcfe").add(new Sr().setRGB(.015,0,0))),l.normalMap.minFilter=Z4,l.normalMap.anisotropy=h.capabilities.getMaxAnisotropy()/2,l.roughnessMap.anisotropy=h.capabilities.getMaxAnisotropy()/2,l.map.anisotropy=h.capabilities.getMaxAnisotropy()/2,l.roughness=5,l.metalness=0,l.onBeforeCompile=function(m){let x=m.fragmentShader;x=x.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            //vec3 fresnelCol = vec3(254., 103., 57.)/255.;
            vec3 fresnelCol = vec3(0.)/255.;
            ${mM}
            `),x=x.replace("#include <lights_fragment_begin>",`
            ${Gg}
            `),m.fragmentShader=x},l.needsUpdate=!0,l}getToonMaterial_Door(l,h){return l.metalness=.15,l.color=new Sr("#454545"),l.onBeforeCompile=function(m){let x=m.fragmentShader;x=x.replace("#include <lights_physical_pars_fragment>",`
            #include <lights_physical_pars_fragment>
            vec3 fresnelCol = vec3(254., 103., 57.)/255.;
            ${mM}
            `),x=x.replace("#include <lights_fragment_begin>",`
            ${Gg}
            `),m.fragmentShader=x},l.needsUpdate=!0,l}}const zv=new zN;class yf extends k1{get Cloud_Color_1(){return ha.uniforms.color_1.value}set Cloud_Color_1(l){ha.uniforms.color_1.value.copy(l)}get intensity_Color_1(){return ha.uniforms.color_intensity_1.value}set intensity_Color_1(l){ha.uniforms.color_intensity_1.value=l}get Cloud_Color_2(){return ha.uniforms.color_2.value}set Cloud_Color_2(l){ha.uniforms.color_2.value.copy(l)}get intensity_Color_2(){return ha.uniforms.color_intensity_2.value}set intensity_Color_2(l){ha.uniforms.color_intensity_2.value=l}update(l){}}vf([ys()],yf.prototype,"Cloud_Color_1",1);vf([ys({min:0,max:20,step:.001})],yf.prototype,"intensity_Color_1",1);vf([ys()],yf.prototype,"Cloud_Color_2",1);vf([ys({min:0,max:20,step:.001})],yf.prototype,"intensity_Color_2",1);class BN extends _a{constructor(){super(...arguments);N(this,"zLength",212.4027);N(this,"offset",new mn(0,34,200));N(this,"extendNum",1);N(this,"RoadUnitLength",0);N(this,"hasStartGame",!1);N(this,"obj");N(this,"shouldStop",!1);N(this,"doorHasCreate",!1);N(this,"shouldOpenDoor",!1);N(this,"originPosList",[]);N(this,"mixerList",[]);N(this,"hasLoadBackground",!1)}onLoad(){const h=this.viewer.user.resources.SM_Road;this.viewer.scene.add(h),h.traverse(x=>{x.receiveShadow=!0,x instanceof yo&&(x.material=zv.getToonMaterial_Road(x.material,this.viewer.renderer),x.receiveShadow=!0)});for(let x of h.children)x.scale.multiplyScalar(.1),x.position.multiplyScalar(.1),x.position.sub(this.offset);let m=h.children.length;this.RoadUnitLength=m;for(let x=0;x<this.extendNum;x++)for(let _=0;_<m;_++){let A=this.cloneObject3D(h.children[_]);A.position.add(new mn(0,0,-this.zLength*(1+x))),h.add(A)}this.zLength*=1+this.extendNum,this.obj=h;for(let x=0;x<this.obj.children.length;x++)this.originPosList.push(this.obj.children[x].position.clone());this.on("start",this._startGame,this,!0)}update(h){if(this.obj&&!this.shouldStop){for(let m=0;m<this.obj.children.length;m++)if(this.obj.children[m].position.z>Mi.z){m%this.RoadUnitLength==0&&this.hasStartGame&&(this.shouldStop=!0,this._showDoor(this.obj.children[m].position.z),gt.emit("showDoor",this.obj.children[m].position.z)),this.obj.children[m].position.sub(new mn(0,0,this.zLength)),this.originPosList[m].sub(new mn(0,0,this.zLength));let x=this.originPosList[m].clone();this.obj.children[m].position.add(new mn(0,-70,0)),Qi.TweenManager.KillTweensOf(this.obj.children[m]),Qi.TweenManager.Tween(this.obj.children[m]).to({position:x},2).easing(Qi.Easing.Back.Out).start()}}for(let m of this.mixerList)m.time+h>1.4583333333333333?(this.doorHasCreate||(gt.emit("doorCreate"),this._creatBackground()),this.shouldOpenDoor&&m.time+h*1.6<m.timeScale*m._actions[0]._clip.duration&&m.update(h*1.6)):m.update(h)}cloneObject3D(h){return h.clone()}_startGame(){this.hasStartGame=!0}_showDoor(h){this.viewer.load({url:"Genshin/Login/DOOR.glb"}).then(m=>{gt.emit("doorCreateBegin"),m.traverse(x=>{x instanceof yo&&(x.castShadow=!0,x.receiveShadow=!0,x.material=zv.getToonMaterial_Door(x.material,this.viewer.renderer))}),m.scale.set(.1,.1,.04);for(let x of m.animations){const _=new U4(m);_.clipAction(x).setLoop(K4,1),_.clipAction(x).play(),this.mixerList.push(_)}this.offset.set(0,-this.offset.y,h-this.extendNum*this.zLength-14),m.position.copy(this.offset)})}_creatBackground(){this.hasLoadBackground||(this.viewer.load({url:"Genshin/Login/WHITE_PLANE.glb"}).then(h=>{h.scale.set(.1,.1,.1),h.traverse(m=>{m instanceof yo&&(m.material.color=new Sr("#ffffff").multiplyScalar(3))}),h.position.copy(this.offset),this.doorHasCreate=!0}),this.hasLoadBackground=!0)}openDoor(){this.shouldOpenDoor=!0}}const HN=`
vec3 rgb2hsv(vec3 c)
{
    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

    float d = q.x - min(q.w, q.y);
    float e = 1.0e-10;
    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
}

vec3 hsv2rgb(vec3 c)
{
    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
`;class jN extends G4{constructor(){super("CustomEffect",`
            ${HN}
            ${ic}
            uniform float intensity;
            uniform float whiteAlpha;
            void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
                vec3 linear = aces_fitted(inputColor.rgb);
                vec3 hsv = rgb2hsv(linear);
                hsv.z += intensity; 
                
                vec3 color = mix(hsv2rgb(hsv),vec3(1.),whiteAlpha);
                color = clamp(color,vec3(0.),vec3(1.));
                color = ACES_Inv(color);

                outputColor.rgb = color;
                outputColor.a = inputColor.a;
            }
        `),this.uniforms.set("intensity",new pM(0)),this.uniforms.set("whiteAlpha",new pM(0))}}class GN extends V4{constructor(){super(...arguments);N(this,"_intensity",0)}initialize(h){this.effect=new jN}playTransition(){Qi.TweenManager.Timeline(this.effect.uniforms.get("intensity")).to({value:3},.84,{easing:Qi.Easing.Cubic.In}).start(),Qi.TweenManager.Timeline(this.effect.uniforms.get("whiteAlpha")).delay(.5).to({value:1},.2).start()}recoverTransition(){}}var VN=Object.defineProperty,WN=Object.getOwnPropertyDescriptor,zT=(a,l,h,m)=>{for(var x=m>1?void 0:m?WN(l,h):l,_=a.length-1,A;_>=0;_--)(A=a[_])&&(x=(m?A(l,h,x):A(x))||x);return m&&x&&VN(l,h,x),x};const Cn=new j4(16736802,35);class B1 extends _a{constructor(){super(...arguments);N(this,"_originalPos",new mn)}onLoad(h){this._originalPos.set(1e4,0,6e3),this._originalPos.y=Math.sqrt(Math.pow(this._originalPos.x,2)+Math.pow(this._originalPos.z,2))/1.35;let m=new $4;this.viewer.scene.add(m),Cn.target=m,Cn.castShadow=!0,Cn.shadow.mapSize.width=1024,Cn.shadow.mapSize.height=1024,Cn.shadow.camera.top=400,Cn.shadow.camera.bottom=-100,Cn.shadow.camera.left=-100,Cn.shadow.camera.right=400,Cn.shadow.camera.near=1,Cn.shadow.camera.far=5e4,Cn.shadow.bias=-5e-5,this.viewer.scene.add(Cn),this.viewer.renderer.shadowMap.enabled=!0}update(h){Cn.position.copy(Mi.clone().add(this._originalPos)),Cn.target.position.copy(Mi)}get color(){return Cn.color}set color(h){Cn.color.copy(h)}get intensity(){return Cn.intensity}set intensity(h){Cn.intensity=h}}zT([ys()],B1.prototype,"color",1);zT([ys({min:0,max:100,step:.01})],B1.prototype,"intensity",1);const H1=206e3,XN=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec3 vPositionW;

float random(float seed) {
    return fract(sin(seed) * 43758.5453);
}

void main() {
    #include <clipping_planes_fragment>
    vec3 outgoingLight = vec3( 0.0 );
    vec4 diffuseColor = vec4( diffuse, opacity );
    #include <logdepthbuf_fragment>

    #if defined( USE_MAP ) || defined( USE_ALPHAMAP )
        vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
    #endif
    #ifdef USE_MAP
        float rr = vColor.r+vColor.g+vColor.b;
        float randomInt = float(int(random(rr) * 3.0));
        diffuseColor.a *= texture2D( map, vec2(uv.x/3.+randomInt/3.,uv.y)).r;
    #endif
    #ifdef USE_ALPHAMAP
        diffuseColor.a *= texture2D( alphaMap, uv ).g;
    #endif
    //与相机距离越近，透明度降低
    float distanceToCamera = distance(cameraPosition.xyz,vPositionW);
    diffuseColor.a*=smoothstep(1500.,5000.,distanceToCamera);

    #include <color_fragment>
    #include <alphatest_fragment>
    outgoingLight = diffuseColor.rgb;
    #include <output_fragment>
    #include <tonemapping_fragment>
    #include <encodings_fragment>
    #include <fog_fragment>
    #include <premultiplied_alpha_fragment>
}`,qN=`uniform float size;
uniform float scale;
uniform float time;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec3 vPositionW;
float random(float seed) {
    return fract(sin(seed) * 43758.5453);
}

void main() {
    #include <color_vertex>
    #include <morphcolor_vertex>
    #include <begin_vertex>

    //进行随机移动
    float moveLen = 500.;

    vColor;
    transformed+=vec3((random(vColor.r)-0.5)*2.,(random(vColor.g)-0.8)*2.,(random(vColor.b)-0.5)*2.)*sin(time*(0.1*random(vColor.b))+random(vColor.g))*moveLen;
    vColor.a = smoothstep(0.,0.2,sin(time*(1.2*random(vColor.b)+0.4)+random(vColor.g))-0.8);

    #include <morphtarget_vertex>
    #include <project_vertex>
    gl_PointSize = size;
    #ifdef USE_SIZEATTENUATION
        bool isPerspective = isPerspectiveMatrix( projectionMatrix );
        if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
    #endif
    #include <logdepthbuf_vertex>
    #include <clipping_planes_vertex>
    #include <worldpos_vertex>
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    #include <fog_vertex>
}`;let YN=[{Object:"Plane",Location:[39188.92,26406.37,41612.57],Rotation:[1.57,-.85,0]},{Object:"Plane",Location:[38546.52,180333.61,43235.39],Rotation:[1.57,-.85,0]},{Object:"Plane",Location:[47130.91,101574.17,48893.04],Rotation:[1.57,-.85,0]}];class QN extends _a{constructor(){super(...arguments);N(this,"PolarLightTransforms",[]);N(this,"lightInst");N(this,"starParticle")}onLoad(){const h=YN;for(let x of h){let _={position:new mn(x.Location[0]*.1,x.Location[2]*.1,-x.Location[1]*.1),rotation:new F1().setFromEuler(new DT(x.Rotation[0],-x.Rotation[1],x.Rotation[2])),scale:new mn(.1,.1,.1)};this.PolarLightTransforms.push(_)}let m=function(x,_){return x.position.z-_.position.z};this.PolarLightTransforms.sort(m),this.viewer.load({url:"Genshin/Login/SM_Light.glb"}).then(x=>{x.traverse(_=>{if(_ instanceof yo){const A=new I1(_.geometry,vM,this.PolarLightTransforms.length);this.viewer.scene.add(A),this.lightInst=A,this.updateInstance()}}),this.viewer.scene.remove(x)}),this.viewer.addPlugin(ZN,{PolarLightTransforms:this.PolarLightTransforms})}update(h){if(vM.uniforms.time.value+=h,this.lightInst&&this.PolarLightTransforms[this.PolarLightTransforms.length-1].position.z>Mi.z){const m=this.PolarLightTransforms.pop();m.position.z-=H1*.1,this.PolarLightTransforms.unshift(m),this.updateInstance()}}updateInstance(){for(let h=0;h<this.PolarLightTransforms.length;h++){const m=new N1;m.compose(this.PolarLightTransforms[h].position,this.PolarLightTransforms[h].rotation,this.PolarLightTransforms[h].scale),this.lightInst.setMatrixAt(h,m)}this.lightInst.instanceMatrix.needsUpdate=!0}}class ZN extends k1{constructor(){super(...arguments);N(this,"particlesGeometry");N(this,"particles");N(this,"particlesMaterial");N(this,"LightTransforms")}onLoad({PolarLightTransforms:h}){this.LightTransforms=h;const m=[],x=[],_=400;for(let K=0;K<_;K++){const ge=(Math.random()-.5)*2500,ve=(Math.random()-.5)*2500,fe=(Math.random()-.5)*1e3;m.push(ge,ve,fe);const Ce=Math.random()*3-.2,Fe=Math.random()*3+.5,Ue=Math.random()*3+1,vt=1;x.push(Ce,Fe,Ue,vt)}this.particlesGeometry=new B4;const k=new $u().load("Genshin/Login/Textures/Tex_0075.png"),B=new tN({size:100,transparent:!0,vertexColors:!0,depthWrite:!1,map:k});B.userData={time:{value:0}},B.onBeforeCompile=(K,ge)=>{K.uniforms.time=B.userData.time,K.fragmentShader=XN,K.vertexShader=qN},this.particlesMaterial=B,this.particles=new eN(this.particlesGeometry,B),this.particlesGeometry.setAttribute("position",new hM(m,3)),this.particlesGeometry.setAttribute("color",new hM(x,4)),this.particles.position.set(0,0,-1e3),this.viewer.scene.add(this.particles)}update(h){this.particles.position.set(Mi.x,Mi.y,Mi.z-200),this.particlesMaterial.userData.time.value+=h;let m=this.LightTransforms[this.LightTransforms.length-1].position.clone();m.add(new mn(-2400,-3e3,0)),m.equals(this.particles.position)||this.particles.position.copy(m)}}let mu=[{Object:"Plane",Location:[-60488.11,30484.8,-6891.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-69542.77,101073.62,-6497.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44203.43,57784.28,-11918.68],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-40366.7,181360.72,-11099.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-72774.31,46232.82,-5950.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38697.31,102738.58,-13675.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-39697.58,89473.2,-12885.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-70576.63,98760.97,-5235.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11577.29,20967.52,-8495.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53051.34,58629.79,-8506.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-40641.91,64329.8,-12371.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66843.48,29598.76,-6530.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-42266.62,117846.26,-11546.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-48705.39,101066.07,-10441.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49567.87,164044.48,-10240.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63117.21,134433.47,-8259.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38076.25,28385.15,-11646.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63856.56,63654.14,-6040.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47108.72,146434.25,-9769.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-65756.09,55139.4,-8018.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66542.17,71700.15,-6776.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-52955.52,118478.04,-8090.08],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-46181.9,17829.44,-12024.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-67787.98,101975.33,-7922.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-70802.82,74705.08,-5455.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77337.82,42162.42,-3855.2],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-58027.16,171653.22,-8907.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47533.1,65320.45,-10543.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-78667.24,28819.17,-3939.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38111.49,79744.12,-11381.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-61521.25,67721.06,-7865.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44977.68,8419.15,-12344.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-41123.9,112317.79,-11020.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49029.45,153857.14,-10354.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47707.91,191223.48,-11574.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-74357.59,77016.9,-6039],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-60313.66,111327.62,-9280.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38888.7,158582.42,-13395.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64989.38,18268.15,-6906.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47702.64,29095.63,-11841.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-37533.73,204645.06,-11568.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-69394.3,30884.51,-7636.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-68848.27,47398.38,-6964.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-38732.76,43229.99,-11517.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-73883.41,17287.79,-6478.6],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-44755.27,58276.9,-9764.92],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-39071.59,51918.05,-11078.43],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63274.73,40025.57,-8652.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-62579.56,50923.39,-8502.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-42790.08,51176.43,-11429.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53200.27,67074.03,-10203.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77784.38,5304.76,-4549.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-49289.36,151485.28,-9629.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-55640.91,190088.7,-10384.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-53048.9,175399.2,-10796.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66006.77,86973.08,-6132.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-43524.03,54104.23,-10704.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-47088.84,80199.55,-9276.33],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-77146.67,58302.61,-3942.77],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66249.42,15264.65,-6270.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64073.55,123106.3,-6906.44],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-46229.73,130501.7,-10025.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-82490.97,173482.25,-4353.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-80608.41,144983.98,-2785.73],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-86136.46,162263.17,-3370.05],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81995.86,158964.97,-2667.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81583.3,86139.34,-4563.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-63542.82,191916.59,-8719.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84895.84,94419.38,-3594.49],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-64876.92,181148.41,-6024.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-67078.11,187838.31,-5642.94],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-66333.29,171824.92,-7252.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84164.83,50794.71,-2514.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-75747.9,93340.18,-5363.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-86779.97,69595.43,-3190.09],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-68075.7,160090,-6346.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-81496.24,184704,-5170.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-74364.87,125927.47,-6323.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-76422.23,128279.49,-5181.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-84114.8,78938.19,-3427.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-80861.78,199222.39,-4110.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-90903.52,80324.41,-1891.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-65615.95,200893.42,-6966.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-89984.97,193926.34,-2505.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-79432.23,98348.16,-4836.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-75866.27,166627.03,-6072.61],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-61931.27,171435.47,-7012.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-72609.31,157633.53,-6800.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-71874.77,112376.08,-5185.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-58272.69,194003.62,-8954.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33191.57,192969.95,-12168.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7729.77,203302.69,-12044.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33448.5,124687.7,-14101.5],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10800.77,191961.03,-13088.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26776.67,124435.65,-13278.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-6388.23,188151.53,-11936.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[33506.66,167310.17,-12751.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10470.86,124911.66,-12972.34],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[21894.78,153700.95,-11352.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22500.16,104625.02,-11561.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[15021.9,161372.28,-13835.44],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35952.62,8960.45,-12680.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[24983.55,169113.8,-11648.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7514.82,207115.61,-12237.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36099.28,199031.14,-12898.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[30087.89,181245.11,-11916.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[34063.2,97968.63,-14079.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11050.82,106841.92,-13121.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[32327.57,102022.19,-12596.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[8259.29,135051.55,-12240.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35508.52,194710.14,-14040.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[13806.81,131640.5,-13873.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11197.23,203040.88,-12422.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[20678.98,92152.57,-13003.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[27871.1,108478.56,-11428.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[14984.64,203967.14,-12377.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[13265.85,139993.58,-13118.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[31890.34,156823.81,-12186.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23321.93,190977.06,-13803.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10227.62,202461.75,-13626.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[24688.1,69232.33,-12567.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[15203.11,188450.92,-11680.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36308.25,63836.87,-13727.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23746.79,206325.89,-12324.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11698.77,198823.94,-13880.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[19291.59,81163.95,-13557.63],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[16262.82,207534.09,-12083.66],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[12134.07,147130.5,-12981.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26012.87,138733.91,-11915.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[3466.73,183045.06,-12574.12],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22092.25,188174.31,-13289.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36754.02,51818.83,-11973.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[8574.26,153492.7,-12620.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[30644.81,186736.53,-13303.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[35201.45,106908.62,-13286.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[23851.34,78647.8,-12721.8],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22179.39,167124.92,-13018.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[31671.54,50759.5,-12471.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[11813.79,143170.44,-13022.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34351.11,27696.56,-12688.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[21255.91,6485.1,-11217.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11208.84,102613.62,-13130.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33057.55,68809.81,-13096.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[4234.78,51710.18,-11486.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[1667.21,71991.79,-14084.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-3965.94,149901.31,-13356.85],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23668.09,192454.53,-13715.24],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[34579.93,535.9,-12641.43],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12943,136305.36,-11375.42],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36129.8,179558.42,-11778.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21417.77,104294.96,-13669.01],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[18684.31,43129.44,-13519.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[10694.96,31095.83,-8981.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-29257.06,34978.15,-12890.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-11700.69,128994.75,-12722.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26687.75,37564.85,-12873.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-18283.91,68041.17,-12362.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23971.93,53742.49,-12644.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[1813.69,101170.84,-12334.53],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[201.05,132976.06,-13340.41],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-109.44,27352.04,-13497.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-29617.71,131991.28,-13137.96],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-31325.67,166604.19,-13429.68],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34200.95,156391.66,-13779.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7907.19,39106.35,-11793.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-798.99,83786.37,-12406.34],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-32995.72,124826.48,-11257.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-8568.22,119949.73,-13907.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21707.48,89456.42,-11855.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-13206.12,108514.83,-12494.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36359.77,147442.47,-14037.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-20089.54,125311.23,-11847.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-24227.66,206625,-11776.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-10234.68,116258.25,-12829.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23368.36,114280.21,-13810.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[22199.9,47657.26,-13026.88],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23635.01,28632.46,-11560.63],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6880.52,87265.32,-13670.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-27647.29,86538.07,-13170.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-27256.34,69600.05,-11908.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-15893.25,60098.4,-11558.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33723.85,193627.64,-11240.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-23819.21,76624.97,-8963.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-8552.08,8124.37,-13352.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-33068.69,127354.11,-12455.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-3920.98,91168.34,-13107.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-2587.8,125725.26,-11725.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[886.14,134066.64,-13209.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-16435.53,43916.24,-12313.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36057.67,34172.8,-12659.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-35375.84,181701.91,-11995.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-10987.94,50148.55,-11494.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7678.29,38058.29,-12141.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6170.16,48239.19,-13554.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[2379.64,25611.57,-12964.82],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1434.87,118983.62,-13924.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-17754.98,71741.3,-12472.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-4099.07,83695.23,-13730.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-19459.88,121049.45,-12919.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[6969.36,32893.25,-12802.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-6095.34,96087.12,-12933.86],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-32797.46,71242.98,-13183.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[16729.79,11503.73,-12044.45],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-15198.83,103351.99,-12469.89],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-22466.19,192079.95,-13829.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1313.15,99086.27,-12820.38],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-36871.18,185380.89,-12529.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-35360.94,7367.01,-11563.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12880.47,169898.52,-12104.35],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-26283.14,114315.76,-12690.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[26090.14,1625.05,-12106.72],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[17351.56,62470.75,-13134.32],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-21606.88,101088.28,-12209.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-175.6,51561.08,-9890.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[20253.86,20200.81,-13226.5],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7315.29,38971.62,-11814.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-34409.87,153439.33,-12254.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-22889.51,195137.83,-13730.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-13531.78,44644.05,-13348.08],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-26576.53,28506.67,-12224.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-9095.18,57368.46,-12946.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-12337.18,52056.7,-12155.97],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-17948.2,33375.7,-13310.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-1353.68,31655.12,-13855.3],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7224.22,104272.54,-13626.86],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71511.45,107899.02,-7124.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72810.08,49857.28,-6531.54],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[64592.77,101436.56,-7718.37],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[73622.58,51558.74,-6659.51],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[43200.82,18227.13,-12499.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82170.21,124002.15,-3823],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[57687.3,6002.62,-8528.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[66682.44,62333.83,-6221.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[52207.59,65898.03,-9726.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62883.23,20746.46,-6422.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71609.9,168502.23,-4851.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[67136.91,65582.41,-5919.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75239.44,110216.45,-6259.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[56903.44,75679.29,-8625.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82051.9,-1572.71,-3188.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70423.33,94955.27,-6042.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72738.38,131873.92,-4846.06],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[59108.46,77306.6,-9113.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58786.59,93678.12,-7196.81],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89295.12,11261.52,-3815.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[61955.38,52479.84,-7401.91],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[63051.84,96387.06,-8603.96],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[83699.05,64346.81,-1973.48],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[85843.8,204874.86,-1584.47],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70186.14,69562.7,-5121.26],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[85904.45,171221.14,-3911.47],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49979.89,36179.12,-11089.29],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[70919.38,173793.12,-6153.13],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[83566.2,136606.17,-3045.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[87411.4,5028.76,-3804.73],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[76811.52,2662.42,-5780.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58347.78,980.65,-7687.67],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75660.41,9705.05,-5236.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[80207.13,24260.02,-3198.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46530.74,30774.18,-10716.83],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[68274.11,69517.43,-7040.79],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[88295.8,143629.58,-1557.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[72078.51,161115.12,-4719.27],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[74671.67,130453.27,-4800.87],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[77906.59,145324.61,-3230.64],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[42864.79,10651.66,-10540.39],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65980.25,79478.13,-6033.32],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[82617.17,120626.51,-2973.77],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89755.86,50612.07,-1160.1],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[91043.76,77887.8,-2530.57],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[90599.33,109670.28,-2722.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[90479.91,120468.84,-3154.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[71373.92,180298.23,-4948.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65874.48,33575.15,-7683.76],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62643.75,90847.28,-8991.11],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[81936.69,37121.51,-3387.95],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45169.82,791.72,-12092.89],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[77392.2,110209.6,-5039],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[79861.74,102198.28,-5329.04],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62561.84,12948.66,-7417.93],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[89089.84,112020.41,-2143.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[56783.67,48e3,-9931.19],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[69571.55,57019.32,-6273.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[80563.8,113249.64,-4021.71],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[86451.38,38681.21,-2109.67],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[75966.5,80977.07,-4593.61],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[42461.85,-2206.48,-10773.84],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[66021.14,180875.58,-6845.62],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44038.62,115115.38,-9916.46],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[65524.25,173954.56,-6129.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49752.55,78332.03,-9069.02],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[63932.05,150056.62,-8121.16],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[37629.06,99027.16,-13346.15],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[43775.45,156398.53,-9922.48],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[36576.96,23631.96,-7747.9],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45697.84,147818.84,-11227.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[49266.07,175812.95,-8835],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[50142.55,169308.12,-10517.14],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[45726.14,195604.75,-10526.59],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[54675.18,149483.39,-7877.56],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[69604.1,181135.42,-6380.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44948.47,176907.08,-11097.99],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[39166.82,61122.98,-10930.74],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[44173.32,143495.72,-10092.98],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[62606.25,167094.27,-8288.03],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[52247.95,102230.37,-8862.07],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46775.55,194146.84,-11945.28],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[40302,56987.04,-10790.31],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[59000.56,126305.89,-9596.36],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[55809.79,206690.89,-8221.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[40529.25,200411.97,-11612.78],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[54145.5,113944.23,-9723.22],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46014.91,133397.47,-10047.7],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[57505.39,140903.88,-9929.23],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[46285.07,117698.52,-9400.18],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[58556.93,207930.09,-8139.21],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[67890.2,177279.2,-7288.58],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[61931.2,188274.8,-7540.75],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[53601.83,108660.44,-9249.3],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[60339.25,194334.88,-8445.55],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[60801.77,180457.8,-7048.52],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[53743.35,182143.38,-10774.65],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[7154.81,13400.49,-9534.17],Rotation:[1.57,-0,0],Scale:[300,300,300]},{Object:"Plane",Location:[-7615.13,110930.13,-9485.18],Rotation:[1.57,-0,0],Scale:[300,300,300]}];class KN extends _a{constructor(){super(...arguments);N(this,"posList",[]);N(this,"instanceMesh")}onLoad(h){const m=new OT(3e3,1500),x=new I1(m,ha,mu.length);for(let A=0;A<mu.length;A++){const k=new mn(mu[A].Location[0],mu[A].Location[2],-mu[A].Location[1]).multiplyScalar(.1);this.posList.push(k)}let _=function(A,k){return A.z-k.z};this.posList.sort(_),this.instanceMesh=x,this.updateInstance(),this.viewer.scene.add(x)}update(h){if(this.instanceMesh&&this.posList[this.posList.length-1].z>Mi.z){const m=this.posList.pop();m.z-=H1*.1,this.posList.unshift(m),this.updateInstance()}}updateInstance(){const h=new F1,m=new mn(1,1,1);for(let x=0;x<this.posList.length;x++){const _=new N1;_.compose(this.posList[x],h,m),this.instanceMesh.setMatrixAt(x,_)}this.instanceMesh.instanceMatrix.needsUpdate=!0}}class JN extends _a{constructor(){super(...arguments);N(this,"FogList",[]);N(this,"number",1);N(this,"interval",80)}onLoad(h){const m=new OT(1e3,1e3);for(let x=0;x<this.number;x++){const _=new yo(m,gM);_.position.z=-x*this.interval,this.viewer.scene.add(_),this.FogList.push(_)}}update(h){for(let m=0;m<this.FogList.length;m++)this.FogList[m].position.z=Mi.z-m*80-400;gM.uniforms.time.value+=h}}let $N=[{Object:"SM_Qiao01",Location:[-3259.54,55909.38,-8971.05],Rotation:[0,-0,-3.26],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[-9677.17,56694.38,-8971.05],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-16160.93,57487.46,-8971.05],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-19991.23,57955.97,-12244.69],Rotation:[0,-0,-3.26],Scale:[7.49,7.49,7.49]},{Object:"SM_Qiao01",Location:[19413.68,26615.11,-9828.82],Rotation:[0,-0,-5.34],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[6706.94,30988.29,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[10552.28,36268.59,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao01",Location:[16803.78,85760.77,-9828.82],Rotation:[0,-0,-2.88],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[10555.82,84097.91,-9828.82],Rotation:[0,-0,-2.88],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-18525.85,69364.14,-12612.54],Rotation:[0,-0,0],Scale:[9.76,9.76,9.76]},{Object:"SM_ZhuZi01",Location:[-4961.68,77231.14,-16825.37],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-28871.62,103671.23,-11160.32],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[18490.02,38575.96,-18797.49],Rotation:[0,-0,-3.22],Scale:[10.6,10.6,10.6]},{Object:"SM_ZhuZi01",Location:[13441.07,68078.86,-31761.5],Rotation:[0,-0,0],Scale:[16.33,16.33,16.33]},{Object:"SM_ZhuZi01",Location:[13322.26,94559.95,-14267.74],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[4877.59,7859.61,-8885.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-47983.31,98522.4,-21724.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-4796.11,14035.09,-10501.75],Rotation:[0,-0,2.73],Scale:[5.52,5.52,5.52]},{Object:"SM_Qiao01",Location:[-3259.54,154108.7,-9828.82],Rotation:[0,-0,-3.26],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[-9677.17,154893.7,-9828.82],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-16160.93,155686.78,-9828.82],Rotation:[0,-0,-3.26],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-19991.23,156155.3,-9828.82],Rotation:[0,-0,-3.26],Scale:[5.52,5.52,5.52]},{Object:"SM_Qiao01",Location:[7277.17,116763.12,-9828.82],Rotation:[0,-0,-5.34],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[11083.29,121989.55,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[14928.63,127269.85,-9828.82],Rotation:[0,-0,-5.34],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao01",Location:[25034.26,183082.17,-9828.82],Rotation:[0,-0,-2.88],Scale:[.8,.8,.8]},{Object:"SM_Qiao02",Location:[18786.29,181419.3,-9828.82],Rotation:[0,-0,-2.88],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-18525.85,167563.45,-12612.54],Rotation:[0,-0,0],Scale:[9.76,9.76,9.76]},{Object:"SM_ZhuZi01",Location:[21543.86,202600.36,-11815.69],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-28871.62,201870.55,-11160.32],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[27176.13,183971.92,-13077.91],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[9400.02,134814.62,-17395.76],Rotation:[0,-0,-3.22],Scale:[10.6,10.6,10.6]},{Object:"SM_ZhuZi01",Location:[13441.07,166278.17,-33032.77],Rotation:[0,-0,0],Scale:[16.33,16.33,16.33]},{Object:"SM_ZhuZi01",Location:[21552.73,191881.36,-14267.74],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[4877.59,106058.93,-13314.7],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-14183.06,121644.65,-13454.14],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi01",Location:[-47983.31,196721.72,-21724.87],Rotation:[0,-0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[12424.48,53632.54,-8836.33],Rotation:[0,-0,-.14],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[5957.73,54554.15,-8836.33],Rotation:[0,-0,-.14],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[16131.76,53104.19,-15754.45],Rotation:[0,-0,-.14],Scale:[12.56,12.56,12.56]},{Object:"SM_Qiao02",Location:[20564.82,21186.92,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[14154.31,22441.3,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[14190.16,22434.29,-9103.71],Rotation:[0,-0,-.19],Scale:[4.16,4.16,4.16]},{Object:"SM_ZhuZi02",Location:[-24156.43,48468.04,-11681.44],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[12409.99,39026.4,-9229.88],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[13072.63,15697.74,-9052.71],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-20425.44,93584.4,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-13926.08,94237.45,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-24151.42,93210.02,-10667.05],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-13962.42,94233.8,-9103.71],Rotation:[0,-0,-3.04],Scale:[4.16,4.16,4.16]},{Object:"SM_Qiao02",Location:[-12631.35,83666.99,-6470.84],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-7632.57,79462.19,-6470.84],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-43669.46,107924.12,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-46243.29,101920.48,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[24239.87,20467.79,-10667.05],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[12899.75,150950.73,-9694.1],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[6489.23,152205.14,-9694.1],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-7462.1,173587.48,-13131.17],Rotation:[0,-0,-.19],Scale:[12.3,12.3,12.3]},{Object:"SM_Qiao02",Location:[28685.56,121142.08,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[22275.04,122396.45,-12093.55],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[22310.89,122389.44,-9103.71],Rotation:[0,-0,-.19],Scale:[4.16,4.16,4.16]},{Object:"SM_ZhuZi02",Location:[-46214.1,154239.41,-11681.44],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[16786.33,130027.66,-6284.35],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[21461.64,110428.16,-12232.26],Rotation:[0,-0,-.19],Scale:[10.35,10.35,10.35]},{Object:"SM_Qiao02",Location:[-20425.44,191783.73,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-13926.08,192436.77,-12093.55],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-24151.42,191409.36,-10667.05],Rotation:[0,-0,-3.04],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-13962.42,192433.11,-9103.71],Rotation:[0,-0,-3.04],Scale:[4.16,4.16,4.16]},{Object:"SM_Qiao02",Location:[-15131.77,180023.33,-7205.48],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-10132.99,175818.53,-7205.48],Rotation:[0,-0,-3.84],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-43669.46,206123.42,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao02",Location:[-46243.29,200119.8,-12093.55],Rotation:[0,-0,-5.12],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[32360.61,120422.95,-10667.05],Rotation:[0,-0,-.19],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi02",Location:[-10041.13,151780.16,-4538.24],Rotation:[0,-0,-.19],Scale:[4.36,4.36,4.36]},{Object:"SM_ZhuZi02",Location:[-15583.6,24915.45,-16764.29],Rotation:[0,-0,-.19],Scale:[11.01,11.01,11.01]},{Object:"SM_ZhuZi02",Location:[-5821.24,114219,-14220.5],Rotation:[0,-0,-.19],Scale:[8.77,8.77,8.77]},{Object:"SM_ZhuZi02",Location:[18945.66,86650.52,-13077.91],Rotation:[0,-0,-.14],Scale:[11.02,11.02,11.02]},{Object:"SM_Qiao04",Location:[-6615.05,35478.82,-10267.71],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[21913.41,38149.66,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[25049.79,37910.36,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,69364.13,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,69364.14,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7843.3,92904.8,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10854.39,93814.42,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-9760.54,35478.82,-10267.71],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,69364.13,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,69364.14,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-10147.13,133691.66,-6631.95],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[3693.11,135250.05,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[6829.48,135010.75,-4688.34],Rotation:[0,-0,-3.22],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[16073.78,190226.2,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[19084.87,191135.83,-9026.2],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-13292.62,133691.66,-6631.95],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-12802.35,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-15947.84,167563.45,-7371],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10601.09,7859.6,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-21301.37,25171.66,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-18159.03,25030.85,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-23313.97,25261.84,-22485.36],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-19169.94,48441.03,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-22315.43,48441.03,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-17155.32,48441.03,-22345.92],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7455.6,7859.6,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[10601.09,106058.93,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-19900.83,121900.85,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-16758.5,121760.05,-3783.78],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-21913.43,121991.04,-22485.36],Rotation:[0,-0,3.1],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-41227.61,154212.38,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[-44373.1,154212.39,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi03",Location:[-39213,154212.38,-22345.92],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao04",Location:[7455.6,106058.93,-3644.34],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-8441.4,11828.74,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-5816.18,13430.53,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-11060.07,10230.94,-4585.22],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-21684.16,67868.18,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-15456.73,70656.77,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-35647.27,65416.07,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-22937.42,82841.48,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-28350.31,86995.72,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-12151.61,74563.68,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-17564.5,78717.92,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-1365.8,66285.88,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-6778.69,70440.12,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[9420.01,58008.08,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[4007.12,62162.32,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-10240.84,111312.08,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-7615.61,112913.88,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-12859.51,109714.29,-5504.83],Rotation:[0,-0,3.69],Scale:[7.57,7.57,7.57]},{Object:"SM_Qiao03",Location:[-21684.16,166067.5,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-15456.73,168856.08,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-35647.27,163615.41,-1523.6],Rotation:[0,-0,3.56],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-22937.42,181040.8,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-28350.31,185195.05,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-12151.61,172763,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-17564.5,176917.23,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-1365.8,164485.2,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[-6778.69,168639.44,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[9420.01,156207.41,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_Qiao03",Location:[4007.12,160361.66,-8660.21],Rotation:[0,-0,5.63],Scale:[16.79,16.79,16.79]},{Object:"SM_ZhuZi04",Location:[-4725.46,35505.06,-22840.58],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-10787.73,69364.13,-26072.59],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[5914.76,92322.2,-27727.79],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-8132.51,133691.66,-25333.54],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[-10787.73,167563.45,-26072.59],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[14145.23,189643.61,-27727.79],Rotation:[0,-0,-2.85],Scale:[7.57,7.57,7.57]},{Object:"SM_ZhuZi04",Location:[5676.85,35604.1,-19298.23],Rotation:[0,0,0],Scale:[7.57,7.57,7.57]}],dp=new N1,pp=new mn,fp=new F1,mp=new mn,yM=new DT;class e7 extends _a{constructor(){super(...arguments);N(this,"columeInstanceMap",new Map)}onLoad(){const h=this.cloneList($N);for(let m of h)this.columeInstanceMap.has(m.Object)||this.columeInstanceMap.set(m.Object,{indexList:[],instance:[]}),this.columeInstanceMap.get(m.Object).indexList.push(m);for(let m of this.columeInstanceMap.keys())this.viewer.load({url:"Genshin/Login/"+m+".glb"}).then(x=>{let _=this.columeInstanceMap.get(m);x.traverse(A=>{if(A instanceof yo){let k=zv.getToonMaterial_Column(A.material);const B=new I1(A.geometry,k,_.indexList.length);B.castShadow=!0;for(let K=0;K<_.indexList.length;K++){let ge=_.indexList[K];pp.set(ge.Location[0]*.1,ge.Location[2]*.1,-ge.Location[1]*.1),fp.setFromEuler(yM.set(ge.Rotation[0],ge.Rotation[2],ge.Rotation[1])),mp.set(ge.Scale[0]*.1,ge.Scale[2]*.1,ge.Scale[1]*.1),dp.compose(pp,fp,mp),B.setMatrixAt(K,dp)}this.viewer.scene.add(B),_.instance.push(B)}}),this.viewer.scene.remove(x)})}update(h){for(let m of this.columeInstanceMap.values())for(let x=0;x<m.indexList.length;x++)if(-m.indexList[x].Location[1]*.1>Mi.z+2e3){m.indexList[x].Location[1]+=H1,pp.set(m.indexList[x].Location[0]*.1,m.indexList[x].Location[2]*.1,-m.indexList[x].Location[1]*.1),fp.setFromEuler(yM.set(m.indexList[x].Rotation[0],m.indexList[x].Rotation[2],m.indexList[x].Rotation[1])),mp.set(m.indexList[x].Scale[0]*.1,m.indexList[x].Scale[2]*.1,m.indexList[x].Scale[1]*.1),dp.compose(pp,fp,mp);for(let _ of m.instance)_.setMatrixAt(x,dp),_.instanceMatrix.needsUpdate=!0}}cloneList(h){let m=[];for(let x of h)m.push({Object:x.Object,Location:x.Location.slice(),Rotation:x.Rotation.slice(),Scale:x.Scale.slice()});return m}}class t7 extends _a{constructor(){super(...arguments);N(this,"originalPos",new mn);N(this,"vCloud")}onLoad(h){this.viewer.load({url:"Genshin/Login/SM_BigCloud.glb"}).then(m=>{this.vCloud=m;for(let x of m.children)x.position.multiplyScalar(.1),x.scale.multiplyScalar(.1);m.traverse(x=>{x instanceof yo&&(x.renderOrder=-1,x.name=="Plane011"?x.material=IN:x.material=FN)})})}update(h){this.vCloud&&this.vCloud.position.copy(Mi)}}function Vg(a){let l=-(Math.sqrt(10)*Math.sqrt(-187248350*Math.pow(a,2)+232585567*a+241290)+21650*a-1230),h=98370*a-1e5;return l/h}function n7(a){let l=new dM;l.set(1.76474,-.67577,-.08896,-.14702,1.16025,-.01322,-.03633,-.16243,1.19877);let h=new dM;return h.set(.64304,.31119,.04578,.05926,.93144,.00929,.00596,.06393,.93012),a=a.applyMatrix3(h),a.set(Vg(a.x),Vg(a.y),Vg(a.z)),a=a.applyMatrix3(l),a}function i7(a){let l=new mn(a.r,a.g,a.b);return l=n7(l),a.r=l.x,a.g=l.y,a.b=l.z,a}class r7 extends k1{onLoad(){const h=window.innerHeight,m=new Sr().setHex(7252),x=new Sr().setHex(147361),_=new Sr().setHex(2533631),A=.2,k=.6,B=new Float32Array(1*h*4);for(let ge=0;ge<h;ge++)for(let ve=0;ve<1;ve++){const fe=(ge*1+ve)*4;let Ce=1-ge/(h-1),Fe=1-this.smoothstep(0,A,Ce),Ue=this.smoothstep(0,A,Ce)*(1-this.smoothstep(A,k,Ce)),vt=Math.pow(this.smoothstep(A,k,Ce),1),re=new Sr().setRGB(Math.min(Fe*m.r+Ue*x.r+vt*_.r,1e5),Math.min(Fe*m.g+Ue*x.g+vt*_.g,1e5),Math.min(Fe*m.b+Ue*x.b+vt*_.b,1e5));i7(re),B[fe]=re.r,B[fe+1]=re.g,B[fe+2]=re.b,B[fe+3]=1}const K=new H4(B,1,h,nN,q4);K.needsUpdate=!0,this.viewer.scene.background=K}smoothstep(l,h,m){return Math.max(0,Math.min((m-l)/(h-l),1))}}const{TweenManager:a7}=Qi;let s7=Lu.prototype._onResize;function BT(){var a=document.documentElement.clientWidth,l=document.documentElement.clientHeight;a>l?Lu.prototype._onResize=s7:Lu.prototype._onResize=function(){this.viewer.resize(l,a),this.viewer.emit(Lu.RESIZE,l,a)}}BT();var o7="resize";window.addEventListener(o7,BT,!1);class l7{constructor(l){N(this,"viewer");N(this,"SM",new fN(this));this.viewer=new sN({canvas:l,camera:{fov:45,near:50,far:1e5,rotation:k4(5.5*Math.PI/180,0,0)},user:new pN,linear:!1,toneMapping:J4,outputEncoding:Q4}),this.SM.registState(c7),this.SM.registState(u7),this.SM.setState("StatePreload"),this.SM.setState("StateGame")}destroy(){this.SM.reset(),this.viewer.destroy()}}class c7 extends FT{constructor(){super(...arguments);N(this,"name","StatePreload")}onEnter(){const h=this.target.viewer.user.resources;return Promise.all([gt.task(Fn.Load({url:"Genshin/Login/DOOR.glb"}).then(m=>h.DOOR=m),{name:"DOOR"}),gt.task(Fn.Load({url:"Genshin/Login/SM_BigCloud.glb"}).then(m=>h.SM_BigCloud=m),{name:"SM_BigCloud"}),gt.task(Fn.Load({url:"Genshin/Login/SM_Light.glb"}).then(m=>h.SM_Light=m),{name:"SM_Light"}),gt.task(Fn.Load({url:"Genshin/Login/SM_Qiao01.glb"}).then(m=>h.SM_Qiao01=m),{name:"SM_Qiao01"}),gt.task(Fn.Load({url:"Genshin/Login/SM_Qiao02.glb"}).then(m=>h.SM_Qiao02=m),{name:"SM_Qiao02"}),gt.task(Fn.Load({url:"Genshin/Login/SM_Qiao03.glb"}).then(m=>h.SM_Qiao03=m),{name:"SM_Qiao03"}),gt.task(Fn.Load({url:"Genshin/Login/SM_Qiao04.glb"}).then(m=>h.SM_Qiao04=m),{name:"SM_Qiao04"}),gt.task(Fn.Load({url:"Genshin/Login/SM_Road.glb"}).then(m=>h.SM_Road=m),{name:"SM_Road"}),gt.task(Fn.Load({url:"Genshin/Login/SM_ZhuZi01.glb"}).then(m=>h.SM_ZhuZi01=m),{name:"SM_ZhuZi01"}),gt.task(Fn.Load({url:"Genshin/Login/SM_ZhuZi02.glb"}).then(m=>h.SM_ZhuZi02=m),{name:"SM_ZhuZi02"}),gt.task(Fn.Load({url:"Genshin/Login/SM_ZhuZi03.glb"}).then(m=>h.SM_ZhuZi03=m),{name:"SM_ZhuZi03"}),gt.task(Fn.Load({url:"Genshin/Login/SM_ZhuZi04.glb"}).then(m=>h.SM_ZhuZi04=m),{name:"SM_ZhuZi04"}),gt.task(Fn.Load({url:"Genshin/Login/WHITE_PLANE.glb"}).then(m=>h.WHITE_PLANE=m),{name:"WHITE_PLANE"})])}}class u7 extends FT{constructor(){super(...arguments);N(this,"name","StateGame");N(this,"_road");N(this,"_BloomTransition");N(this,"_forwardCamera")}onEnter(...h){this._initScene(),this._initAudios()}_initScene(){const h=this.target.viewer;h.scene.fog=new Y4(3709682,5e3,1e4),h.addNode(U1),h.addNode(B1),h.addNode(QN),h.addNode(KN),h.addNode(JN),h.addNode(e7),h.addNode(t7),this._forwardCamera=h.addNode(yN),this._road=h.addNode(BN),h.addPlugin(r7),h.addPlugin(X4),h.addPlugin(z4,{mipmapBlur:!0,luminanceThreshold:2,intensity:.6}),this._BloomTransition=h.addPlugin(GN),h.addPlugin(aN,{mode:rN.ACES_FILMIC}),gt.on("start",this._startGame,this,!0)}_initAudios(){const h=this.target.viewer,m=h.addNode(uM),x=h.addNode(uM);gt.on("canvas-click",()=>{m.play({url:"/Genshin/BGM.mp3",loop:!0})}),gt.on("button-start-click",()=>{m.play({url:"/Genshin/BGM.mp3",loop:!0}),x.play({url:"/Genshin/Genshin Impact [Duang].mp3",force:!0})}),gt.on("openDoor",()=>{setTimeout(()=>x.play({url:"/Genshin/Genshin Impact [DoorThrough].mp3",force:!0}),150)}),gt.on("doorCreateBegin",()=>{setTimeout(()=>x.play({url:"/Genshin/Genshin Impact [DoorComeout].mp3",force:!0}),150)})}_startGame(h){this._road.emit("start"),gt.on("showDoor",m=>{this._forwardCamera.emit("showDoor",m),gt.on("doorCreate",()=>this.target.viewer.on(Lu.POINTER_DOWN,this._jump,this,!0),this,!0)},this,!0)}_jump(){gt.emit("openDoor"),this._forwardCamera.emit("openDoor"),this._BloomTransition.playTransition(),a7.Timeline(this).delay(.1).call(()=>{this._road.openDoor()}).delay(2).call(()=>{gt.restart(),console.log("restart")}).start()}}Fn.Load({url:"/Genshin/BGM.mp3"});Fn.Load({url:"/Genshin/Genshin Impact [Duang].mp3"});Fn.Load({url:"/Genshin/Genshin Impact [DoorThrough].mp3"});Fn.Load({url:"/Genshin/Genshin Impact [DoorComeout].mp3"});document.documentElement.clientWidth;document.documentElement.clientHeight;function h7({...a}){const l=Mn.useRef(null);return Mn.useEffect(()=>{const h=new l7(l.current);return()=>h.destroy()},[gt.restartCount]),Tt.jsx("aside",{className:"webgl-wrapper",children:Tt.jsx("canvas",{onClick:()=>gt.emit("canvas-click"),ref:l,className:"webgl-canvas",width:"10px",style:{width:"10px"},...a,children:"No Canvas!"})})}function d7(){const[a,l]=Mn.useState(!0);return Mn.useEffect(()=>(gt.on("preloaded",()=>l(!1)),gt.on("restart",()=>l(!0)),()=>{gt.reset(),uN()}),[gt.restartCount]),Tt.jsxs(Tt.Fragment,{children:[Tt.jsx(h7,{}),a&&Tt.jsx(dN,{}),!a&&Tt.jsx(lN,{})]})}function HT(){var a=document.documentElement.clientWidth,l=document.documentElement.clientHeight;const h=document.getElementById("root");a>l?(h.style.transform="rotate(0deg)",h.style.width=`${a}px`,h.style.height=`${l}px`,h.style.top="0px",h.style.left="0px"):(h.style.transform="rotate(90deg)",h.style.width=`${l}px`,h.style.height=`${a}px`,h.style.top=`${(l-a)/2}px`,h.style.left=`${0-(l-a)/2}px`)}HT();var p7="resize";window.addEventListener(p7,HT,!1);Wg.createRoot(document.getElementById("root")).render(Tt.jsx(wO.StrictMode,{children:Tt.jsx(d7,{})}));
